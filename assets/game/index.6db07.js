window.__require=function t(e,i,o){function a(r,s){if(!i[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var d=i[r]={exports:{}};e[r][0].call(d.exports,function(t){return a(e[r][1][t]||t)},d,d.exports,t,e,i,o)}return i[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<o.length;r++)a(o[r]);return a}({AStarFinder:[function(t,e,i){"use strict";cc._RF.push(e,"0fcd3Y6PKdDYapQhfNdn6b9","AStarFinder");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("MapBox"),s=o("StaticGrid"),l=function(){function t(){}return t.backTracePath=function(t,e,i){for(void 0===i&&(i=!1),(e=[]).push(t.tile);t.parent;)t=t.parent,e.push(t.tile);return i||e.reverse(),e},t.getNext=function(t){for(var e=0,i=null,o=0;o<t.length;o++)(!i||i.compareTo(t[o])>0)&&(e=o,i=t[o]);return t.splice(e,1),i},t.findPath=function(e,i){var o,a,l=[],c=null,d=null;e.endToStartPath?(c=e.endNode,d=e.startNode):(c=e.startNode,d=e.endNode);var u=e.heuristicFunc,h=e.searchGrid,p=e.diagonalMovement,f=e.weight,_=e.boat;for(c.startToCurNodeLen=0,c.heuristicStartToEndLen=0,l.push(c),c.isOpened=!0,t.result_split_path=!1,t.lastGlobalRegionID=0;0!=l.length;){if(-1!=e.maxOpenList&&l.length>e.maxOpenList)return i;var m=l.shift();m.isClosed=!0,h.addToClosed(m);var g=m.tile;if(m.equals(d))return t.backTracePath(d,i,e.endToStartPath);if(e.useGlobalPathLock){if(g.region.regionPathID<t.lastGlobalRegionID&&-1!=g.region.regionPathID){m.isClosed=!0,h.addToClosed(m);continue}g.region.regionPathID>t.lastGlobalRegionID&&(t.lastGlobalRegionID=g.region.regionPathID)}var y=p!=s.DiagonalMovement.Never?g.neighboursAll:g.neighbours;try{for(var v=(o=void 0,n(y)),b=v.next();!b.done;b=v.next()){var w=b.value,T=h.m_nodes[w.x][w.y];if(!(T.isClosed||w.type.block&&!e.block)){if(e.useGlobalPathLock){if(w.region.regionPathID<t.lastGlobalRegionID&&-1!=w.region.regionPathID){m.isClosed=!0,h.addToClosed(m);continue}if(w.region.regionPathID>t.lastGlobalRegionID&&(t.lastGlobalRegionID=w.region.regionPathID),!w.region.usedByPathLock){var k=w.edge_region_right;if(!k||!k.usedByPathLock){var B=w.edge_region_up;if(!B||!B.usedByPathLock){m.isClosed=!0,h.addToClosed(m);continue}}}}if(_){if(!w.isGoodForBoat())continue}else{if(w.type.lava&&!e.lava)continue;if(!(e.block&&w.type.block||e.lava&&w.type.lava))if(e.ground&&e.ocean){if(!w.type.ground&&!w.type.ocean)continue}else if(!w.type.ground&&e.ground||!w.type.ocean&&e.ocean||!w.type.swamp&&e.swamp)continue}var S=1;if(e.roads&&r.default.inst.getTileSimple(T.x,T.y).type.road&&(S=.01),t.lastGlobalRegionID>=4&&h.closed_list_count>10)return t.result_split_path=!0,t.backTracePath(m,i,e.endToStartPath);var C=m.startToCurNodeLen+S*(T.x-m.x==0||T.y-m.y==0?1:1.414);(!T.isOpened||C<T.startToCurNodeLen)&&(T.startToCurNodeLen=C,0==T.heuristicCurNodeToEndLen&&(T.heuristicCurNodeToEndLen=f*u(Math.abs(T.x-d.x),Math.abs(T.y-d.y))),T.heuristicStartToEndLen=T.startToCurNodeLen+T.heuristicCurNodeToEndLen,T.parent=m,T.isOpened||(l.push(T),T.isOpened=!0,h.addToClosed(T)))}}}catch(x){o={error:x}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}}return i},t.lastGlobalRegionID=0,t.result_split_path=!1,t}();a.default=l,cc._RF.pop()},{}],AStarParam:[function(t,e,i){"use strict";cc._RF.push(e,"60a56tg8VFPvZkcSfEqijns","AStarParam");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ParamBase=n.Heuristic=n.HeuristicMode=void 0;var s,l=a("StaticGrid");(function(t){t[t.MANHATTAN=0]="MANHATTAN",t[t.EUCLIDEAN=1]="EUCLIDEAN",t[t.CHEBYSHEV=2]="CHEBYSHEV"})(s=n.HeuristicMode||(n.HeuristicMode={}));var c=function(){function t(){}return t.manhattan=function(t,e){return t+e},t.euclidean=function(t,e){var i=t,o=e;return Math.sqrt(i*i+o*o)},t.chebyshev=function(t,e){return Math.max(t,e)},t}();n.Heuristic=c;var d=function(){function t(){this.m_searchGrid=null,this.m_startNode=null,this.m_endNode=null,this.m_heuristic=null}return Object.defineProperty(t.prototype,"heuristicFunc",{get:function(){return this.m_heuristic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchGrid",{get:function(){return this.m_searchGrid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startNode",{get:function(){return this.m_startNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endNode",{get:function(){return this.m_endNode},enumerable:!1,configurable:!0}),t.prototype.setGrid=function(t,e,i){this.m_searchGrid=t,this.m_startNode=this.m_searchGrid.getNodeAt(e.x,e.y),this.m_endNode=this.m_searchGrid.getNodeAt(i.x,i.y),this.m_startNode||(this.m_startNode=new l.ASNode(e.x,e.y,!0)),this.m_endNode||(this.m_endNode=new l.ASNode(i.x,i.y,!0))},t.prototype._reset=function(t,e,i){void 0===i&&(i=null)},t.prototype.reset=function(t,e,i){void 0===i&&(i=null),this._reset(t,e,i),this.m_startNode=null,this.m_endNode=null,i&&(this.m_searchGrid=i),this.m_searchGrid.reset(),this.m_startNode=this.m_searchGrid.getNodeAt(t.x,t.y),this.m_endNode=this.m_searchGrid.getNodeAt(e.x,e.y),this.m_startNode||(this.m_startNode=new l.ASNode(t.x,t.y,!0)),this.m_endNode||(this.m_endNode=new l.ASNode(e.x,e.y,!0))},t.prototype.setHeuristic=function(t){switch(this.m_heuristic=null,t){case s.MANHATTAN:this.m_heuristic=c.manhattan;break;case s.EUCLIDEAN:this.m_heuristic=c.euclidean;break;case s.CHEBYSHEV:this.m_heuristic=c.chebyshev;break;default:this.m_heuristic=c.euclidean}},t}();n.ParamBase=d;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weight=0,e.maxOpenList=-1,e.roads=!1,e.useGlobalPathLock=!1,e.boat=!1,e.limit=!1,e.swamp=!1,e.ocean=!1,e.lava=!1,e.block=!1,e.ground=!1,e.endToStartPath=!1,e}return r(e,t),e.prototype.resetParam=function(){this.roads=!1,this.swamp=!1,this.ocean=!1,this.lava=!1,this.ground=!1,this.useGlobalPathLock=!1,this.boat=!1,this.limit=!1,this.endToStartPath=!1},e}(d);n.default=u,cc._RF.pop()},{}],AchievementItem:[function(t,e,i){"use strict";cc._RF.push(e,"74df44zpAxKSKfWYbfWzuAu","AchievementItem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AchievData"),c=cc._decorator,d=c.ccclass,u=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.desc=null,e.icon=null,e.btnReward=null,e.atlas=null,e.callback=null,e.clicked=!1,e}return r(e,t),e.prototype.start=function(){},e.prototype.click=function(){this.callback&&!this.clicked&&(this.clicked=!0,this.callback())},e.prototype.updateItem=function(t,e){this.clicked=!1,this.callback=e;var i=l.default.getConfigByID(t.id);this.title.string=t.name,this.desc.string=i.desc,this.btnReward.active=!t.awarded,this.btnReward.getChildByName("btn").active=t.complete,this.btnReward.getChildByName("label").active=!t.complete;var o=this.atlas.getSpriteFrame("propIcon-"+i.icon);o&&(this.icon.spriteFrame=o)},s([u(cc.Label)],e.prototype,"title",void 0),s([u(cc.Label)],e.prototype,"desc",void 0),s([u(cc.Sprite)],e.prototype,"icon",void 0),s([u(cc.Node)],e.prototype,"btnReward",void 0),s([u(cc.SpriteAtlas)],e.prototype,"atlas",void 0),s([d],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],AchievementToast:[function(t,e,i){"use strict";cc._RF.push(e,"a4da5J1KK1FIoLMJPWGkv6k","AchievementToast");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AchievData"),c=cc._decorator,d=c.ccclass,u=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.desc=null,e.icon=null,e.atlas=null,e.callback=null,e}return r(e,t),e.prototype.start=function(){var t=this;this.node.y=.8*cc.winSize.height,cc.tween(this.node).to(.3,{y:.4*cc.winSize.height},{easing:"backOut"}).delay(2).to(.3,{y:.8*cc.winSize.height},{easing:"backOut"}).call(function(){t.node.destroy(),t.callback&&t.callback()}).start()},e.prototype.show=function(t,e){this.callback=e;var i=l.default.getConfigByID(t.id);this.title.string=t.name,this.desc.string=i.desc;var o=this.atlas.getSpriteFrame("propIcon-"+i.icon);o&&(this.icon.spriteFrame=o)},s([u(cc.Label)],e.prototype,"title",void 0),s([u(cc.Label)],e.prototype,"desc",void 0),s([u(cc.Sprite)],e.prototype,"icon",void 0),s([u(cc.SpriteAtlas)],e.prototype,"atlas",void 0),s([d],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],AchievementView:[function(t,e,i){"use strict";cc._RF.push(e,"95ab95CWHVOzqdT0XCWe+mo","AchievementView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Tools"),c=a("AdsManager"),d=a("GameTdd"),u=a("AchievData"),h=a("UserData"),p=a("GamePopBase"),f=a("List"),_=a("ViewController"),m=a("GameAudio"),g=a("AdView"),y=a("AwardView"),v=a("AchievementItem"),b=cc._decorator,w=b.ccclass,T=b.property,k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.percent=null,e.progressBar=null,e.btnRewards=[],e.scrollView=null,e.pbItem=null,e.btnShare=null,e.pageIdx=0,e.datas=[],e.totalCfg=[5,20,40,60],e.totalRewardID=[1,1,1,1],e.guiding=!1,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,u.default.dispatcher.on(u.default.eventName,this.updateList,this),c.default.preloadNativeAd()},e.prototype.onDestroy=function(){u.default.dispatcher.off(u.default.eventName,this)},e.prototype.open=function(){t.prototype.open.call(this,function(){}),this.updateList()},e.prototype.onClickToggle=function(t,e){var i=parseInt(e);i!=this.pageIdx&&(m.default.playClick(),this.pageIdx=i,this.btnShare.active=QQ_GAME&&2==i,this.updateList())},e.prototype.updateTop=function(){var t=u.default.getAchievCount()||1,e=u.default.getCompleteCount()||0;this.percent.string="\u6210\u5c31\u8fdb\u5ea6\uff1a"+e+" / "+t,t>0&&(this.progressBar.progress=e/t);for(var i=0;i<this.btnRewards.length;i++)this.btnRewards[i].active=e>=this.totalCfg[i],this.btnRewards[i].parent.active=!h.default.member.achievTotal[i],this.btnRewards[i].parent.getChildByName("close").active=!this.btnRewards[i].active},e.prototype.updateList=function(){switch(this.pageIdx){case 0:this.datas[this.pageIdx]=u.default.getRecommendedList();break;case 1:this.datas[this.pageIdx]=u.default.getAchievingList();break;case 2:this.datas[this.pageIdx]=u.default.getCompleteList(!0)}this.scrollView.getComponent(f.default).numItems=this.datas[this.pageIdx].length,this.updateTop()},e.prototype.updateItem=function(t,e){var i=this;if(!(this.datas[this.pageIdx].length<=e)){var o=this.datas[this.pageIdx][e],a=u.default.getConfigByID(o.id);t.getComponent(v.default).updateItem(o,function(){if(u.default.award(o.id)){var t=[],e=h.default.getPropConfigByID("clock"),n=l.default.fromJson(e,new h.PropConfig);if(n){var r=a.times+.2;n.reward=Math.floor(e.reward*r),t.push(n)}_.default.open(_.view_type.AwardView,null,null,!0,function(e){e.getComponent(y.default).init(y.Reward_type.achiev,t)});var s=d.default.getData("p8",d.v_type.Number)||1;OPPO_GAME&&i.scheduleOnce(function(){var e=c.default.getNativeAdData();e&&_.default.open(_.view_type.AdView,null,null,!1,function(i){i.getComponent(g.default).init(t,e,g.AD_TYPE.achiev)},function(){c.default.preloadNativeAd()})},s)}})}},e.prototype.getTotalReward=function(t,e){var i=parseInt(e),o=this.totalRewardID[i];_.default.open(_.view_type.AwardView,null,null,!0,function(t){t.getComponent(y.default).init(y.Reward_type.achiev,o)}),h.default.member.achievTotal[i]=!0,h.default.save(),this.updateTop()},e.prototype.onClickShare=function(t){m.default.playClick();var e=t.getCurrentTarget().getComponent(cc.Button);e.interactable=!1,setTimeout(function(){e.interactable=!0},1e3),c.default.shareAppMessage({})},e.inst=null,s([T(cc.Label)],e.prototype,"percent",void 0),s([T(cc.ProgressBar)],e.prototype,"progressBar",void 0),s([T([cc.Node])],e.prototype,"btnRewards",void 0),s([T(cc.ScrollView)],e.prototype,"scrollView",void 0),s([T(cc.Prefab)],e.prototype,"pbItem",void 0),s([T(cc.Node)],e.prototype,"btnShare",void 0),i=s([w],e)}(p.GamePopBase);n.default=k,cc._RF.pop()},{}],ActionLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"17de8aMOllMJbI3h7LZfy06","ActionLibrary");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("AchievData"),r=o("MapAction"),s=o("DropsLibrary"),l=o("PowerLibrary"),c=o("TopTileLibrary"),d=o("BaseBuilding"),u=o("Brush"),h=o("ToolBox"),p=o("ViewController"),f=o("Config"),_=o("MapLayer"),m=o("MapBox"),g=o("ActorAsset"),y=o("ActorTool"),v=o("Tornado"),b=function(){function t(){}return t.pyromaniacEffect=function(e,i){var o,a,n,r,s,l,c,d;if(void 0===i&&(i=null),!e.kingdom)return!1;if(!e.currentTile)return!1;if(!(null===(a=null===(o=e.a)||void 0===o?void 0:o.attackTarget)||void 0===a?void 0:a.currentTile))return!1;if(h.Toolbox.randomChance(.95))return!1;var u=h.Toolbox.randomChance(.5)&&(null===(n=e.a)||void 0===n?void 0:n.attackTarget)?y.default.getTileNearby(y.ActorTileTarget.RandomTileWithCivStructures,null===(c=null===(l=null===(s=e.a)||void 0===s?void 0:s.attackTarget)||void 0===l?void 0:l.currentTile)||void 0===c?void 0:c.chunk):y.default.getTileNearby(y.ActorTileTarget.RandomTileWithCivStructures,null===(r=e.currentTile)||void 0===r?void 0:r.chunk);return!(!u||!t.canThrowBomb(e,u)||(null===(d=u.zone.city)||void 0===d?void 0:d.kingdom)&&!e.kingdom.isEnemy(u.zone.city.kingdom)||(t.throwTorchAtTile(e,u),0))},t.throwTorchAtTile=function(t,e){var i=e.posV3,o=cc.Vec3.distance(t.currentPosition,i),a=h.Toolbox.getNewPoint(t.currentPosition.x,t.currentPosition.y,i.x,i.y,o),n=h.Toolbox.getNewPoint(t.currentPosition.x,t.currentPosition.y,i.x,i.y,t.a.curStats.size);n.y+=.5,m.default.inst.stackEffects.startProjectile(n,a,"torch")},t.bombermanEffect=function(e,i){var o,a,n;if(void 0===i&&(i=null),h.Toolbox.randomChance(.98)||!(null===(o=null==e?void 0:e.a)||void 0===o?void 0:o.currentPosition)||!(null===(n=null===(a=null==e?void 0:e.a)||void 0===a?void 0:a.attackTarget)||void 0===n?void 0:n.currentPosition))return!1;var r=null;if(e.a.attackTarget&&h.Toolbox.distVec3(e.a.currentPosition,e.a.attackTarget.currentPosition)>4&&(r=e.a.attackTarget.currentTile),!r&&h.Toolbox.randomChance(.5)&&(r=y.default.getTileNearby(y.ActorTileTarget.RandomTileWithUnits,e.currentTile.chunk))){for(var s=!1,l=0;l<r.chunk.k_list_objects.length;l++){var c=r.chunk.k_list_objects[l];if(!c.isNature()&&e.kingdom.isEnemy(c)){r=e.currentTile,s=!0;break}}s||(r=null)}return!r&&h.Toolbox.randomChance(.5)&&(r=y.default.getTileNearby(y.ActorTileTarget.RandomTNT,e.currentTile.chunk)),r||(r=y.default.getTileNearby(y.ActorTileTarget.RandomBurnableTile,e.currentTile.chunk)),!!r&&!!t.canThrowBomb(e,r)&&(t.throwBombAtTile(e,r),!0)},t.canThrowBomb=function(t,e){void 0===e&&(e=null);var i=h.Toolbox.distVec2Float(cc.v2(t.a.currentPosition),e.pos);return i>3&&i<26},t.throwBombAtTile=function(t,e){void 0===e&&(e=null);var i=e.posV3,o=cc.Vec3.distance(t.currentPosition,i),a=h.Toolbox.getNewPoint(t.currentPosition.x,t.currentPosition.y,i.x,i.y,o),n=h.Toolbox.getNewPoint(t.currentPosition.x,t.currentPosition.y,i.x,i.y,t.a.curStats.size);n.y+=.5,m.default.inst.stackEffects.startProjectile(n,a,"firebomb")},t.zombieEffect=function(t,e){return void 0===e&&(e=null),t.a.spawnParticle(h.Toolbox.color_infected),h.Toolbox.randomChance(.25)&&t.a.startShake(.2,.05,!0,!1),!0},t.infectedEffect=function(t,e){if(void 0===e&&(e=null),t.a.spawnParticle(h.Toolbox.color_infected),t.a.startShake(.4,.2,!0,!1),h.Toolbox.randomChance(.05)){var i=t.a.data.health/10;t.a.getHit(Math.max(i,100))}return!0},t.mushSporesEffect=function(t,e){void 0===e&&(e=null),m.default.inst.getObjectsInChunks(e,3,_.MapObjectType.Actor),m.default.inst.temp_map_objects.shuffle();for(var i=3,o=0;o<m.default.inst.temp_map_objects.length;o++){var a=m.default.inst.temp_map_objects[o];if(a!=t.a&&!h.Toolbox.randomChance(.7)&&a.addTrait("mushSpores")&&(a.spawnParticle(h.Toolbox.color_mushSpores),0==--i))break}return!0},t.tumorEffect=function(t,e){return void 0===e&&(e=null),t.a.startShake(.4,.2,!0,!1),h.Toolbox.randomChance(.1)&&t.a.getHit(.1*t.a.curStats.health,!1,g.AttackType.Tumor,null,!1),!0},t.healingAuraEffect=function(t,e){if(void 0===e&&(e=null),h.Toolbox.randomChance(.2)){m.default.inst.getObjectsInChunks(e,4,_.MapObjectType.Actor);for(var i=0;i<m.default.inst.temp_map_objects.length;i++){var o=m.default.inst.temp_map_objects[i];o!=t.a&&o.data.health<o.curStats.health&&(o.restoreHealth(10),o.spawnParticle(h.Toolbox.color_heal),o.removeTrait("plague"))}}return!0},t.regenerationEffect=function(t,e){if(void 0===e&&(e=null),t.a.haveTrait("infected"))return!0;var i=!0;return t.a.stats.needFood&&(i=t.a.data.hunger>0),t.a.data.health!=t.a.curStats.health&&i&&h.Toolbox.randomChance(.2)&&(t.a.restoreHealth(1),t.a.spawnParticle(h.Toolbox.color_heal)),!0},t.coldAuraEffect=function(t,e){return void 0===e&&(e=null),m.default.inst.loopWithBrush(t.currentTile,u.default.getBrushBySize(4),l.default.drawTemperatureMinus,"coldAura"),!0},t.plagueEffect=function(e,i){return void 0===i&&(i=null),t.tickPlagueInfection(e.a),e.a.startShake(.4,.2,!0,!1),h.Toolbox.randomChance(.07)&&e.a.getHit(.1*e.a.curStats.health,!1,g.AttackType.Plague,null,!1),!0},t.ratEffect=function(e,i){return void 0===i&&(i=null),h.Toolbox.randomChance(.7)&&y.default.countRatsNearby(e.a)>10&&h.Toolbox.randomChance(.2)&&t.tickPlagueInfection(e.a),!0},t.tickPlagueInfection=function(t){if(t.spawnParticle(h.Toolbox.color_plague),h.Toolbox.randomChance(.05))for(var e=0;e<t.currentTile.chunk.k_list_objects.length;e++)for(var i=t.currentTile.chunk.k_list_objects[e],o=t.currentTile.chunk.k_dict_objects.get(i),a=0;a<o.length;a++){var n=o[a];n.objectType!=_.MapObjectType.Actor||!n.base_data.alive||h.Toolbox.randomBool()||h.Toolbox.distVec3(t.currentPosition,n.currentPosition)>6||n.a.addTrait("plague")}},t.burningFeetEffectTileDraw=function(t){return t.type.frozen&&h.Toolbox.randomBool()&&r.default.unfreezeTile(t),!0},t.burningFeetEffect=function(e,i){void 0===i&&(i=null),m.default.inst.loopWithBrush(e.currentTile,u.default.getBrushBySize(4),t.burningFeetEffectTileDraw,"burningFeetEffect"),e.a.isInLiquid()||e.currentTile.setFire(!0);for(var o=0;o<e.currentTile.neighbours.length;o++){var a=e.currentTile.neighbours[o];a.setFire(!1),a.setBurned(-1)}return!0},t.flowerPrintsEffect=function(t,e){if(void 0===e&&(e=null),!h.Toolbox.randomChance(.3))return!1;var i=t.a.currentTile;return!!i.type.grow_vegetation_auto&&(i.type.grow_type_selector_plants&&m.default.inst.tryGrowVegetationRandom(i,d.VegetationType.Plants),!0)},t.acidBloodEffect=function(t,e){void 0===e&&(e=null);for(var i=t.a.currentTile,o=0;o<25;o++)if(!h.Toolbox.randomBool()){var a=h.Toolbox.randomFloat(.05,.5),n=h.Toolbox.randomFloat(.05,1);m.default.inst.dropManager.spawnBurstPixel(i,"acid",a,n)}return!0},t.acidTouchEffect=function(t,e){return void 0===e&&(e=null),!!h.Toolbox.randomChance(.3)&&(r.default.checkAcidTerraform(t.a.currentTile),!0)},t.castSpawnSkeleton=function(e,i){var o;if(void 0===i&&(i=null),e&&(i=e.currentTile),h.Toolbox.findSameUnitInChunkAround(i.chunk,"skeleton"),h.Toolbox.temp_list_units.length>6)return!1;var a=null===(o=null==i?void 0:i.region)||void 0===o?void 0:o.tiles.getRandom();return!!a&&(t.spawnSkeleton(null,a),!0)},t.spawnSkeleton=function(t,e){return void 0===e&&(e=null),!!e&&(m.default.inst.stackEffects.get("fx_create_skeleton").spawnAt(e.posV3,.1).setCallback(19,function(){m.default.inst.createNewUnit("skeleton",e).makeWait(1)}),!0)},t.castFire=function(t,e){if(void 0===e&&(e=null),t&&(e=t.currentTile),!e)return!1;m.default.inst.dropManager.spawn(e,"fire",15);for(var i=0;i<3;i++)m.default.inst.dropManager.spawn(e.neighboursAll.getRandom(),"fire",15);return!0},t.castBloodRain=function(t,e){return void 0===e&&(e=null),t&&(e=t.currentTile),!!e&&(m.default.inst.dropManager.spawn(e,"bloodRain",15),!0)},t.castSpawnGrassSeeds=function(t,e){return void 0===e&&(e=null),e||(e=t.currentTile),!!e&&(m.default.inst.dropManager.spawn(e,"seedsGrass",15),!0)},t.castCurses=function(t,e){return void 0===e&&(e=null),!!e&&(m.default.inst.dropManager.spawn(e,"curse",15),!0)},t.castLightning=function(t,e){return void 0===e&&(e=null),t&&(e=t.currentTile),m.default.spawnLightning(e,.15),!0},t.castTornado=function(t,e){return void 0===e&&(e=null),t&&(e=t.currentTile),!!e&&(m.default.inst.createNewUnit("tornado",e).getComponent(v.default).resizeTornado(v.default.TORNADO_SCALE_DEFAULT/3),!0)},t.createBlueOrbs=function(t,e){void 0===e&&(e=null),t&&(e=t.currentTile);for(var i=cc.v3(e.posV3.x,e.posV3.y),o=0;o<e.region.tiles.length;o++){var a=e.region.tiles[o];h.Toolbox.randomChance(.1)&&m.default.inst.stackEffects.startProjectile(i,a.posV3,"blue_orb_small")}return!0},t.castCure=function(t,e){return void 0===e&&(e=null),e&&(e=t.currentTile),!!e&&(m.default.inst.dropManager.spawn(e,"cure",15),!0)},t.castShieldOnHimself=function(e,i){return void 0===i&&(i=null),t.addShieldEffectOnTarget(e)},t.addShieldEffectOnTarget=function(t,e){return void 0===e&&(e=null),!t.haveStatus("shield")&&(t.a.addStatusEffect("shield",30),!0)},t.addBurningEffectOnTarget=function(t,e){return void 0===e&&(e=null),t.isBuilding()&&t.b.stats.burnable?(t.addStatusEffect("burning"),"tumor"==t.stats.id&&n.default.update(46),!0):!!t.isActor()&&(t.addStatusEffect("burning"),!0)},t.addFrozenEffectOnTarget20=function(e,i){return void 0===i&&(i=null),!!h.Toolbox.randomChance(.2)&&t.addFrozenEffectOnTarget(e,i)},t.addFrozenEffectOnTarget=function(t,e){return void 0===e&&(e=null),!t.isBuilding()&&(t.addStatusEffect("frozen"),!0)},t.addSlowEffectOnTarget20=function(e,i){return void 0===i&&(i=null),!!h.Toolbox.randomChance(.2)&&t.addSlowEffectOnTarget(e,i)},t.addSlowEffectOnTarget=function(t,e){return void 0===e&&(e=null),!t.isBuilding()&&(t.addStatusEffect("slowness"),!0)},t.addPoisonedEffectOnTarget=function(t,e){return void 0===e&&(e=null),!(!t.isActor()||t.a.haveTrait("poison_immune")||!t.a.stats.have_skin||t.a.stats.immune_to_injuries||(h.Toolbox.randomChance(.3)&&t.a.addStatusEffect("poisoned"),1))},t.increaseDroppedBombsCounter=function(t,e){void 0===t&&(t=null),void 0===e&&(e=""),n.default.update(65,m.default.inst.gameStats.bombsDropped++,!0)},t.mageDeath=function(t,e){var i,o,a;return void 0===e&&(e=null),!!(t.isActor()&&(null===(i=t.a)||void 0===i?void 0:i.attackedBy))&&(null===(a=null===(o=t.a.attackedBy)||void 0===o?void 0:o.a)||void 0===a||a.addTrait("mageslayer"),!0)},t.dragonDeath=function(t,e){var i,o,a;return void 0===e&&(e=null),!!(t.isActor()&&(null===(i=t.a)||void 0===i?void 0:i.attackedBy))&&(null===(a=null===(o=t.a.attackedBy)||void 0===o?void 0:o.a)||void 0===a||a.addTrait("dragonslayer"),!0)},t.giveCursed=function(t,e){return e.addTrait("cursed"),e.removeTrait("blessed"),!1},t.giveBlessed=function(t,e){return e.removeTrait("cursed"),e.addTrait("blessed"),!1},t.spawnGhost=function(t,e){if(void 0===e&&(e=null),!t.isActor())return!1;if(!t.a.stats.have_soul)return!1;var i=m.default.inst.createNewUnit("ghost",e);return i.removeTrait("blessed"),y.default.copyUnitToOtherUnit(t.a,i),!0},t.tryToGrowBiomeGrass=function(t,e){return void 0===e&&(e=null),!!e.type.canGrowBiomeGrass&&""==e.type.biome&&(s.default.useSeedOn(e,c.default.grass_low,c.default.grass_high),!0)},t.tryToGrowTree=function(t,e){return void 0===e&&(e=null),m.default.inst.tryGrowVegetationRandom(e,d.VegetationType.Trees,!1,!1),!0},t.tryToCreatePlants=function(t,e){return void 0===e&&(e=null),t.currentTile.type.grow_type_selector_plants&&m.default.inst.tryGrowVegetationRandom(t.currentTile,d.VegetationType.Plants),!0},t.startNuke=function(t,e){return void 0===e&&(e=null),t.a.findCurrentTile(!0),m.default.inst.stackEffects.spawnNukeFlash(e,"atomicBomb"),!0},t.spawnAliens=function(t,e){void 0===e&&(e=null),t.a.findCurrentTile(!0);var i=1;h.Toolbox.randomChance(.5)&&i++,h.Toolbox.randomChance(.1)&&i++;for(var o=0;o<i;o++)m.default.inst.createNewUnit("alien",t.a.currentTile,null,t.a.zPosition.y);return!0},t.fireBlood=function(t,e){void 0===e&&(e=null);for(var i=0;i<5;i++)h.Toolbox.randomBool()&&m.default.inst.dropManager.spawnBurstPixel(t.a.currentTile,"fire",0,h.Toolbox.randomFloat(.6,1.1),.3,.15);return!0},t.teleportRandom=function(t,e){var i,o;void 0===e&&(e=null);var a=null===(o=null===(i=m.default.inst.islandsCalculator.getRandomIslandGround(!0))||void 0===i?void 0:i.regions.getRandom())||void 0===o?void 0:o.tiles.getRandom();if(!a)return!1;if(a.type.block)return!1;if(!a.type.ground)return!1;var n=t.a.stats.effect_teleport;if(""==n&&(n="fx_teleport_blue"),!m.default.inst.qualityChanger.lowRes){m.default.inst.stackEffects.get(n).spawnAt(t.currentPosition,t.a.curStats.scale);var r=m.default.inst.stackEffects.get(n).spawnAt(a.posV3,t.a.curStats.scale);r&&r.spriteAnimation.setFrameIndex(9)}return t.a.cancelAllBeh(),t.a.spawnOn(a),!0},t.turnIntoMush=function(t,e){void 0===e&&(e=null);var i=t.a;if(!i||!i.node)return!1;if(!i.haveTrait("mushSpores"))return!1;if(!i.inMapBorder())return!1;if(!i.stats.canTurnIntoMush)return!1;i.removeTrait("cursed"),i.removeTrait("infected"),i.removeTrait("mushSpores"),i.removeTrait("tumorInfection");var o=m.default.inst.createNewUnit(i.stats.mushID,i.currentTile);return y.default.copyUnitToOtherUnit(i,o),m.default.inst.qualityChanger.lowRes||m.default.inst.stackEffects.startSpawnEffect(o.currentTile),m.default.inst.destroyActor(t),n.default.update(44),!0},t.turnIntoTumorMonster=function(t,e){void 0===e&&(e=null);var i=t.a;if(!i||!i.node)return!1;if(!i.haveTrait("tumorInfection"))return!1;if(!i.inMapBorder())return!1;if(!i.stats.canTurnIntoTumorMonster)return!1;i.removeTrait("cursed"),i.removeTrait("infected"),i.removeTrait("mushSpores"),i.removeTrait("tumorInfection");var o=m.default.inst.createNewUnit(i.stats.tumorMonsterID,i.currentTile);return y.default.copyUnitToOtherUnit(i,o),m.default.inst.qualityChanger.lowRes||m.default.inst.stackEffects.startSpawnEffect(o.currentTile),m.default.inst.destroyActor(t),!0},t.turnIntoZombie=function(e,i){void 0===i&&(i=null);var o=e.a;if(!o||!o.node)return!1;if(!o.haveTrait("infected"))return!1;if(!o.inMapBorder())return!1;if(!o.stats.canTurnIntoZombie)return!1;o.removeTrait("cursed"),o.removeTrait("infected"),o.removeTrait("mushSpores"),o.removeTrait("tumorInfection");var a=o.stats.zombieID?o.stats.zombieID:"zombie";"dragon"==o.stats.id&&(o.removeTrait("fire_blood"),o.removeTrait("fire_proof"));var r=m.default.inst.createNewUnit(a,o.currentTile);return y.default.copyUnitToOtherUnit(o,r),r.removeTrait("fast"),r.removeTrait("agile"),r.removeTrait("genius"),r.data.firstName="Un"+h.Toolbox.lowerCaseFirst(o.data.firstName),m.default.inst.qualityChanger.lowRes||m.default.inst.stackEffects.startSpawnEffect(r.currentTile),m.default.inst.destroyActor(e),o.stats.animal?t.zombieList&&(t.zombieList.add(o.stats.id),t.zombieList.size>=5&&(t.zombieList=null,n.default.update(42,5,!0))):n.default.update(37),n.default.update(71,m.default.inst.gameStats.infectedZombie++,!0),!0},t.turnIntoSkeleton=function(t,e){void 0===e&&(e=null);var i=t.a;if(!i||!i.node)return!1;if(!i.stats.skeletonID)return!1;if(!i.haveTrait("cursed"))return!1;if(!i.inMapBorder())return!1;var o=i.stats.skeletonID;i.removeTrait("cursed"),i.removeTrait("infected"),i.removeTrait("mushSpores"),i.removeTrait("tumorInfection");var a=m.default.inst.createNewUnit(o,i.currentTile);return y.default.copyUnitToOtherUnit(i,a),a.data.firstName="Un"+h.Toolbox.lowerCaseFirst(i.data.firstName),m.default.inst.qualityChanger.lowRes||m.default.inst.stackEffects.startSpawnEffect(a.currentTile),m.default.inst.destroyActor(t),!0},t.getActorNearPos=function(t){for(var e,i=null,o=0,a=0,n=m.default.inst.units.getSimpleList(),r=0;r<n.length;r++){var s=n[r];(null===(e=s.data)||void 0===e?void 0:e.alive)&&s.stats.canBeInspected&&!s.isInsideSomething()&&((o=h.Toolbox.distVec2Float(cc.v2(s.currentPosition),t))>3||i&&!(o<a)||(i=s,a=o))}return i},t.getActorFromTile=function(t){var e;if(void 0===t&&(t=null),!t)return null;for(var i=null,o=0,a=0,n=m.default.inst.units.getSimpleList(),r=0;r<n.length;r++){var s=n[r];(null===(e=s.data)||void 0===e?void 0:e.alive)&&s.stats.canBeInspected&&!s.isInsideSomething()&&((o=h.Toolbox.distTile(s.currentTile,t))>3||i&&!(o<a)||(i=s,a=o))}return i},t.inspectUnit=function(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var o=e?t.getActorFromTile(e):m.default.inst.getActorNearCursor();return!!o&&(f.default.selectedUnit=o,p.default.open(p.view_type.CreatureInfo),n.default.update(17),!0)},t.inspectCity=function(t,e){var i;return void 0===t&&(t=null),void 0===e&&(e=""),(null===(i=null==t?void 0:t.zone)||void 0===i?void 0:i.city)&&(f.default.selectedCity=t.zone.city,p.default.open(p.view_type.CityWindow)),!0},t.inspectKingdom=function(t,e){var i,o;return void 0===t&&(t=null),void 0===e&&(e=""),(null===(o=null===(i=null==t?void 0:t.zone)||void 0===i?void 0:i.city)||void 0===o?void 0:o.kingdom)&&(f.default.selectedKingdom=t.zone.city.kingdom,p.default.open(p.view_type.KingdomWindow)),!0},t.inspectCulture=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=""),t&&t.zone.culture&&(f.default.selectedCulture=t.zone.culture),!0},t.action_fire=function(e,i){var o,a;void 0===e&&(e=null),void 0===i&&(i=null),!m.default.inst.flashEffects.contains(i)&&h.Toolbox.randomChance(.2)&&m.default.inst.particlesFire.spawn(i.posV3.x,i.posV3.y),m.default.inst.getObjectsInChunks(i);for(var n=0;n<m.default.inst.temp_map_objects.length;n++){var r=m.default.inst.temp_map_objects[n];(null===(o=r.base_data)||void 0===o?void 0:o.alive)&&!(null===(a=r.currentTile)||void 0===a?void 0:a.type.ocean)&&t.addBurningEffectOnTarget(r)}return i.setFire(!0),!0},t.action_growTornadoes=function(t,e){void 0===t&&(t=null),void 0===e&&(e=""),v.default.growTornados(t)},t.action_shrinkTornadoes=function(t,e){void 0===t&&(t=null),void 0===e&&(e=""),v.default.shrinkTornados(t)},t.zombieList=new Set,t}();a.default=b,cc._RF.pop()},{}],ActiveStatusEffect:[function(t,e,i){"use strict";cc._RF.push(e,"1b123MDVmhGcIO/rjAcOawk","ActiveStatusEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.StatusEffect=void 0;var l=a("WorldAction"),c=a("SpriteAnimation"),d=a("AssetLibrary"),u=a("BaseStats"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.action=l.default.create(),e.actionOnHit=l.default.create(),e.actionInterval=0,e.duration=10,e.texture="",e.random_frame=!1,e.animated=!1,e.animation_speed=.1,e.animation_speed_random=0,e.startScale=0,e.targetScale=0,e.random_flip=!1,e.cancelActorJob=!1,e.baseStats=new u.default,e.oppositeTraits=[],e.oppositeStatus=[],e.removeStatus=[],e.spriteList=[],e}return r(e,t),e}(d.Asset);n.StatusEffect=h;var p=cc._decorator,f=p.ccclass,_=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actionTimer=0,e.timer=0,e.asset=null,e.finished=!1,e.simObject=null,e.curZ=0,e}return r(e,t),e.prototype.setStatus=function(t,e){this.asset=t,this.simObject=e,this.actionTimer=this.asset.actionInterval,this.timer=this.asset.duration},e.prototype.setZFlip=function(t){this.curZ=t;var e=this.node.position;e.z=t,this.node.position=e},e.prototype.updateZFlip=function(){this.simObject.isActor()&&(this.simObject.a.flip?.01!=this.curZ&&this.setZFlip(.01):-.01!=this.curZ&&this.setZFlip(-.01))},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.updateZFlip(),this.simObject.isActor()?this.spriteRenderer.enabled=this.simObject.a._is_visible:this.spriteRenderer.enabled=this.simObject.b._is_visible,this.finished||(0!=this.asset.actionInterval&&(this.actionTimer>0?this.actionTimer-=e:(this.actionTimer=this.asset.actionInterval,this.asset.action.isEmpty||this.asset.action.do(this.simObject,this.simObject.currentTile))),this.timer>0?this.timer-=e:this.finished=!0)},s([f],e)}(c.SpriteAnimation));n.default=_,cc._RF.pop()},{}],ActorAnimationLoader:[function(t,e,i){"use strict";cc._RF.push(e,"2c68fo3QuZEo5SSDUh98MUO","ActorAnimationLoader");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("UnusedLibrary"),r=o("TextureLoader"),s=o("UnitSpriteAnimation"),l=function(){function t(){}return t.init=function(){r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,"actors/races/items/").forEach(function(e,i){t.dictItems.set(i,e)})},t.getItem=function(e){return e?t.dictItems.get(e):null},t.getHeadSpecial=function(e,i){var o=e+"_"+i,a=t.dictCivHeads.get(o);return t.dictCivHeads.has(o)||(r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,e).forEach(function(i,o){var a=e+"_"+o;t.dictCivHeads.set(a,i)}),a=t.dictCivHeads.get(o)),a},t.getHead=function(e,i){var o=e+"_head_"+i,a=t.dictCivHeads.get(o);return a||(r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,e).forEach(function(i,o){t.dictCivHeads.set(e+"_"+o,i)}),a=t.dictCivHeads.get(o)),a},t.getHeadFromFullPath=function(e){var i=t.dictCivHeads.get(e);return i||(r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,e).forEach(function(i){t.dictCivHeads.set(e,i)}),i=t.dictCivHeads.get(e)),i},t.loadAnimationBoat=function(e){if(!t.dict_boats.has(e)){var i=new Map,o=n.default.inst.getSpriteFrames("boats/"+e);o.forEach(function(t,e){i.set(e,t)});var a=new s.AnimationDataBoat;a.broken=new s.ActorAnimation,a.broken.frames=[i.get("broken")],a.normal=new s.ActorAnimation,a.normal.frames=[i.get("normal")],o.forEach(function(e,o){!o.includes("@1")&&o.includes("@")&&t.createBoatAnimationArray(a,i,o)}),t.dict_boats.set(e,a)}return t.dict_boats.get(e)},t.createBoatAnimationArray=function(t,e,i,o){void 0===o&&(o=.2);var a=parseInt(i.split("@")[0]),n=new s.ActorAnimation;n.frames=[],n.frames.push(e.get(a+"@0")),n.frames.push(e.get(a+"@1")),n.timeBetweenFrames=o,t.dict.set(a,n)},t.loadAnimationUnit=function(e,i){if(!t.dict_units.has(e)){var o=t.generateAnimation(e,i);if(i.texture_heads){var a=r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,i.texture_heads);o.heads=Array.from(a.values())}}return t.dict_units.get(e)},t.generateAnimation=function(e,i){var o=new s.AnimationDataUnit;return o.sprites=new Map,r.TextureLoader.inst.getSpriteFrames(r.ATLAS_TYPE.WORLDATLAS,e).forEach(function(t,e){o.sprites.set(e,t)}),o.frameData=new Map,o.id=e,t.generateFrameData(o,o.sprites,"walk_0,walk_1,walk_2,walk_3,swim_0,swim_1,swim_2,swim_3"),t.dict_units.set(e,o),i.animation_swim&&(o.swimming=t.createAnim(0,o.sprites,i.animation_swim,i.animation_swim_speed)),i.animation_walk&&(o.walking=t.createAnim(1,o.sprites,i.animation_walk,i.animation_walk_speed)),i.animation_idle&&(o.idle=t.createAnim(2,o.sprites,i.animation_idle,i.animation_idle_speed)),o},t.generateFrameData=function(e,i,o){o.split(",").forEach(function(o){if(i.has(o)){var a=new s.AnimationFrameData;a.id=o,a.posHead=t.getPosHead(o,!0),a.posItem=t.getPosItem(o,!0),e.frameData.set(o,a)}})},t.getPosHead=function(t,e){switch(void 0===e&&(e=!1),t){case"walk_0":return e?cc.v2(0,13):cc.v2(0,9);case"walk_1":return e?cc.v2(0,15):cc.v2(0,11);case"walk_2":return e?cc.v2(0,13):cc.v2(0,10);case"walk_3":return e?cc.v2(0,14):cc.v2(0,8);case"swim_0":return e?cc.v2(-1,4):cc.v2(0,7);case"swim_1":return e?cc.v2(-2,5):cc.v2(0,6);case"swim_2":return e?cc.v2(-1,4):cc.v2(0,7);case"swim_3":return e?cc.v2(-2,5):cc.v2(0,6);default:return e?cc.v2(0,8):cc.v2(0,6)}},t.getPosItem=function(t,e){switch(void 0===e&&(e=!1),t){case"walk_0":return e?cc.v2(-5.5,8):cc.v2(3.5,3.6);case"walk_1":return e?cc.v2(-5.5,10):cc.v2(3.5,6.5);case"walk_2":return e?cc.v2(-5.5,8):cc.v2(3.5,5.8);case"walk_3":return e?cc.v2(-5.5,10):cc.v2(3.5,3.8);default:return e?cc.v2(-5.5,8):cc.v2(3.5,4)}},t.createAnim=function(e,i,o,a){void 0===a&&(a=.01);var n=new s.ActorAnimation;return n.id=e,n.frames=t.createArray(i,o),n.timeBetweenFrames=a,n},t.createArray=function(t,e){for(var i=e.split(","),o=[],a=0,n=0;n<i.length;n++)if(t.has(i[a])){var r=t.get(i[a]);o.push(r),a++}return o},t.int_ids_heads=new Map,t.int_ids_body=new Map,t.dict_units=new Map,t.dict_boats=new Map,t.dictItems=new Map,t.dictCivHeads=new Map,t.banner=null,t}();a.default=l,cc._RF.pop()},{}],ActorAsset:[function(t,e,i){"use strict";cc._RF.push(e,"e52abTe7+JJybkCwfIU9sAf","ActorAsset");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.ActorTag=o.ActorSize=o.ActorDirection=o.ActorGender=o.UnitProfession=o.AttackType=void 0,function(t){t[t.Acid=0]="Acid",t[t.Fire=1]="Fire",t[t.Plague=2]="Plague",t[t.Tumor=3]="Tumor",t[t.Other=4]="Other",t[t.Bomb=5]="Bomb",t[t.Hunger=6]="Hunger",t[t.Eaten=7]="Eaten",t[t.Age=8]="Age",t[t.GrowUp=9]="GrowUp",t[t.Poison=10]="Poison",t[t.Divine=11]="Divine",t[t.None=12]="None"}(o.AttackType||(o.AttackType={})),function(t){t[t.Null=0]="Null",t[t.Baby=1]="Baby",t[t.Unit=2]="Unit",t[t.King=3]="King",t[t.Leader=4]="Leader",t[t.Warrior=5]="Warrior"}(o.UnitProfession||(o.UnitProfession={})),function(t){t[t.Unknown=0]="Unknown",t[t.Male=1]="Male",t[t.Female=2]="Female"}(o.ActorGender||(o.ActorGender={})),function(t){t[t.Up=0]="Up",t[t.UpRight=1]="UpRight",t[t.Right=2]="Right",t[t.UpLeft=3]="UpLeft",t[t.Down=4]="Down",t[t.DownRight=5]="DownRight",t[t.DownLeft=6]="DownLeft",t[t.Left=7]="Left"}(o.ActorDirection||(o.ActorDirection={})),function(t){t[t.S1_Bug=1]="S1_Bug",t[t.S2_Egg=2]="S2_Egg",t[t.S3_Crab=3]="S3_Crab",t[t.S4_Rat=4]="S4_Rat",t[t.S5_Piranha=5]="S5_Piranha",t[t.S6_Chicken=6]="S6_Chicken",t[t.S7_Monkey=7]="S7_Monkey",t[t.S8_Fox=8]="S8_Fox",t[t.S9_Sheep=9]="S9_Sheep",t[t.S10_Dwarf=10]="S10_Dwarf",t[t.S11_Snake=11]="S11_Snake",t[t.S12_Human=12]="S12_Human",t[t.S13_Wolf=13]="S13_Wolf",t[t.S14_Cow=14]="S14_Cow",t[t.S15_Bear=15]="S15_Bear",t[t.S16_Typhoon=16]="S16_Typhoon",t[t.S17_Giant=17]="S17_Giant"}(o.ActorSize||(o.ActorSize={})),o.ActorTag=function(){this.id="",this.valString="",this.valInt=0,this.valBool=!1},o.default=function(){this.list=[]},cc._RF.pop()},{}],ActorBag:[function(t,e,i){"use strict";cc._RF.push(e,"57e03uKmwhPZYts+0q+8rwR","ActorBag");var o=i;Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){this.resource="",this.amount=0}return t.prototype.add=function(t,e){this.resource=t,this.amount+=e},t.prototype.empty=function(){this.resource="",this.amount=0},t.prototype.getResource=function(t){return this.resource!=t?0:this.amount},t}();o.default=a,cc._RF.pop()},{}],ActorBase:[function(t,e,i){"use strict";cc._RF.push(e,"b55cb7OxndGUqaAYA0I+YPu","ActorBase");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.ActorContainer=n.SplitPathStatus=void 0;var l,c=a("MathUtils"),d=a("Constants"),u=a("Log"),h=a("GameCommon"),p=a("AiSystem"),f=a("ActorAnimationLoader"),_=a("AssetManager"),m=a("BaseContainer"),g=a("BaseSimObject"),y=a("ChineseNameGenerator"),v=a("FamilysManager"),b=a("ItemGenerator"),w=a("NameGenerator"),T=a("Globals"),k=a("ItemTools"),B=a("ToolBox"),S=a("MapBox"),C=a("WorldTimer"),x=a("ActorAsset"),A=a("ActorBag"),P=a("ActorEquipment"),O=a("ActorMove"),R=a("ActorStatus"),F=a("ActorTool");(function(t){t[t.Normal=0]="Normal",t[t.Prepare=1]="Prepare",t[t.Split=2]="Split"})(l=n.SplitPathStatus||(n.SplitPathStatus={}));var L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(m.ObjectContainer);n.ActorContainer=L;var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.unitGroup=null,e.beh_tile_target=null,e.beh_building_target=null,e.beh_actor_target=null,e.insideBuilding=null,e.insideBoat=null,e.inventory=new A.default,e.equipment=null,e.homeBuilding=null,e.attackedBy=null,e.race=null,e.data=null,e.professionAsset=null,e.stats=null,e.tempPosition=cc.Vec3.ZERO,e.nextStepPosition=T.default.emptyVector,e.shakeOffset=cc.Vec2.ZERO,e.moveJumpOffset=cc.Vec3.ZERO,e.is_moving=!1,e.tileTarget=null,e.nextStepTile=null,e.split_path=null,e.current_path=[],e.current_path_global=[],e.callbacks_on_death=[],e.callbacks_landed=[],e.callbacks_added_madness=[],e.callbacks_cancel_path_movement=[],e.callbacks_get_hit=[],e.attackTarget=null,e.timer_action=0,e.timer_jump_animation=0,e.forceTimer=null,e.hitboxZ=0,e.forceVector=cc.Vec3.ZERO,e.actorAnimationData=null,e.current_texture="",e.targetsToIgnoreTimer=null,e.flying=!1,e._positionDirty=!1,e.attackTimer=0,e.s_attackType=null,e.s_slashType="",e.s_weapon_texture="",e.id_sprite_head=0,e.id_sprite_body=0,e.s_head_sprite=null,e.s_body_sprite=null,e.s_item_sprite=null,e.s_item_sprite_weapon=null,e.item_sprite_dirty=!1,e.s_attackSpeed_seconds=0,e.s_personality=null,e.s_traits_ids=new Set,e.s_special_effect_traits=null,e._status_frozen=!1,e._trait_weightless=!1,e._trait_peaceful=!1,e._trait_fire_resistant=!1,e.ai=null,e.hasItem=!1,e._isInLiquid=!1,e._is_visible=!0,e.frameData=null,e._last_animation_id=-1,e._currentTileDirty=!0,e.actorScale=1,e.targetScale=0,e._current_item_texture="",e._actionFall=!1,e.shakeHorizontal=!0,e.shakeVertical=!0,e.shakeTimer=new C.default(.3,!0),e.shakeVolume=.1,e.rotationCooldown=0,e.actorSize=.06,e.curAngle=cc.v3(),e.targetAngle=cc.v3(),e.unit_sprite_color=cc.Color.WHITE,e.jumpTime=0,e.lastX=-10,e.lastY=-10,e.flipAngle=0,e.flip=!1,e.flipScale=cc.v3(1,1,1),e._timeout_targets=0,e.isGroupLeader=!1,e}return r(e,t),e.prototype.setActorSize=function(t){this.actorSize=t},e.prototype.create=function(){t.prototype.create.call(this),this.ai=new p.AiSystemActor(this),this.ai.jobs_library=_.default.job_actor,this.ai.task_library=_.default.tasks_actor,this.ai.nextJobDelegate=this.getNextJob.bind(this),this.ai.jobSetStartAction=this.jobSetStartActionAction.bind(this),this.ai.jobSetEndAction=this.jobSetEndActionAction.bind(this),this.ai.clearAction=this.clearBeh.bind(this),this.ai.taskSwitchedAction=this.taskSwitchedAction.bind(this),this.targetsToIgnore.clear(),this.targetsToIgnoreTimer=new C.default(3,this.clearIgnoreTargets.bind(this)),this.flying=this.stats.flying},e.prototype.clearBeh=function(){this.clearTasks(),this.beh_tile_target=null,this.beh_building_target=null,this.beh_actor_target=null},e.prototype.taskSwitchedAction=function(){this.item_sprite_dirty=!0},e.prototype.jobSetStartActionAction=function(){var t;(null===(t=this.data)||void 0===t?void 0:t.alive)&&this.loadTexture()},e.prototype.jobSetEndActionAction=function(){var t;(null===(t=this.data)||void 0===t?void 0:t.alive)&&this.loadTexture()},e.prototype.getNextJob=function(){return e.nextJobActor(this)},e.nextJobActor=function(t){var e,i,o,a,n=(null===(e=t.stats)||void 0===e?void 0:e.unit)?(null===(o=t.stats)||void 0===o?void 0:o.baby)?"baby":t.city?"citizen":null===(a=t.stats)||void 0===a?void 0:a.job:null===(i=t.stats)||void 0===i?void 0:i.job;return t.haveTrait("madness")&&(n="random_move"),t.haveStatus("burning")&&(n="unit_on_fire"),n},e.prototype.newCreature=function(t){void 0===t&&(t=0),S.default.inst.gameStats.creaturesCreated++,this.race=_.default.raceLibrary.get(this.stats.race),this.setData(new R.default),this.data.actorID=S.default.inst.mapStats.getNextId("unit"),this.generatePersonality(),this.updateStats(),this.data.bornTime=t,this.data.health=this.curStats.health,this.data.statsID=this.stats.id,this.stats.diet_meat?this.data.hunger=this.stats.maxHunger/2:this.stats.needFood&&(this.data.hunger=this.stats.maxHunger)},e.prototype.setData=function(e){this.data=e,t.prototype.setData.call(this,e)},e.generateCivUnit=function(t,e,i){B.Toolbox.randomBool()?e.gender=x.ActorGender.Male:e.gender=x.ActorGender.Female,e.favoriteFood=i.preferred_food.getRandom(),e.firstName=w.default.getName(t.nameTemplate,e.gender)},e.prototype.generatePersonality=function(){if(this.data.generateTraits(this.stats,this.race),this.race.civilization?e.generateCivUnit(this.stats,this.data,this.race):this.data.firstName=w.default.getName(this.stats.nameTemplate,this.data.gender),d.default.LANGUAGE==d.LANGUAGE_TYPE.ZH&&(this.stats.unit?(this.data.familyName=_.default.chineseName.get(this.stats.nameTemplate).addition_startList.getRandom(),this.data.familyID=this.data.familyName,this.data.firstName=y.default.getCreatureName(this.stats.nameTemplate,this.data.familyName,!0)):(this.data.familyName=_.default.chineseName.get(this.stats.nameTemplate).addition_endList.getRandom(),this.data.familyID=this.data.familyName,this.data.firstName=y.default.getCreatureName(this.stats.nameTemplate,this.data.familyName,!1)),v.default.familys.get(this.data.familyID).num++),this.stats.defaultWeapons&&this.stats.defaultWeapons.length>0){var t=this.stats.defaultWeapons.getRandom(),i=_.default.items.get(t),o="base";this.stats.defaultWeaponsMaterial.length>0&&(o=this.stats.defaultWeaponsMaterial.getRandom()),b.default.generateItem(i,o,this.equipment.weapon,S.default.inst.mapStats.year-10)}for(var a=0;a<this.data.traits.length;)_.default.traits.get(this.data.traits[a])?a++:this.data.traits.splice(a,1);this.setStatsDirty()},e.prototype.resetTraits=function(){if(this.data.traits=[],this.s_traits_ids.clear(),this.stats.traits)for(var t=0;t<this.stats.traits.length;t++){var e=this.stats.traits[t];this.addTrait(e)}this.setStatsDirty()},e.prototype.removeTrait=function(t){for(var e=0;e<this.data.traits.length;e++)if(this.data.traits[e]==t){this.data.traits.splice(e,1);break}this.setStatsDirty()},e.prototype.addTrait=function(t){var e=this;return!this.haveTrait(t)&&!this.haveOppositeTrait(t)&&("madness"==t&&this.callbacks_added_madness.forEach(function(t){t(e)}),this.data.traits.push(t),this.statsDirty=!0,!0)},e.prototype.clearIgnoreTargets=function(){this.targetsToIgnore.clear()},e.prototype.getUnitTexture=function(){var t,e="races/"+this.stats.race+"/";return(null===(t=this.professionAsset)||void 0===t?void 0:t.special_skin_path)?e+=this.professionAsset.special_skin_path:this.data.gender==x.ActorGender.Female?e+="unit_female":e+="unit_male",e},e.prototype.loadTexture=function(){var t=this.stats.unit?this.getUnitTexture():this.stats.texture_path;this.current_texture!=t&&(this.current_texture=t,this.current_texture&&(this.actorAnimationData=f.default.loadAnimationUnit("actors/"+this.current_texture,this.stats),this.setBodySprite(this.actorAnimationData.idle.frames[0])))},e.prototype.addForce=function(t,e,i){!this.stats.canBeMovedByPowers||this.zPosition.y>0||(this.forceVector.x=.6*t,this.forceVector.y=.6*e,this.forceVector.z=2*i)},e.prototype.isInAir=function(){return!!this.flying||this.stats.hovering},e.prototype.isFlying=function(){return this.flying},e.prototype.isHovering=function(){return this.stats.hovering},e.prototype.isAffectedByLiquid=function(){return!this.isInAir()&&this._isInLiquid},e.prototype.onEnable=function(){this._is_visible=!0,this.updateAnimation(S.default.inst.elapsed)},e.prototype.onDisable=function(){this._is_visible=!1},e.prototype.updateAnimation=function(t,e){var i,o;if(void 0===e&&(e=!1),!this.stats.specialAnimation)if(null===(i=this.ai.action)||void 0===i?void 0:i.forceAnimation)this.spriteAnimation.applyCurrentSpriteGraphics(this.actorAnimationData.sprites.get(this.ai.action.forceAnimation));else{if(!e&&!this._is_visible||!(null===(o=this.data)||void 0===o?void 0:o.alive)||!this.spriteAnimation)return;(this.is_moving||this._isInLiquid)&&0==this.zPosition.y?(this.spriteAnimation.isOn=!0,this.isAffectedByLiquid()&&this.actorAnimationData.swimming?this.setAnimation(this.actorAnimationData.swimming):this.setAnimation(this.actorAnimationData.walking)):this.timer_jump_animation>0?this.spriteAnimation.isOn=!0:this.zPosition.y>0&&this.spriteAnimation.isOn?(this._last_animation_id=-1,this.spriteAnimation.frames.length>2?this.spriteAnimation.stopAt(2):this.spriteAnimation.stopAt(0,!1)):this.setAnimation(this.actorAnimationData.idle)}},e.prototype.setAnimation=function(t){this._last_animation_id!=t.id&&(this._last_animation_id=t.id,this.spriteAnimation.isOn=!0,this.spriteAnimation.setFrames(t.frames),this.spriteAnimation.timeBetweenFrames=t.timeBetweenFrames)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.statsDirty&&this.updateStats(),this.updateSpriteAnimation(e),this.timer_jump_animation>0&&(this.timer_jump_animation-=e),this.checkFindCurrentTile(),this.checkIsInWater(),this.updateAnimation(e)},e.prototype.checkFindCurrentTile=function(){(this._currentTileDirty||this.nextStepTile&&B.Toolbox.distTile(this.currentTile,this.nextStepTile)>2)&&this.findCurrentTile(!0)},e.prototype.checkIsInWater=function(){var t=this.currentTile.type.liquid&&0==this.moveJumpOffset.y&&this.zPosition.y<=0&&this.data.alive;t!=this._isInLiquid&&(this._isInLiquid=t,this.item_sprite_dirty=!0)},e.prototype.updateSpriteAnimation=function(t){var e;this._is_visible&&(null===(e=this.spriteAnimation)||void 0===e||e.logicUpdate(t))},e.prototype.getWeaponAsset=function(){return this.stats.use_items&&!this.equipment.weapon.isEmpty()?_.default.items.get(this.equipment.weapon.data.id):_.default.items.get(this.stats.defaultAttack)},e.prototype.updateTargetScale=function(){this.node&&(this.curStats.scale>0?(this.targetScale=this.curStats.scale,this.node.scale=this.targetScale,this.actorScale=this.targetScale,this.actorSize=this.targetScale):this.targetScale=0)},e.prototype.updateStats=function(){var e;if(t.prototype.updateStats.call(this),null===(e=this.data)||void 0===e?void 0:e.alive){this.stats.useSkinColors&&-1==this.data.skin_set&&this.stats.color_sets&&F.default.setSkinSet(this,"default"),this.stats.useSkinColors&&-1==this.data.skin&&(this.data.skin=B.Toolbox.randomInt(0,this.stats.color_sets[this.data.skin_set].colors.length)),this.data.mood||(this.data.mood="normal");var i=_.default.moods.get(this.data.mood);if(this.curStats.clear(),this.curStats.addStats(this.stats.baseStats),this.curStats.addStats(i.baseStats),this.curStats.diplomacy+=this.data.diplomacy,this.curStats.stewardship+=this.data.stewardship,this.curStats.intelligence+=this.data.intelligence,this.curStats.warfare+=this.data.warfare,this.activeStatusEffects)for(var o=0;o<this.activeStatusEffects.length;o++){var a=this.activeStatusEffects[o];this.curStats.addStats(a.asset.baseStats)}var n=_.default.items.get(this.stats.defaultAttack);n&&this.curStats.addStats(n.baseStats);var r=this.getWeaponAsset();for(this.s_attackType=r.attackType,this.s_slashType=r.slash,this.item_sprite_dirty=!0,this.stats.use_items&&!this.equipment.weapon.isEmpty()?this.s_weapon_texture="w_"+this.equipment.weapon.data.id+"_"+this.equipment.weapon.data.material:this.s_weapon_texture="",this.findHeadSprite(),o=0;o<this.data.traits.length;o++){var s=this.data.traits[o],l=_.default.traits.get(s);l&&this.curStats.addStats(l.baseStats)}if(this.stats.unit&&(this.s_personality=null,this.kingdom&&this.kingdom.isCiv()&&this.kingdom.king==this||this.city&&this.city.leader==this)){s="balanced";var d=this.curStats.diplomacy;this.curStats.diplomacy>this.curStats.stewardship?(s="diplomat",d=this.curStats.diplomacy):this.curStats.diplomacy<this.curStats.stewardship&&(s="administrator",d=this.curStats.stewardship),this.curStats.warfare>d&&(s="militarist"),this.s_personality=_.default.personalities.get(s),this.curStats.addStats(this.s_personality.baseStats)}for(this._trait_weightless=this.haveTrait("weightless"),this._status_frozen=this.haveStatus("frozen"),this.curStats.damage+=(this.data.level-1)/2,this.curStats.armor+=(this.data.level-1)/3,this.curStats.crit+=this.data.level-1,this.curStats.attackSpeed+=this.data.level-1,this.curStats.health+=20*(this.data.level-1),this.s_traits_ids.clear(),this.s_special_effect_traits=[],o=0;o<this.data.traits.length;o++){var u=this.data.traits[o];this.s_traits_ids.add(u);var h=_.default.traits.get(u);h&&h.action_special_effect&&(this.s_special_effect_traits||(this.s_special_effect_traits=[]),this.s_special_effect_traits.push(h))}var p=this.s_special_effect_traits;if(p&&0==p.length&&(this.s_special_effect_traits=null),this.checkMadness(),this._trait_peaceful=this.haveTrait("peaceful"),this._trait_fire_resistant=this.haveTrait("fire_proof"),this.stats.use_items)for(var f=P.default.getList(this.equipment),m=0;m<f.length;m++){var g=f[m];g.data&&(k.default.calcItemValues(g.data),this.curStats.addStats(k.default.s_stats))}this.curStats.normalize(),this.event_full_heal&&(this.event_full_heal=!1,this.data.health=this.curStats.health),this.curStats.health+=c.default.intCast(this.curStats.health*(this.curStats.mod_health/100)),this.curStats.damage+=c.default.intCast(this.curStats.damage*(this.curStats.mod_damage/100)),this.curStats.armor+=c.default.intCast(this.curStats.armor*(this.curStats.mod_armor/100)),this.curStats.crit+=c.default.intCast(this.curStats.crit*(this.curStats.mod_crit/100)),this.curStats.diplomacy+=c.default.intCast(this.curStats.diplomacy*(this.curStats.mod_diplomacy/100)),this.curStats.speed+=c.default.intCast(this.curStats.speed*(this.curStats.mod_speed/100)),this.curStats.attackSpeed+=c.default.intCast(this.curStats.attackSpeed*(this.curStats.mod_attackSpeed/100));var y=this.getCulture();y&&(this.curStats.damage=this.curStats.damage+this.curStats.damage*y.stats.bonus_damage.value,this.curStats.armor=this.curStats.armor+this.curStats.armor*y.stats.bonus_armor.value),this.curStats.health<1&&(this.curStats.health=1),this.data.health>this.curStats.health&&(this.data.health=this.curStats.health),this.data.health<1&&(this.data.health=1),this.curStats.damage<1&&(this.curStats.damage=1),this.curStats.speed<1&&(this.curStats.speed=1),this.curStats.armor<0&&(this.curStats.armor=0),this.curStats.diplomacy<0&&(this.curStats.diplomacy=0),this.curStats.dodge<0&&(this.curStats.dodge=0),this.curStats.accuracy<10&&(this.curStats.accuracy=10),this.curStats.crit<0&&(this.curStats.crit=0),this.curStats.attackSpeed<0&&(this.curStats.attackSpeed=1),this.curStats.attackSpeed>=300&&(this.curStats.attackSpeed=300),this.s_attackSpeed_seconds=(300-this.curStats.attackSpeed)/(100+this.curStats.attackSpeed),this.curStats.s_crit_chance=this.curStats.crit/100,this.curStats.zones=2*(this.curStats.stewardship+1),this.curStats.cities=this.curStats.stewardship/5+1,this.curStats.army=this.curStats.warfare+5,this.curStats.bonus_towers=this.curStats.warfare/10,this.curStats.bonus_towers>2&&(this.curStats.bonus_towers=2),this.curStats.army<0&&(this.curStats.army=5),this.attackTimer=0,this.updateTargetScale(),this.curStats.normalize(),this.currentScale.x=this.curStats.scale,this.currentScale.y=this.curStats.scale,this.currentScale.z=this.curStats.scale}},e.prototype.getCulture=function(){var t;return(null===(t=this.data)||void 0===t?void 0:t.culture)?S.default.inst.cultures.get(this.data.culture):null},e.prototype.findHeadSprite=function(){if(this.actorAnimationData&&this.stats.body_separate_part_head&&(this.setHeadSprite(null),this.tryToLoadFunHead(),!this.s_head_sprite)){if(!this.stats.unit)return this.checkHeadID(),this.data.head>this.actorAnimationData.heads.length-1&&(this.data.head=0),void this.setHeadSprite(this.actorAnimationData.heads[this.data.head]);var t=!1,e="";if(this.data.profession!=x.UnitProfession.Warrior||this.equipment.helmet.isEmpty()?this.data.profession==x.UnitProfession.King?(e="head_king",t=!0):this.haveTrait("wise")?(e=this.data.gender!=x.ActorGender.Male?"head_old_female":"head_old_male",t=!0):e=this.data.gender!=x.ActorGender.Male?"heads_female":"heads_male":(e="head_warrior",t=!0),t){var i="actors/races/"+this.stats.race+"/heads_special";this.setHeadSprite(f.default.getHeadSpecial(i,e))}else i="actors/races/"+this.stats.race+"/"+e,this.checkHeadID(),this.setHeadSprite(f.default.getHead(i,this.data.head))}},e.prototype.setHeadSprite=function(t){if(this.s_head_sprite=t,this.s_head_sprite){if(this.id_sprite_head=f.default.int_ids_heads.get(this.s_head_sprite)||0,0==this.id_sprite_head){var e=f.default.int_ids_heads.size+1;f.default.int_ids_heads.set(this.s_head_sprite,e),this.id_sprite_head=e}}else this.id_sprite_head=-1},e.prototype.setBodySprite=function(t){if(this.s_body_sprite=t,this.s_body_sprite){if(this.id_sprite_body=f.default.int_ids_body.get(this.s_body_sprite)||0,0==this.id_sprite_body){var e=f.default.int_ids_body.size+1;f.default.int_ids_body.set(this.s_body_sprite,e),this.id_sprite_body=e}}else this.id_sprite_body=0},e.prototype.tryToLoadFunHead=function(){},e.prototype.checkHeadID=function(){-1==this.data.head&&(this.loadTexture(),this.stats.unit?this.data.head=B.Toolbox.randomInt(0,this.stats.heads):this.data.head=B.Toolbox.randomInt(0,this.actorAnimationData.heads.length))},e.prototype.checkMadness=function(){var t,e;this.haveTrait("madness")&&!(null===(e=null===(t=this.kingdom)||void 0===t?void 0:t.asset)||void 0===e?void 0:e.mad)&&this.setKingdom(S.default.inst.kingdoms.dict_hidden.get("mad"))},e.prototype.setKingdom=function(t){var e;this.kingdom!=t&&(!t&&(null===(e=this.data)||void 0===e?void 0:e.alive)&&u.default.d("kingdom is set... "),this.kingdom&&this.kingdom.removeUnit(this),this.kingdom=t,this.kingdom&&this.kingdom.addUnit(this))},e.prototype.haveOppositeTrait=function(t){if(!(t="string"==typeof t?_.default.traits.get(t):t))return!1;if(!t.oppositeArr)return!1;for(var e=0;e<t.oppositeArr.length;e++){var i=t.oppositeArr[e];if(this.haveTrait(i))return!0}return!1},e.prototype.haveTrait=function(t){var e,i;return!(null===(e=this.s_traits_ids)||void 0===e||!e.has(t))||!!(this.statsDirty&&(null===(i=this.data)||void 0===i?void 0:i.traits.includes(t)))},e.prototype.inMapBorder=function(){return!(this.currentPosition.x>S.default.width||this.currentPosition.y>S.default.height||this.currentPosition.x<0||this.currentPosition.y<0)},e.prototype.updateForce=function(t){0==this.forceVector.x&&0==this.forceVector.y&&0==this.forceVector.z||(t*=.6,this._positionDirty=!0,this.zPosition.y+=this.forceVector.z*t*40,0!=this.forceVector.x&&(this.currentPosition.x+=this.forceVector.x*t*40),0!=this.forceVector.y&&(this.currentPosition.y+=this.forceVector.y*t*40),this.zPosition.y<0&&(this.zPosition.y=0),this.forceVector.z-=5*t,this.forceVector.z<=0&&this.zPosition.y<=0&&(this.forceVector.z=0,this.forceVector.x=0,this.forceVector.y=0,this._actionFall=!0))},e.prototype.actionLanded=function(){var t,e;this.updateAnimation(0),this._positionDirty=!0,this._currentTileDirty=!0;try{for(var i=s(this.callbacks_landed),o=i.next();!o.done;o=i.next())(0,o.value)(this)}catch(r){t={error:r}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.updateFall=function(t){this.zPosition.y<0||(t*=.6,this.zPosition.y-=25*t,this.zPosition.y<=0&&(this.zPosition.y=0,this._actionFall=!0),this._positionDirty=!0)},e.prototype.updateShake=function(){h.default.isPaused||(this.shakeTimer.isActive?(this.shakeVertical&&(this.shakeOffset.y=B.Toolbox.randomFloat(-this.shakeVolume,this.shakeVolume)),this.shakeHorizontal&&(this.shakeOffset.x=B.Toolbox.randomFloat(-this.shakeVolume,this.shakeVolume)),this._positionDirty=!0):0==this.shakeOffset.x&&0==this.shakeOffset.y||(this.shakeOffset.set(cc.Vec2.ZERO),this._positionDirty=!0))},e.prototype.isNearbyTile=function(t){return this.currentTile==t||t.neighboursAll.has(this.currentTile)},e.prototype.updateFlipRotation=function(t){this.stats.flipAnimation&&(this.flip?(this.flipAngle+=600*t,this.flipAngle>180&&(this.flipAngle=180)):(this.flipAngle-=600*t,this.flipAngle<0&&(this.flipAngle=0)),this.targetAngle.y!=this.flipAngle&&(this.targetAngle.y=this.flipAngle))},e.prototype.updateRotationBack=function(t){if(this.rotationCooldown>0)this.rotationCooldown-=t;else{if(0==this.targetAngle.z)return;this.targetAngle.z>300?(this.targetAngle.z+=10,this.targetAngle.z>=360&&(this.targetAngle.z=0)):(this.targetAngle.z-=10,this.targetAngle.z<0&&(this.targetAngle.z=0))}},e.prototype.updateRotation=function(){this.curAngle.x==this.targetAngle.x&&this.curAngle.y==this.targetAngle.y&&this.curAngle.z==this.targetAngle.z||(this.curAngle.set(this.targetAngle),this.updateScaleX(),this.node.angle=this.curAngle.z)},e.prototype.updateScaleX=function(){this.node.scaleX=(this.targetAngle.y-90)/-90*this.actorSize},e.prototype.updateDeadAnimation=function(){var t;!this.spriteRenderer||null!==(t=this.stats)&&void 0!==t&&t.specialDeadAnimation||(S.default.inst.qualityChanger.isFullLowRes()?this.killHimself(!0,x.AttackType.None,!1):this.stats.deathAnimationAngle&&this.targetAngle.z<90&&(this.targetAngle.z=c.default.lerp(this.targetAngle.z,90,4*S.default.inst.elapsed),this.targetAngle.z>90&&(this.targetAngle.z=90),Math.abs(this.curAngle.z)<45)||(this.changeMoveJumpOffset(-.05),this.isFalling()||this.updateDeadBlackAnimation()))},e.prototype.isFalling=function(){return 0!=this.zPosition.y||0!=this.moveJumpOffset.y},e.prototype.updateDeadBlackAnimation=function(){this.unit_sprite_color.g>0?(this.unit_sprite_color.r-=127.5*S.default.inst.elapsed,this.unit_sprite_color.g-=127.5*S.default.inst.elapsed,this.unit_sprite_color.b-=127.5*S.default.inst.elapsed,this.setUnitSpriteColor(this.unit_sprite_color)):this.node.opacity>0?this.node.opacity-=255*S.default.inst.elapsed:this.killHimself(!0,x.AttackType.None,!1)},e.prototype.setUnitSpriteColor=function(t){this.node.color=t,this.node.children.forEach(function(e){e.color=t})},e.prototype.updateWalkJump=function(t){if(!(!this._is_visible&&0==this.moveJumpOffset.y||this.zPosition.y>0||this.stats.disableJumpAnimation)){if(this.is_moving){if(!this.is_moving&&0==this.jumpTime||this.isAffectedByLiquid())return}else if(0==this.moveJumpOffset.y&&(0==this.jumpTime||this.isAffectedByLiquid()))return;this.jumpTime+=6*S.default.inst.elapsed,this.jumpTime>=1?this.changeMoveJumpOffset(-3*t):this.changeMoveJumpOffset(3*t),this.jumpTime>=2&&(this.jumpTime=0,this.changeMoveJumpOffset(0)),this.stats.rotatingAnimation&&(this.targetAngle.z+=200*(0-this.moveJumpOffset.y)*S.default.inst.elapsed),this._positionDirty=!0}},e.prototype.changeMoveJumpOffset=function(t){this.moveJumpOffset.y+=t,this.moveJumpOffset.y<0&&(this.moveJumpOffset.y=0),this._positionDirty=!0},e.prototype.setCurrentTile=function(t){this.currentTile=t},e.prototype.setCurrentTilePosition=function(t){this.setCurrentTile(t),this.currentPosition.set(t.posV3),this._positionDirty=!0},e.prototype.spawnOn=function(t,e){void 0===e&&(e=0),this.setCurrentTilePosition(t),this.zPosition.y=e,this.hitboxZ=this.stats.defaultZ},e.prototype.findCurrentTile=function(t){if(void 0===t&&(t=!0),this._currentTileDirty||this.currentPosition.x!=this.lastX||this.currentPosition.y!=this.lastY){this._currentTileDirty=!1,this.lastX=this.currentPosition.x,this.lastY=this.currentPosition.y;var e=c.default.intCast(this.currentPosition.x),i=c.default.intCast(this.currentPosition.y);if(e>=S.default.width&&(e=S.default.width-1),i>=S.default.height&&(i=S.default.height-1),e<0&&(e=0),i<0&&(i=0),this.setCurrentTile(S.default.inst.getTileSimple(e,i)),!(B.Toolbox.dist(this.currentTile.posV3.x,this.currentTile.posV3.y,this.currentPosition.x,this.currentPosition.y)<.5)&&t)if(this.currentTile.type.ocean&&this.stats.damagedByOcean&&!this.stats.flying)for(var o=0;o<this.currentTile.neighboursAll.length;o++){var a=this.currentTile.neighboursAll[o];if(!a.type.liquid){this.currentTile=a;break}}else{if(this.currentTile.type.liquid||!this.stats.dieOnGround)return;for(o=0;o<this.currentTile.neighboursAll.length;o++){var n=this.currentTile.neighboursAll[o];if(n.type.liquid){this.currentTile=n;break}}}}},e.prototype.moveTo=function(t){this._positionDirty=!0,this.is_moving=!0,this.attackTarget||!this.currentTile||!t.data.fire||this.currentTile.data.fire||this._trait_fire_resistant?(this.nextStepTile=t,B.Toolbox.distTile(this.currentTile,t)>2?this._currentTileDirty=!0:this.setCurrentTile(this.nextStepTile),this.currentTile.type.stepAction&&B.Toolbox.randomChance(t.type.stepActionChance)&&this.currentTile.type.stepAction(t,this),this.nextStepPosition=t.posV3.clone()):this.cancelAllBeh()},e.prototype.setFlip=function(t){this.flip=t},e.prototype.smoothMovement=function(t,e){var i;if(this.nextStepPosition.x!=T.default.emptyVector.x&&(null===(i=this.data)||void 0===i?void 0:i.alive)&&(this.is_moving=!0,B.Toolbox.distVec3(this.currentPosition,t)>Number.EPSILON)){this.stats.flipAnimation&&this.is_moving&&(this.currentPosition.x<t.x?this.setFlip(!0):this.setFlip(!1));var o=this.stats.ignoreTileSpeedMod||this.isInAir()||this.stats.oceanCreature?1:!this.currentTile.type.liquid||this.currentTile.type.liquid?this.currentTile.type.walkMod:1;!this.stats.ignoreTileSpeedMod&&this._isInLiquid&&1!=this.stats.speedModLiquid&&(o*=this.stats.speedModLiquid);var a=o*this.curStats.speed*.1;return a<.1&&(a=.1),a*=e,this.currentPosition=B.Toolbox.moveTowards(this.currentPosition,t,a),void(this._positionDirty=!0)}this._positionDirty=!0,this.is_moving=!1,this.isUsingPath()&&this.updatePathMovement()},e.prototype.isUsingPath=function(){return 0!=this.current_path.length||this.split_path!=l.Normal},e.prototype.goTo=function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.setTileTarget(t),O.default.goTo(this,t,e,i)},e.prototype.stopMovement=function(){this.split_path=l.Normal,this.nextStepTile=null,this.current_path_global=null,this.current_path=[],this.setTileTarget(null),this.is_moving=!1,this.nextStepPosition=T.default.emptyVector},e.prototype.updatePathMovement=function(){var t=this;if(0==this.current_path.length){if(this.split_path==l.Normal)return;return this.split_path==l.Prepare?(this.split_path=l.Split,void(this.timer_action=B.Toolbox.randomFloat(0,2))):(this.split_path=l.Normal,void(this.tileTarget&&this.goTo(this.tileTarget)))}var e=this.current_path.shift();if(e){if(this.stats.isBoat&&!e.isGoodForBoat())return this.callbacks_cancel_path_movement.forEach(function(e){e(t)}),void this.cancelAllBeh();if(e.type.block){var i=this.ai.task;if(i&&!i.moveFromBlock)return void this.cancelAllBeh()}this.stats.dieInLava&&e.type.lava?this.cancelAllBeh():this.stats.damagedByOcean&&e.type.ocean&&!this._isInLiquid?this.cancelAllBeh():this.stats.dieOnGround&&e.type.ground?this.cancelAllBeh():this.moveTo(e)}},e.prototype.setTileTarget=function(t){var e;(null===(e=this.tileTarget)||void 0===e?void 0:e.targetedBy)==this&&(this.tileTarget.targetedBy=null),this.tileTarget=t,this.tileTarget&&(this.tileTarget.targetedBy=this)},e.clearStatusEffects=function(t){var e;if((null===(e=t.activeStatusEffects)||void 0===e?void 0:e.length)>0)for(;t.activeStatusEffects&&0<t.activeStatusEffects.length;){var i=t.activeStatusEffects[0];t.removeStatusEffect(i.asset.id,i,0)}},e.prototype.clearTasks=function(){this.insideBuilding=null,this._timeout_targets=0,this.attackTarget=null,this.timer_action=0,this.setTileTarget(null)},e.prototype.cancelAllBeh=function(){var t;this.inventory.resource&&(null===(t=this.city)||void 0===t?void 0:t.data)&&this.city.data.storage.change(this.inventory.resource,this.inventory.amount),this.inventory.empty(),this.ai.clearBeh(),this.ai.setTaskBehFinished(),this.ai.setJob(null),this.clearTasks(),this.stopMovement()},e.prototype.killHimself=function(t,e,i,o){void 0===t&&(t=!1),void 0===e&&(e=x.AttackType.Other),void 0===i&&(i=!0),void 0===o&&(o=!0)},e.spriteOffset=cc.v3(.5,.5),e.actorCastPos=cc.v3(0,13),e.possible_moves=[],e.possible_zones=[],e}(g.default);n.default=D,cc._RF.pop()},{}],ActorEquipmentSlot:[function(t,e,i){"use strict";cc._RF.push(e,"d145dXQlgVA0ZTTygWbBl+6","ActorEquipmentSlot");var o,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.ItemData=a.EquipmentType=void 0,function(t){t[t.Weapon=0]="Weapon",t[t.Helmet=1]="Helmet",t[t.Armor=2]="Armor",t[t.Boots=3]="Boots",t[t.Ring=4]="Ring",t[t.Amulet=5]="Amulet"}(o=a.EquipmentType||(a.EquipmentType={})),a.ItemData=function(){this.year=0,this.by="",this.from="",this.id="",this.material="",this.prefix="",this.suffix="",this.type=o.Weapon};var n=function(){function t(t){void 0===t&&(t=o.Armor),this.type=t,this.emptySlot()}return t.prototype.copyTo=function(t){this.data=t.data},t.prototype.isEmpty=function(){return null==this.data},t.prototype.emptySlot=function(){this.data=null},t.prototype.setItem=function(t){this.data=t},t}();a.default=n,cc._RF.pop()},{}],ActorEquipment:[function(t,e,i){"use strict";cc._RF.push(e,"3c33653ybVBd7RexOHEfh9H","ActorEquipment");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ActorEquipmentSlot"),r=function(){function t(){this.NONE="none",this.helmet=new n.default(n.EquipmentType.Helmet),this.armor=new n.default(n.EquipmentType.Armor),this.weapon=new n.default(n.EquipmentType.Weapon),this.boots=new n.default(n.EquipmentType.Boots),this.ring=new n.default(n.EquipmentType.Ring),this.amulet=new n.default(n.EquipmentType.Amulet)}return t.prototype.getDataForSave=function(){var e=[];return t._list=t.getList(this),t._list.forEach(function(t){e.push(t.data)}),e},t.prototype.load=function(t){var e=this;t&&0!=t.length&&t.forEach(function(t){e.getSlot(t.type).setItem(t)})},t.getList=function(e,i){return void 0===i&&(i=!1),t._list=[],t.addToList(e.helmet,i),t.addToList(e.armor,i),t.addToList(e.weapon,i),t.addToList(e.boots,i),t.addToList(e.ring,i),t.addToList(e.amulet,i),t._list},t.prototype.getSlot=function(t){switch(t){case n.EquipmentType.Weapon:return this.weapon;case n.EquipmentType.Helmet:return this.helmet;case n.EquipmentType.Armor:return this.armor;case n.EquipmentType.Boots:return this.boots;case n.EquipmentType.Ring:return this.ring;case n.EquipmentType.Amulet:return this.amulet;default:return null}},t.addToList=function(e,i){if(i){if(e.data)return}else if(!e.data)return;t._list.push(e)},t._list=[],t}();a.default=r,cc._RF.pop()},{}],ActorJobLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"51ed3yGiSFOTpDSpzT8a/mg","ActorJobLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorJob"),l=a("CondGroupLeader"),c=a("CondHaveAttackTarget"),d=a("CondHaveUnitGroup"),u=a("CondNoAttackTarget"),h=a("CondNotGroupLeader"),p=a("CondNoUnitGroup"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.initJobsCivs(),this.initJobsMobs(),this.initJobsBoats()},e.prototype.initJobsBoats=function(){var t=new s.default;t.id="boat_fishing",this.add(t),this.t.addTask("boat_danger_check"),this.t.addTask("boat_fishing"),this.t.addTask("boat_idle");var e=new s.default;t.id="boat_trading",this.add(e),this.t.addTask("boat_danger_check"),this.t.addTask("boat_trading"),this.t.addTask("boat_idle");var i=new s.default;i.id="boat_transport",this.add(i),this.t.addTask("boat_danger_check"),this.t.addTask("boat_transport_check"),this.t.addTask("boat_idle")},e.prototype.initJobsCivs=function(){var t=new s.default;t.id="unit",this.add(t),this.t.addTask("check_join_city"),this.t.addTask("build_city_here"),this.t.addTask("random_move"),this.t.addTask("check_join_empty_nearby_city"),this.t.addTask("nomad_try_build_city"),this.t.addTask("check_if_stuck_on_small_land"),this.t.addTask("end_job");var e=new s.default;e.id="baby",this.add(e),this.t.addTask("random_move"),this.t.addTask("city_idle_walking"),this.t.addTask("stay_in_house"),this.t.addTask("check_if_stuck_on_small_land");var i=new s.default;i.id="citizen",this.add(i),this.t.addTask("random_move"),this.t.addTask("city_idle_walking"),this.t.addTask("find_city_job"),this.t.addTask("stay_in_house"),this.t.addTask("try_to_return_home"),this.t.addTask("check_if_stuck_on_small_land");var o=new s.default;o.id="fireman",this.add(o),this.t.addTask("put_out_fire"),this.t.addTask("end_job");var a=new s.default;a.id="hunter",a.cityJob=!0,this.add(a),this.t.addTask("random_move"),this.t.addTask("look_for_animals"),this.t.addTask("end_job");var n=new s.default;n.id="builder",n.cityJob=!0,this.add(n),this.t.addTask("build_new_building"),this.t.addTask("end_job");var r=new s.default;r.id="settler",r.cityJob=!0,r.cancel_when_embarking=!1,this.add(r),this.t.addTask("city_idle_walking"),this.t.addTask("settler_check_transport"),this.t.addTask("settler_same_island"),this.t.addTask("build_city_here"),this.t.addTask("check_join_city"),this.t.addTask("try_to_return_home"),this.t.addTask("check_if_stuck_on_small_land");var f=new s.default;f.id="cleaner",f.cityJob=!0,this.add(f),this.t.addTask("cleaning"),this.t.addTask("end_job");var _=new s.default;_.id="road_builder",_.cityJob=!0,this.add(_),this.t.addTask("build_road"),this.t.addTask("end_job");var m=new s.default;m.id="woodcutter",m.cityJob=!0,this.add(m),this.t.addTask("chop_trees"),this.t.addTask("end_job");var g=new s.default;g.id="miner",g.cityJob=!0,this.add(g),this.t.addTask("mine"),this.t.addTask("end_job");var y=new s.default;y.id="miner_deposit",y.cityJob=!0,this.add(y),this.t.addTask("mine_deposit"),this.t.addTask("end_job");var v=new s.default;v.id="metalworker",v.cityJob=!0,this.add(v),this.t.addTask("convert_ore"),this.t.addTask("end_job");var b=new s.default;b.id="blacksmith",b.cityJob=!0,this.add(b),this.t.addTask("make_items"),this.t.addTask("end_job");var w=new s.default;w.id="gatherer",w.cityJob=!0,this.add(w),this.t.addTask("collect_fruits"),this.t.addTask("end_job");var T=new s.default;T.id="farmer_plower",T.cityJob=!0,this.add(T),this.t.addTask("farming_make_field"),this.t.addTask("end_job");var k=new s.default;k.id="farmer",k.cityJob=!0,this.add(k),this.t.addTask("plant_crops"),this.t.addTask("harvest"),this.t.addTask("end_job");var B=new s.default;B.id="attacker",B.cityJob=!0,this.add(B),this.t.addTask("warrior_check_city_army_group"),this.t.addTask("city_idle_walking"),this.t.addCondition(new l.default),this.t.addCondition(new d.default),this.t.addCondition(new u.default),this.t.addTask("warrior_army_leader_move_random"),this.t.addCondition(new l.default),this.t.addCondition(new d.default),this.t.addTask("warrior_army_leader_move_to_attack_target"),this.t.addCondition(new l.default),this.t.addCondition(new d.default),this.t.addCondition(new c.default),this.t.addTask("warrior_army_follow_leader"),this.t.addCondition(new d.default),this.t.addCondition(new h.default),this.t.addTask("city_idle_walking"),this.t.addCondition(new p.default),this.t.addTask("random_move"),this.t.addCondition(new p.default),this.t.addTask("check_warrior_transport"),this.t.addTask("wait"),this.t.addTask("try_to_return_home"),this.t.addTask("check_if_stuck_on_small_land");var S=new s.default;S.id="defender",S.cityJob=!0,this.add(S),this.t.addTask("check_warrior_defender"),this.t.addTask("wait"),this.t.addTask("try_to_return_home")},e.prototype.initJobsMobs=function(){var t=new s.default;t.id="rat",this.add(t),this.t.addTask("rat"),this.t.addTask("check_hunger_animal"),this.t.addTask("try_babymaking");var e=new s.default;e.id="crab",this.add(e),this.t.addTask("swim_to_island"),this.t.addTask("crab_danger_check"),this.t.addTask("random_move"),this.t.addTask("crab_danger_check"),this.t.addTask("try_babymaking"),this.t.addTask("crab"),this.t.addTask("crab_danger_check");var i=new s.default;i.id="crab_burrow",this.add(i),this.t.addTask("crab_burrow");var o=new s.default;o.id="animal_water_eater",this.add(o),this.t.addTask("swim_to_island"),this.t.addTask("wait10"),this.t.addTask("random_move"),this.t.addTask("try_babymaking"),this.t.addTask("water_feeding"),this.t.addTask("wait10");var a=new s.default;a.id="animal",this.add(a),this.t.addTask("random_animal_move"),this.t.addTask("check_hunger_animal"),this.t.addTask("try_babymaking"),this.t.addTask("wait10");var n=new s.default;n.id="bee",this.add(n),this.t.addTask("pollinate"),this.t.addTask("random_move");var r=new s.default;r.id="animal_herd",this.add(r),this.t.addTask("random_move"),this.t.addTask("check_hunger_animal"),this.t.addTask("try_babymaking"),this.t.addTask("follow_same_race"),this.t.addTask("wait5");var l=new s.default;l.id="random_move",this.add(l),this.t.addTask("random_move");var c=new s.default;c.id="random_swim",this.add(c),this.t.addTask("random_swim");var d=new s.default;d.id="move_mob",this.add(d),this.t.addTask("random_move"),this.t.addTask("attack_golden_brain");var u=new s.default;u.id="skeleton_job",this.add(u),this.t.addTask("skeleton_move"),this.t.addTask("attack_golden_brain");var h=new s.default;h.id="necromancer",this.add(h),this.t.addTask("random_move"),this.t.addTask("wait"),this.t.addTask("check_heal"),this.t.addTask("make_skeleton"),this.t.addTask("attack_golden_brain");var p=new s.default;p.id="evil_mage",this.add(p),this.t.addTask("random_move"),this.t.addTask("check_heal"),this.t.addTask("random_teleport"),this.t.addTask("wait");var f=new s.default;f.id="white_mage",this.add(f),this.t.addTask("random_move"),this.t.addTask("check_heal"),this.t.addTask("random_teleport"),this.t.addTask("wait");var _=new s.default;_.id="druid",this.add(_),this.t.addTask("random_move"),this.t.addTask("check_heal"),this.t.addTask("spawn_grass_seeds"),this.t.addTask("wait");var m=new s.default;m.id="plague_doctor",this.add(m),this.t.addTask("check_cure"),this.t.addTask("burn_tumors"),this.t.addTask("random_move_towards_civ_building"),this.t.addTask("check_heal"),this.t.addTask("wait");var g=new s.default;g.id="mush",this.add(g),this.t.addTask("random_move"),this.t.addTask("wait");var y=new s.default;y.id="tumor_monster",this.add(y),this.t.addTask("random_move"),this.t.addTask("wait"),this.t.addTask("attack_golden_brain");var v=new s.default;v.id="unit_on_fire",this.add(v),this.t.addTask("short_move"),this.t.addTask("short_move"),this.t.addTask("short_move"),this.t.addTask("run_to_water"),this.t.addTask("end_job")},e}(a("AssetLibrary").default);n.default=f,cc._RF.pop()},{}],ActorJob:[function(t,e,i){"use strict";cc._RF.push(e,"9f4b1Gdew9FIZXh0rvSbqAb","ActorJob");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.JobCityAsset=n.JobAsset=void 0;var s=a("AssetLibrary"),l=a("BaseContainer"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tasks=[],e}return r(e,t),e.prototype.addCondition=function(t){this.tasks[this.tasks.length-1].addCondition(t)},e.prototype.addTask=function(t){var e=new l.TaskContainer;e.id=t,this.tasks.push(e)},e}(s.Asset);n.JobAsset=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(c);n.JobCityAsset=d;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=[],e.cancel_when_embarking=!0,e}return r(e,t),e}(c);n.default=u,cc._RF.pop()},{}],ActorMove:[function(t,e,i){"use strict";cc._RF.push(e,"ed674cMfn9CYpy+n/3AJ5za","ActorMove");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.PathFinderResult=a.ExecuteEvent=void 0;var n,r,s=o("AStarFinder"),l=o("PathfinderTools"),c=o("DebugConfig"),d=o("MapBox"),u=o("ActorBase");(function(t){t[t.True=0]="True",t[t.False=1]="False",t[t.Continue=2]="Continue"})(n=a.ExecuteEvent||(a.ExecuteEvent={})),function(t){t[t.PathFound=0]="PathFound",t[t.NotFound=1]="NotFound",t[t.SamePlace=2]="SamePlace",t[t.DifferentIslands=3]="DifferentIslands"}(r=a.PathFinderResult||(a.PathFinderResult={}));var h=function(){function t(){}return t.goTo=function(e,i,o,a){var h;if(void 0===o&&(o=!1),void 0===a&&(a=!1),e.current_path=[],e.current_path_global=null,!c.default.UnitPathfinding)return e.current_path.push(i),n.True;if(e.stats.isBoat&&!i.isGoodForBoat())return n.False;if(e.isInAir())return e.current_path.push(i),n.True;var p=e.currentTile.isSameIsland(i);if(p&&!e.isInLiquid()&&(o=!1),d.default.inst.pathfindingParam.resetParam(),d.default.inst.pathfindingParam.block=a,d.default.inst.pathfindingParam.lava=!e.stats.dieInLava,e.currentTile.type.lava&&(d.default.inst.pathfindingParam.lava=!0),d.default.inst.pathfindingParam.ocean=e.stats.oceanCreature,(o&&!e.stats.damagedByOcean||e.isInLiquid())&&(d.default.inst.pathfindingParam.ocean=!0),d.default.inst.pathfindingParam.ground=e.stats.landCreature,d.default.inst.pathfindingParam.boat=e.stats.isBoat&&e.currentTile.isGoodForBoat(),d.default.inst.pathfindingParam.limit=!0,l.default.tryToGetSimplePath(e.currentTile,i,e.current_path,e.stats,d.default.inst.pathfindingParam)||(e.current_path=[]),e.stats.isBoat&&"boat_transport"==e.stats.id&&d.default.inst.pathFindingVisualiser.showPath(null,e.current_path),e.current_path.length>0)return e.setTileTarget(i),n.True;if(!p){if(!(i.type.ground&&d.default.inst.pathfindingParam.ground||i.type.ocean&&d.default.inst.pathfindingParam.ocean||i.type.swamp&&d.default.inst.pathfindingParam.swamp||i.type.lava&&d.default.inst.pathfindingParam.lava||i.type.block&&d.default.inst.pathfindingParam.block))return n.False;if(i.region.island.getTileCount()<e.currentTile.region.island.getTileCount()){if(!i.region.island.connectedWith(e.currentTile.region.island))return n.False;d.default.inst.pathfindingParam.endToStartPath=!0}else if(!e.currentTile.region.island.connectedWith(i.region.island))return n.False}var f=c.default.UseGlobalPathLock;if(e.stats.isBoat?f=!1:p||(f=!1),f){switch(d.default.inst.regionPathFinder.getGlobalPath(e.currentTile,i,e.stats.isBoat)){case r.SamePlace:return e.current_path.push(i),n.True;case r.NotFound:case r.DifferentIslands:return n.True}if(d.default.inst.regionPathFinder.last_globalPath){e.current_path_global=d.default.inst.regionPathFinder.last_globalPath;for(var _=0,m=0;m<e.current_path_global.length;m++){var g=e.current_path_global[m];g.usedByPathLock=!0,g.regionPathID=_++}if(e.stats.isBoat&&c.default.CheckGoodForBoat)for(t._temp_list=[],m=0;m<e.current_path_global.length;m++)for(var y=e.current_path_global[m],v=0;v<y.neighbours.length;v++){var b=y.neighbours[v];e.current_path_global.includes(b)||(b.usedByPathLock=!0,t._temp_list.push(b))}}else e.currentTile.region.usedByPathLock=!0,e.currentTile.region.regionPathID=0}d.default.inst.pathfindingParam.useGlobalPathLock=f;var w=i;if(s.default.result_split_path&&(null===(h=e.current_path_global)||void 0===h?void 0:h.length)>4&&(w=e.current_path_global[4].tiles.getRandom()),d.default.inst.calcPath(e.currentTile,w,e.current_path),e.stats.isBoat&&"boat_transport"==e.stats.id&&d.default.inst.pathFindingVisualiser.showPath(d.default.inst.searchGridGround,e.current_path),s.default.result_split_path&&(e.split_path=u.SplitPathStatus.Prepare),f){if(e.current_path_global)for(m=0;m<e.current_path_global.length;m++){var T=e.current_path_global[m];T.usedByPathLock=!1,T.regionPathID=-1}e.currentTile.region.usedByPathLock=!1,e.currentTile.region.regionPathID=-1}return e.setTileTarget(i),n.True},t._temp_list=[],t}();a.default=h,cc._RF.pop()},{}],ActorStatsLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"357c73L1bJI5KpJYXm+41ex","ActorStatsLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Log"),l=a("Tools"),c=a("WorldAction"),d=a("ActionLibrary"),u=a("ActorAsset"),h=a("ActorStats"),p=a("BaseBuilding"),f=a("ToolBox"),_=a("TextureLoader"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spawnInRuins=[],e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new h.default;e.id="_unit",e.canBeKilledByStuff=!0,e.canBeKilledByLifeEraser=!0,e.canAttackBuildings=!0,e.unit=!0,e.swimToIsland=!0,e.canBeMovedByPowers=!0,e.canBeHurtByPowers=!0,e.canTurnIntoZombie=!0,e.updateZ=!0,e.effectDamage=!0,e.flipAnimation=!0,e.actorSize=u.ActorSize.S12_Human,e.canBeInspected=!0,e.hideOnMinimap=!0,e.use_items=!0,e.take_items=!0,e.needFood=!0,e.diet_meat=!0,e.inspect_home=!0,e.disableJumpAnimation=!1,e.deathAnimationAngle=!0,e.prefab="p_unit",e.body_separate_part_head=!0,e.body_separate_part_hands=!0,e.canHaveStatusEffect=!0,e.sprite_group_renderer=!0,e.have_soul=!0,e.landCreature=!0,this.add(e),this.t.canTurnIntoMush=!0,this.t.mushID="mush_unit",this.t.canTurnIntoTumorMonster=!0,this.t.tumorMonsterID="tumor_monster_unit",this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.animation_walk_speed=.1,this.t.animation_swim_speed=.1,this.t.job="unit",this.t.baseStats.speed=100,this.t.baseStats.attackSpeed=60,this.t.defaultAttack="hands",this.t.skeletonID="skeleton_cursed",this.t.disableJumpAnimation=!0,this.clone("unit_human","_unit"),this.t.nameLocale="Humans",this.t.nameTemplate="human_name",this.t.race="human",this.t.maxAge=70,this.t.icon="iconHumans",this.t.color=f.Toolbox.makeColor("#005E72"),this.t.zombieID="zombie",this.t.animation_walk_speed=.2,this.t.animation_swim_speed=.2,this.t.setBaseStats(100,15,40,0,5,92,5),this.t.disableJumpAnimation=!0,this.t.heads=7,this.addColorSet("default","#FFC984","#543E2C"),this.clone("unit_elf","_unit"),this.t.nameLocale="Elves",this.t.nameTemplate="elf_name",this.t.race="elf",this.t.maxAge=200,this.t.icon="iconElves",this.t.color=f.Toolbox.makeColor("#005D00"),this.t.zombieID="zombie_elf",this.addTrait("weightless"),this.t.setBaseStats(120,15,50,0,10,95),this.t.action_death.clear(),this.t.action_death.add(d.default.tryToGrowBiomeGrass),this.t.action_death.add(d.default.tryToGrowTree),this.t.disableJumpAnimation=!0,this.t.heads=7,this.addColorSet("default","#FFC984","#543E2C"),this.clone("unit_orc","_unit"),this.t.nameLocale="Orcs",this.t.nameTemplate="orc_name",this.t.race="orc",this.t.maxAge=50,this.t.icon="iconOrcs",this.t.color=f.Toolbox.makeColor("#2F5225"),this.t.zombieID="zombie_orc",this.addTrait("regeneration"),this.addTrait("savage"),this.t.setBaseStats(170,20,50,3,0,90),this.t.disableJumpAnimation=!0,this.t.heads=7,this.addColorSet("default","#5C823C","#2D3724"),this.clone("unit_dwarf","_unit"),this.t.nameLocale="Dwarves",this.t.nameTemplate="dwarf_name",this.t.race="dwarf",this.t.maxAge=110,this.t.baseStats.attackSpeed=50,this.t.icon="iconDwarf",this.t.color=f.Toolbox.makeColor("#828282"),this.t.zombieID="zombie_dwarf",this.t.setBaseStats(150,17,30,4,0,90),this.addTrait("miner"),this.t.disableJumpAnimation=!0,this.t.heads=7,this.addColorSet("default","#FFC984","#543E2C"),this.clone("baby_human","unit_human"),this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.take_items=!1,this.t.baseStats.speed=10,this.t.timeToGrow=200,this.t.baby=!0,this.t.animation_idle="walk_3",this.addTrait("peaceful"),this.t.growIntoID="unit_human",this.t.disableJumpAnimation=!0,this.t.color_sets=this.get("unit_human").color_sets,this.clone("baby_elf","unit_elf"),this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.take_items=!1,this.t.baseStats.speed=10,this.t.timeToGrow=400,this.t.baby=!0,this.t.animation_idle="walk_3",this.t.growIntoID="unit_elf",this.addTrait("peaceful"),this.t.action_death.clear(),this.t.action_death.add(d.default.tryToGrowBiomeGrass),this.t.action_death.add(d.default.tryToCreatePlants),this.t.disableJumpAnimation=!0,this.t.color_sets=this.get("unit_elf").color_sets,this.clone("baby_orc","unit_orc"),this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.take_items=!1,this.t.baseStats.speed=10,this.t.timeToGrow=120,this.t.baby=!0,this.t.animation_idle="walk_3",this.t.growIntoID="unit_orc",this.addTrait("peaceful"),this.t.disableJumpAnimation=!0,this.t.color_sets=this.get("unit_orc").color_sets,this.clone("baby_dwarf","unit_dwarf"),this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.take_items=!1,this.t.baseStats.speed=10,this.t.timeToGrow=250,this.t.baby=!0,this.t.animation_idle="walk_3",this.t.growIntoID="unit_dwarf",this.addTrait("peaceful"),this.t.disableJumpAnimation=!0,this.t.color_sets=this.get("unit_dwarf").color_sets;var i=new h.default;i.id="antBlack",i.race="special",i.kingdom="ants",i.canBeKilledByStuff=!0,i.canBeKilledByLifeEraser=!0,i.ignoreTileSpeedMod=!0,i.skipFightLogic=!0,i.ignoreJobs=!0,i.canBeMovedByPowers=!0,i.canBeHurtByPowers=!0,i.updateZ=!0,i.effectDamage=!0,i.flipAnimation=!0,i.actorSize=u.ActorSize.S12_Human,i.hideOnMinimap=!0,i.prefab="p_unit",i.color=f.Toolbox.makeColor("#000000"),i.canHaveStatusEffect=!0,i.dieOnBlocks=!1,i.moveFromBlock=!1,i.sprite_group_renderer=!0,this.add(i),this.t.canBeInspected=!0,this.addFlag("ant"),this.t.nameLocale="Black Ant",this.t.nameTemplate="ant_name",this.t.texture_path="t_antblack",this.t.animation_walk="walk_0",this.t.baseStats.speed=40,this.t.baseStats.knockback=0,this.addTrait("strong_minded"),this.clone("antGreen","antBlack"),this.t.nameLocale="Green Ant",this.t.texture_path="t_antgreen",this.t.color=f.Toolbox.makeColor("#007F0E"),this.clone("antBlue","antBlack"),this.t.nameLocale="Blue Ant",this.t.texture_path="t_antblue",this.t.color=f.Toolbox.makeColor("#0094FF"),this.clone("antRed","antBlack"),this.t.nameLocale="Red Ant",this.t.texture_path="t_antred",this.t.color=f.Toolbox.makeColor("#FF2511"),this.clone("sandSpider","antBlack"),this.t.nameLocale="Sand Spider",this.t.texture_path="t_sandspider",this.t.color=f.Toolbox.makeColor("#2D2D2D"),this.t.baseStats.speed=100,this.clone("worm","antBlack"),this.t.canBeInspected=!1,this.t.nameTemplate="bug_name",this.t.nameLocale="Worm",this.t.animation_walk="walk_0",this.t.canBeMovedByPowers=!1,this.t.canBeHurtByPowers=!0,this.t.canBeKilledByStuff=!1,this.t.race="special",this.t.baseStats.speed=100,this.t.color.a=0,this.t.shadow=!1,this.t.texture_path="t_worm",this.addTrait("fire_proof");var o=new h.default;o.id="printer",o.race="nature",o.kingdom="nature",o.canBeKilledByLifeEraser=!0,o.ignoreTileSpeedMod=!0,o.skipFightLogic=!0,o.ignoreJobs=!0,o.canBeMovedByPowers=!1,o.canBeHurtByPowers=!0,o.updateZ=!0,o.effectDamage=!0,o.flipAnimation=!0,o.hideOnMinimap=!0,o.needFood=!1,o.skipSave=!0,o.prefab="p_unit",o.canHaveStatusEffect=!0,o.dieOnBlocks=!1,o.moveFromBlock=!1,o.ignoredByInfinityCoin=!0,this.add(o),this.addFlag("ant"),this.t.nameLocale="Printer",this.t.texture_path="t_printer",this.t.baseStats.health=1,this.t.baseStats.speed=1e4,this.t.animation_walk="walk_0,walk_1,walk_2";var a=new h.default;a.id="dragon",a.race="dragon",a.kingdom="dragons",a.canBeKilledByStuff=!0,a.canBeKilledByLifeEraser=!0,a.ignoreTileSpeedMod=!0,a.skipFightLogic=!0,a.ignoreJobs=!0,a.canBeMovedByPowers=!0,a.canBeHurtByPowers=!0,a.updateZ=!0,a.defaultZ=0,a.effectDamage=!0,a.flipAnimation=!0,a.specialAnimation=!0,a.specialDeadAnimation=!0,a.canTurnIntoZombie=!0,a.zombieID="zombie_dragon",a.actorSize=u.ActorSize.S17_Giant,a.shadowTexture="unitShadow_7",a.canBeInspected=!0,a.hideFavoriteIcon=!0,a.icon="iconDragon",a.inspectAvatarScale=1.5,a.prefab="p_dragon",a.needFood=!1,a.dieOnBlocks=!1,a.moveFromBlock=!1,this.add(a),this.t.nameLocale="Dragon",this.t.dieInLava=!1,this.t.baseStats.scale=.3,this.t.baseStats.size=2,this.t.baseStats.health=1e3,this.t.baseStats.speed=60,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=80,this.t.baseStats.knockback=.6,this.t.action_death.add(d.default.dragonDeath),this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("strong_minded"),this.addTrait("fire_proof"),this.addTrait("fire_blood"),this.clone("zombie_dragon","dragon"),this.t.nameLocale="Zombie",this.t.prefab="p_zombie_dragon",this.t.dieInLava=!0,this.setZombie(),this.removeTrait("fire_proof"),this.removeTrait("fire_blood"),this.addTrait("acid_blood"),this.addTrait("acid_proof");var n=new h.default;n.id="UFO",n.kingdom="aliens",n.race="ufo",n.canBeKilledByStuff=!0,n.canBeKilledByLifeEraser=!0,n.ignoreTileSpeedMod=!0,n.skipFightLogic=!0,n.ignoreJobs=!0,n.flying=!0,n.canBeMovedByPowers=!0,n.canBeHurtByPowers=!0,n.effectDamage=!0,n.specialAnimation=!0,n.specialDeadAnimation=!0,n.actorSize=u.ActorSize.S16_Typhoon,n.shadowTexture="unitShadow_7",n.canBeInspected=!0,n.icon="iconUfo",n.needFood=!1,n.hideFavoriteIcon=!0,n.dieByLightning=!0,n.prefab="p_ufo",n.dieOnBlocks=!1,n.moveFromBlock=!1,n.have_skin=!1,n.flag_ufo=!0,this.add(n),this.t.nameLocale="UFO",this.t.nameTemplate="ufo_name",this.t.baseStats.scale=.3,this.t.baseStats.health=500,this.t.baseStats.speed=200,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=80,this.t.baseStats.knockback=.6,this.t.action_death.add(d.default.spawnAliens),this.addTrait("immortal"),this.addTrait("strong_minded"),this.addTrait("fire_proof");var r=new h.default;r.id="boulder",r.race="nature",r.kingdom="nature",r.ignoreTileSpeedMod=!0,r.skipFightLogic=!0,r.ignoreJobs=!0,r.canBeMovedByPowers=!0,r.canBeHurtByPowers=!0,r.updateZ=!0,r.effectDamage=!0,r.specialAnimation=!0,r.specialDeadAnimation=!0,r.needFood=!1,r.skipSave=!0,r.prefab="p_boulder",r.dieOnBlocks=!1,r.moveFromBlock=!1,r.ignoredByInfinityCoin=!0,this.add(r),this.t.nameLocale="Bowling Ball",this.t.baseStats.scale=.3;var s=new h.default;s.id="tornado",s.race="nature",s.kingdom="nature",s.canBeKilledByLifeEraser=!0,s.ignoreTileSpeedMod=!0,s.skipFightLogic=!0,s.ignoreJobs=!0,s.flying=!0,s.canBeMovedByPowers=!0,s.canBeHurtByPowers=!0,s.updateZ=!0,s.flipAnimation=!0,s.specialAnimation=!0,s.specialDeadAnimation=!0,s.needFood=!1,s.skipSave=!0,s.prefab="p_tornado",s.dieOnBlocks=!1,s.moveFromBlock=!1,s.ignoredByInfinityCoin=!0,s.flag_tornado=!0,this.add(s),this.t.nameLocale="Tornado",this.t.baseStats.scale=0,this.t.baseStats.speed=50,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=7,this.addTrait("strong_minded");var l=new h.default;l.id="crabzilla",l.race="crabzilla",l.kingdom="crabzilla",l.canBeKilledByStuff=!0,l.ignoreTileSpeedMod=!0,l.skipFightLogic=!0,l.ignoreJobs=!0,l.flying=!1,l.canBeMovedByPowers=!1,l.canBeHurtByPowers=!0,l.updateZ=!0,l.flipAnimation=!1,l.specialAnimation=!0,l.specialDeadAnimation=!0,l.needFood=!1,l.skipSave=!0,l.prefab="p_crabzilla",l.dieOnBlocks=!1,l.moveFromBlock=!1,l.ignoredByInfinityCoin=!0,this.add(l),this.t.haveSpriteRenderer=!1,this.t.nameLocale="Crabzilla",this.t.baseStats.scale=.25,this.t.actorSize=u.ActorSize.S17_Giant,this.t.baseStats.health=5e3,this.t.baseStats.speed=50,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=7,this.t.baseStats.size=8,this.t.canLevelUp=!1,this.t.shadow=!1,this.t.hit_fx_alternative_offset=!1,this.t.action_death.add(d.default.startNuke),this.addTrait("strong_minded");var c=new h.default;c.id="godFinger",c.actorSize=u.ActorSize.S17_Giant,c.shadowTexture="unitShadow_7",c.race="special",c.kingdom="godfinger",c.canBeKilledByStuff=!0,c.ignoreTileSpeedMod=!0,c.canBeKilledByLifeEraser=!0,c.skipFightLogic=!0,c.ignoreJobs=!0,c.canBeMovedByPowers=!0,c.canBeHurtByPowers=!0,c.updateZ=!0,c.effectDamage=!0,c.specialAnimation=!0,c.needFood=!1,c.skipSave=!0,c.deathAnimationAngle=!0,c.prefab="p_godFinger",c.dieOnBlocks=!1,c.moveFromBlock=!1,this.add(c),this.t.flag_finger=!0,this.t.nameLocale="God Finger",this.t.baseStats.scale=.3,this.t.baseStats.health=30,this.t.baseStats.damage=10,this.t.damagedByOcean=!1,this.t.dieInLava=!1,this.addTrait("strong_minded"),this.addTrait("fire_proof");var m=new h.default;m.id="santa",m.race="special",m.kingdom="santa",m.ignoreTileSpeedMod=!0,m.skipFightLogic=!0,m.ignoreJobs=!0,m.flying=!0,m.very_high_flyer=!0,m.canBeMovedByPowers=!0,m.canBeHurtByPowers=!0,m.effectDamage=!0,m.dieByLightning=!0,m.skipSave=!0,m.prefab="p_santa",this.add(m),this.t.nameLocale="Robot Santa",this.t.baseStats.health=50,this.t.baseStats.damage=10,this.t.baseStats.speed=60,this.t.baseStats.size=2,this.addTrait("strong_minded"),this.addTrait("immune"),this.addTrait("evil");var g=new h.default;g.id="_mob",g.canBeKilledByStuff=!0,g.canBeKilledByLifeEraser=!0,g.canAttackBuildings=!0,g.swimToIsland=!0,g.canBeMovedByPowers=!0,g.canBeHurtByPowers=!0,g.updateZ=!0,g.effectDamage=!0,g.flipAnimation=!0,g.canBeInspected=!0,g.hideOnMinimap=!0,g.deathAnimationAngle=!0,g.prefab="p_unit",g.inspect_children=!1,g.canHaveStatusEffect=!0,g.sprite_group_renderer=!0,g.landCreature=!0,this.add(g),this.t.canTurnIntoMush=!0,this.t.mushID="mush_unit",this.t.canTurnIntoTumorMonster=!0,this.t.tumorMonsterID="tumor_monster_unit",this.t.defaultAttack="base",this.t.job="random_move",this.t.animation_walk="walk_0,walk_1,walk_2,walk_2,walk_1",this.t.animation_swim="swim_0,swim_1,swim_1,swim_2",this.t.disableJumpAnimation=!0,this.clone("_animal","_mob"),this.t.canTurnIntoMush=!0,this.t.mushID="mush_animal",this.t.canTurnIntoTumorMonster=!0,this.t.tumorMonsterID="tumor_monster_animal",this.t.inspect_children=!0,this.t.needFood=!0,this.t.job="animal",this.t.animal=!0,this.t.procreate=!0,this.t.source_meat=!0,this.t.defaultAttack="jaws",this.t.maxAge=100;var y=new h.default;y.id="_peacefulAnimal",y.kingdom="neutral_animals",y.canBeKilledByStuff=!0,y.canBeKilledByLifeEraser=!0,y.swimToIsland=!0,y.procreate=!0,y.canBeMovedByPowers=!0,y.canBeHurtByPowers=!0,y.updateZ=!0,y.effectDamage=!0,y.flipAnimation=!0,y.needFood=!0,y.canBeInspected=!0,y.hideOnMinimap=!0,y.animal=!0,y.deathAnimationAngle=!0,y.prefab="p_unit",y.canHaveStatusEffect=!0,y.sprite_group_renderer=!0,y.landCreature=!0,this.add(y),this.t.canTurnIntoMush=!0,this.t.mushID="mush_animal",this.t.canTurnIntoTumorMonster=!0,this.t.tumorMonsterID="tumor_monster_animal",this.t.maxAge=200,this.t.animation_walk="walk_0,walk_1,walk_2,walk_2,walk_1",this.t.animation_swim="swim_0,swim_1,swim_1,swim_2",this.t.baseStats.damage=1,this.addTrait("peaceful"),this.t.job="animal",this.clone("_carnivore","_animal"),this.t.needFood=!0,this.t.diet_meat=!0,this.t.diet_meat_insect=!0,this.clone("_herbivore","_peacefulAnimal"),this.t.needFood=!0,this.t.diet_grass=!0,this.t.diet_flowers=!0,this.t.diet_crops=!0,this.t.diet_berries=!0,this.t.diet_meat_insect=!0,this.clone("_omnivore","_animal"),this.t.needFood=!0,this.t.diet_meat=!0,this.t.diet_meat_insect=!0,this.t.diet_grass=!1,this.t.diet_flowers=!0,this.t.diet_crops=!0,this.t.diet_berries=!0,this.clone("sheep","_herbivore"),this.t.nameLocale="Sheeps",this.t.nameTemplate="sheep_name",this.t.baseStats.speed=30,this.t.race="sheep",this.t.diet_grass=!0,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S9_Sheep,this.t.icon="iconSheep",this.t.color=f.Toolbox.makeColor("#D7D7D7"),this.t.baseStats.damage=5,this.t.job="animal_herd",this.t.texture_path="t_sheep",this.t.playRandomSound=!0,this.t.playRandomSound_id="sheep",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_sheep",this.addColorSet("default","#BFBFBF","#FFFFFF"),this.addColorSet("default","#825D45","#2D2D2D"),this.addColorSet("mushroom","#C902A1","#FFDB2B"),this.addColorSet("corrupted","#111111","#333333"),this.clone("zombie_sheep","sheep"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_sheep",this.setZombie(),this.clone("cow","_herbivore"),this.t.nameLocale="Cow",this.t.kingdom="neutral_animals",this.t.nameTemplate="cow_name",this.t.baseStats.speed=30,this.t.race="cow",this.t.diet_grass=!0,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S14_Cow,this.t.shadowTexture="unitShadow_6",this.t.icon="iconCow",this.t.color=f.Toolbox.makeColor("#D7D7D7"),this.t.baseStats.damage=5,this.t.job="animal",this.t.texture_path="t_cow",this.t.playRandomSound=!1,this.t.playRandomSound_id="cow",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_cow",this.clone("zombie_cow","cow"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_cow",this.setZombie(),this.clone("penguin","_animal"),this.t.nameLocale="Penguin",this.t.job="animal_water_eater",this.t.nameTemplate="penguin_name",this.t.needFood=!0,this.t.swimToIsland=!1,this.t.speedModLiquid=30,this.t.kingdom="neutral_animals",this.t.baseStats.speed=15,this.t.race="penguin",this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_3",this.t.icon="iconPenguin",this.t.color=f.Toolbox.makeColor("#D7D7D7"),this.t.baseStats.damage=5,this.t.texture_path="t_penguin",this.t.playRandomSound=!1,this.t.playRandomSound_id="penguin",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_penguin",this.addTrait("weightless"),this.clone("zombie_penguin","penguin"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_penguin",this.setZombie(),this.clone("turtle","_animal"),this.t.nameLocale="Turtle",this.t.nameTemplate="turtle_name",this.t.job="animal_water_eater",this.t.needFood=!0,this.t.swimToIsland=!1,this.t.speedModLiquid=40,this.t.kingdom="neutral_animals",this.t.baseStats.speed=5,this.t.baseStats.armor=30,this.t.race="turtle",this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_7",this.t.icon="iconTurtle",this.t.color=f.Toolbox.makeColor("#D7D7D7"),this.t.baseStats.damage=5,this.t.texture_path="t_turtle",this.t.playRandomSound=!1,this.t.playRandomSound_id="turtle",this.t.layEggs=!0,this.t.eggStatsID="egg_turtle",this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_turtle",this.t.swampCreature=!0,this.t.immune_to_slowness=!0,this.t.swimToIsland=!1,this.addColorSet("default","#75B455","#56823E"),this.addColorSet("swamp","#476A72","#6DA1AD"),this.addColorSet("corrupted","#111111","#333333"),this.addTrait("slow"),this.addTrait("weightless"),this.addTrait("genius"),this.addTrait("tough"),this.clone("river_turtle","turtle"),this.t.texture_path="t_river_turtle",this.clone("zombie_turtle","turtle"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_turtle",this.setZombie(),this.clone("crab","_animal"),this.t.nameLocale="Crab",this.t.nameTemplate="crab_name",this.t.kingdom="crab",this.t.race="crab",this.t.needFood=!0,this.t.swimToIsland=!1,this.t.job="crab",this.t.disableJumpAnimation=!0,this.t.baseStats.speed=20,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S3_Crab,this.t.shadowTexture="unitShadow_2",this.t.icon="iconCrab",this.t.color=f.Toolbox.makeColor("#D7D7D7"),this.t.baseStats.health=50,this.t.baseStats.damage=15,this.t.baseStats.armor=15,this.t.texture_path="t_crab",this.t.playRandomSound=!1,this.t.playRandomSound_id="crab",this.t.layEggs=!0,this.t.eggStatsID="egg_crab",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_crab",this.addTrait("weightless"),this.clone("zombie_crab","crab"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_crab",this.setZombie(),this.clone("fairy","_peacefulAnimal"),this.t.nameTemplate="fairy_name",this.t.nameLocale="Fairy",this.t.kingdom="good",this.t.procreate=!1,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_idle="walk_0,walk_1,walk_2,walk_3",this.t.baseStats.health=10,this.t.baseStats.speed=35,this.t.needFood=!1,this.t.race="good",this.t.hovering=!0,this.t.source_meat=!1,this.t.source_meat_insect=!1,this.t.actorSize=u.ActorSize.S4_Rat,this.t.shadowTexture="unitShadow_2",this.t.icon="iconFairy",this.t.color=f.Toolbox.makeColor("#23F3FF"),this.t.baseStats.damage=5,this.t.texture_path="t_fairy",this.t.disableJumpAnimation=!0,this.t.have_soul=!0,this.t.moveFromBlock=!0,this.t.dieOnBlocks=!1,this.addTrait("weightless"),this.addTrait("healing_aura"),this.addTrait("immune"),this.addTrait("immortal"),this.addTrait("energized"),this.t.action_death.clear(),this.t.action_death.add(d.default.tryToCreatePlants),this.clone("enchanted_fairy","fairy"),this.t.action_death=this.get("fairy").action_death,this.removeTrait("energized");var v=new h.default;v.id="_insect",v.race="insect",v.kingdom="neutral_animals",v.canBeKilledByStuff=!0,v.canBeKilledByLifeEraser=!0,v.damagedByOcean=!0,v.procreate=!1,v.canBeMovedByPowers=!0,v.canBeHurtByPowers=!0,v.updateZ=!0,v.effectDamage=!0,v.flipAnimation=!0,v.needFood=!1,v.canBeInspected=!0,v.hideOnMinimap=!0,v.animal=!0,v.source_meat_insect=!0,v.actorSize=u.ActorSize.S1_Bug,v.shadowTexture="unitShadow_2",v.color=f.Toolbox.makeColor("#23F3FF"),v.deathAnimationAngle=!0,v.prefab="p_unit",v.canHaveStatusEffect=!0,v.sprite_group_renderer=!0,this.add(v),this.t.maxAge=50,this.t.animation_idle="walk_0,walk_1,walk_2",this.t.animation_walk="walk_0,walk_1,walk_2",this.t.animation_swim="swim_0,swim_1,swim_1",this.t.baseStats.speed=3,this.t.baseStats.health=1,this.t.baseStats.damage=1,this.addTrait("peaceful"),this.t.job="animal",this.t.maxRandomAmount=5,this.clone("_flying_insect","_insect"),this.t.animation_idle="walk_0,walk_1",this.t.animation_walk="walk_0,walk_1",this.t.hovering=!0,this.t.disableJumpAnimation=!0,this.t.skipSave=!0,this.t.flipAnimation=!1,this.t.damagedByOcean=!1,this.t.moveFromBlock=!0,this.addTrait("weightless"),this.clone("bee","_flying_insect"),this.t.nameTemplate="bug_name",this.t.nameLocale="Bee",this.t.animation_walk="walk_0,walk_1",this.t.baseStats.health=10,this.t.baseStats.speed=15,this.t.hovering_max=1,this.t.flipAnimation=!0,this.t.icon="iconBee",this.t.color=f.Toolbox.makeColor("#23F3FF"),this.t.baseStats.damage=5,this.t.diet_meat_insect=!1,this.t.diet_meat=!1,this.t.diet_meat_same_race=!1,this.t.texture_path="t_bee",this.t.needFood=!1,this.t.job="bee",this.clone("fly","_flying_insect"),this.t.nameTemplate="bug_name",this.t.nameLocale="Fly",this.t.texture_path="t_fly",this.clone("butterfly","_flying_insect"),this.t.nameLocale="Butterfly",this.t.icon="iconButterfly",this.t.baseStats.health=10,this.t.baseStats.speed=15,this.t.texture_path="t_butterfly",this.t.maxRandomAmount=6,this.t.flipAnimation=!0,this.t.color=f.Toolbox.makeColor("#23F3FF"),this.t.action_death.clear(),this.t.action_death.add(d.default.tryToCreatePlants),this.clone("grasshopper","_insect"),this.t.nameTemplate="bug_name",this.t.nameLocale="Grasshopper",this.t.texture_path="t_grasshopper",this.t.shadow=!1,this.clone("beetle","_insect"),this.t.nameTemplate="bug_name",this.t.nameLocale="Beetle",this.t.disableJumpAnimation=!0,this.t.texture_path="t_beetle",this.t.shadow=!1;var b=new h.default;b.id="_egg",b.kingdom="neutral_animals",b.egg=!0,b.source_meat=!0,b.canBeKilledByStuff=!0,b.canBeKilledByLifeEraser=!0,b.skipFightLogic=!0,b.updateZ=!0,b.effectDamage=!0,b.canBeMovedByPowers=!0,b.canBeHurtByPowers=!0,b.specialAnimation=!0,b.hideOnMinimap=!0,b.canBeInspected=!0,b.deathAnimationAngle=!0,b.prefab="p_unit",b.ignoreJobs=!0,b.canHaveStatusEffect=!0,b.sprite_group_renderer=!0,this.add(b),this.t.color=f.Toolbox.makeColor("#E5E5B8"),this.t.needFood=!1,this.t.actorSize=u.ActorSize.S2_Egg,this.t.shadowTexture="unitShadow_2",this.t.animation_walk="walk_0",this.t.kingdom="neutral_animals",this.addFlag("egg"),this.t.setBaseStats(1,0,0,0,0,0,0),this.t.inspect_stats=!1,this.addTrait("strong_minded"),this.addTrait("immune"),this.clone("egg_chicken","_egg"),this.t.nameLocale="Chicken",this.t.race="chicken",this.t.nameTemplate="chicken_name",this.t.growIntoID="chick",this.t.texture_path="t_egg_chicken",this.clone("egg_crab","_egg"),this.t.nameLocale="Crab",this.t.nameTemplate="crab_name",this.t.race="crab",this.t.growIntoID="crab",this.t.texture_path="t_egg_crab",this.clone("egg_turtle","_egg"),this.t.nameLocale="Turtle",this.t.nameTemplate="turtle_name",this.t.race="turtle",this.t.growIntoID="turtle",this.t.texture_path="t_egg_turtle",this.clone("chicken","_herbivore"),this.t.nameLocale="Chicken",this.t.baseStats.health=50,this.t.baseStats.speed=20,this.t.baseStats.damage=4,this.t.race="chicken",this.t.nameTemplate="chicken_name",this.t.diet_grass=!0,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S6_Chicken,this.t.shadowTexture="unitShadow_3",this.t.layEggs=!0,this.t.eggStatsID="egg_chicken",this.t.icon="iconChicken",this.t.color=f.Toolbox.makeColor("#DEDAC4"),this.t.texture_path="t_chicken",this.addTrait("weightless"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_chicken",this.addColorSet("default","#BFBFBF","#FFFFFF"),this.addColorSet("default","#A37459","#2D2D2D"),this.addColorSet("default","#DB9641","#C7883A"),this.addColorSet("corrupted","#111111","#333333"),this.clone("rooster","chicken"),this.t.texture_path="t_rooster",this.t.baseStats.health=80,this.t.baseStats.damage=6,this.t.layEggs=!1,this.addColorSet("default_white-orange","#FAFCFB","#C66B22"),this.clone("zombie_chicken","chicken"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_chicken",this.setZombie(),this.clone("chick","chicken"),this.t.procreate=!1,this.t.nameTemplate="chicken_name",this.t.baseStats.health=20,this.t.baseStats.speed=10,this.t.baseStats.damage=1,this.t.layEggs=!1,this.t.texture_path="t_chick",this.t.baby=!0,this.t.timeToGrow=100,this.t.growIntoID="chicken",this.t.actorSize=u.ActorSize.S4_Rat,this.t.shadowTexture="unitShadow_2",this.clone("rat","_omnivore"),this.t.nameLocale="Rat",this.t.nameTemplate="rat_name",this.t.baseStats.health=10,this.t.baseStats.damage=2,this.t.actorSize=u.ActorSize.S4_Rat,this.t.shadowTexture="unitShadow_2",this.t.texture_path="t_rat",this.t.damagedByOcean=!1,this.t.race="rat",this.t.kingdom="rats",this.t.baseStats.speed=30,this.t.shadow=!0,this.t.needFood=!0,this.t.source_meat=!0,this.t.diet_meat_same_race=!0,this.t.maxRandomAmount=5,this.t.canAttackBuildings=!1,this.t.color=f.Toolbox.makeColor("#2D2D2D"),this.t.job="rat",this.addTrait("rat"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_rat",this.clone("zombie_rat","rat"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_rat",this.setZombie(),this.clone("ratKing","_omnivore"),this.t.nameLocale="Rat King",this.t.procreate=!1,this.t.nameTemplate="rat_name",this.t.baseStats.health=50,this.t.baseStats.speed=30,this.t.baseStats.damage=5,this.t.race="rat",this.t.kingdom="ratKings",this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S4_Rat,this.t.shadowTexture="unitShadow_2",this.t.icon="iconRatKing",this.t.color=f.Toolbox.makeColor("#2D2D2D"),this.t.texture_path="t_ratking",this.t.needFood=!0,this.t.diet_meat=!0,this.t.canAttackBuildings=!1,this.t.diet_meat_same_race=!0,this.t.job="rat",this.addTrait("weightless"),this.addTrait("ratKing"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_ratKing",this.clone("zombie_ratKing","ratKing"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_ratking",this.setZombie(),this.clone("cat","_carnivore"),this.t.nameLocale="Cat",this.t.nameTemplate="cat_name",this.t.kingdom="cats",this.t.baseStats.health=99,this.t.baseStats.speed=30,this.t.baseStats.damage=4,this.t.race="cat",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_3",this.t.icon="iconCat",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_cat",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_cat",this.addTrait("weightless"),this.t.defaultAttack="claws",this.addColorSet("polar","#BFBFBF","#FFFFFF"),this.addColorSet("jungle","#494949","#2D2D2D"),this.addColorSet("savanna","#E29B44","#C7883A"),this.addColorSet("default_brown-bright-dark","#FCC291","#BC712B"),this.addColorSet("default_blue-bright-dark","#A7A5C6","#8B89A6"),this.addColorSet("corrupted","#111111","#333333"),this.clone("zombie_cat","cat"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_cat",this.setZombie(),this.clone("rabbit","_herbivore"),this.t.nameLocale="Rabbit",this.t.baseStats.health=15,this.t.baseStats.speed=20,this.t.nameTemplate="rabbit_name",this.t.race="rabbit",this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S6_Chicken,this.t.shadowTexture="unitShadow_2",this.t.icon="iconRabbit",this.t.color=f.Toolbox.makeColor("#D3D6D1"),this.t.texture_path="t_rabbit",this.addTrait("weightless"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_rabbit",this.addColorSet("default","#D3D6D1","#695049"),this.addColorSet("polar","#BFBFBF","#FFFFFF"),this.addColorSet("savanna","#E9D2B0","#D8B27D"),this.addColorSet("corrupted","#111111","#333333"),this.addTrait("fast"),this.clone("zombie_rabbit","rabbit"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_rabbit",this.setZombie(),this.clone("piranha","_mob"),this.t.nameLocale="Piranha",this.t.race="piranha",this.t.kingdom="piranhas",this.t.nameTemplate="piranha_name",this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=200,this.t.baseStats.damage=20,this.t.baseStats.knockback=.5,this.t.canAttackBuildings=!1,this.t.dieOnGround=!0,this.t.swimToIsland=!1,this.t.diet_meat=!0,this.t.actorSize=u.ActorSize.S5_Piranha,this.t.icon="iconPiranha",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#3483B6"),this.t.job="random_swim",this.t.texture_path="t_piranha",this.t.immune_to_slowness=!0,this.addColorSet("default","#64787D","#4E4860"),this.addColorSet("swamp","#647D66","#485D60"),this.t.landCreature=!1,this.t.oceanCreature=!0,this.t.swampCreature=!0,this.clone("bandit","_mob"),this.t.nameLocale="Bandits",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.race="bandit",this.t.kingdom="bandits",this.t.baseStats.speed=60,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=10,this.t.baseStats.knockback=1,this.t.icon="iconBandit",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#4A3F35"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.texture_path="t_bandit",this.t.texture_heads="t_bandit_heads",this.t.defaultWeapons=["spear","sword","bow"],this.t.defaultWeaponsMaterial=["bronze","steel","iron"],this.t.use_items=!0,this.t.take_items=!0,this.t.have_soul=!0,this.addTrait("bomberman"),this.t.disableJumpAnimation=!0,this.clone("snowman","_mob"),this.t.nameLocale="Snowman",this.t.race="snowman",this.t.kingdom="snowman",this.t.nameTemplate="snowman_name",this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=70,this.t.baseStats.damage=10,this.t.baseStats.knockback=1,this.t.defaultAttack="snowball",this.t.icon="iconSnowman",this.t.color=f.Toolbox.makeColor("#FFFFFF"),this.t.texture_path="t_snowman",this.t.damagedByOcean=!0,this.t.damagedByRain=!0,this.t.canTurnIntoMush=!1,this.t.canTurnIntoTumorMonster=!1,this.addTrait("regeneration"),this.addTrait("cold_aura"),this.addTrait("fat"),this.addTrait("freeze_proof"),this.t.disableJumpAnimation=!0,this.clone("alien","_mob"),this.t.texture_path="t_alien",this.t.texture_heads="t_alien_heads",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.nameLocale="Alien",this.t.race="alien",this.t.kingdom="aliens",this.t.baseStats.health=600,this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=70,this.t.baseStats.damage=10,this.t.baseStats.knockback=1,this.t.defaultWeapons=["alien_blaster"],this.t.icon="iconAlien",this.t.color=f.Toolbox.makeColor("#00FF00"),this.t.use_items=!0,this.t.canTurnIntoTumorMonster=!0,this.t.canTurnIntoMush=!0,this.t.mushID="mush_unit",this.t.tumorMonsterID="tumor_monster_unit",this.t.nameTemplate="alien_name",this.t.have_soul=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("fat"),this.addTrait("acid_blood"),this.addTrait("acid_proof"),this.t.disableJumpAnimation=!0,this.clone("bear","_carnivore"),this.t.nameLocale="Bear",this.t.race="bear",this.t.kingdom="bears",this.t.nameTemplate="bear_name",this.t.baseStats.health=150,this.t.baseStats.speed=50,this.t.baseStats.attackSpeed=50,this.t.baseStats.damage=25,this.t.baseStats.knockback=1.2,this.t.baseStats.knockbackReduction=30,this.t.baseStats.targets=2,this.t.procreate=!0,this.t.diet_meat=!0,this.t.diet_berries=!0,this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_bear",this.t.canAttackBuildings=!1,this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_6",this.t.icon="iconBear",this.t.color=f.Toolbox.makeColor("#6C522D"),this.t.texture_path="t_bear",this.addTrait("strong"),this.t.defaultAttack="claws",this.addColorSet("polar","#BFBFBF","#FFFFFF"),this.addColorSet("default","#A37459","#2D2D2D"),this.addColorSet("corrupted","#111111","#333333"),this.clone("zombie_bear","bear"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_bear",this.setZombie(),this.clone("wolf","_carnivore"),this.t.nameLocale="Wolfs",this.t.nameTemplate="wolf_name",this.t.race="wolf",this.t.kingdom="wolves",this.t.baseStats.speed=75,this.t.canAttackBuildings=!1,this.t.baseStats.attackSpeed=100,this.t.baseStats.damage=15,this.t.baseStats.knockback=.8,this.t.procreate=!0,this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_wolf",this.t.actorSize=u.ActorSize.S13_Wolf,this.t.shadowTexture="unitShadow_7",this.t.texture_path="t_wolf",this.t.icon="iconWolf",this.t.color=f.Toolbox.makeColor("#393939"),this.t.job="animal_herd",this.t.playRandomSound=!0,this.t.playRandomSound_id="wolf",this.t.diet_meat_same_race=!0,this.t.diet_meat=!0,this.addColorSet("polar","#BFBFBF","#FFFFFF"),this.addColorSet("default","#A37459","#825D45"),this.addColorSet("default","#9B9B9B","#7C7C7C"),this.addColorSet("default_dark","#919191","#493838"),this.addColorSet("corrupted","#111111","#333333"),this.clone("dog","_peacefulAnimal"),this.t.nameLocale="Dog",this.t.kingdom="neutral_animals",this.t.nameTemplate="wolf_name",this.t.baseStats.health=150,this.t.baseStats.speed=60,this.t.baseStats.damage=10,this.t.race="dog",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_5",this.t.icon="iconDog",this.t.color=f.Toolbox.makeColor("#393939"),this.t.texture_path="t_dog",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_dog",this.t.defaultAttack="jaws",this.addColorSet("default_white-dark","#919191","#493838"),this.addColorSet("default_brown-bright-dark","#AA683B","#8E3D07"),this.addColorSet("polar","#BFBFBF","#FFFFFF"),this.addColorSet("corrupted","#111111","#333333"),this.t.clearTraits(),this.addTrait("fast"),this.clone("zombie_dog","dog"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_dog",this.addTrait("eyepatch"),this.setZombie(),this.clone("snake","_carnivore"),this.t.nameLocale="Snake",this.t.kingdom="snakes",this.t.nameTemplate="snake_name",this.t.baseStats.health=80,this.t.baseStats.speed=30,this.t.baseStats.damage=4,this.t.race="snake",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S11_Snake,this.t.shadowTexture="unitShadow_4",this.t.icon="iconSnake",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_snake",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_snake",this.t.immune_to_slowness=!0,this.t.swampCreature=!0,this.addColorSet("default","#9B7C52","#61E742"),this.addColorSet("jungle","#D6E742","#61E742"),this.addColorSet("savanna","#EA6042","#D6E742"),this.addColorSet("swamp_blue","#61E742","#9542EA"),this.addColorSet("corrupted","#111111","#333333"),this.addTrait("poison_immune"),this.addTrait("venomous"),this.addTrait("weightless"),this.t.defaultAttack="venomous_bite",this.clone("zombie_snake","snake"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_snake",this.setZombie(),this.clone("frog","_peacefulAnimal"),this.t.nameLocale="Frog",this.t.nameTemplate="frog_name",this.t.baseStats.health=20,this.t.baseStats.speed=30,this.t.baseStats.damage=5,this.t.race="frog",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.diet_meat_insect=!0,this.t.actorSize=u.ActorSize.S5_Piranha,this.t.shadowTexture="unitShadow_3",this.t.icon="iconFrog",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_frog",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_frog",this.t.immune_to_slowness=!0,this.t.swampCreature=!0,this.t.swimToIsland=!1,this.t.clearTraits(),this.addTrait("poisonous"),this.addTrait("weightless"),this.addColorSet("default_green","#8AD441","#12B013"),this.addColorSet("jungle_red_yellow","#CB431F","#85CB1F"),this.addColorSet("savanna","#7F3710","#C59C16"),this.addColorSet("mushroom","#C902A1","#FFDB2B"),this.addColorSet("corrupted","#111111","#333333"),this.clone("zombie_frog","frog"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_frog",this.setZombie(),this.clone("rhino","_herbivore"),this.t.nameLocale="Rhino",this.t.kingdom="rhinos",this.t.nameTemplate="rhino_name",this.t.baseStats.health=250,this.t.baseStats.speed=30,this.t.baseStats.armor=10,this.t.baseStats.attackSpeed=20,this.t.baseStats.damage=18,this.t.baseStats.knockback=1.2,this.t.baseStats.knockbackReduction=30,this.t.baseStats.targets=3,this.t.race="rhino",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_11",this.t.icon="iconRhino",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_rhino",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_rhino",this.t.maxRandomAmount=1,this.t.procreate_age=6,this.t.animal_baby_making_around_limit=4,this.t.clearTraits(),this.addTrait("strong"),this.addTrait("fat"),this.clone("zombie_rhino","rhino"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_rhino",this.setZombie(),this.clone("monkey","_herbivore"),this.t.nameLocale="Monkey",this.t.kingdom="neutral_animals",this.t.nameTemplate="monkey_name",this.t.baseStats.health=70,this.t.baseStats.speed=30,this.t.baseStats.damage=15,this.t.baseStats.attackSpeed=50,this.t.baseStats.knockback=1,this.t.race="monkey",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S7_Monkey,this.t.shadowTexture="unitShadow_3",this.t.icon="iconMonkey",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_monkey",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_monkey",this.t.clearTraits(),this.addTrait("genius"),this.addTrait("agile"),this.t.defaultAttack="rocks",this.clone("zombie_monkey","monkey"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_monkey",this.t.defaultAttack="jaws",this.setZombie(),this.clone("crocodile","_carnivore"),this.t.nameLocale="Crocodile",this.t.kingdom="crocodiles",this.t.nameTemplate="crocodile_name",this.t.baseStats.health=200,this.t.baseStats.speed=20,this.t.baseStats.armor=10,this.t.baseStats.damage=30,this.t.baseStats.knockbackReduction=80,this.t.swimToIsland=!1,this.t.race="crocodile",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_21",this.t.icon="iconCrocodile",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_crocodile",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_crocodile",this.t.immune_to_slowness=!0,this.t.maxRandomAmount=2,this.t.landCreature=!0,this.t.oceanCreature=!0,this.t.swampCreature=!0,this.addTrait("tough"),this.clone("zombie_crocodile","crocodile"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_crocodile",this.setZombie(),this.clone("hyena","_carnivore"),this.t.nameLocale="Hyena",this.t.kingdom="hyenas",this.t.nameTemplate="hyena_name",this.t.baseStats.health=75,this.t.baseStats.speed=60,this.t.baseStats.damage=7,this.t.race="hyena",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_5",this.t.icon="iconHyena",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_hyena",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_hyena",this.t.maxRandomAmount=2,this.clone("zombie_hyena","hyena"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_hyena",this.setZombie(),this.clone("buffalo","_herbivore"),this.t.nameLocale="Buffalo",this.t.nameTemplate="buffalo_name",this.t.kingdom="neutral_animals",this.t.baseStats.health=200,this.t.baseStats.speed=50,this.t.baseStats.damage=15,this.t.race="buffalo",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_7",this.t.icon="iconBuffalo",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_buffalo",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_buffalo",this.t.maxRandomAmount=3,this.t.clearTraits(),this.addTrait("strong"),this.clone("zombie_buffalo","buffalo"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_buffalo",this.setZombie(),this.clone("fox","_carnivore"),this.t.nameLocale="Fox",this.t.nameTemplate="fox_name",this.t.kingdom="neutral_animals",this.t.baseStats.speed=50,this.t.baseStats.damage=10,this.t.race="fox",this.t.skipFightLogic=!1,this.t.source_meat=!0,this.t.actorSize=u.ActorSize.S8_Fox,this.t.shadowTexture="unitShadow_4",this.t.icon="iconFox",this.t.color=f.Toolbox.makeColor("#C2974E"),this.t.texture_path="t_fox",this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie_fox",this.t.clearTraits(),this.addTrait("genius"),this.addTrait("fast"),this.clone("zombie_fox","fox"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_fox",this.setZombie(),this.clone("zombie_wolf","wolf"),this.t.nameLocale="Zombie",this.t.texture_path="t_zombie_wolf",this.setZombie(),this.clone("demon","_mob"),this.t.nameLocale="Demon",this.t.nameTemplate="demon_name",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.defaultWeapons=["flame_sword"],this.t.use_items=!0,this.t.race="demon",this.t.kingdom="demons",this.t.baseStats.health=666,this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=10,this.t.baseStats.damage=10,this.t.baseStats.knockback=1,this.t.baseStats.targets=0,this.t.damagedByOcean=!0,this.t.damagedByRain=!0,this.t.dieInLava=!1,this.t.icon="iconDemon",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="move_mob",this.t.texture_path="t_demon",this.t.texture_heads="t_demon_heads",this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("burning_feet"),this.addTrait("fire_blood"),this.addTrait("fire_proof"),this.addTrait("evil"),this.clone("fire_skull","_mob"),this.t.nameLocale="Fire Skull",this.t.nameTemplate="fire_skull_name",this.t.canTurnIntoMush=!1,this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.have_skin=!1,this.t.race="demon",this.t.kingdom="demons",this.t.baseStats.health=200,this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=8,this.t.icon="iconFireSkull",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.job="move_mob",this.t.texture_path="t_fire_skull",this.t.disableJumpAnimation=!0,this.t.animation_idle="walk_0,walk_1,walk_2,walk_3",this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.maxRandomAmount=4,this.addTrait("immortal"),this.addTrait("evil"),this.addTrait("weightless"),this.addTrait("fire_blood"),this.addTrait("fire_proof"),this.clone("acid_blob","_mob"),this.t.nameLocale="Acid Blob",this.t.nameTemplate="acid_blob_name",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.have_skin=!1,this.t.canTurnIntoMush=!1,this.t.race="acids",this.t.kingdom="acids",this.t.baseStats.health=200,this.t.baseStats.speed=10,this.t.baseStats.crit=20,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=15,this.t.icon="iconAcidBlob",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#008800"),this.t.job="move_mob",this.t.texture_path="t_acid_blob",this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.maxRandomAmount=2,this.addTrait("acid_blood"),this.addTrait("acid_proof"),this.addTrait("acid_touch"),this.addTrait("fat"),this.clone("zombie","_mob"),this.t.nameLocale="Zombie",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.baseStats.health=150,this.t.baseStats.speed=10,this.t.baseStats.attackSpeed=110,this.t.baseStats.damage=24,this.t.baseStats.dodge=0,this.t.baseStats.knockback=1,this.t.icon="iconZombie",this.t.needFood=!1,this.t.use_items=!0,this.t.color=f.Toolbox.makeColor("#24803E"),this.t.job="move_mob",this.t.texture_path="t_zombie_human",this.t.texture_heads="t_zombie_human_heads",this.t.canAttackBuildings=!1,this.t.canAttackBrains=!0,this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.setZombie(),this.clone("zombie_orc","zombie"),this.t.texture_path="t_zombie_orc",this.t.texture_heads="t_zombie_orc_heads",this.addTrait("regeneration"),this.addTrait("savage"),this.clone("zombie_dwarf","zombie"),this.t.texture_path="t_zombie_dwarf",this.t.texture_heads="t_zombie_dwarf_heads",this.addTrait("miner"),this.clone("zombie_elf","zombie"),this.t.texture_path="t_zombie_elf",this.t.texture_heads="t_zombie_elf_heads",this.addTrait("weightless"),this.clone("necromancer","_mob"),this.t.nameLocale="Necromancer",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!0,this.t.race="necromancer",this.t.kingdom="undead",this.t.baseStats.health=350,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=0,this.t.baseStats.damage=1,this.t.baseStats.knockback=1,this.t.baseStats.targets=1,this.t.dieInLava=!0,this.t.icon="iconNecromancer",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="necromancer",this.t.attack_spells=["curse","spawnSkeleton","bloodRain","bloodRain"],this.t.effect_cast_top="fx_cast_top_green",this.t.effect_cast_ground="fx_cast_ground_green",this.t.texture_path="t_necromancer",this.t.use_items=!0,this.t.defaultWeapons=["necromancer_staff"],this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.action_death.clear(),this.t.action_death.add(d.default.mageDeath),this.t.have_soul=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("evil"),this.clone("druid","_mob"),this.t.nameLocale="Druid",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.race="good",this.t.kingdom="druid",this.t.baseStats.health=500,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=0,this.t.baseStats.damage=1,this.t.baseStats.knockback=1,this.t.baseStats.targets=1,this.t.dieInLava=!0,this.t.icon="iconDruid",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#4CDB75"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie";this.t.skeletonID="skeleton_cursed",this.t.job="druid",this.t.attack_spells=["bloodRain"],this.t.effect_cast_top="fx_cast_top_blue",this.t.effect_cast_ground="fx_cast_ground_blue",this.t.texture_path="t_druid",this.t.texture_heads="t_druid_heads",this.t.use_items=!0,this.t.defaultWeapons=["druid_staff"],this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.action_death.clear(),this.t.action_death.add(d.default.mageDeath),this.t.action_death.add(d.default.tryToCreatePlants),this.t.action_death.add(d.default.tryToGrowTree),this.t.have_soul=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("flower_prints"),this.clone("plagueDoctor","_mob"),this.t.nameLocale="Plague Doctor",this.t.immune_to_tumor=!0,this.t.body_separate_part_hands=!0,this.t.race="good",this.t.kingdom="good",this.t.maxAge=100,this.t.baseStats.health=500,this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=0,this.t.baseStats.damage=1,this.t.baseStats.knockback=1,this.t.baseStats.targets=1,this.t.dieInLava=!0,this.t.icon="iconPlagueDoctor",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="plague_doctor",this.t.attack_spells=["bloodRain"],this.t.effect_cast_top="fx_cast_top_blue",this.t.effect_cast_ground="fx_cast_ground_blue",this.t.texture_path="t_plaguedoctor",this.t.use_items=!0,this.t.defaultWeapons=["plague_doctor_staff"],this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.action_death.clear(),this.t.action_death.add(d.default.mageDeath),this.t.have_soul=!0,this.addTrait("regeneration"),this.addTrait("immune"),this.addTrait("fire_proof"),this.clone("whiteMage","_mob"),this.t.nameLocale="White Mage",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!0,this.t.race="good",this.t.kingdom="good",this.t.baseStats.health=300,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=0,this.t.baseStats.damage=1,this.t.baseStats.knockback=1,this.t.baseStats.targets=1,this.t.dieInLava=!0,this.t.icon="iconWhiteMage",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="white_mage",this.t.attack_spells=["teleportRandom","bloodRain","shield"],this.t.texture_path="t_whitemage",this.t.effect_teleport="fx_teleport_blue",this.t.effect_cast_top="fx_cast_top_blue",this.t.effect_cast_ground="fx_cast_ground_blue",this.t.use_items=!0,this.t.defaultWeapons=["white_staff"],this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.action_death.clear(),this.t.action_death.add(d.default.mageDeath),this.t.have_soul=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("freeze_proof"),this.clone("evilMage","_mob"),this.t.nameLocale="Evil Mage",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!0,this.t.race="evilMage",this.t.nameTemplate="evil_mage_name",this.t.kingdom="evil",this.t.baseStats.health=500,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=0,this.t.baseStats.damage=1,this.t.baseStats.knockback=1,this.t.baseStats.targets=1,this.t.dieInLava=!0,this.t.icon="iconEvilMage",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#EE3A42"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="evil_mage",this.t.effect_teleport="fx_teleport_red",this.t.effect_cast_top="fx_cast_top_red",this.t.effect_cast_ground="fx_cast_ground_red",this.t.attack_spells=["teleportRandom","lightning","tornado","bloodRain","bloodRain","fire"],this.t.texture_path="t_evilmage",this.t.use_items=!0,this.t.defaultWeapons=["evil_staff"],this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.action_death.clear(),this.t.action_death.add(d.default.mageDeath),this.t.have_soul=!0,this.addTrait("evil"),this.addTrait("fire_proof"),this.addTrait("immortal"),this.addTrait("regeneration"),this.clone("skeleton","_mob"),this.t.nameLocale="Skeleton",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.nameTemplate="skeleton_name",this.t.have_skin=!1,this.t.race="undead",this.t.kingdom="undead",this.t.baseStats.health=60,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=10,this.t.icon="iconSkeleton",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="skeleton_job",this.t.texture_path="t_skeleton",this.t.texture_heads="t_skeleton_heads",this.t.defaultWeapons=["spear","sword","bow"],this.t.defaultWeaponsMaterial=["bronze","steel","iron"],this.t.use_items=!0,this.t.take_items=!0,this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.canTurnIntoMush=!1,this.t.canTurnIntoTumorMonster=!1,this.addTrait("immortal"),this.addTrait("weightless"),this.clone("wraith","_mob"),this.t.nameLocale="Wraith",this.t.nameTemplate="wraith_name",this.t.canTurnIntoMush=!1,this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.have_skin=!1,this.t.race="undead",this.t.kingdom="undead",this.t.baseStats.health=100,this.t.baseStats.speed=8,this.t.baseStats.armor=39,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=10,this.t.icon="iconWraith",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="move_mob",this.t.texture_path="t_wraith",this.t.defaultWeapons=["spear","sword","bow"],this.t.defaultWeaponsMaterial=["bronze","steel","iron"],this.t.use_items=!0,this.t.take_items=!0,this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.maxRandomAmount=4,this.addTrait("immortal"),this.addTrait("weightless"),this.addTrait("immune"),this.addTrait("fire_proof"),this.addTrait("freeze_proof"),this.addTrait("regeneration"),this.clone("ghost","_mob"),this.t.nameLocale="Ghost",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.have_skin=!1,this.t.canTurnIntoZombie=!1,this.t.race="undead",this.t.kingdom="undead",this.t.baseStats.health=333,this.t.baseStats.speed=10,this.t.baseStats.armor=77,this.t.baseStats.attackSpeed=13,this.t.baseStats.damage=13,this.t.icon="iconGhost",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="skeleton_job",this.t.texture_path="t_ghost",this.t.disableJumpAnimation=!0,this.t.animation_idle="walk_0,walk_1,walk_2,walk_3",this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.maxRandomAmount=1,this.t.canTurnIntoMush=!1,this.t.mushID="",this.t.canTurnIntoTumorMonster=!1,this.t.tumorMonsterID="",this.t.have_skin=!1,this.t.immune_to_injuries=!0,this.t.dieOnBlocks=!1,this.addTrait("immortal"),this.addTrait("weightless"),this.addTrait("cursed"),this.addTrait("fire_proof"),this.addTrait("freeze_proof"),this.clone("pirates","skeleton"),this.t.nameLocale="Pirates",this.t.baseStats.health=100,this.t.baseStats.speed=8,this.t.baseStats.armor=39,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=10,this.t.icon="iconPirates",this.t.needFood=!1,this.t.landCreature=!0,this.t.oceanCreature=!0,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="skeleton_job",this.t.texture_path="t_pirates",this.t.texture_heads="t_pirates_heads",this.addTrait("immortal"),this.clone("mermen","_mob"),this.t.nameLocale="Mermen",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.baseStats.health=120,this.t.baseStats.speed=40,this.t.baseStats.armor=39,this.t.baseStats.attackSpeed=60,this.t.baseStats.damage=15,this.t.icon="iconMermen",this.t.race="mermen",this.t.kingdom="mad",this.t.use_items=!0,this.t.needFood=!1,this.t.landCreature=!0,this.t.oceanCreature=!0,this.t.swampCreature=!0,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="skeleton_job",this.t.texture_path="t_mermen",this.t.defaultWeapons=["spear"],this.t.defaultWeaponsMaterial=["wood","stone"],this.addTrait("poison_immune"),this.clone("goblin","_mob"),this.t.nameLocale="Goblin",this.t.body_separate_part_head=!1,this.t.body_separate_part_hands=!1,this.t.baseStats.health=100,this.t.baseStats.speed=65,this.t.baseStats.armor=39,this.t.baseStats.attackSpeed=60,this.t.baseStats.damage=15,this.t.icon="iconGoblin",this.t.race="goblin",this.t.kingdom="mad",this.t.use_items=!0,this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#ffffff"),this.t.job="skeleton_job",this.t.texture_path="t_goblin",this.t.defaultWeapons=["hammer"],this.t.defaultWeaponsMaterial=["wood","stone"],this.addTrait("deceitful"),this.clone("skeleton_cursed","skeleton"),this.t.defaultWeapons=[],this.t.defaultWeaponsMaterial=[],this.clone("mush_unit","_mob"),this.t.nameLocale="Mush",this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.race="mush",this.t.kingdom="mush",this.t.baseStats.health=300,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=30,this.t.icon="iconMush",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#FF49CB"),this.t.job="mush",this.t.texture_path="t_mush_unit",this.t.texture_heads="t_mush_unit_heads",this.t.use_items=!0,this.t.take_items=!0,this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.canTurnIntoZombie=!1,this.t.canTurnIntoMush=!1,this.t.canTurnIntoTumorMonster=!1,this.addTrait("immortal"),this.addTrait("weightless"),this.addTrait("mushSpores"),this.addTrait("regeneration"),this.clone("mush_animal","mush_unit"),this.t.baseStats.health=150,this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=20,this.t.baseStats.damage=20,this.t.texture_path="t_mush_animal",this.t.body_separate_part_hands=!1,this.t.body_separate_part_head=!1,this.t.use_items=!1,this.t.take_items=!1,this.clone("tumor_monster_unit","_mob"),this.t.nameLocale="Tumor",this.t.immune_to_tumor=!0,this.t.canTurnIntoTumorMonster=!1,this.t.body_separate_part_head=!0,this.t.body_separate_part_hands=!0,this.t.race="tumor",this.t.kingdom="tumor",this.t.baseStats.health=60,this.t.baseStats.speed=30,this.t.baseStats.attackSpeed=40,this.t.baseStats.damage=10,this.t.icon="iconTumor",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#FF49CB"),this.t.job="tumor_monster",this.t.texture_path="t_tumor_monster_unit",this.t.texture_heads="t_tumor_monster_unit_heads",this.t.use_items=!0,this.t.take_items=!0,this.t.disableJumpAnimation=!0,this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.addTrait("immortal"),this.addTrait("weightless"),this.addTrait("ugly"),this.clone("tumor_monster_animal","tumor_monster_unit"),this.t.texture_path="t_tumor_monster_animal",this.t.body_separate_part_hands=!1,this.t.body_separate_part_head=!1,this.t.use_items=!1,this.t.take_items=!1,this.clone("lil_pumpkin","tumor_monster_animal"),this.t.texture_path="t_lil_pumpkin",this.t.nameTemplate="lil_pumpkin_name",this.t.race="super_pumpkins",this.t.kingdom="super_pumpkins",this.t.immune_to_slowness=!0,this.t.clearTraits(),this.addTrait("attractive"),this.addTrait("fat"),this.addTrait("bloodlust"),this.clone("assimilator","tumor_monster_animal"),this.t.texture_path="t_assimilator",this.t.nameTemplate="assimilator_name",this.t.canTurnIntoMush=!1,this.t.race="assimilators",this.t.kingdom="assimilators",this.t.baseStats.damage=0,this.t.baseStats.attackSpeed=0,this.addTrait("fire_proof"),this.removeTrait("ugly"),this.removeTrait("weightless"),this.t.damagedByOcean=!0,this.t.damagedByRain=!0,this.t.defaultAttack="shotgun",this.clone("bioblob","tumor_monster_animal"),this.t.texture_path="t_bioblob",this.t.nameTemplate="bioblob_name",this.t.race="biomass",this.t.kingdom="biomass",this.t.immune_to_slowness=!0,this.addTrait("strong_minded"),this.addTrait("ugly"),this.clone("walker","_mob"),this.t.nameLocale="Cold Ones",this.t.nameTemplate="cold_one_name",this.t.body_separate_part_head=!0,this.t.race="walker",this.t.kingdom="walkers",this.t.baseStats.speed=20,this.t.baseStats.attackSpeed=160,this.t.baseStats.damage=40,this.t.baseStats.knockback=1,this.t.baseStats.targets=2,this.t.icon="iconWalker",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#90D2D4"),this.t.canTurnIntoZombie=!0,this.t.zombieID="zombie",this.t.skeletonID="skeleton_cursed",this.t.job="move_mob",this.t.texture_path="t_walker",this.t.texture_heads="t_walker_heads",this.t.animation_walk="walk_0,walk_1,walk_2,walk_3",this.t.animation_swim="swim_0,swim_1,swim_2,swim_3",this.t.disableJumpAnimation=!0,this.t.have_soul=!0,this.addTrait("immortal"),this.addTrait("regeneration"),this.addTrait("cold_aura"),this.addTrait("weightless"),this.addTrait("freeze_proof"),this.clone("livingPlants","_mob"),this.t.nameLocale="Living Plants",this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_6",this.t.nameTemplate="living_plant_name",this.t.race="livingPlants",this.t.kingdom="living_plants",this.t.baseStats.health=300,this.t.baseStats.speed=10,this.t.baseStats.armor=0,this.t.baseStats.attackSpeed=70,this.t.baseStats.damage=30,this.t.baseStats.knockback=1.2,this.t.baseStats.knockbackReduction=80,this.t.baseStats.targets=3,this.t.damagedByOcean=!0,this.t.icon="iconLivingPlants",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#115D11"),this.t.rotatingAnimation=!0,this.t.disableJumpAnimation=!1,this.t.specialAnimation=!0,this.t.inspectAvatarScale=1,this.t.baseStats.scale=.25,this.t.canTurnIntoMush=!1,this.t.canTurnIntoTumorMonster=!1,this.addTrait("immortal"),this.addTrait("regeneration"),this.clone("livingHouse","_mob"),this.t.nameLocale="Living Houses",this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_6",this.t.nameTemplate="homie_name",this.t.race="livingHouse",this.t.kingdom="living_houses",this.t.baseStats.health=500,this.t.baseStats.armor=1,this.t.baseStats.speed=10,this.t.baseStats.attackSpeed=60,this.t.baseStats.damage=50,this.t.baseStats.knockback=1.4,this.t.baseStats.knockbackReduction=80,this.t.baseStats.targets=3,this.t.damagedByOcean=!0,this.t.icon="iconLivingHouse",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#24803E"),this.t.rotatingAnimation=!0,this.t.disableJumpAnimation=!1,this.t.specialAnimation=!0,this.t.inspectAvatarScale=1,this.t.baseStats.scale=.25,this.t.canTurnIntoMush=!1,this.t.canTurnIntoTumorMonster=!1,this.addTrait("immortal"),this.clone("greg","_mob"),this.t.nameLocale="Greg",this.t.actorSize=u.ActorSize.S15_Bear,this.t.shadowTexture="unitShadow_6",this.t.texture_path="t_greg",this.t.animation_walk="walk_0",this.t.animation_swim="walk_0",this.t.race="greg",this.t.kingdom="greg",this.t.baseStats.health=1e3,this.t.baseStats.armor=1,this.t.baseStats.speed=5,this.t.baseStats.attackSpeed=60,this.t.baseStats.damage=20,this.t.baseStats.knockback=1.4,this.t.baseStats.knockbackReduction=80,this.t.baseStats.targets=3,this.t.damagedByOcean=!0,this.t.icon="iconGreg",this.t.needFood=!1,this.t.color=f.Toolbox.makeColor("#24803E"),this.t.rotatingAnimation=!0,this.t.nameTemplate="greg_name",this.t.have_soul=!0,this.addTrait("immortal");var w=new h.default;w.id="_boat",w.race="boat",w.canBeKilledByStuff=!0,w.canBeKilledByLifeEraser=!0,w.canAttackBuildings=!0,w.canBeMovedByPowers=!0,w.canBeHurtByPowers=!0,w.updateZ=!0,w.effectDamage=!0,w.dieOnGround=!0,w.oceanCreature=!0,w.shadow=!1,w.isBoat=!0,w.kingdom="neutral_animals",w.skipFightLogic=!0,w.canBeInspected=!0,w.hideOnMinimap=!0,w.inspect_stats=!1,w.inspect_children=!1,w.inspect_experience=!1,w.inspect_kills=!1,w.inspect_home=!0,w.specialAnimation=!0,w.immune_to_injuries=!0,w.prefab="p_boat",w.sprite_group_renderer=!0,this.add(w),this.t.texture_atlas=_.UnitTextureAtlasID.Boats,this.t.nameLocale="Boats",this.t.inspectAvatarScale=1,this.t.color=f.Toolbox.makeColor("#000000"),this.t.baseStats.scale=.25,this.t.baseStats.knockbackReduction=100,this.addTrait("boat"),this.clone("boat_trading","_boat"),this.t.baseStats.health=1e3,this.t.baseStats.armor=50,this.t.baseStats.speed=140,this.t.drawBoatMark=!0,this.t.job="boat_trading",this.t.tech="boats_trading",this.t.cost=new p.ConstructionCost(10,0,0,10),this.clone("boat_transport","_boat"),this.t.baseStats.speed=120,this.t.baseStats.health=1500,this.t.baseStats.armor=60,this.t.drawBoatMark=!0,this.t.job="boat_transport",this.t.tech="boats_transport",this.t.cost=new p.ConstructionCost(5,0,2,20),this.clone("boat_fishing","_boat"),this.t.baseStats.speed=60,this.t.baseStats.health=500,this.t.baseStats.armor=50,this.t.job="boat_fishing",this.t.cost=new p.ConstructionCost(5,0,0,5),this.spawnInRuins.push("rat");for(var T=0;T<this.list.length;T++){var k=this.t=this.list[T];k.shadow&&this.loadShadow(k),!k.id.includes("_")&&k.actorSize<=u.ActorSize.S3_Crab&&this.addTrait("weightless")}},e.prototype.addColorSet=function(t,e,i){this.t.useSkinColors=!0,this.t.color_sets||(this.t.color_sets=[]);var o=new h.ColorSet;o.id=t,this.t.color_sets.push(o);for(var a=f.Toolbox.makeColor(e),n=f.Toolbox.makeColor(i),r=0;r<5;r++){var s=1-.25*r;s>1&&(s=1);var l=f.Toolbox.blendColor(a,n,s);o.colors.push(l)}},e.prototype.setZombie=function(){this.t.nameLocale="Zombie",this.t.canAttackBrains=!0,this.t.race="zombie",this.t.kingdom="zombie",this.t.take_items=!1,this.t.take_items_ignore_range_weapons=!0,this.addTrait("zombie"),this.addTrait("immortal"),this.addTrait("stupid"),this.removeTrait("fast"),this.removeTrait("agile"),this.removeTrait("genius"),this.t.canTurnIntoZombie=!1,this.t.needFood=!1,this.t.zombieID="",this.t.job="move_mob",this.t.canTurnIntoMush=!1},e.prototype.addFlag=function(t){this.t.flags.push(t)},e.prototype.clear=function(){for(var t=0;t<this.list.length;t++)this.list[t].currentAmount=0},e.prototype.addTrait=function(t){this.t.traits.includes(t)||this.t.traits.push(t)},e.prototype.removeTrait=function(t){this.t.traits.remove(t)},e.prototype.loadShadow=function(t){if(!e.shadowSprites.has(t.shadowTexture)){var i=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.WORLDATLAS,"shadows/"+t.shadowTexture);i||s.default.e("Shadow not found "+t.shadowTexture+" for "+t.id),e.shadowSprites.set(t.shadowTexture,i)}t.shadow_sprite=e.shadowSprites.get(t.shadowTexture)},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=l.default.fromJson(i,new h.default);return o.action_death=c.default.create(),o.id=t,this.add(o),o},e.shadowSprites=new Map,e}(a("AssetLibrary").default);n.default=m,cc._RF.pop()},{}],ActorStats:[function(t,e,i){"use strict";cc._RF.push(e,"9dfb0iLOPpIdb23SUFrmqZ6","ActorStats");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ColorSet=void 0;var s=a("WorldAction"),l=a("AssetLibrary"),c=a("BaseStats"),d=a("ActorAsset");n.ColorSet=function(){this.colors=[]};var u=function(t){function e(){var e=t.call(this)||this;return e.race="animal",e.nameLocale="",e.kingdom="",e.actorSize=d.ActorSize.S12_Human,e.animation_walk="",e.animation_walk_speed=.1,e.animation_swim="",e.animation_swim_speed=.1,e.animation_idle_speed=.1,e.animation_idle="walk_0",e.texture_heads="",e.baseStats=new c.default,e.tech="",e.defaultAttack="base",e.immune_to_tumor=!1,e.immune_to_slowness=!1,e.aggression=0,e.shadow=!0,e.shadowTexture="unitShadow_5",e.shadow_sprite=null,e.hit_fx_alternative_offset=!0,e.canLevelUp=!0,e.nameTemplate="default_name",e.playRandomSound=!1,e.playRandomSound_id="-",e.maxAge=0,e.timeToGrow=0,e.use_items=!1,e.take_items=!1,e.take_items_ignore_range_weapons=!1,e.useSkinColors=!1,e.color_sets=[],e.canBeKilledByStuff=!1,e.canBeKilledByLifeEraser=!1,e.ignoreTileSpeedMod=!1,e.skipFightLogic=!1,e.canAttackBuildings=!1,e.canAttackBrains=!1,e.ignoreJobs=!1,e.countAsUnit=!0,e.egg=!1,e.flag_tornado=!1,e.flag_ufo=!1,e.flag_finger=!1,e.animal=!1,e.unit=!1,e.baby=!1,e.texture_path="",e.body_separate_part_head=!1,e.body_separate_part_hands=!1,e.hovering_min=.5,e.hovering_max=1.2,e.hovering=!1,e.flying=!1,e.very_high_flyer=!1,e.disableJumpAnimation=!1,e.rotatingAnimation=!1,e.dieOnBlocks=!0,e.moveFromBlock=!0,e.dieOnGround=!1,e.damagedByOcean=!1,e.damagedByRain=!1,e.oceanCreature=!1,e.landCreature=!1,e.swampCreature=!1,e.isBoat=!1,e.drawBoatMark=!1,e.swimToIsland=!1,e.speedModLiquid=1,e.procreate=!1,e.procreate_age=3,e.animal_baby_making_around_limit=6,e.layEggs=!1,e.eggStatsID="",e.prefab="",e.dieInLava=!0,e.canBeMovedByPowers=!1,e.canBeHurtByPowers=!1,e.canTurnIntoZombie=!1,e.canTurnIntoMush=!1,e.canTurnIntoTumorMonster=!1,e.have_soul=!1,e.canReceiveTraits=!0,e.zombieID="",e.skeletonID="",e.mushID="",e.tumorMonsterID="",e.showIconInspectWindow=!1,e.showIconInspectWindow_id="",e.hideFavoriteIcon=!1,e.canBeInspected=!1,e.inspectAvatarScale=2.5,e.maxHunger=100,e.needFood=!1,e.diet_berries=!1,e.diet_crops=!1,e.diet_flowers=!1,e.diet_grass=!1,e.diet_meat=!1,e.diet_meat_insect=!1,e.diet_meat_same_race=!1,e.source_meat=!1,e.source_meat_insect=!1,e.defaultZ=0,e.updateZ=!1,e.hideOnMinimap=!1,e.inspect_stats=!0,e.inspect_children=!0,e.inspect_kills=!0,e.inspect_experience=!0,e.inspect_home=!1,e.immune_to_injuries=!1,e.sprite_group_renderer=!1,e.immune_to_injures=!1,e.job="",e.effect_cast_top="",e.effect_cast_ground="",e.effect_teleport="",e.attack_spells=[],e.heads=7,e.effectDamage=!1,e.specialAnimation=!1,e.flipAnimation=!1,e.specialDeadAnimation=!1,e.deathAnimationAngle=!1,e.canHaveStatusEffect=!1,e.haveSpriteRenderer=!0,e.dieByLightning=!1,e.have_skin=!0,e.growIntoID="",e.icon="iconQuestionMark",e.skipSave=!1,e.color=cc.Color.TRANSPARENT,e.cost=null,e.traits=[],e.defaultWeapons=[],e.defaultWeaponsMaterial=[],e.flags=[],e.flags_dict=null,e.disablePunchAttackAnimation=!1,e.maxRandomAmount=3,e.currentAmount=0,e.action_death=s.default.create(),e.baseStats.damage=10,e.baseStats.health=100,e.baseStats.armor=0,e.baseStats.speed=40,e.baseStats.dodge=0,e.baseStats.accuracy=90,e.baseStats.attackSpeed=1,e.baseStats.diplomacy=0,e.baseStats.knockback=1,e.baseStats.knockbackReduction=0,e.baseStats.targets=1,e.baseStats.areaOfEffect=1,e.baseStats.size=.5,e.baseStats.range=1,e.baseStats.damageCritMod=2,e.baseStats.scale=.06,e.baseStats.mod_supply_timer=1,e}return r(e,t),e.prototype.clearFlags=function(){this.flags=[],this.flags_dict=null},e.prototype.clearTraits=function(){this.traits=[]},e.prototype.haveFlag=function(t){var e=this;return null==this.flags_dict&&(this.flags_dict=new Map,this.flags.forEach(function(t){e.flags_dict.set(t,!0)})),this.flags_dict.has(t)},e.prototype.setBaseStats=function(t,e,i,o,a,n,r){void 0===r&&(r=0),this.baseStats.health=t,this.baseStats.damage=e,this.baseStats.speed=i,this.baseStats.armor=o,this.baseStats.dodge=a,this.baseStats.accuracy=n,this.baseStats.diplomacy=r},e}(l.Asset);n.default=u,cc._RF.pop()},{}],ActorStatus:[function(t,e,i){"use strict";cc._RF.push(e,"60b77tTI5xDy4LQ6EXF4hCc","ActorStatus");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.ActorData=void 0;var l=a("AssetManager"),c=a("BaseObjectData"),d=a("ToolBox"),u=a("MapBox"),h=a("ActorAsset"),p=a("ActorBag");n.ActorData=function(){this.items=[],this.inventory=new p.default,this.status=new f,this.cityID="",this.x=0,this.y=0};var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actorID="",e.firstName="firstName",e.favoriteFood="",e.mood="",e.transportID="",e.gender=null,e.head=-1,e.skin=-1,e.skin_set=-1,e.culture="",e.homeBuildingID="",e.statsID="?",e.profession=h.UnitProfession.Null,e.kills=0,e.age=1,e.bornTime=0,e.children=0,e.hunger=0,e.level=1,e.experience=0,e.diplomacy=0,e.intelligence=0,e.stewardship=0,e.warfare=0,e.special_graphics="",e.favorite=!1,e.traits=[],e.familyID="\u7532",e.familyName="\u7532",e}return r(e,t),e.prototype.generateTraits=function(t,e){if(t.traits)for(var i=0;i<t.traits.length;i++){var o=t.traits[i];this.addTrait(o)}e.civilization&&this.generateCivUnitTraits()},e.prototype.addTrait=function(t){this.traits.includes(t)||this.traits.push(t)},e.prototype.inheritTraits=function(t){for(var e=0;e<t.length;e++){var i=t[e],o=l.default.traits.get(i);if(o&&0!=o.inherit){var a=d.Toolbox.randomFloat(0,100);o.inherit<a||this.traits.includes(o.id)||this.haveOppositeTrait(o)||this.addTrait(o.id)}}},e.prototype.generateCivUnitTraits=function(){for(var t=0;t<l.default.traits.list.length;t++){var e=l.default.traits.list[t];if(0!=e.birth){var i=d.Toolbox.randomFloat(0,100);e.birth<i||this.traits.includes(e.id)||this.haveOppositeTrait(e)||this.addTrait(e.id)}}},e.prototype.haveOppositeTrait=function(t){var e,i;if(!t||!t.oppositeArr)return!1;var o=t.oppositeArr;try{for(var a=s(o),n=a.next();!n.done;n=a.next()){var r=n.value;if(this.traits.includes(r))return!0}}catch(d){e={error:d}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return!1},e.prototype.updateAge=function(t){this.age++;var e=l.default.unitStats.get(this.statsID);if(this.updateAttributes(e,t),!u.default.inst.worldLaws.world_law_old_age.boolVal)return!0;var i=e.maxAge,o=u.default.inst.cultures.get(this.culture);return o&&(i+=o.getMaxAgeBonus()),0==i||i>this.age||!d.Toolbox.randomChance(.15)},e.prototype.updateAttributes=function(t,e,i){if(void 0===i&&(i=!1),t.unit&&(this.age%3==0&&this.age<=100||i))switch(e.preferred_attribute.getRandom()){case"intelligence":this.intelligence++;break;case"warfare":this.warfare++;break;case"stewardship":this.stewardship++}},e}(c.default);n.default=f,cc._RF.pop()},{}],ActorTool:[function(t,e,i){"use strict";cc._RF.push(e,"7bd85QGmbhEGJ4gK93fgQrh","ActorTool");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.ActorTileTarget=void 0;var r,s=o("AssetManager"),l=o("BaseBuilding"),c=o("Docks"),d=o("FamilysManager"),u=o("ToolBox"),h=o("MapLayer"),p=o("MapBox");(function(t){t[t.RandomTNT=0]="RandomTNT",t[t.RandomBurnableTile=1]="RandomBurnableTile",t[t.RandomTileWithUnits=2]="RandomTileWithUnits",t[t.RandomTileWithCivStructures=3]="RandomTileWithCivStructures"})(r=a.ActorTileTarget||(a.ActorTileTarget={}));var f=function(){function t(){}return t.countRatsNearby=function(t){p.default.inst.getObjectsInChunks(t.currentTile,10,h.MapObjectType.Actor);var e=0;return p.default.inst.temp_map_objects.forEach(function(t){t.haveTrait("rat")&&e++}),e},t.findNewBuildingTarget=function(e,i){var o,a,r,s,l,c,d,u,h,p,f,_;if(!e.city)return null;switch(t.possible_buildings=[],e.city.zones.shuffle(),i){case"new_building":var m=e.city.getBuildingToBuild();if(m&&m.tiles.length>0){var g=m.getConstructionTile();g&&g.isSameIsland(e.currentTile)&&t.possible_buildings.push(m)}break;case"random_house_building":var y=e.city.buildings.getSimpleList();y.shuffle();try{for(var v=n(y),b=v.next();!b.done;b=v.next()){var w=b.value;if((null===(d=w.currentTile)||void 0===d?void 0:d.isSameIsland(e.currentTile))&&!(null===(u=w.data)||void 0===u?void 0:u.underConstruction)&&(null===(h=w.data)||void 0===h?void 0:h.alive)&&!(null===(p=w.stats)||void 0===p?void 0:p.isRuin)&&0!=(null===(f=w.stats)||void 0===f?void 0:f.housing)){t.possible_buildings.push(w);break}}}catch(R){o={error:R}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}break;case"ruins":for(var T=0;T<e.city.zones.length;T++){var k=e.city.zones[T];try{for(var B=(r=void 0,n(k.ruins)),S=B.next();!S.done;S=B.next()){var C=S.value;t.possible_buildings.push(C)}}catch(F){r={error:F}}finally{try{S&&!S.done&&(s=B.return)&&s.call(B)}finally{if(r)throw r.error}}try{for(var x=(l=void 0,n(k.abandoned)),A=x.next();!A.done;A=x.next()){var P=A.value;t.possible_buildings.push(P)}}catch(L){l={error:L}}finally{try{A&&!A.done&&(c=x.return)&&c.call(x)}finally{if(l)throw l.error}}}break;case"mine":if(e.city.haveBuildingType("mine")){var O=e.city.getBuildingType("mine");(null===(_=O.currentTile)||void 0===_?void 0:_.isSameIsland(e.currentTile))&&t.possible_buildings.push(O)}break;default:return t.findNewTargetInZones(e,i)}return 0==t.possible_buildings.length?null:t.possible_buildings.getRandom()},t.findNewTargetInZones=function(e,i){var o,a,r,s,c,d,h=null;t.possible_buildings=[];for(var p=0;p<e.city.zones.length;p++){var f=e.city.zones[p];switch(h=null,i){case"trees":h=f.trees;break;case"gold":h=f.gold;break;case"ore":h=f.ore;break;case"stone":h=f.stone;break;case"fruitBush":h=f.food}if(h&&0!=h.size){try{for(var _=(o=void 0,n(h)),m=_.next();!m.done;m=_.next()){var g=m.value;!(null===(r=g.currentTile)||void 0===r?void 0:r.targetedBy)&&(null===(s=g.currentTile)||void 0===s?void 0:s.isSameIsland(e.currentTile))&&((null===(c=g.stats)||void 0===c?void 0:c.buildingType)!=l.BuildingType.Fruits&&(null===(d=g.stats)||void 0===d?void 0:d.buildingType)!=l.BuildingType.Tree||g.haveResources)&&t.possible_buildings.push(g)}}catch(y){o={error:y}}finally{try{m&&!m.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}if(t.possible_buildings.length>0)break}}return 0==t.possible_buildings.length?null:u.Toolbox.getRandom(t.possible_buildings)},t.getTileNearby=function(e,i){t.temp_chunks=[i].concat(i.neighboursAll),t.possible_moves=[];for(var o=0;o<t.temp_chunks.length;o++){var a=t.temp_chunks[o];if(!(t.possible_moves.length>20))for(var n=0;n<a.tiles.length;n++){var s=a.tiles[n];if(!(t.possible_moves.length>20))switch(e){case r.RandomTNT:s.type.explodable&&t.possible_moves.push(s);break;case r.RandomTileWithUnits:s.units.length>0&&t.possible_moves.push(s);break;case r.RandomBurnableTile:(s.type.burnable||s.type.trees)&&t.possible_moves.push(s);break;case r.RandomTileWithCivStructures:s.building&&s.building.city&&t.possible_moves.push(s),s.type.burnable&&s.zone.city&&t.possible_moves.push(s)}}}return 0==t.possible_moves.length?null:t.possible_moves.getRandom()},t.getDockTradeTarget=function(t){var e,i,o=t.currentTile.region.island.docks;if(0==o.length)return null;o.shuffle();try{for(var a=n(o),r=a.next();!r.done;r=a.next()){var s=r.value;if(t.homeBuilding!=s.building&&(s.isDockGood()||s.checkOceanTiles())&&!s.building.isNonUsable()&&!s.building.city.kingdom.isEnemy(t.kingdom))return s}}catch(d){e={error:d}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return null},t.getRandomTileForBoat=function(t){var e=t.currentTile.region;return e.neighbours.length>0&&u.Toolbox.randomBool()&&(e=e.neighbours.getRandom()),e.tiles.length>0?e.tiles.getRandom():null},t.attributeDice=function(t,e){void 0===e&&(e=2);for(var i=0,o=t.curStats.diplomacy+t.curStats.warfare+t.curStats.stewardship,a=0;a<e;a++)i+=u.Toolbox.randomInt(0,o);return i},t.checkHomeDocks=function(t){var e,i,o,a,n,r;if(!t.homeBuilding||t.homeBuilding.isNonUsable())for(var s=t.currentTile.region.island.docks,l=0;l<s.length;l++){var d=s[l];if(!(null===(e=d.building)||void 0===e?void 0:e.isNonUsable())&&!(null===(o=null===(i=d.building)||void 0===i?void 0:i.city)||void 0===o?void 0:o.kingdom.isEnemy(t.kingdom))&&(null===(n=null===(a=d.building)||void 0===a?void 0:a.city)||void 0===n?void 0:n.kingdom)==t.kingdom)return void d.addBoatToDock(t)}t.homeBuilding&&!t.homeBuilding.isNonUsable()||t.setHomeBuilding(null),t.homeBuilding&&((null===(r=t.homeBuilding.currentTile)||void 0===r?void 0:r.isSameIsland(t.currentTile))?t.homeBuilding.getComponent(c.default).checkOceanTiles()||t.setHomeBuilding(null):(t.homeBuilding.getComponent(c.default).removeBoatFromDock(t),t.setHomeBuilding(null)))},t.copyUnitToOtherUnit=function(t,e){t.spriteRenderer.enabled=!1,e.currentPosition=t.currentPosition,e.node.position=t.node.position,e.curAngle=t.node.eulerAngles,e.node.eulerAngles=e.curAngle,e.data.firstName=t.data.firstName,e.data.age=t.data.age,e.data.kills=t.data.kills,e.data.children=t.data.children,e.data.favorite=t.data.favorite,e.takeItems(t,e.stats.take_items_ignore_range_weapons);for(var i=0;i<t.data.traits.length;i++){var o=t.data.traits[i];"peaceful"!=o&&e.addTrait(o)}e.setStatsDirty(),e._positionDirty=!0},t.canBeCuredFromTraits=function(t){for(var e=0;e<t.s_traits_ids.size;e++){var i=t.s_traits_ids[e],o=s.default.traits.get(i);if(o&&o.can_be_cured)return!0}return!1},t.getBabyColor=function(t,e){var i,o=t.data.skin,a=null!==(i=null==e?void 0:e.data.skin)&&void 0!==i?i:-1;return-1==a||o==a?o:1==Math.abs(o-a)?u.Toolbox.randomBool()?o:a:(o+a)/2},t.setSkinSet=function(e,i){if(i&&e.stats.useSkinColors&&0!=e.stats.color_sets.length){t._color_sets=[];for(var o=0,a=0;a<e.stats.color_sets.length;a++)e.stats.color_sets[a].id.includes(i)&&t._color_sets.push(o),o++;if(t._color_sets.length>0){var n=t._color_sets.getRandom();e.data.skin_set=n}}},t.getFamily=function(t){try{return d.default.familys.get(t.data.familyID)}catch(e){return console.log("\u5bb6\u65cfID:",t.data.familyID),d.default.familys.get("\u7532")}},t.possible_moves=[],t.temp_chunks=[],t.possible_buildings=[],t._color_sets=[],t}();a.default=f,cc._RF.pop()},{}],ActorTraitLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"5327freNtFBJ4fx4HY3JNZZ","ActorTraitLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ActorTrait=n.TraitType=n.TraitGroup=void 0;var s,l,c=a("WorldAction"),d=a("ActionLibrary"),u=a("BaseStats"),h=a("AssetLibrary"),p=a("AssetManager");(function(t){t[t.Personality=0]="Personality",t[t.Genetic=1]="Genetic",t[t.Other=2]="Other"})(s=n.TraitGroup||(n.TraitGroup={})),function(t){t[t.Positive=0]="Positive",t[t.Negative=1]="Negative",t[t.Other=2]="Other"}(l=n.TraitType||(n.TraitType={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon="",e.birth=0,e.inherit=0,e.opposite="",e.oppositeArr=[],e.transformationTrait=!1,e.baseStats=new u.default,e.sameTraitMod=0,e.oppositeTraitMod=0,e.group=s.Other,e.type=l.Other,e.action_death=c.default.create(),e.action_special_effect=c.default.create(),e.can_be_cured=!1,e}return r(e,t),e}(h.Asset);n.ActorTrait=f;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new f;e.id="boat",e.icon="iconBoat",e.opposite="plague,immortal,energized,wise",this.add(e);var i=new f;i.id="energized",i.icon="iconLightning",this.t.baseStats.speed=10,this.add(i);var o=new f;o.id="vermin",o.icon="iconVermin",this.add(o);var a=new f;a.id="ratKing",a.icon="iconRatKing",this.add(a);var n=new f;n.id="rat",n.icon="iconRat",this.add(n),this.t.action_special_effect.add(d.default.ratEffect);var r=new f;r.id="healing_aura",r.icon="iconHealingAura",this.add(r),this.t.action_special_effect.add(d.default.healingAuraEffect);var c=new f;c.id="savage",c.icon="iconSavage",c.group=s.Personality,c.type=l.Positive,c.sameTraitMod=5,c.birth=.5,this.add(c);var u=new f;u.id="miner",u.icon="iconMiner",u.group=s.Personality,u.type=l.Positive,u.birth=.5,this.add(u);var h=new f;h.id="veteran",h.icon="iconVeteran",h.group=s.Personality,h.type=l.Positive,h.sameTraitMod=5,this.add(h),this.t.baseStats.warfare=5,this.t.baseStats.damage=3,this.t.baseStats.armor=1,this.t.baseStats.dodge=2,this.t.baseStats.health=30;var p=new f;p.id="wise",p.icon="iconWise",p.group=s.Personality,p.type=l.Positive,p.opposite="stupid,boat",this.add(p),this.t.baseStats.diplomacy=1,this.t.baseStats.stewardship=1,this.t.baseStats.warfare=1,this.t.baseStats.intelligence=1;var _=new f;_.id="strong_minded",_.icon="iconStrongMinded",_.opposite="madness",_.group=s.Personality,_.type=l.Positive,this.add(_);var m=new f;m.id="peaceful",m.icon="iconPeaceful",m.group=s.Personality,m.type=l.Positive,this.add(m);var g=new f;g.id="zombie",g.icon="iconZombie",this.add(g),this.t.action_special_effect.add(d.default.zombieEffect);var y=new f;y.id="infected",y.icon="iconInfected",y.opposite="immune,boat",y.inherit=100,this.add(y),this.t.can_be_cured=!0,this.t.transformationTrait=!0,this.t.action_special_effect.add(d.default.infectedEffect),this.t.action_death.add(d.default.turnIntoZombie),this.t.baseStats.dodge=-5,this.t.baseStats.speed=4,this.t.baseStats.loyalty_traits=-15;var v=new f;v.id="mushSpores",v.icon="iconMushSpores",v.opposite="immune,boat",v.inherit=100,this.add(v),this.t.can_be_cured=!0,this.t.transformationTrait=!0,this.t.action_death.add(d.default.mushSporesEffect),this.t.action_death.add(d.default.turnIntoMush),this.t.baseStats.dodge=-5,this.t.baseStats.speed=4,this.t.baseStats.loyalty_traits=-15;var b=new f;b.id="tumorInfection",b.icon="iconTumorInfection",b.opposite="immune,boat",b.inherit=100,this.add(b),this.t.can_be_cured=!0,this.t.action_special_effect.add(d.default.tumorEffect),this.t.action_death.add(d.default.turnIntoTumorMonster),this.t.baseStats.dodge=-5,this.t.baseStats.speed=4,this.t.baseStats.loyalty_traits=-15;var w=new f;w.id="plague",w.icon="iconPlague",w.opposite="immune,immortal,rat,ratKing,boat",w.inherit=100,this.add(w),this.t.can_be_cured=!0,this.t.action_special_effect.add(d.default.plagueEffect),this.t.baseStats.speed=-10,this.t.baseStats.damage=-3,this.t.baseStats.dodge=-10,this.t.baseStats.armor=-1,this.t.baseStats.loyalty_traits=-15;var T=new f;T.id="blessed",T.icon="iconBlessing",T.opposite="evil",this.add(T),this.t.baseStats.mod_armor=10,this.t.baseStats.mod_damage=50,this.t.baseStats.mod_health=50,this.t.baseStats.mod_speed=50,this.t.baseStats.mod_diplomacy=20,this.t.baseStats.mod_crit=10;var k=new f;k.id="cursed",k.icon="iconCurse",k.opposite="evil,boat",this.add(k),this.t.can_be_cured=!0,this.t.transformationTrait=!0,this.t.action_death.add(d.default.turnIntoSkeleton),this.t.baseStats.loyalty_traits=-100,this.t.baseStats.mod_armor=-50,this.t.baseStats.mod_damage=-50,this.t.baseStats.mod_health=-50,this.t.baseStats.mod_speed=-20,this.t.baseStats.mod_diplomacy=-90,this.t.baseStats.mod_attackSpeed=-50;var B=new f;B.id="evil",B.icon="iconEvil",B.opposite="cursed,blessed",this.add(B);var S=new f;S.id="kingslayer",S.icon="iconKingslayer",this.add(S),this.t.baseStats.mod_supply_timer=2,this.t.baseStats.loyalty_traits=-25,this.t.baseStats.attackSpeed=5,this.t.baseStats.diplomacy=-5,this.t.baseStats.warfare=5;var C=new f;C.id="mageslayer",C.icon="iconMageslayer",this.add(C),this.t.baseStats.loyalty_traits=-10,this.t.baseStats.warfare=5,this.t.baseStats.crit=3,this.t.baseStats.dodge=2,this.t.baseStats.accuracy=3;var x=new f;x.id="dragonslayer",x.icon="iconDragonslayer",this.add(x),this.t.baseStats.warfare=6,this.t.baseStats.crit=4,this.t.baseStats.dodge=3,this.t.baseStats.accuracy=5,this.t.baseStats.mod_diplomacy=10;var A=new f;A.id="giant",A.icon="iconGiant",A.group=s.Personality,A.type=l.Positive,A.opposite="tiny",A.birth=.5,A.inherit=10,this.add(A),this.t.baseStats.scale=.05,this.t.baseStats.mod_health=50,this.t.baseStats.attackSpeed=-5;var P=new f;P.id="tiny",P.icon="iconTiny",P.group=s.Personality,P.type=l.Negative,P.opposite="giant",P.birth=.5,P.inherit=10,this.add(P),this.t.baseStats.diplomacy=-1,this.t.baseStats.scale=-.02,this.t.baseStats.mod_health=-50,this.t.baseStats.attackSpeed=10,this.t.baseStats.speed=5;var O=new f;O.id="madness",O.icon="iconMadness",O.opposite="strong_minded",this.add(O),this.t.baseStats.damage=1,this.t.baseStats.speed=5,this.t.baseStats.diplomacy=-100,this.t.baseStats.attackSpeed=10,this.t.baseStats.loyalty_traits=-100;var R=new f;R.id="immortal",R.icon="iconImmortal",R.birth=.1,R.sameTraitMod=-20,R.group=s.Genetic,R.type=l.Positive,R.opposite="boat",this.add(R),this.t.baseStats.health=10,this.t.baseStats.loyalty_traits=-20;var F=new f;F.id="crippled",F.icon="iconCrippled",F.sameTraitMod=10,F.type=l.Negative,this.add(F),this.t.baseStats.speed=-15,this.t.baseStats.diplomacy=-1,this.t.baseStats.attackSpeed=-15;var L=new f;L.id="golden_tooth",L.icon="iconGoldenTooth",L.sameTraitMod=5,L.type=l.Positive,this.add(L),this.t.baseStats.diplomacy=2;var D=new f;D.id="eyepatch",D.icon="iconEyePatch",D.sameTraitMod=20,D.type=l.Negative,this.add(D),this.t.baseStats.accuracy=-10,this.t.baseStats.diplomacy=1,this.t.baseStats.attackSpeed=-15,this.t.baseStats.crit=-15;var M=new f;M.id="skin_burns",M.icon="iconSkinBurns",M.sameTraitMod=40,M.type=l.Negative,this.add(M),this.t.baseStats.diplomacy=-1,this.t.baseStats.speed=-5,this.t.baseStats.attackSpeed=-5;var I=new f;I.id="tough",I.icon="iconTough",I.birth=1.5,I.group=s.Genetic,I.type=l.Positive,I.sameTraitMod=-5,this.add(I),this.t.baseStats.armor=2;var j=new f;j.id="strong",j.icon="iconStrong",j.birth=1.5,j.opposite="weak",j.oppositeTraitMod=-10,j.sameTraitMod=5,j.group=s.Genetic,j.type=l.Positive,this.add(j),this.t.baseStats.damage=3,this.t.baseStats.warfare=2;var E=new f;E.id="weak",E.icon="iconWeak",E.birth=1.5,E.opposite="strong",E.oppositeTraitMod=-10,E.group=s.Genetic,E.type=l.Negative,this.add(E),this.t.baseStats.damage=-1,this.t.baseStats.warfare=-2,this.t.baseStats.diplomacy=-2;var N=new f;N.id="stupid",N.icon="iconStupid",N.birth=1.5,N.opposite="genius,wise",N.sameTraitMod=30,N.group=s.Genetic,N.type=l.Negative,this.add(N),this.t.baseStats.intelligence=-5,this.t.baseStats.diplomacy=-2,this.t.baseStats.warfare=-2,this.t.baseStats.stewardship=-5,this.t.baseStats.loyalty_traits=-15,this.t.baseStats.personality_rationality=-.5;var z=new f;z.id="genius",z.icon="iconGenius",z.birth=.9,z.opposite="stupid",z.sameTraitMod=20,z.oppositeTraitMod=-20,z.group=s.Genetic,z.type=l.Positive,this.add(z),this.t.baseStats.intelligence=10,this.t.baseStats.diplomacy=5,this.t.baseStats.warfare=5,this.t.baseStats.stewardship=7,this.t.baseStats.loyalty_traits=-10;var G=new f;G.id="regeneration",G.icon="iconRegeneration",G.birth=.5,G.group=s.Genetic,G.type=l.Positive,this.add(G),this.t.action_special_effect.add(d.default.regenerationEffect);var U=new f;U.id="ugly",U.icon="iconUgly",U.birth=2,U.opposite="attractive",U.sameTraitMod=5,U.oppositeTraitMod=-15,U.group=s.Genetic,U.type=l.Negative,this.add(U);var W=new f;W.id="fat",W.icon="iconFat",W.birth=2,W.opposite="agile,weightless",W.oppositeTraitMod=-10,W.sameTraitMod=10,W.group=s.Genetic,W.type=l.Negative,this.add(W),this.t.baseStats.dodge=-10,this.t.baseStats.accuracy=-5,this.t.baseStats.attackSpeed=-10;var q=new f;q.id="attractive",q.icon="iconAttractive",q.birth=1.5,q.opposite="ugly",q.sameTraitMod=10,q.group=s.Genetic,q.type=l.Positive,this.add(q),this.t.baseStats.diplomacy=2,this.t.baseStats.stewardship=1,this.t.baseStats.crit=10;var H=new f;H.id="fast",H.icon="iconFast",H.birth=1,H.opposite="slow",H.group=s.Genetic,H.type=l.Positive,this.add(H),this.t.baseStats.speed=10,this.t.baseStats.attackSpeed=5;var V=new f;V.id="slow",V.icon="iconSlow",V.birth=2,V.opposite="fast,agile",V.group=s.Genetic,V.type=l.Negative,this.add(V),this.t.baseStats.speed=-10,this.t.baseStats.attackSpeed=-5;var Z=new f;Z.id="gluttonous",Z.icon="iconGluttonous",Z.birth=1,Z.inherit=50,Z.sameTraitMod=5,Z.group=s.Genetic,Z.type=l.Negative,this.add(Z);var K=new f;K.id="burning_feet",K.icon="iconBurningFeet",this.add(K),this.t.action_special_effect.add(d.default.burningFeetEffect);var J=new f;J.id="flower_prints",J.icon="iconFlowerPrints",this.add(J),this.t.action_special_effect.add(d.default.flowerPrintsEffect);var Y=new f;Y.id="acid_touch",Y.icon="iconAcidTouch",this.t.action_special_effect.add(d.default.acidTouchEffect);var Q=new f;Q.id="acid_blood",Q.icon="iconAcidBlood",this.add(Q),this.t.action_death.add(d.default.acidBloodEffect);var X=new f;X.id="acid_proof",X.icon="iconAcidProof",this.add(X);var $=new f;$.id="fire_blood",$.icon="iconFireBlood",this.add($),this.t.action_death.add(d.default.fireBlood);var tt=new f;tt.id="fire_proof",tt.icon="iconFireProof",this.add(tt);var et=new f;et.id="freeze_proof",et.icon="iconFreezeProof",this.add(et);var it=new f;it.id="cold_aura",it.icon="iconColdAura",this.add(it),this.t.action_special_effect.add(d.default.coldAuraEffect);var ot=new f;ot.id="bomberman",ot.icon="iconGrenade",this.add(ot),this.t.action_special_effect.add(d.default.bombermanEffect);var at=new f;at.id="pyromaniac",at.icon="iconPyromaniac",at.birth=1,this.add(at),this.t.action_special_effect.add(d.default.pyromaniacEffect),this.t.baseStats.warfare=3;var nt=new f;nt.id="eagle_eyed",nt.icon="iconEagleEye",nt.birth=.7,nt.opposite="short_sighted",nt.group=s.Genetic,nt.type=l.Positive,this.add(nt),this.t.baseStats.accuracy=10,this.t.baseStats.crit=15;var rt=new f;rt.id="short_sighted",rt.icon="iconShortsighted",rt.birth=.7,rt.opposite="eagle_eyed",rt.group=s.Genetic,rt.type=l.Negative,this.add(rt),this.t.baseStats.accuracy=-5,this.t.baseStats.crit=-5;var st=new f;st.id="lucky",st.icon="iconLucky",st.birth=.7,st.opposite="unlucky",st.group=s.Genetic,st.type=l.Positive,this.add(st),this.t.baseStats.dodge=5,this.t.baseStats.accuracy=4,this.t.baseStats.crit=30;var lt=new f;lt.id="unlucky",lt.icon="iconUnlucky",lt.birth=.7,lt.opposite="lucky",lt.group=s.Genetic,lt.type=l.Negative,this.add(lt),this.t.baseStats.dodge=-2,this.t.baseStats.accuracy=-4,this.t.baseStats.crit=-30;var ct=new f;ct.id="immune",ct.icon="iconImmune",ct.birth=.25,ct.inherit=10,ct.group=s.Genetic,ct.type=l.Positive,this.add(ct),this.t.baseStats.armor=3;var dt=new f;dt.id="agile",dt.icon="iconAgile",dt.birth=.75,dt.opposite="fat,slow",dt.sameTraitMod=5,dt.group=s.Genetic,dt.type=l.Positive,this.add(dt),this.t.baseStats.dodge=10,this.t.baseStats.attackSpeed=30;var ut=new f;ut.id="deceitful",ut.icon="iconDeceitful",ut.birth=1.5,ut.inherit=-1,ut.opposite="honest",ut.sameTraitMod=-15,ut.oppositeTraitMod=-5,ut.group=s.Personality,ut.type=l.Negative,this.add(ut),this.t.baseStats.diplomacy=1,this.t.baseStats.stewardship=4,this.t.baseStats.loyalty_traits=-20;var ht=new f;ht.id="bloodlust",ht.icon="iconBloodlust",ht.birth=1.5,ht.opposite="pacifist",ht.group=s.Personality,ht.type=l.Negative,this.add(ht),this.t.baseStats.mod_supply_timer=1.5,this.t.baseStats.loyalty_traits=-20,this.t.baseStats.warfare=10,this.t.baseStats.diplomacy=-2;var pt=new f;pt.id="pacifist",pt.icon="iconPacifist",pt.birth=1.5,pt.opposite="bloodlust",pt.group=s.Personality,pt.type=l.Positive,this.add(pt),this.t.baseStats.mod_supply_timer=-.1,this.t.baseStats.loyalty_traits=50,this.t.baseStats.diplomacy=10,this.t.baseStats.warfare=-4;var ft=new f;ft.id="ambitious",ft.icon="iconAmbitious",ft.birth=1.6,ft.opposite="content",ft.inherit=-1,ft.sameTraitMod=-10,this.add(ft),this.t.baseStats.diplomacy=2,this.t.baseStats.warfare=4,this.t.baseStats.stewardship=1,this.t.baseStats.damage=1,this.t.baseStats.loyalty_traits=-15;var _t=new f;_t.id="content",_t.icon="iconContent",_t.birth=2,_t.opposite="ambitious,greedy",_t.inherit=-1,_t.sameTraitMod=15,_t.group=s.Personality,_t.type=l.Positive,this.add(_t),this.t.baseStats.mod_supply_timer=-.3,this.t.baseStats.loyalty_traits=10,this.t.baseStats.diplomacy=2,this.t.baseStats.stewardship=2,this.t.baseStats.warfare=-2;var mt=new f;mt.id="honest",mt.icon="iconHonest",mt.birth=1.8,mt.opposite="deceitful",mt.inherit=-1,mt.sameTraitMod=10,mt.oppositeTraitMod=-10,mt.group=s.Personality,mt.type=l.Positive,this.add(mt),this.t.baseStats.stewardship=3,this.t.baseStats.diplomacy=2,this.t.baseStats.warfare=-2,this.t.baseStats.loyalty_traits=5;var gt=new f;gt.id="paranoid",gt.icon="iconParanoid",gt.birth=1.4,gt.opposite="honest",gt.inherit=-1,gt.group=s.Personality,gt.type=l.Negative,this.add(gt),this.t.baseStats.diplomacy=-2,this.t.baseStats.warfare=4,this.t.baseStats.mod_supply_timer=.5,this.t.baseStats.loyalty_traits=-15;var yt=new f;yt.id="greedy",yt.icon="iconGreedy",yt.birth=1.5,yt.inherit=-1,yt.opposite="content",yt.group=s.Personality,yt.type=l.Negative,this.add(yt),this.t.baseStats.diplomacy=-2,this.t.baseStats.stewardship=-3,this.t.baseStats.warfare=4,this.t.baseStats.mod_supply_timer=4,this.t.baseStats.loyalty_traits=-5;var vt=new f;vt.id="weightless",vt.icon="iconWeightless",vt.birth=.8,vt.opposite="fat",this.add(vt);var bt=new f;bt.id="poisonous",bt.icon="iconPoisonous",this.add(bt);var wt=new f;wt.id="venomous",wt.icon="iconVenomous",this.add(wt);var Tt=new f;Tt.id="poison_immune",Tt.icon="iconPoisonImmune",this.add(Tt);var kt=new f;kt.id="ancestor",kt.icon="iconAncestor",this.add(kt)},e.prototype.add=function(e){return t.prototype.add.call(this,e),this.checkDefault(e),e},e.prototype.checkDefault=function(t){0==t.inherit&&(t.inherit=10*t.birth),t.opposite&&(t.oppositeArr=t.opposite.split(","))},e.prototype.checkTraitsMod=function(t,e){for(var i=0,o=0;o<t.data.traits.length;o++){var a=t.data.traits[o],n=p.default.traits.get(a);if(n&&(0!=n.sameTraitMod&&e.haveTrait(a)&&(i+=n.sameTraitMod),0!=n.oppositeTraitMod))for(var r=n.oppositeArr,s=0;s<r.length;s++){var l=r[s];e.haveTrait(l)&&(i+=n.oppositeTraitMod)}}return i},e}(h.default);n.default=_,cc._RF.pop()},{}],Actor:[function(t,e,i){"use strict";cc._RF.push(e,"3012dJCKrVOWp1izKor8ou3","Actor");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t},d=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var u=a("MathUtils"),h=a("AchievData"),p=a("GameCommon"),f=a("MapAction"),_=a("SpriteAnimation"),m=a("AssetManager"),g=a("ItemLibrary"),y=a("SpellLibrary"),v=a("Globals"),b=a("ItemTools"),w=a("ToolBox"),T=a("GameAudio"),k=a("MapLayer"),B=a("MapBox"),S=a("WorldLog"),C=a("WorldTimer"),x=a("ActionLibrary"),A=a("ActorAsset"),P=a("ActorBase"),O=a("ActorEquipment"),R=a("ActorEquipmentSlot"),F=a("HoverModule"),L=a("Ant"),D=a("Baby"),M=a("Bee"),I=a("Boat"),j=a("Dragon"),E=a("Egg"),N=a("GodFinger"),z=a("Tornado"),G=a("UFO"),U=cc._decorator,W=U.ccclass,q=(U.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.new_creature=!0,e.colorEffect=0,e.timerReproduction=null,e.growTimer=null,e.specialTimer=0,e._timerSound=2,e.children_special=[],e.children_pre_behaviour=[],e.children_behaviour=[],e.curShadowPosition=v.default.POINT_IN_VOID,e.curTransformPosition=cc.Vec3.ZERO,e.lastTransformPosition=v.default.POINT_IN_VOID,e.colorMaterial=null,e.diet_index=0,e._activeSelf=!1,e._onlyHitByActor=!0,e}var i;return r(e,t),i=e,Object.defineProperty(e.prototype,"coloredName",{get:function(){var t;if(this.data){var e=this.kingdom;return(null===(t=null==e?void 0:e.kingdomColor)||void 0===t?void 0:t.colorBorderOut)?"<color="+this.kingdom.kingdomColor.colorBorderOut.toHEX("#rrggbbaa")+">"+this.data.firstName+"</color>":this.data.firstName}return""},enumerable:!1,configurable:!0}),e.prototype.updateChildren=function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)t[i].logicUpdate(e)},e.prototype.loadStats=function(t){this.stats=t,this.statsDirty=!0,this.stats.use_items&&(this.equipment=new O.default)},e.prototype.setHomeBuilding=function(t){this.homeBuilding=t,this.homeBuilding?this.data.homeBuildingID=t.data.objectID:this.data.homeBuildingID=""},e.prototype.create=function(){if(!this.created){t.prototype.create.call(this),this.setObjectType(k.MapObjectType.Actor);var e=this.node.getChildByName("body");if(e&&(this.spriteRenderer=e.getComponent(cc.Sprite),this.spriteAnimation=e.getComponent(_.SpriteAnimation)),this.stats.currentAmount++,this.new_creature&&(this.stats.unit?this.stats.baby?this.setProfession(A.UnitProfession.Baby):this.setProfession(A.UnitProfession.Unit):this.setProfession(A.UnitProfession.Null)),this.race=m.default.raceLibrary.get(this.stats.race),this.race.units.add(this),this.loadTexture(),"nature"!=this.race.id&&(this.timerReproduction=new C.default(10,!0),this.growTimer=new C.default(.05,this.updateGrowthScale.bind(this))),this.stats.hovering&&(this.moveJumpOffset.y=this.stats.hovering_min),this.addChildren(),this.stats.kingdom.includes("ants"))for(var i=0;i<B.default.inst.units.list.length;i++){var o=B.default.inst.units.list[i];o.stats.id,o.stats.id,o.stats.id,o.stats.id}this.updateStats(),this.updateTargetScale(),this.startBabymakingTimeout(),this.callbacks_landed.push(this.cancelAllBeh.bind(this)),this.callbacks_landed.push(this.checkDeathOutsideMap.bind(this)),this.callbacks_added_madness.push(this.applyMadness.bind(this)),this.callbacks_on_death.push(P.default.clearStatusEffects),this._positionDirty=!0,this.updatePos(),this.node.name=this.stats.id+"_"+this.data.actorID,this.forceAnimation()}},e.prototype.checkDeathOutsideMap=function(){this.inMapBorder()||this.killHimself(!1,A.AttackType.Other,!0,!0)},e.prototype.loadFromSave=function(){this.checkMadness(),this.setStatsDirty();for(var t=0;t<this.data.traits.length;)m.default.traits.get(this.data.traits[t])?t++:this.data.traits.splice(t,1);this.stats.unit&&this.data.profession==A.UnitProfession.Null&&(this.data.profession=A.UnitProfession.Unit),this.setProfession(this.data.profession)},e.prototype.setProfession=function(t){this.data.profession=t,this.professionAsset=m.default.professions.getAsset(t),this.setStatsDirty(),this.city&&(this.city.unitsDirty=!0),this.cancelAllBeh()},e.prototype.isProfession=function(t){return this.data.profession==t},e.prototype.updateHunger=function(){if(this.data.hunger--,this.data.hunger<=10&&this.city){var t=this.city.getFoodItem(this.data.favoriteFood);t&&(this.consumeCityFoodItem(t),t=null,this.haveTrait("gluttonous")&&(t=this.city.getFoodItem(this.data.favoriteFood))&&this.consumeCityFoodItem(t))}this.data.hunger<=0&&(this.data.hunger=0,0==this.data.hunger&&this.getHit(1,!0,A.AttackType.Hunger))},e.prototype.consumeCityFoodItem=function(t){this.city.eatFoodItem(t.id),this.restoreStatsFromEating(t.restoreHunger,t.restoreHealth),t.id==this.data.favoriteFood&&this.restoreStatsFromEating(t.restoreHunger/2,t.restoreHealth/2),this.data.favoriteFood&&(t.id==this.data.favoriteFood&&"happy"!=this.data.mood?this.changeMood("happy"):"happy"==this.data.mood?this.changeMood("normal"):"normal"==this.data.mood?w.Toolbox.randomChance(.2)&&this.changeMood("sad"):"sad"==this.data.mood&&w.Toolbox.randomChance(.05)&&this.changeMood("angry"))},e.prototype.changeMood=function(t){t!=this.data.mood&&(this.setStatsDirty(),this.data.mood=t)},e.prototype.restoreStatsFromEating=function(t,e,i){void 0===t&&(t=100),void 0===e&&(e=.1),void 0===i&&(i=!1),this.data.hunger+=t,i&&this.data.hunger>this.stats.maxHunger&&(this.data.hunger=this.stats.maxHunger),this.data.health<this.curStats.health&&this.restoreHealth(u.default.intCast(this.curStats.health*e+1))},e.prototype.restoreHealth=function(t){this.data.health!=this.curStats.health&&(this.data.health+=t,this.data.health>this.curStats.health&&(this.data.health=this.curStats.health))},e.prototype.reloadInventory=function(){this.setStatsDirty()},e.prototype.isRace=function(t){return"string"==typeof t?this.stats.race==t:this.stats.race==t.stats.race},e.prototype.addChildren=function(){this.children_pre_behaviour=[],this.children_behaviour=[],this.children_special=[],this.getComponent(N.default)&&this.addChild(this.getComponent(N.default),this.children_special),this.getComponent(j.default)&&this.addChild(this.getComponent(j.default),this.children_special),this.getComponent(G.default)&&this.addChild(this.getComponent(G.default),this.children_special),this.getComponent(z.default)&&this.addChild(this.getComponent(z.default),this.children_special),this.stats.flags.includes("ant")&&(this.addComponent(L.default),this.addChild(this.getComponent(L.default),this.children_behaviour)),this.stats.flags.includes("egg")&&(this.addComponent(E.default),this.addChild(this.getComponent(E.default),this.children_pre_behaviour)),this.stats.baby&&(this.addComponent(D.default),this.addChild(this.addComponent(D.default),this.children_pre_behaviour)),this.stats.hovering&&this.addChild(this.addComponent(F.default),this.children_special),"bee"==this.stats.id&&this.addChild(this.addComponent(M.default),this.children_pre_behaviour),this.stats.isBoat&&this.addChild(this.addComponent(I.default),this.children_pre_behaviour),0==this.children_pre_behaviour.length&&(this.children_pre_behaviour=null),0==this.children_behaviour.length&&(this.children_behaviour=null),0==this.children_special.length&&(this.children_special=null)},e.prototype.addChild=function(t,e){null==e||e.push(t),t.create()},e.prototype.updateSpecialTraitEffects=function(){if(this.s_special_effect_traits&&0!=this.s_special_effect_traits.length){i._tempTraitList=c(this.s_special_effect_traits);for(var t=0;t<i._tempTraitList.length;t++){var e=i._tempTraitList[t];e.action_special_effect.isEmpty||e.action_special_effect.do(this,this.currentTile)}}},e.prototype.spawnParticle=function(t){if(!w.Toolbox.randomBool()&&!B.default.inst.qualityChanger.lowRes){var e=this.node.position;e.y+=this.spriteRenderer.node.y*this.node.scaleY/2,e.x+=w.Toolbox.randomFloat(-.2,.2),e.y+=w.Toolbox.randomFloat(-.2,.2),B.default.inst.stackEffects.spawnStatusParticle(e,t)}},e.prototype.makeWait=function(t){void 0===t&&(t=10),this.stopMovement(),this.timer_action=t},e.prototype.playRandomSound=function(){this.stats.playRandomSound&&T.default.play(this.stats.playRandomSound_id)},e.prototype.startShake=function(t,e,i,o){void 0===t&&(t=.3),void 0===e&&(e=.1),void 0===i&&(i=!0),void 0===o&&(o=!0),this.shakeHorizontal=i,this.shakeVertical=o,this.shakeTimer.startTimer(t),this.shakeVolume=e},e.prototype.updateSpecialTimers=function(t){this.s_special_effect_traits&&this.s_special_effect_traits.length>0&&(this.specialTimer>0?this.specialTimer-=t:(this.specialTimer=1,this.updateSpecialTraitEffects())),this._timerSound>0?this._timerSound-=t:(this._timerSound=2,this.playRandomSound())},e.prototype.canFight=function(){var t;return!(null!==(t=this.ai.task)&&void 0!==t&&t.ignoreFightCheck||this.stats.skipFightLogic||this._trait_peaceful)},e.prototype.updateBehaviour=function(t){if(!(0!=this.forceVector.x||0!=this.forceVector.y||0!=this.forceVector.z||0!=this.zPosition.y&&this.stats.updateZ||!this.currentTile||this.behaviourActorTargetCheck()))if(this.checkEnemyTargets())this.stopMovement();else if(!this.is_moving){if(this.isUsingPath())return void this.updatePathMovement();this.updateChildren(this.children_behaviour,t),this.ai.logicUpdate(t)}},e.prototype.behaviourActorTargetCheck=function(){var t,e,i,o,a;if(this.attackTarget)if(!(null===(t=this.attackTarget.base_data)||void 0===t?void 0:t.alive)||(null===(e=this.kingdom)||void 0===e?void 0:e.isCiv())&&!(null===(o=null===(i=this.attackTarget)||void 0===i?void 0:i.kingdom)||void 0===o?void 0:o.isEnemy(this.kingdom)))this.attackTarget=null;else if((null===(a=this.kingdom)||void 0===a?void 0:a.isCiv())&&this.kingdom.isEnemy(this.attackTarget.kingdom),this.canAttackTarget(this.attackTarget)){if(this.attackTimer>0||this.attackTimer>0&&this.isInAttackRange(this.attackTarget))return this.stopMovement(),!0;if(this.tryToAttack(this.attackTarget))return this.stopMovement(),!0}},e.prototype.checkEnemyTargets=function(){var t,e,i,o;if(!this.canFight())return!1;if(this.attackTarget)return(null===(e=null===(t=this.ai)||void 0===t?void 0:t.task)||void 0===e?void 0:e.fighting)||this.ai.setTask("fight",!0,!0),!1;if(this._timeout_targets>0)return!1;if(this._timeout_targets=.4+w.Toolbox.randomFloat(0,.1),(null===(o=null===(i=this.attackTarget)||void 0===i?void 0:i.base_data)||void 0===o?void 0:o.alive)&&!this.targetsToIgnore.has(this.attackTarget)&&this.canAttackTarget(this.attackTarget)||(this.attackTarget=null),this.isAffectedByLiquid()&&!this.stats.oceanCreature)return!1;this.kingdom||this.checkKingdom();var a=this.findEnemyObjectTarget();if(a){if(this.attackTarget){var n=w.Toolbox.distTile(this.attackTarget.currentTile,this.currentTile);w.Toolbox.distTile(a.currentTile,this.currentTile)<n&&(this.attackTarget=a,this._timeout_targets=1)}else this.attackTarget=a;return this.ai.setTask("fight",!1,!0),!0}return!1},e.prototype.updatePos=function(){if(this._positionDirty){this._positionDirty=!1;var t=this.currentPosition.x+this.moveJumpOffset.x+this.shakeOffset.x,e=this.currentPosition.y+this.moveJumpOffset.y+this.shakeOffset.y,i=e;e+=this.zPosition.y,this.curShadowPosition.x=this.currentPosition.x+this.shakeOffset.x,this.curShadowPosition.y=this.currentPosition.y+this.shakeOffset.y,this.isAffectedByLiquid()&&(i+=.3),i<0&&(i=0),this.curTransformPosition.x=t,this.curTransformPosition.y=e,this.curTransformPosition.z=i,this.node.x==t&&this.node.y==e||(this.node.position=this.curTransformPosition,this.lastTransformPosition.set(cc.v3(t,e,i)))}},e.prototype.updateAge=function(){var t,e;(null===(t=this.data)||void 0===t?void 0:t.updateAge(this.race))||this.haveTrait("immortal")?(this.city&&((null===(e=this.city.kingdom)||void 0===e?void 0:e.king)==this&&this.addExperience(20),this.city.leader==this&&this.addExperience(10)),this.data.age>40&&w.Toolbox.randomChance(.3)&&this.addTrait("wise")):this.killHimself(!1,A.AttackType.Age)},e.prototype.checkCulture=function(){this.city&&!B.default.inst.cultures.get(this.data.culture)&&(this.data.culture="",this.currentTile.zone.city==this.city&&this.currentTile.zone.culture&&this.setCulture(this.currentTile.zone.culture))},e.prototype.setCulture=function(t){this.data.culture=t.id},e.prototype.checkKingdom=function(){this.kingdom||(this.checkMadness(),this.stats.unit?this.setKingdom(B.default.inst.kingdoms.dict_hidden.get("nomads_"+this.stats.race)):this.stats.kingdom&&this.setKingdom(B.default.inst.kingdoms.dict_hidden.get(this.stats.kingdom)))},e.prototype.isInsideSomething=function(){var t;return!(null===(t=this.ai.action)||void 0===t||!t.special_inside_object)},e.prototype.isItemRendered=function(){var t;return!(!this.stats.use_items||this._isInLiquid||this.equipment.weapon.isEmpty()&&(null===(t=this.ai.task)||void 0===t||!t.force_item_sprite)&&!this.inventory.resource)},e.prototype.getRenderedToolOrItem=function(){var t;return this.inventory.resource?this.inventory.resource:(null===(t=this.ai.task)||void 0===t?void 0:t.force_item_sprite)?this.ai.task.force_item_sprite:""},e.prototype.getTextureToRenderInHand=function(){return this.getRenderedToolOrItem()||this.s_weapon_texture},e.prototype.updateTimers=function(t){var e,i,o;0!=this.zPosition.y&&this.stats.updateZ&&this.updateFall(t),(null===(i=null===(e=this.attackedBy)||void 0===e?void 0:e.base_data)||void 0===i?void 0:i.alive)||(this.attackedBy=null),this.insideBoat||(this.shakeTimer.logicUpdate(t),this.updateFlipRotation(t),p.default.isPaused||(this.updateShake(),this.updateForce(t),(null===(o=this.data)||void 0===o?void 0:o.alive)&&(this.checkCulture(),this.updateRotationBack(t),this._status_frozen||(this.updateWalkJump(t),this.attackTimer>=0&&(this.attackTimer-=t),this._timeout_targets>=0&&(this._timeout_targets-=cc.director.getDeltaTime()),this.timer_action>=0&&(this.timer_action-=t),this.canFight()&&this.targetsToIgnoreTimer.logicUpdate(t)))))},e.prototype.checkSpriteConstructor=function(){var t;return!this.stats.sprite_group_renderer||!!this.s_body_sprite&&!(null===(t=this.data)||void 0===t||!t.alive)&&(this.spriteRenderer.spriteFrame=this.s_body_sprite,!0)},e.prototype.forceAnimation=function(){this.updateAnimation(B.default.inst.elapsed,!0)},e.prototype.checkSpriteRenderer=function(){this.stats.haveSpriteRenderer&&this.stats.hideOnMinimap&&(B.default.inst.qualityChanger.lowRes?this.spriteRenderer.enabled&&(this.spriteRenderer.enabled=!1):this.spriteRenderer.enabled=!0)},e.prototype.logicUpdate=function(e){var i,o,a,n;if(t.prototype.logicUpdate.call(this,e),this._actionFall&&(this._actionFall=!1,this.actionLanded()),this._activeSelf||this.checkExit(),null!==(i=this.insideBoat)&&void 0!==i&&i.actor)this.setCurrentTilePosition(this.insideBoat.actor.currentTile);else if(this.checkKingdom(),this.updateColorEffect(e),this.updatePos(),this.updateChildren(this.children_special,e),this.updateRotation(),this.updateChildren(this.children_pre_behaviour,e),this.checkSpriteRenderer(),this._is_visible&&this._activeSelf&&!B.default.inst.qualityChanger.lowRes&&this.checkSpriteConstructor(),(null===(o=this.data)||void 0===o?void 0:o.alive)&&(null===(a=this.base_data)||void 0===a?void 0:a.alive)){if(!this.checkCurTileAction()||p.default.isPaused)return;if(this.updateStatusEffects(e),this._status_frozen)return;this.checkUpdateTimers(e),this.timer_action>=0||null===(n=this.data)||void 0===n||!n.alive||(this.updateBehaviour(e),this.nextStepPosition.x!=v.default.emptyVector.x&&this.smoothMovement(this.nextStepPosition,e))}else this.updateDeadAnimation()},e.prototype.checkUpdateTimers=function(t){this.race.nature||(this.stats.specialAnimation||this.actorScale==this.targetScale||this.growTimer.logicUpdate(t),this.timerReproduction.logicUpdate(t),this.updateSpecialTimers(t))},e.prototype.checkExit=function(){var t;this._activeSelf||(null===(t=this.ai.action)||void 0===t?void 0:t.special_inside_object)&&(this.insideBuilding&&!this.insideBuilding.isNonUsable()||this.insideBoat)||(this.exitHouse(),this.cancelAllBeh())},e.prototype.checkCurTileAction=function(){if(0!=this.zPosition.y)return!0;var t=this.currentTile.type;if(this.stats.canBeKilledByStuff){if(this.stats.dieOnGround&&!this.currentTile.type.liquid&&(this.stats.id.includes("piranha")&&h.default.update(52),this.killHimself()),p.default.isPaused)return!1;if(t.liquid&&!this.isFlying()){if(t.lava||this.removeStatusEffect("burning"),this.stats.damagedByOcean&&this.currentTile.type.ocean&&this.colorEffect<=0&&!this.shakeTimer.isActive&&this.getHit(5),this.currentTile.type.liquid&&this.stats.swimToIsland&&!this.is_moving){var e=!1;this.currentTile.type.ocean&&!this.stats.oceanCreature?e=!0:this.currentTile.type.swamp&&!this.stats.swampCreature&&(e=!0),!e||this.ai.task&&this.ai.task.swim_to_island||this.ai.setTask("swim_to_island",!0,!0)}}else if(t.block)!this.stats.moveFromBlock||this.is_moving||this.ai.task&&this.ai.task.moveFromBlock||this.ai.setTask("move_from_block",!0,!0),this.stats.dieOnBlocks&&this.colorEffect<=0&&!this.shakeTimer.isActive&&this.getHit(1);else if(t.ground&&!this.isFlying()&&(t.damagedWhenWalked&&!this._trait_weightless&&(this.currentTile.health>0?this.currentTile.health--:f.default.decreaseTile(this.currentTile)),this.currentTile.data.fire&&!this._trait_fire_resistant&&(x.default.addBurningEffectOnTarget(this),this.stats.specialAnimation||this.spriteAnimation.stopAt(2),!this.data.alive)))return!1;if(t.damageUnits&&!this.isFlying()&&this.colorEffect<=0&&(!t.lava||this.stats.dieInLava)&&(this.getHit(t.damage),this.stats.specialAnimation||this.spriteAnimation.stopAt(2),!this.data.alive))return!1}return!0},e.prototype.killHimself=function(t,e,i,o){var a,n,r,s;if(void 0===t&&(t=!1),void 0===e&&(e=A.AttackType.Other),void 0===i&&(i=!0),void 0===o&&(o=!0),(null===(a=this.data)||void 0===a?void 0:a.alive)||t){if(null===(n=this.data)||void 0===n?void 0:n.alive){if("tornado"==this.stats.id&&this.getComponent(z.default).killTornado(),this.data.alive=!1,this.base_data.alive=!1,this.insideBoat&&this.insideBoat.removeFromTaxi(this),"crabzilla"==this.stats.id&&(t=!0),o){if(this.currentTile.type.unitDeathAction&&!this.currentTile.type.unitDeathAction.isEmpty&&this.currentTile.type.unitDeathAction.do(this,this.currentTile),this.stats.action_death.isEmpty||this.stats.action_death.do(this,this.currentTile),!cc.isValid(this.node,!0))return;for(var l=0;l<this.data.traits.length;){var c=this.data.traits[l],d=m.default.traits.get(c);d&&(d.action_death.isEmpty||d.action_death.do(this,this.currentTile),this.data.traits.includes(c)&&l++)}cc.isValid(this.node,!0)||(t=!0);for(var u=0;u<this.callbacks_on_death.length;u++)this.callbacks_on_death[u](this)}if(this.haveTrait("energized")&&e!=A.AttackType.None&&B.default.spawnLightning(this.currentTile),i)switch(B.default.inst.gameStats.creaturesDied++,B.default.inst.mapStats.deaths++,e){case A.AttackType.Plague:B.default.inst.mapStats.deaths_plague++;break;case A.AttackType.Other:B.default.inst.mapStats.deaths_other++;break;case A.AttackType.Bomb:B.default.inst.mapStats.deaths_explosion++,B.default.inst.countKillByDestructionPowers();break;case A.AttackType.Divine:B.default.inst.mapStats.deaths_divine++,B.default.inst.countKillByDivineLightPowers();break;case A.AttackType.Hunger:B.default.inst.mapStats.deaths_hunger++;break;case A.AttackType.Eaten:B.default.inst.mapStats.deaths_eaten++,h.default.update(7),h.default.update(72,B.default.inst.mapStats.deaths_eaten,!0);break;case A.AttackType.Age:B.default.inst.mapStats.deaths_age++;break;default:B.default.inst.mapStats.deaths_other++}this.stats.currentAmount--,this.data.favorite&&e!=A.AttackType.GrowUp&&((null===(r=this.attackedBy)||void 0===r?void 0:r.a)?S.default.logFavMurder(this,null===(s=this.attackedBy)||void 0===s?void 0:s.a):S.default.logFavDead(this)),this.race.units.remove(this),this.clearTasks(),this.stopMovement(),!this.stats.specialAnimation&&this.spriteAnimation&&this.spriteAnimation.stopAnimations()}this.city&&(this.city.removeCitizen(this,i,e),this.setCity(null)),t&&(this.race.units.remove(this),this.kingdom&&this.setKingdom(null),B.default.inst.destroyActor(this)),this.attackTarget=null}},e.prototype.isInAttackRange=function(t){var e=!1;try{e=w.Toolbox.distVec3(this.currentPosition,t.currentPosition)<this.curStats.range+t.curStats.size}catch(i){cc.log(i)}return e},e.prototype.tryToAttack=function(t){if(this.isInLiquid()&&!this.stats.oceanCreature)return!1;if(this.attackTimer>0)return!1;var e=t.currentTile;if(!this.isInAttackRange(t))return!1;if(this.s_attackType==g.WeaponType.Melee&&t.zPosition.y>0)return!1;this.timer_action=this.s_attackSpeed_seconds,this.attackTimer=this.s_attackSpeed_seconds,this.punchTargetAnimation(t.node.position,t.currentTile,!0,this.s_attackType==g.WeaponType.Range),T.default.playPunch(this.currentPosition);var i=t.currentPosition.clone();t.objectType==k.MapObjectType.Actor&&t.a.is_moving&&t.a.isFlying()&&(i=w.Toolbox.moveTowards(i,t.a.nextStepPosition,3*t.curStats.size));var o=cc.Vec3.distance(this.currentPosition,t.currentPosition)+t.getZ(),a=w.Toolbox.getNewPoint(this.currentPosition.x,this.currentPosition.y,i.x,i.y,o-t.curStats.size),n=this.currentPosition.clone();n.y+=.5,n.x+=i.x>this.currentPosition.x?.5:-.5;var r=57.29578*w.Toolbox.getAngle(n.x,n.y,i.x,i.y);if(this.s_attackType==g.WeaponType.Melee)n=w.Toolbox.getNewPoint(n.x,n.y,i.x,i.y+t.getZ(),2*this.curStats.size),B.default.inst.newAttack(this,a,e,t);else if(this.s_attackType==g.WeaponType.Range&&(n=w.Toolbox.getNewPoint(n.x,n.y,i.x,i.y+t.getZ(),this.curStats.size),!this.tryToCastSpell(t)))for(var s=this.getWeaponAsset().projectile,l=0;l<this.curStats.projectiles;l++){a.x=i.x,a.y=i.y+.1,a.x+=w.Toolbox.randomFloat(0-(t.curStats.size+1),t.curStats.size+1),a.y+=w.Toolbox.randomFloat(0-t.curStats.size,t.curStats.size);var c=w.Toolbox.getNewPoint(this.currentPosition.x,this.currentPosition.y,i.x,i.y,this.curStats.size);c.y+=.5;var d=0;t.isInAir()&&(d=t.getZ());var u=B.default.inst.stackEffects.startProjectile(c,a,s,d);r=u.getAngle(),u&&(u.byWho=this,u.setStats(u.byWho.curStats),u.targetObject=t)}return B.default.inst.stackEffects.slash(n,this.s_slashType,r),!0},e.prototype.tryToCastSpell=function(t){var e=this.stats.attack_spells;if(e&&0==e.length)return!1;var i=m.default.spells.get(this.stats.attack_spells.getRandom());if(!w.Toolbox.randomChance(i.chance))return!1;if(i.castTarget==y.CastTarget.Himself&&(t=this),i.castEntity==y.CastEntity.BuildingsOnly){if(t.isActor())return!1}else if(i.castEntity==y.CastEntity.UnitsOnly&&t.isBuilding())return!1;var o=this.data.health/this.curStats.health;if(0!=i.healthPercent&&i.healthPercent<=o)return!1;if(0!=i.min_distance&&w.Toolbox.distTile(this.currentTile,t.currentTile)<i.min_distance)return!1;var a=!i.action.isEmpty&&i.action.do(t,t.currentTile);return a&&this.doCastAnimation(),a},e.prototype.doCastAnimation=function(){if(!B.default.inst.qualityChanger.lowRes){var t=B.default.inst.stackEffects.get(this.stats.effect_cast_ground).spawnAt(this.currentPosition,this.curStats.scale);t&&(t.node.parent=this.node,t.node.position=cc.Vec3.ZERO,t=null),(t=B.default.inst.stackEffects.get(this.stats.effect_cast_top).spawnAt(this.currentPosition.add(P.default.actorCastPos),this.curStats.scale))&&(t.node.parent=this.node,t.node.position=cc.v3(P.default.actorCastPos))}},e.prototype.getZ=function(){return this.zPosition.y+this.hitboxZ},e.prototype.punchTargetAnimation=function(t,e,i,o,a){void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===a&&(a=40),this.stats.flipAnimation&&(i&&(this.node.x<t.x?this.setFlip(!0):this.setFlip(!1)),this.stats.disablePunchAttackAnimation||(this.targetAngle.z=o?this.flip?a:(360-a)%360:this.flip?(360-a)%360:a))},e.prototype.startColorEffect=function(t){void 0===t&&(t="red"),this.stats.effectDamage&&(this.colorEffect=.3,"red"==t?this.colorMaterial=cc.Color.RED:"white"==t&&(this.colorMaterial=cc.Color.WHITE),this.updateColorEffect(0))},e.prototype.updateColorEffect=function(t){0!=this.colorEffect&&null!=this.spriteRenderer&&(this.colorEffect-=t,this.colorEffect<0&&(this.colorEffect=0),this.colorEffect>0?this.setUnitSpriteColor(this.colorMaterial):this.setUnitSpriteColor(cc.Color.WHITE))},e.prototype.getHit=function(t,e,i,o,a){var n,r;if(void 0===e&&(e=!0),void 0===i&&(i=A.AttackType.Other),void 0===o&&(o=null),void 0===a&&(a=!0),this.attackedBy=null,!(a&&(null===(n=this.shakeTimer)||void 0===n?void 0:n.isActive)||!(null===(r=this.data)||void 0===r?void 0:r.alive)||this.data.health<=0)){if(o||(this._onlyHitByActor=!1),i==A.AttackType.Other&&(t*=1-this.curStats.armor/100),t<1&&(t=1),this.data.health-=u.default.intCast(t),this.timer_action=.002,i!=A.AttackType.Other||this.stats.immune_to_injuries||this.haveStatus("shield")||(w.Toolbox.randomChance(.02)&&this.addTrait("crippled"),w.Toolbox.randomChance(.02)&&this.addTrait("eyepatch"),this.addExperience(1)),e&&this.startColorEffect("red"),this.data.health<=0){if(o!=this&&(this.attackedBy=o),this.killHimself(!1,i),this._onlyHitByActor&&(this.stats.id,"UFO"==this.stats.id&&h.default.update(54)),!o||o==this||!o.isActor())return;if(o.a.increaseKillCount(),o.a.stats.use_items&&!this.haveTrait("infected")&&o.a.stats.take_items&&o.a.takeItems(this,o.a.stats.take_items_ignore_range_weapons),!o.city)return;var s=!1;return this.stats.animal?(s=!0,o.city.data.storage.change("meat")):this.stats.unit&&o.a.haveTrait("savage")&&(s=!0),void(s&&(w.Toolbox.randomChance(.5)?o.city.data.storage.change("bones"):w.Toolbox.randomChance(.5)?o.city.data.storage.change("leather"):w.Toolbox.randomChance(.5)&&o.city.data.storage.change("meat")))}if(this.shakeTimer.startTimer(-1),o!=this&&(this.attackedBy=o),!this.attackTarget&&this.attackedBy&&!this.targetsToIgnore.has(this.attackedBy)&&this.canAttackTarget(this.attackedBy)&&(this.attackTarget=this.attackedBy),this.activeStatusEffects&&this.activeStatusEffects.length>0)for(var l=0;l<this.activeStatusEffects.length;l++){var c=this.activeStatusEffects[l];c.asset.actionOnHit&&c.asset.actionOnHit.do(this,this.currentTile)}for(l=0;l<this.callbacks_get_hit.length;l++)this.callbacks_get_hit[l](this)}},e.prototype.takeItems=function(t,e){var i,o;if(void 0===e&&(e=!1),this.stats.use_items&&t.stats.use_items){var a=O.default.getList(t.equipment);try{for(var n=d(a),r=n.next();!r.done;r=n.next()){var s=r.value;if(s.data&&(s.type!=R.EquipmentType.Weapon||!e||m.default.items.get(s.data.id).attackType!=g.WeaponType.Range)){var l=this.equipment.getSlot(s.type);if(l.data){b.default.calcItemValues(l.data);var c=b.default.s_value;b.default.calcItemValues(s.data),b.default.s_value>c&&(l.setItem(s.data),s.emptySlot(),this.setStatsDirty(),this.item_sprite_dirty=!0)}else l.setItem(s.data),s.emptySlot(),this.setStatsDirty(),this.item_sprite_dirty=!0}}}catch(p){i={error:p}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}}},e.prototype.increaseKillCount=function(){this.data.kills++,this.data.kills>10&&this.addTrait("veteran"),this.addExperience(10),this.haveTrait("madness")&&this.restoreHealth(this.curStats.health/15+1)},e.prototype.getExpToLevelup=function(){return 100+20*(this.data.level-1)},e.prototype.addExperience=function(t){if(this.stats.canLevelUp){var e=10,i=this.getCulture();if(i&&(e+=i.getMaxLevelBonus()),!(this.data.level>=e)){var o=this.getExpToLevelup();this.data.experience+=t,this.data.experience>=o&&(this.data.experience=0,this.data.level++,this.data.level==e&&(this.data.experience=o),this.setStatsDirty(),this.event_full_heal=!0)}}},e.prototype.startBabymakingTimeout=function(){this.timerReproduction&&this.timerReproduction.startTimer(40+w.Toolbox.randomFloat(0,40))},e.prototype.stayInBuilding=function(t){this.insideBuilding=t,this.setActorVisible(!1)},e.prototype.exitHouse=function(){this.timer_action=0,this.insideBuilding=null,this.setActorVisible(!0)},e.prototype.embarkInto=function(t){var e;(null===(e=this.ai.job)||void 0===e?void 0:e.cancel_when_embarking)?this.cancelAllBeh():(this.clearTasks(),this.stopMovement(),this.ai.restartJob()),this.data.transportID=t.actor.data.actorID,this.setActorVisible(!1),this.node.position=v.default.POINT_IN_VOID,this.lastTransformPosition.set(v.default.POINT_IN_VOID),this.insideBoat=t,this.insideBoat.addUnitInto(this)},e.prototype.setActorVisible=function(t){this._activeSelf=t,this.node.active=t},e.prototype.disembarkTo=function(t,e){this.spawnOn(e),this.data.transportID=null,this.setActorVisible(!0),this.insideBoat=null,this._currentTileDirty=!0},e.prototype.isCurrentJob=function(t){return!!this.ai.job&&this.ai.job.id==t},e.prototype.checkZoneForGround=function(t){for(var e=0;e<t.tiles.length;e++){var i=t.tiles[e];i.type.liquid||P.default.possible_moves.push(i)}},e.prototype.becomeCitizen=function(t){this.city!=t&&t.addNewUnit(this)},e.prototype.spawnOn=function(e,i){if(void 0===i&&(i=0),t.prototype.spawnOn.call(this,e,i),this.stats.id.includes("santa")){var o=w.Toolbox.randomFloat(30,50);this.currentPosition.y-=o,this.zPosition.y=o}else this.stats.id.includes("UFO")&&(this.zPosition.y=8)},e.prototype.applyRandomForce=function(){var t=w.Toolbox.randomFloat(.05,.4),e=this.currentTile.neighboursAll.getRandom(),i=w.Toolbox.getAngle(this.currentTile.posV3.x,this.currentTile.posV3.y,e.posV3.x,e.posV3.y);this.addForce((0-Math.cos(i))*t,(0-Math.sin(i))*t,t)},e.prototype.applyMadness=function(t){t.city&&(t.city.removeCitizen(this),t.removeFromCity()),t.removeTrait("peaceful"),t.startShake(.3,.2),t.startColorEffect("white"),t.kingdom&&t.kingdom.removeUnit(t),t.setKingdom(B.default.inst.kingdoms.dict_hidden.get("mad")),t.cancelAllBeh()},e.prototype.updateGrowthScale=function(){if(0!=this.targetScale){this.actorScale+=.001,this.actorScale>this.targetScale&&(this.actorScale=this.targetScale);var t=cc.v3(this.actorScale,this.actorScale,this.actorScale);this.flipScale.x<0&&(t.x=0-t.x),this.node.setScale(t)}},e.prototype.justBorn=function(){this.actorScale=.02,this.updateGrowthScale()},e.prototype.removeFromCity=function(){this.setCity(null)},e.prototype.setCity=function(t){this.city=t},e.prototype.removeFromGroup=function(){this.unitGroup&&this.unitGroup.removeUnit(this),this.unitGroup=null},e.prototype.isInCityIsland=function(){var t,e;if(!this.city||!(null===(t=this.data)||void 0===t?void 0:t.alive))return!1;var i=this.city.getTile();return!!i&&!(null===(e=this.currentTile)||void 0===e||!e.isSameIsland(i))},e.prototype.setGroupLeader=function(t){this.isGroupLeader=t},e.prototype.getAnimationFrameData=function(){return this.frameData},e.prototype.isInfectedWithAnything=function(){return!!(this.haveTrait("infected")||this.haveTrait("plague")||this.haveTrait("mushSpores")&&this.stats.canTurnIntoMush||this.haveTrait("tumorInfection")&&this.stats.canTurnIntoTumorMonster)},e._tempTraitList=[],i=s([W],e)}(P.default));n.default=q,cc._RF.pop()},{}],AdView:[function(t,e,i){"use strict";cc._RF.push(e,"06b34Wn2fBJ+5O7ILR9ZSK7","AdView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.AD_TYPE=void 0;var c,d=a("Constants"),u=a("AdsManager"),h=a("AdTools"),p=a("UserData"),f=a("GamePopBase"),_=a("MsgCache"),m=a("AssetManager"),g=a("TextureLoader"),y=cc._decorator,v=y.ccclass,b=y.property;(function(t){t[t.boxGift=0]="boxGift",t[t.achiev=1]="achiev",t[t.infinite=2]="infinite"})(c=n.AD_TYPE||(n.AD_TYPE={}));var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.source=null,e.logoBox=null,e.adSprite=null,e.video=null,e.btnLabel=null,e.rewardItem=[],e.data=[],e.adId="",e.type=c.boxGift,e}return r(e,t),e.prototype.init=function(t,e,i){var o,a;this.data=Array.from(t),this.type=i,this.title.string=["\u76d2\u5b50\u793c\u7269","\u83b7\u5f97\u5956\u52b1","\u9053\u5177\u8017\u5c3d"][i],this.source.active=i!=c.boxGift,this.logoBox.active=i==c.boxGift,this.video.active=i!=c.boxGift,this.btnLabel.string=["\u9886\u53d6","\u53cc\u500d\u9886\u53d6","\u9650\u65f6\u89e3\u9501"][i];try{for(var n=l(this.rewardItem),r=n.next();!r.done;r=n.next())r.value.active=!1}catch(u){o={error:u}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}this.showAd(e),this.showReward(this.data)},e.prototype.showAd=function(t){var e=this;this.adId=t.adPositionId,this.adSprite.node.getChildByName("title").getComponent(cc.Label).string=t.title||"\u70b9\u51fb\u67e5\u770b",cc.find("load/label",this.adSprite.node).getComponent(cc.Label).string=t.clickBtnTxt||"\u70b9\u51fb\u67e5\u770b";var i=t.desc||t.source;this.adSprite.node.getChildByName("desc").getComponent(cc.Label).string=i||"";var o=h.default.checkImageUrl(t,!1),a=!!o;this.adSprite.node.active=a,a&&cc.assetManager.loadRemote(o,{ext:".png"},function(t,i){t?cc.error("\u5e7f\u544a\u56fe\u7247\u5c55\u793a\u9519\u8bef\uff1a",JSON.stringify(t)):cc.isValid(e.adSprite)&&(e.adSprite.spriteFrame=new cc.SpriteFrame(i))})},e.prototype.showReward=function(t){for(var e=0;e<t.length;e++)if(this.rewardItem[e]){this.rewardItem[e].active=!0,this.rewardItem[e].getChildByName("name").getComponent(cc.Label).string=t[e].propName;var i=this.rewardItem[e].getChildByName("rare");i.active=t[e].rare>=0;var o=g.TextureLoader.inst.getSpriteFrame(g.ATLAS_TYPE.UIATLAS,"reward/rare_"+t[e].rare);o&&(i.getComponent(cc.Sprite).spriteFrame=o);var a=this.rewardItem[e].getChildByName("icon"),n="propIcon/"+m.default.powers.dict.get(t[e].propID).icon,r=g.TextureLoader.inst.getSpriteFrame(g.ATLAS_TYPE.UIATLAS,n);r&&(a.getComponent(cc.Sprite).spriteFrame=r);var s=this.rewardItem[e].getChildByName("num");if(s.getComponent(cc.Label).string=t[e].number.toString(),s.active=!0,!p.default.getPropByID(t[e].propID))return}},e.prototype.click=function(t){var e=this,i=t.getCurrentTarget().getComponent(cc.Button);i.interactable=!1,this.video.active?(d.default.REPORT_ID="achievVideo",u.default.showVideoAds(function(t){if(1==t)e.reward(2);else{var o=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";_.default.pushToast(o),i.interactable=!0}})):this.reward()},e.prototype.reward=function(t){var e,i;void 0===t&&(t=1);try{for(var o=l(this.data),a=o.next();!a.done;a=o.next()){var n=a.value,r=p.default.getPropByID(n.propID);r&&(this.type==c.infinite?(r.number++,r.infiniteTime+=100,_.default.pushToast("\u83b7\u5f97100\u79d2\u65e0\u9650\u4f7f\u7528<"+r.propName+">\u5956\u52b1")):r.number+=n.reward*t)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}p.default.save(),_.default.pushToast("\u606d\u559c\u4f60\uff0c\u9886\u53d6\u5956\u52b1\u6210\u529f\uff01"),this.close()},e.prototype.closeAd=function(){this.adSprite.node.active=!1},e.prototype.clickAd=function(){console.log("\u70b9\u51fb\u5e7f\u544a:",this.adId),u.default.reportNativeAdClick(this.adId),HUAWEI_GAME&&this.closeAd()},e.prototype.reportAdShow=function(){u.default.reportNativeAdShow(this.adId)},s([b(cc.Label)],e.prototype,"title",void 0),s([b(cc.Node)],e.prototype,"source",void 0),s([b(cc.Node)],e.prototype,"logoBox",void 0),s([b(cc.Sprite)],e.prototype,"adSprite",void 0),s([b(cc.Node)],e.prototype,"video",void 0),s([b(cc.Label)],e.prototype,"btnLabel",void 0),s([b([cc.Node])],e.prototype,"rewardItem",void 0),s([v],e)}(f.GamePopBase);n.default=w,cc._RF.pop()},{}],AiSystem:[function(t,e,i){"use strict";cc._RF.push(e,"34ed8sHs5hGCpC609yk/mwe","AiSystem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.AiSystemKingdom=n.AiSystemCity=n.AiSystemActor=void 0;var s=a("BehaviourActionBase"),l=function(){function t(e){this.jobs_library=null,this.task_library=null,this.action_index=0,this.task_index=0,this.job=null,this.task=null,this.action=null,this.ai_object=null,this.nextJobDelegate=null,this.jobSetStartAction=null,this.jobSetEndAction=null,this.clearAction=null,this.taskSwitchedAction=null,this.ai_object=e,this.nextJobDelegate=t.nextJobDefault}return t.prototype.updateNewBehJob=function(){if(!this.job){var t=this.nextJobDelegate();this.setJob(t)}if(this.job){this.task_index>this.job.tasks.length-1&&(this.task_index=0);var e=this.job.tasks[this.task_index++],i=!0;if(e.conditions&&e.conditions.length>0)for(var o=0;o<e.conditions.length&&(i=e.conditions[o].check(this.ai_object));o++);i?this.setTask(e.id):this.setTask("nothing")}},t.prototype.setTask=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),e&&this.clearBeh(),i&&(this.job=null,this.task_index=0),this.task=this.task_library.get(t),this.action_index=0,this.taskSwitchedAction&&this.taskSwitchedAction()},t.prototype.restartJob=function(){this.action_index=0,this.task_index=0},t.prototype.clearBeh=function(){this.clearAction&&this.clearAction()},t.prototype.setJob=function(t){this.jobSetStartAction&&this.jobSetStartAction(),this.job=t?this.jobs_library.get(t):null,this.task_index=0,this.jobSetEndAction&&this.jobSetEndAction()},t.prototype.logicUpdate=function(){if(this.task)if(this.action_index>this.task.list.length-1)this.setTaskBehFinished();else switch(this.action=this.task.get(this.action_index),this.action.startExecute(this.ai_object)){case s.BehResult.Continue:this.action_index++;break;case s.BehResult.Stop:this.setTaskBehFinished();break;case s.BehResult.RestartTask:this.action_index=0;break;case s.BehResult.RepeatStep:case s.BehResult.Skip:}else this.updateNewBehJob()},t.prototype.setTaskBehFinished=function(){this.task=null,this.action_index=-1,this.taskSwitchedAction&&this.taskSwitchedAction()},t.nextJobDefault=function(){return""},t}();n.default=l;var c=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e}(l);n.AiSystemActor=c;var d=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e}(l);n.AiSystemCity=d;var u=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e}(l);n.AiSystemKingdom=u,cc._RF.pop()},{}],AntimatterBombEffect:[function(t,e,i){"use strict";cc._RF.push(e,"4ba1bWzcWJPvZmlynS5DtKH","AntimatterBombEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MapAction"),c=a("SpriteAnimation"),d=a("AssetManager"),u=a("TerraformLibrary"),h=a("TileLibrary"),p=a("BaseEffect"),f=a("Brush"),_=a("GameAudio"),m=a("MapBox"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.used=!1,e.godPower=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.onLoad=function(){this.spriteAnimation=this.getComponent(c.SpriteAnimation)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),m.default.inst.startShake(),this.spriteAnimation.currentFrameIndex>=15&&!this.used&&(this.used=!0,m.default.inst.applyForce(this.tile,10,0,!0,!1,1e3),m.default.inst.loopWithBrush(this.tile,f.default.getBrushBySize(11),this.tileAntimatter,"antimatter"))},e.prototype.tileAntimatter=function(t){return l.default.terraformMain(t,h.default.pit_deep_ocean,u.default.destroy_no_flash),!0},e.prototype.spawn=function(t){this.tile=t,this.used=!1,this.godPower=d.default.powers.get("tileDeepOcean"),this.prepare(t,1),this.spriteAnimation.resetAnim(),_.default.playAntimatterBomb()},s([y],e)}(p.default));n.default=v,cc._RF.pop()},{}],Ant:[function(t,e,i){"use strict";cc._RF.push(e,"e1c86qsurxM2YqnpBC6DfiH","Ant");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MapAction"),c=a("AssetManager"),d=a("TerraformLibrary"),u=a("TileLibrary"),h=a("BaseActorComponent"),p=a("Brush"),f=a("ToolBox"),_=a("GameAudio"),m=a("MapBox"),g=a("ActorAsset"),y=cc._decorator,v=y.ccclass,b=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stepsMin=0,e.stepsMax=0,e.nextTile=null,e.printTileOrigin=null,e.printTick=0,e.currentPrint=null,e.randomSteps=0,e.spiderChangedDirection=!1,e.redAntTileType1="",e.redAntTileType2="",e.antMode=0,e.antCounter=0,e.antSteps=0,e.changeDir=3,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.currentDirection=g.ActorDirection.Up,this.stepsMin=f.Toolbox.randomInt(1,6),this.stepsMax=f.Toolbox.randomInt(10,60)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),"sandSpider"==this.actor.stats.id?this.sandSpider():"worm"==this.actor.stats.id?this.updateWorm():"printer"==this.actor.stats.id?this.updatePrinter():this.chooseAntAction()},e.prototype.updatePrinter=function(){if(this.currentPrint)for(var t=0;t<this.currentPrint.stepsPerTick;t++)this.printStep()},e.prototype.setPrintTemplate=function(t){this.currentPrint=t,this.printTileOrigin=this.actor.currentTile},e.prototype.printStep=function(){if(this.printTick>=this.currentPrint.steps.length)this.actor.killHimself(!1,g.AttackType.None,!1);else{var t=this.currentPrint.steps[this.printTick],e=m.default.inst.getTile(this.printTileOrigin.pos.x+t.x,this.printTileOrigin.pos.y+t.y);e&&(this.actor.spawnOn(e),this.printTile()),this.printTick++}},e.prototype.printTile=function(){_.default.playPrint1(this.node.position),this.actor.currentTile.top_type&&l.default.decreaseTile(this.actor.currentTile),this.actor.currentTile.type.increaseTo&&(l.default.terraformMain(this.actor.currentTile,this.actor.currentTile.type.increaseTo,c.default.terraform.get("destroy")),m.default.inst.setTileDirty(this.actor.currentTile,!0)),m.default.inst.conwayLayer.remove(this.actor.currentTile)},e.prototype.chooseAntAction=function(){switch(this.actor.stats.id){case"antBlack":this.antBlack();break;case"antGreen":this.antGreen();break;case"antBlue":this.antBlue();break;case"antRed":this.antRed()}},e.prototype.antAction=function(t){var e,i,o,a,n,r,s,l,c,d,u,h,p,_,m,y,v;"worm"==this.actor.stats.id?(t<0&&(t=f.Toolbox.directions_all.length-1),t==f.Toolbox.directions_all.length&&(t=0),v=f.Toolbox.directions_all[t]):(t<0&&(t=f.Toolbox.directions.length-1),t==f.Toolbox.directions.length&&(t=0),v=f.Toolbox.directions[t]);var b=null;switch(v){case g.ActorDirection.Up:(b=null===(e=this.actor.currentTile)||void 0===e?void 0:e.tile_up)||(b=this.actor.currentTile.tile_down);break;case g.ActorDirection.UpRight:(b=null===(o=null===(i=this.actor.currentTile)||void 0===i?void 0:i.tile_up)||void 0===o?void 0:o.tile_right)||(b=null===(a=this.actor.currentTile.tile_down)||void 0===a?void 0:a.tile_left);break;case g.ActorDirection.UpLeft:(b=null===(r=null===(n=this.actor.currentTile)||void 0===n?void 0:n.tile_up)||void 0===r?void 0:r.tile_left)||(b=null===(s=this.actor.currentTile.tile_down)||void 0===s?void 0:s.tile_right);break;case g.ActorDirection.Right:(b=null===(l=this.actor.currentTile)||void 0===l?void 0:l.tile_right)||(b=this.actor.currentTile.tile_left);break;case g.ActorDirection.Down:(b=null===(c=this.actor.currentTile)||void 0===c?void 0:c.tile_down)||(b=this.actor.currentTile.tile_up);break;case g.ActorDirection.DownRight:(b=null===(u=null===(d=this.actor.currentTile)||void 0===d?void 0:d.tile_down)||void 0===u?void 0:u.tile_right)||(b=null===(h=this.actor.currentTile.tile_up)||void 0===h?void 0:h.tile_left);break;case g.ActorDirection.DownLeft:(b=null===(_=null===(p=this.actor.currentTile)||void 0===p?void 0:p.tile_down)||void 0===_?void 0:_.tile_left)||(b=null===(m=this.actor.currentTile.tile_up)||void 0===m?void 0:m.tile_right);break;case g.ActorDirection.Left:(b=null===(y=this.actor.currentTile)||void 0===y?void 0:y.tile_left)||(b=this.actor.currentTile.tile_right)}this.moveTo(b)},e.prototype.getNewDirection=function(t){var e,i,o,a,n,r,s,l,c,d,u,h;return(null===(e=this.actor.currentTile)||void 0===e?void 0:e.tile_up)==t?g.ActorDirection.Up:(null===(o=null===(i=this.actor.currentTile)||void 0===i?void 0:i.tile_up)||void 0===o?void 0:o.tile_right)==t?g.ActorDirection.UpRight:(null===(n=null===(a=this.actor.currentTile)||void 0===a?void 0:a.tile_up)||void 0===n?void 0:n.tile_left)==t?g.ActorDirection.UpLeft:(null===(r=this.actor.currentTile)||void 0===r?void 0:r.tile_down)==t?g.ActorDirection.Down:(null===(l=null===(s=this.actor.currentTile)||void 0===s?void 0:s.tile_down)||void 0===l?void 0:l.tile_right)==t?g.ActorDirection.DownRight:(null===(d=null===(c=this.actor.currentTile)||void 0===c?void 0:c.tile_down)||void 0===d?void 0:d.tile_left)==t?g.ActorDirection.DownLeft:(null===(u=this.actor.currentTile)||void 0===u?void 0:u.tile_left)==t?g.ActorDirection.Left:(null===(h=this.actor.currentTile)||void 0===h?void 0:h.tile_right)==t?g.ActorDirection.Right:g.ActorDirection.Up},e.prototype.getNextTileBasedOnDirection=function(t,e){var i,o,a,n,r=null;return e==g.ActorDirection.Up&&(r=null==t?void 0:t.tile_up),g.ActorDirection.UpRight==e&&(r=null===(i=null==t?void 0:t.tile_up)||void 0===i?void 0:i.tile_right),g.ActorDirection.UpLeft==e&&(r=null===(o=null==t?void 0:t.tile_up)||void 0===o?void 0:o.tile_left),g.ActorDirection.Down==e&&(r=null==t?void 0:t.tile_down),g.ActorDirection.DownRight==e&&(r=null===(a=null==t?void 0:t.tile_down)||void 0===a?void 0:a.tile_right),g.ActorDirection.DownLeft==e&&(r=null===(n=null==t?void 0:t.tile_down)||void 0===n?void 0:n.tile_left),g.ActorDirection.Left==e&&(r=null==t?void 0:t.tile_left),g.ActorDirection.Right==e&&(r=null==t?void 0:t.tile_right),r||(null==t?void 0:t.tile_up)},e.prototype.moveTo=function(t){this.currentDirection=this.getNewDirection(t),this.nextTile=this.getNextTileBasedOnDirection(t,this.currentDirection),this.nextTile&&(this.nextTile=this.getNextTileBasedOnDirection(this.nextTile,this.currentDirection)),this.nextTile&&(this.nextTile=this.getNextTileBasedOnDirection(this.nextTile,this.currentDirection)),this.nextTile&&!this.nextTile.type.block?this.actor.moveTo(t):this.currentDirection=this.getNewDirection(t)},e.tileDrawWorm=function(t){return l.default.wormTile(t,4),!0},e.prototype.updateWorm=function(){(0==this.antSteps||this.antSteps>this.randomSteps)&&(this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions_all),this.randomSteps=f.Toolbox.randomInt(this.stepsMin,this.stepsMax),this.antSteps=1);var t=f.Toolbox.directions_all.indexOf(this.currentDirection);this.actor.currentTile.height<220&&m.default.inst.loopWithBrush(this.actor.currentTile,p.default.getBrushBySize(2),i.tileDrawWorm,"worm"),this.antAction(t),this.antSteps++},e.prototype.sandSpider=function(){0==this.antSteps?this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions):this.actor.currentTile.type.isType("sand")&&!this.spiderChangedDirection&&(this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions),this.spiderChangedDirection=!0);var t=f.Toolbox.directions.indexOf(this.currentDirection);this.actor.currentTile.type.isType("sand")||(this.spiderChangedDirection=!1),this.antUseOnTile(this.actor.currentTile,"sand"),this.antAction(t),this.antSteps++,this.antSteps>20&&this.actor.killHimself(!1,g.AttackType.None,!1)},e.prototype.antBlue=function(){var t=f.Toolbox.directions.indexOf(this.currentDirection),e="";this.actor.currentTile.type.liquid?(e="sand",t++):(e="shallow_waters",t--),this.antUseOnTile(this.actor.currentTile,e),this.antAction(t)},e.prototype.antRed=function(){this.redAntTileType1||(this.redAntTileType1=u.default.getRandomTileType(),this.redAntTileType2=u.default.getRandomTileType(this.redAntTileType1));var t=f.Toolbox.directions.indexOf(this.currentDirection);0==this.antSteps&&(t=f.Toolbox.directions.indexOf(this.currentDirection)),this.actor.currentTile.type.isType(this.redAntTileType2)?(this.antUseOnTile(this.actor.currentTile,this.redAntTileType1),this.antSteps++>3&&(t++,this.antSteps=0)):(this.antUseOnTile(this.actor.currentTile,this.redAntTileType2),this.antSteps++>3&&(t--,this.antSteps=0)),this.antAction(t)},e.prototype.antGreen=function(){var t=f.Toolbox.directions.indexOf(this.currentDirection),e="";this.actor.currentTile.type.liquid?(e="sand",t--):this.actor.currentTile.type.isType("sand")?(e="soil_low",t++):this.actor.currentTile.type.isType("soil_low")?(e="soil_high",t--):this.actor.currentTile.type.isType("forest")?(e="soil_low",t++):(e="sand",t--),this.antUseOnTile(this.actor.currentTile,e),this.antAction(t)},e.prototype.antBlack=function(){var t=f.Toolbox.directions.indexOf(this.currentDirection);if(0==this.antMode){if(this.actor.currentTile.type.liquid&&(this.antCounter=20),this.antCounter>0){var e="";this.actor.currentTile.type.isType("mountains")?(e="hills",t--):(e="mountains",t++),this.antUseOnTile(this.actor.currentTile,e),this.antCounter--}0==this.antCounter&&(this.antCounter=40,this.antMode=1,this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions),t=f.Toolbox.directions.indexOf(this.currentDirection))}else this.antCounter>0&&(this.antCounter--,this.actor.currentTile.type.isType("mountains")||this.actor.currentTile.type.isType("hills")?(this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions),t=f.Toolbox.directions.indexOf(this.currentDirection)):(this.antUseOnTile(this.actor.currentTile,"sand"),this.currentDirection=f.Toolbox.getRandom(f.Toolbox.directions),t=f.Toolbox.directions.indexOf(this.currentDirection)),0==this.antCounter&&(this.antMode=0));this.antAction(t)},e.prototype.antTile1=function(){var t=f.Toolbox.directions.indexOf(this.currentDirection);this.changeDir--;var e=t,i="";this.actor.currentTile.type.isType("forest")?(i="soil_low",t++):this.actor.currentTile.type.liquid?(i="sand",t++):(i="forest",t--),this.antUseOnTile(this.actor.currentTile,i),this.changeDir>0?t=e:this.changeDir=2,this.antAction(t)},e.prototype.antUseOnTile=function(t,e){l.default.terraformMain(t,c.default.tiles.get(e),d.default.destroy)},i=s([v],e)}(h.default));n.default=b,cc._RF.pop()},{}],AppBoxView:[function(t,e,i){"use strict";cc._RF.push(e,"79f7aoPZsxF+7BhSfy8x20Y","AppBoxView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AdsManager"),c=a("GamePopBase"),d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.close=function(){t.prototype.close.call(this),l.default.closeAppBoxAd()},s([u],e)}(c.GamePopBase));n.default=h,cc._RF.pop()},{}],AssetLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"9ef8c0WabBN4ohVDr1vg4LG","AssetLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.BaseAssetLibrary=n.Asset=void 0;var s=a("Log"),l=a("SaveUtils"),c=function(){function t(){this.id="ASSET_ID"}return t.prototype.create=function(){},t}();n.Asset=c;var d=function(){function t(){this.id="ASSET_LIBRARY"}return t.prototype.init=function(){},t.prototype.saveAssets=function(){var t=JSON.stringify(this);l.default.set("/modules/core/"+this.id,t)},t.prototype.checkCache=function(){},t}();n.BaseAssetLibrary=d;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=new Array,e.dict=new Map,e.t=null,e}return r(e,t),e.prototype.get=function(t){return this.dict.get(t)},e.prototype.add=function(t){var e=t.id;if(this.dict.has(e)){for(var i=0;i<this.list.length;i++)if(this.list[i].id==e){this.list.splice(i,1);break}this.dict.delete(e),s.default.d("["+this.id+"] found new asset to replace... "+e)}return this.t=t,this.t.create(),this.list.push(t),this.dict.set(e,t),t},e.prototype.clone=function(){return null},e}(d);n.default=u,cc._RF.pop()},{}],AssetManager:[function(t,e,i){"use strict";cc._RF.push(e,"06c6ebna2lJAYeIFyQyfjwT","AssetManager");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("ItemGenerator"),s=o("ActorJobLibrary"),l=o("ActorStatsLibrary"),c=o("ActorTraitLibrary"),d=o("BehaviourTaskActorLibrary"),u=o("BehaviourTaskCityLibrary"),h=o("BehaviourTaskKingdomLibrary"),p=o("BuildingLibrary"),f=o("ChineseNameLibrary"),_=o("CityJobLibrary"),m=o("CultureTechLibrary"),g=o("DisasterLibrary"),y=o("DropsLibrary"),v=o("ItemAccessoryMaterialLibrary"),b=o("ItemArmorMaterialLibrary"),w=o("ItemLibrary"),T=o("ItemPrefixLibrary"),k=o("ItemSuffixLibrary"),B=o("ItemWeaponMaterialLibrary"),S=o("KingdomJobLibrary"),C=o("KingdomLibrary"),x=o("MoodLibrary"),A=o("NameGeneratorLibrary"),P=o("PersonalityLibrary"),O=o("PowerLibrary"),R=o("ProfessionLibrary"),F=o("ProjectileLibrary"),L=o("RaceLibrary"),D=o("ResourceLibrary"),M=o("SpellLibrary"),I=o("StatusLibrary"),j=o("TerraformLibrary"),E=o("TileLibrary"),N=o("TopTileLibrary"),z=function(){function t(){var e,i;this.list=[],this.dict=new Map,this.add(t.tiles=new E.default,"tiles"),this.add(t.topTiles=new N.default,"cap_tiles"),this.add(t.culture_tech=new m.default,"culture_tech"),this.add(t.professions=new R.default,"professions"),this.add(t.personalities=new P.default,"personalities"),this.add(t.moods=new x.default,"moods"),this.add(t.drops=new y.default,"drops"),this.add(t.buildings=new p.default,"buildings"),this.add(t.status=new I.default,"status"),this.add(t.spells=new M.default,"spells"),this.add(t.tasks_actor=new d.default,"beh"),this.add(t.tasks_city=new u.default,"beh_city"),this.add(t.tasks_kingdom=new h.default,"beh_kingdom"),this.add(t.kingdoms=new C.default,"kingdoms"),this.add(t.raceLibrary=new L.default,"race"),this.add(t.unitStats=new l.default,"units"),this.add(t.nameGenerator=new A.default,"name_generator"),this.add(t.chineseName=new f.default,"chinese_name"),this.add(t.disasters=new g.default,"disasters"),this.add(t.traits=new c.default,"traits"),this.add(t.job_actor=new s.default,"jobs_actor"),this.add(t.job_city=new _.default,"jobs_city"),this.add(t.job_kingdom=new S.default,"jobs_kingdom"),this.add(t.powers=new O.default,"powers"),this.add(t.items=new w.default,"items"),this.add(t.items_prefix=new T.default,"items_prefix"),this.add(t.items_suffix=new k.default,"items_suffix"),this.add(t.items_material_weapon=new B.default,"items_material_weapon"),this.add(t.items_material_armor=new b.default,"items_material_armor"),this.add(t.items_material_accessory=new v.default,"items_material_jewelry"),this.add(t.resources=new D.default,"resources"),this.add(t.terraform=new j.default,"terraform"),this.add(t.projectiles=new F.default,"projectiles"),r.default.init();try{for(var o=n(this.list),a=o.next();!a.done;a=o.next())a.value.checkCache()}catch(z){e={error:z}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}}return t.init=function(){t.inst=new t},t.prototype.add=function(t,e){t.init(),this.list.push(t),this.dict.set(e,t),t.id=e},t.inst=null,t.job_kingdom=null,t.tasks_kingdom=null,t.job_city=null,t.tasks_city=null,t.job_actor=null,t.tasks_actor=null,t.culture_tech=null,t.moods=null,t.personalities=null,t.professions=null,t.drops=null,t.buildings=null,t.unitStats=null,t.traits=null,t.kingdoms=null,t.nameGenerator=null,t.chineseName=null,t.disasters=null,t.raceLibrary=null,t.resources=null,t.items=null,t.items_prefix=null,t.items_suffix=null,t.items_material_weapon=null,t.items_material_armor=null,t.items_material_accessory=null,t.projectiles=null,t.tiles=null,t.topTiles=null,t.terraform=null,t.powers=null,t.spells=null,t.status=null,t}();a.default=z,cc._RF.pop()},{}],AwardView:[function(t,e,i){"use strict";cc._RF.push(e,"c472190yXxNaLVFP1d6T6pX","AwardView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.Reward_type=void 0;var c,d=a("AdsManager"),u=a("RewardData"),h=a("UserData"),p=a("GamePopBase"),f=a("MsgCache"),_=a("AssetManager"),m=a("TextureLoader");(function(t){t[t.online=0]="online",t[t.sign=1]="sign",t[t.cumulative=2]="cumulative",t[t.luckyWheel=3]="luckyWheel",t[t.boxMonster=4]="boxMonster",t[t.collect=5]="collect",t[t.achiev=6]="achiev",t[t.vedio=7]="vedio",t[t.mystery=8]="mystery",t[t.share=9]="share",t[t.boxGift=10]="boxGift"})(c=n.Reward_type||(n.Reward_type={}));var g=["\u5728\u7ebf\u5956\u52b1","\u7b7e\u5230\u5956\u52b1","\u7d2f\u8ba1\u5956\u52b1","\u5e78\u8fd0\u8f6c\u76d8","\u7a00\u6709\u5b9d\u7bb1\u602a","\u6536\u85cf\u6709\u793c","\u6210\u5c31\u5956\u52b1","\u89c6\u9891\u5956\u52b1","\u795e\u79d8\u793c\u7269","\u5206\u4eab\u5956\u52b1","\u76d2\u5b50\u793c\u7269"],y=cc._decorator,v=y.ccclass,b=y.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.source=null,e.rewardItem=[],e.btnShare=null,e.data=[],e.type=c.online,e.guiding=!1,e}return r(e,t),Object.defineProperty(e.prototype,"isGuiding",{set:function(t){this.guiding=t},enumerable:!1,configurable:!0}),e.prototype.init=function(t,e){var i,o;this.type=t,this.btnShare.active=QQ_GAME&&t==c.achiev,this.source.string=g[t];try{for(var a=l(this.rewardItem),n=a.next();!n.done;n=a.next())n.value.active=!1}catch(d){i={error:d}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}this.data="number"==typeof e?u.default.getRewards(e):Array.from(e),this.showReward(this.data)},e.prototype.showReward=function(t){for(var e=0;e<t.length;e++)if(this.rewardItem[e]){this.rewardItem[e].active=!0,this.rewardItem[e].getChildByName("name").getComponent(cc.Label).string=t[e].propName;var i=this.rewardItem[e].getChildByName("rare");i.active=t[e].rare>=0;var o=m.TextureLoader.inst.getSpriteFrame(m.ATLAS_TYPE.UIATLAS,"reward/rare_"+t[e].rare);o&&(i.getComponent(cc.Sprite).spriteFrame=o);var a=this.rewardItem[e].getChildByName("icon"),n="propIcon/"+_.default.powers.dict.get(t[e].propID).icon,r=m.TextureLoader.inst.getSpriteFrame(m.ATLAS_TYPE.UIATLAS,n);r&&(a.getComponent(cc.Sprite).spriteFrame=r);var s=this.rewardItem[e].getChildByName("num");s.getComponent(cc.Label).string=t[e].reward.toString(),s.active=!1,h.default.getPropByID(t[e].propID)&&(s.active=!0)}},e.prototype.sure=function(){for(var t=0;t<this.data.length;t++){var e=h.default.getPropByID(this.data[t].propID);e&&(e.number+=this.data[t].reward)}h.default.save(),this.close()},e.prototype.share=function(){var t=this;d.default.shareAppMessage({title:"\u5f53\u4e00\u6b21\u4e0a\u5e1d\uff0c\u521b\u9020\u8fd8\u662f\u6bc1\u706d\u7531\u4f60\u51b3\u5b9a",imageUrl:"share.png",success:function(){f.default.pushToast("\u83b7\u5f97\u53cc\u500d\u5956\u52b1\uff01");for(var e=0;e<t.data.length;e++){var i=h.default.getPropByID(t.data[e].propID);i&&(i.number+=2*t.data[e].reward)}h.default.save(),t.close()},fail:function(){f.default.pushToast("\u5206\u4eab\u5931\u8d25\uff01")}})},s([b(cc.Label)],e.prototype,"source",void 0),s([b([cc.Node])],e.prototype,"rewardItem",void 0),s([b(cc.Node)],e.prototype,"btnShare",void 0),s([v],e)}(p.GamePopBase);n.default=w,cc._RF.pop()},{}],Baby:[function(t,e,i){"use strict";cc._RF.push(e,"b1ef3iiGydBi5f5emmS4R6K","Baby");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameCommon"),c=a("BaseActorComponent"),d=a("MapBox"),u=a("ActorAsset"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timerGrow=0,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.timerGrow=this.actor.stats.timeToGrow},e.prototype.logicUpdate=function(e){if(this.actor.data.alive&&!l.default.isPaused&&(t.prototype.logicUpdate.call(this,e),this.timerGrow-=e,this.timerGrow<=0)){var i=d.default.inst.createNewUnit(this.actor.stats.growIntoID,this.actor.currentTile);i.startBabymakingTimeout(),i.data.hunger=i.stats.maxHunger/2,d.default.inst.gameStats.creaturesBorn--,this.actor.stats.unit&&(this.actor.city&&this.actor.city.addNewUnit(i),i.setKingdom(this.actor.kingdom)),i.data.diplomacy=this.actor.data.diplomacy,i.data.intelligence=this.actor.data.intelligence,i.data.stewardship=this.actor.data.stewardship,i.data.warfare=this.actor.data.warfare,i.data.culture=this.actor.data.culture,i.data.experience=this.actor.data.experience,i.data.level=this.actor.data.level,i.data.firstName=this.actor.data.firstName,-1!=this.actor.data.skin&&(i.data.skin=this.actor.data.skin),-1!=this.actor.data.skin_set&&(i.data.skin_set=this.actor.data.skin_set),i.data.age=this.actor.data.age,i.data.bornTime=this.actor.data.bornTime,i.data.health=this.actor.data.health,i.data.gender=this.actor.data.gender,i.data.kills=this.actor.data.kills,this.actor.data.traits.forEach(function(t){"peaceful"!=t&&i.addTrait(t)}),this.actor.data.favorite&&(i.data.favorite=!0),this.actor.killHimself(!0,u.AttackType.GrowUp,!1,!1)}},s([p],e)}(c.default));n.default=f,cc._RF.pop()},{}],BaseActorComponent:[function(t,e,i){"use strict";cc._RF.push(e,"30021k+fMtO6qkKlDHSLF6J","BaseActorComponent");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actor=null,e}return r(e,t),e.prototype.create=function(){this.actor=this.getComponent("Actor"),t.prototype.create.call(this)},e}(a("BaseMapObject").default);n.default=s,cc._RF.pop()},{}],BaseAnimatedObject:[function(t,e,i){"use strict";cc._RF.push(e,"f81ecyjENlBf6PTCXjUb3de","BaseAnimatedObject");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("SpriteAnimation"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteAnimation=null,e.shadow=null,e.lastShadowPos=cc.Vec3.ZERO,e.lastShadowScale=0,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.spriteAnimation=this.node.getComponent(s.SpriteAnimation)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.updateSpriteAnimation(e)},e.prototype.updateSpriteAnimation=function(t){this.spriteAnimation&&this.spriteAnimation.logicUpdate(t)},e.prototype.resetShadow=function(){this.lastShadowPos=cc.Vec3.ZERO,this.lastShadowScale=0},e.prototype.checkShadowPosition=function(t){this.lastShadowPos.x==t.x&&this.lastShadowPos.y==t.y||(this.lastShadowPos.set(t),this.shadow.node.position=this.lastShadowPos);var e=this.node.scale;this.lastShadowScale!=e&&(this.lastShadowScale=e,this.shadow.node.scale=e)},e}(a("BaseMapObject").default);n.default=l,cc._RF.pop()},{}],BaseBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"eaf4cCoDhBGzrGOgBKREbr3","BaseBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.BuildingAnimationUpdated=n.BaseBuildingComponent=n.BuildingContainer=n.BuildingSprites=n.BuildingAnimationData=n.BuildingSpriteAnimation=n.BuildingData=n.ConstructionCost=n.BuildingFundament=n.CreepWorkerMovementType=n.VegetationType=n.BuildingAnimationState=n.BuildPlacingType=n.BuildingPlacements=n.BuildingType=n.BuildingState=void 0;var s,l=a("SpriteAnimation"),c=a("BaseContainer"),d=a("BaseObjectData"),u=cc._decorator;u.ccclass,u.property,function(t){t[t.Null=0]="Null",t[t.Normal=1]="Normal",t[t.CivKingdom=2]="CivKingdom",t[t.CivAbandoned=3]="CivAbandoned",t[t.Ruins=4]="Ruins",t[t.Removed=5]="Removed"}(s=n.BuildingState||(n.BuildingState={})),function(t){t[t.None=0]="None",t[t.Tree=1]="Tree",t[t.Stone=2]="Stone",t[t.Ore=3]="Ore",t[t.Gold=4]="Gold",t[t.Fruits=5]="Fruits",t[t.Wheat=6]="Wheat",t[t.Plant=7]="Plant"}(n.BuildingType||(n.BuildingType={})),function(t){t[t.Random=0]="Random",t[t.Center=1]="Center"}(n.BuildingPlacements||(n.BuildingPlacements={})),function(t){t[t.New=0]="New",t[t.Load=1]="Load"}(n.BuildPlacingType||(n.BuildPlacingType={})),function(t){t[t.Normal=0]="Normal",t[t.OnRuin=1]="OnRuin",t[t.OnRemove=2]="OnRemove"}(n.BuildingAnimationState||(n.BuildingAnimationState={})),function(t){t[t.Trees=0]="Trees",t[t.Plants=1]="Plants"}(n.VegetationType||(n.VegetationType={})),function(t){t[t.RandomNeighbourAll=0]="RandomNeighbourAll",t[t.RandomNeighbour=1]="RandomNeighbour",t[t.Direction=2]="Direction"}(n.CreepWorkerMovementType||(n.CreepWorkerMovementType={})),n.BuildingFundament=function(t,e,i,o){this.left=0,this.right=0,this.top=0,this.bottom=0,this.left=t,this.right=e,this.top=i,this.bottom=o},n.ConstructionCost=function(t,e,i,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===o&&(o=0),this.wood=0,this.stone=0,this.metals=0,this.gold=0,this.wood=t,this.stone=e,this.metals=i,this.gold=o};var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=s.Null,e.mainX=0,e.mainY=0,e.templateID="",e.cityID="",e.underConstruction=!0,e.spawnPixelActive=!0,e.objectID="",e.progress=0,e.frameID=-1,e.resourceNum=0,e}return r(e,t),e}(d.default);n.BuildingData=h;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.building=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.building=this.node.parent.getComponent("Building")},e.prototype.applyCurrentSpriteGraphics=function(e){var i;t.prototype.applyCurrentSpriteGraphics.call(this,e),null===(i=this.building)||void 0===i||i.setMainSprite(e)},e}(l.SpriteAnimation);n.BuildingSpriteAnimation=p,n.BuildingAnimationData=function(){this.animated=!1,this.main=[],this.roof=[],this.shadows=[],this.ruins=[],this.special=[]},n.BuildingSprites=function(){this.construction=null,this.construction_shadow=null,this.mapIcon=null,this.animationData=[]};var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(c.ObjectContainer);n.BuildingContainer=f;var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.building=null,e}return r(e,t),e.prototype.create=function(){this.building=this.getComponent("Building")},e.prototype.logicUpdate=function(){},e}(cc.Component);n.BaseBuildingComponent=_;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteAnimation=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this);var e=this.node.getChildByName("main");this.spriteAnimation=e.getComponent(l.SpriteAnimation)},e.prototype.logicUpdate=function(t){this.spriteAnimation.logicUpdate(t)},e}(_);n.BuildingAnimationUpdated=m,cc._RF.pop()},{}],BaseCondition:[function(t,e,i){"use strict";cc._RF.push(e,"e142c6cDz5Fu48SpaN6u5eC","BaseCondition");var o,a=i,n=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(a,"__esModule",{value:!0}),a.BehaviourKingdomCondition=a.BehaviourCityCondition=a.BehaviourActorCondition=void 0;var r=function(){function t(){}return t.prototype.check=function(){return!0},t}();a.default=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.check=function(e){return t.prototype.check.call(this,e)},e}(r);a.BehaviourActorCondition=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.check=function(e){return t.prototype.check.call(this,e)},e}(r);a.BehaviourCityCondition=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.check=function(e){return t.prototype.check.call(this,e)},e}(r);a.BehaviourKingdomCondition=c,cc._RF.pop()},{}],BaseContainer:[function(t,e,i){"use strict";cc._RF.push(e,"2188dua0gpDD4kE0o0Q76v9","BaseContainer");var o=i,a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(o,"__esModule",{value:!0}),o.ObjectContainer=o.TaskContainer=void 0;var n=function(){function t(){this.conditions=[]}return t.prototype.addCondition=function(t){this.conditions.push(t)},t}();o.TaskContainer=n;var r=function(){function t(){this._to_remove=[],this._to_add=[],this._hashSet=new Set,this._simpleListDirty=!1,this._simpleList=[]}return Object.defineProperty(t.prototype,"count",{get:function(){return this._hashSet.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._hashSet.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return Array.from(this._hashSet)},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){var e,i;try{for(var o=a(this._hashSet),n=o.next();!n.done;n=o.next())t(n.value)}catch(r){e={error:r}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t.prototype.has=function(t){return this._hashSet.has(t)},t.prototype.clear=function(){this._hashSet.clear(),this._to_add=[],this._to_remove=[],this._simpleList=[],this._simpleListDirty=!1},t.prototype.doChecks=function(){this.checkAddRemove(),this.checkSimpleListDirty()},t.prototype.checkAddRemove=function(){var t,e,i,o;if(this._to_add.length>0){this._simpleListDirty=!0;try{for(var n=a(this._to_add),r=n.next();!r.done;r=n.next()){var s=r.value;this._hashSet.add(s)}}catch(u){t={error:u}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._to_add=[]}if(!(this._to_remove.length<=0)){this._simpleListDirty=!0;try{for(var l=a(this._to_remove),c=l.next();!c.done;c=l.next()){var d=c.value;this._hashSet.delete(d)}}catch(h){i={error:h}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}this._to_remove=[]}},t.prototype.getSimpleList=function(){return this.checkSimpleListDirty(),this._simpleList},t.prototype.checkSimpleListDirty=function(){this._simpleListDirty&&(this._simpleList=Array.from(this._hashSet),this._simpleListDirty=!1)},t.prototype.getRandom=function(){return this.checkSimpleListDirty(),null==this._simpleList||0==this._simpleList.length?null:this._simpleList.getRandom()},t.prototype.add=function(t){this._to_add.push(t)},t.prototype.remove=function(t){this._to_remove.push(t)},t.prototype.putInSimpleList=function(t){var e,i;try{for(var o=a(this._hashSet),n=o.next();!n.done;n=o.next()){var r=n.value;t.push(r)}}catch(s){e={error:s}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t}();o.ObjectContainer=r,cc._RF.pop()},{}],BaseEffectController:[function(t,e,i){"use strict";cc._RF.push(e,"833327t4G9IfogdnbnK9Z9N","BaseEffectController");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GameCommon"),d=a("BaseEffect"),u=a("BaseMapObject"),h=a("ToolBox"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefab=null,e.list=[],e.timer=0,e.timer_interval=.9,e.objectLimit=0,e.useInterval=!0,e.pool=new cc.NodePool,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.getObject=function(){var t=this.pool.get();t||(t=cc.instantiate(this.prefab)),this.list.push(t);var e=t.getComponent(d.default);return this.addNewObject(e),e.create(),e.active=!0,e.state=1,e.clear(),e},e.prototype.addNewObject=function(t){t.controller=this,t.node.parent=this.node},e.prototype.killObject=function(t){t.active=!0,t.clear(),this.list.remove(t.node),this.pool.put(t.node)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.updateChildren(e),this.updateSpawn(e)},e.prototype.updateSpawn=function(t){if(!c.default.isPaused&&this.useInterval){if(this.timer>0)return void(this.timer-=t);this.timer=this.timer_interval,this.spawn()}},e.prototype.updateChildren=function(t){var e,i;try{for(var o=l(this.list),a=o.next();!a.done;a=o.next()){var n=a.value.getComponent(d.default);n.created&&n.logicUpdate(t)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},e.prototype.spawn=function(){},e.prototype.spawnNew=function(){if(this.isInLimit())return null;var t=this.getObject();return t.spriteAnimation&&t.spriteAnimation.resetAnim(),t},e.prototype.spawnAt=function(t,e){if(void 0===e&&(e=.5),this.isInLimit())return null;var i=this.getObject();return i.prepare(t,e),i},e.prototype.spawnAtRandomScale=function(t,e,i){if(void 0===e&&(e=1),void 0===i&&(i=1),this.isInLimit())return null;var o=this.getObject(),a=h.Toolbox.randomFloat(e,i);return o.prepare(t,a),o},e.prototype.isInLimit=function(){return 0!=this.objectLimit&&this.list.length>this.objectLimit},e.prototype.clear=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];this.pool.put(e)}this.list=[]},s([_({type:cc.Prefab,tooltip:"\u9884\u5236"})],e.prototype,"prefab",void 0),s([f],e)}(u.default);n.default=m,cc._RF.pop()},{}],BaseEffect:[function(t,e,i){"use strict";cc._RF.push(e,"c7e64r6ZCdJSYgoIKXOVsPO","BaseEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SpriteAnimation"),c=a("ToolBox"),d=a("WorldTile"),u=a("MapBox"),h=a("BaseAnimatedObject"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!1,e.effectIndex=0,e.STATE_START=1,e.STATE_ON_DEATH=2,e.STATE_KILLED=3,e.scale=0,e.alpha=0,e.tile=null,e.controller=null,e.state=0,e.sprRenderer=null,e.autoYZ=!1,e.callback=null,e.callbackOnFrame=-1,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.sprRenderer||(this.sprRenderer=this.getComponent(cc.Sprite)),this.node.position=cc.v3(c.Toolbox.randomRange(-50,30),c.Toolbox.randomRange(0,u.default.height)),this.state=1,this.setAlpha(255)},e.prototype.makeParentController=function(){this.node.parent=this.controller.node},e.prototype.setScale=function(t){this.scale=t,this.scale<0&&(this.scale=0),this.node.scale=t},e.prototype.prepare=function(t,e){void 0===e&&(e=1),this.state=1;var i=t instanceof cc.Vec3?t:t.posV3,o=0;this.autoYZ&&(o=i.y),this.node.angle=0,this.node.position=t instanceof d.default?cc.v3(i.x+.5,i.y,o):cc.v3(i.x,i.y,o),this.setScale(e),this.setAlpha(255),this.getComponent(l.SpriteAnimation)&&this.getComponent(l.SpriteAnimation).resetAnim()},e.prototype.setAlpha=function(t){this.alpha=t,this.node.opacity=this.alpha},e.prototype.setTile=function(t){this.tile=t,this.node.position=cc.v3(t.pos.x,t.pos.y)},e.prototype.startToDie=function(){this.state=2},e.prototype.kill=function(){this.state=3,this.controller.killObject(this)},e.prototype.clear=function(){this.callback=null,this.callbackOnFrame=-1},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),-1!=this.callbackOnFrame&&this.spriteAnimation.currentFrameIndex==this.callbackOnFrame&&(this.callback(),this.clear())},e.prototype.setCallback=function(t,e){this.callbackOnFrame=t,this.callback=e},s([_(cc.Sprite)],e.prototype,"sprRenderer",void 0),s([_({tooltip:"\u9ed8\u8ba4false"})],e.prototype,"autoYZ",void 0),s([f],e)}(h.default);n.default=m,cc._RF.pop()},{}],BaseMapObject:[function(t,e,i){"use strict";cc._RF.push(e,"f2ce1H6LutNK6md7OZQCHKV","BaseMapObject");var o,a=i,n=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(a,"__esModule",{value:!0});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentTile=null,e.zPosition=cc.Vec3.ZERO,e.currentPosition=cc.Vec3.ZERO,e.currentScale=cc.Vec3.ZERO,e.defaultScale=cc.v3(.25,.25,.25),e.created=!1,e}return n(e,t),e.prototype.create=function(){this.created=!0},e.prototype.logicUpdate=function(){},e}(cc.Component);a.default=r,cc._RF.pop()},{}],BaseObjectData:[function(t,e,i){"use strict";cc._RF.push(e,"19bbbGMdkZGfbW0S6R59z2W","BaseObjectData");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.BaseModule=void 0;var l=a("TileDictionary"),c=a("BaseMapObject"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(){function t(){this.alive=!0,this.health=100}return s([h()],t.prototype,"alive",void 0),s([h()],t.prototype,"health",void 0),s([u("BaseObjectData")],t)}();n.default=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tileDictionary=new l.TileDictionary,e}return r(e,t),e.prototype.clear=function(){},e}(c.default);n.BaseModule=f,cc._RF.pop()},{}],BaseSimObject:[function(t,e,i){"use strict";cc._RF.push(e,"6971bRHFmFLoKruCbBzNUSV","BaseSimObject");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("ActorAsset"),d=a("AssetManager"),u=a("ItemLibrary"),h=a("CachedRaycastIslands"),p=a("ToolBox"),f=a("ActiveStatusEffect"),_=a("MapLayer"),m=a("MapBox"),g=a("TextureLoader"),y=a("BaseAnimatedObject"),v=a("BaseObjectData"),b=a("BaseStats"),w=cc._decorator,T=w.ccclass,k=w.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pbEffects=null,e.targetsToIgnore=new Set,e.object_destroyed=!1,e.kingdom=null,e.city=null,e.statsDirty=!0,e.event_full_heal=!1,e.curStats=new b.default,e.a=null,e.b=null,e.objectType=_.MapObjectType.Actor,e.base_data=null,e.activeStatusEffects=null,e.activeStatus_dict=null,e.spriteRenderer=null,e._bestDist=0,e._tempDist=0,e._bestObject=null,e._bestBuilding=null,e.hash_id=0,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.hash_id=i.LAST_HASH_ID++,this.spriteRenderer=this.getComponent(cc.Sprite)},e.prototype.addStatusEffect=function(t,e){var i,o,a,n,r,s,c;if(void 0===e&&(e=-1),!(!(null===(r=this.base_data)||void 0===r?void 0:r.alive)||this.isActor()&&!this.a.stats.canHaveStatusEffect||(null===(s=this.activeStatus_dict)||void 0===s?void 0:s.has(t)))){var u=d.default.status.get(t);if(this.isActor()&&u.oppositeTraits.length>0)try{for(var h=l(u.oppositeTraits),_=h.next();!_.done;_=h.next()){var m=_.value;if(this.a.haveTrait(m))return}}catch(C){i={error:C}}finally{try{_&&!_.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}if(u.oppositeStatus.length>0)try{for(var y=l(u.oppositeStatus),v=y.next();!v.done;v=y.next()){var b=v.value;if(null===(c=this.activeStatus_dict)||void 0===c?void 0:c.has(b))return}}catch(x){a={error:x}}finally{try{v&&!v.done&&(n=y.return)&&n.call(y)}finally{if(a)throw a.error}}if(u.texture&&(!u.spriteList||0==u.spriteList.length)){var w=g.TextureLoader.inst.getSpriteFrames(g.ATLAS_TYPE.WORLDATLAS,"effects/"+u.texture);u.spriteList=Array.from(w.values())}var T=cc.instantiate(this.pbEffects).getComponent(f.default);if(T.node.parent=this.node,T.node.anchorY=.05,T.node.scale=1.67,T.create(),T.setStatus(u,this),-1!=e&&(T.timer=e),u.spriteList?(T.timeBetweenFrames=u.animation_speed+p.Toolbox.randomFloat(0,u.animation_speed_random),T.setFrames(u.spriteList)):T.isOn=!1,u.random_frame&&T.setRandomFrame(),u.random_flip){var k=p.Toolbox.randomBool()?1:-1;T.spriteRenderer.node.scaleX*=k}if(T.isOn=u.animated,T.simObject=this,T.updateZFlip(),this.setStatsDirty(),this.activeStatusEffects||(this.activeStatusEffects=[],this.activeStatus_dict=new Map),this.activeStatusEffects.push(T),this.activeStatus_dict.set(t,T),this.isActor()&&u.cancelActorJob&&this.a.cancelAllBeh(),this.isBuilding()&&T.setZFlip(-.01),u.removeStatus.length>0)for(var B=0;B<u.removeStatus.length;B++){var S=u.removeStatus[B];this.removeStatusEffect(S)}}},e.prototype.setStatsDirty=function(){this.statsDirty=!0},e.prototype.removeAllStatusEffects=function(){if(this.activeStatusEffects)for(var t=this.activeStatusEffects.length;t-- >0;){var e=this.activeStatusEffects[t];this.removeStatusEffect(e.asset.id)}},e.prototype.removeStatusEffect=function(t,e,i){var o;void 0===e&&(e=null),void 0===i&&(i=-1),(null===(o=this.activeStatus_dict)||void 0===o?void 0:o.has(t))&&(this.setStatsDirty(),e||(e=this.activeStatus_dict.get(t)),-1==i&&(i=this.activeStatusEffects.indexOf(e)),this.activeStatusEffects.splice(i,1),this.activeStatus_dict.delete(t),0==this.activeStatusEffects.length&&(this.activeStatusEffects=null,this.activeStatus_dict=null),e.node&&e.node.destroy())},e.prototype.setData=function(t){t||cc.log("BaseObjectData\u4e3a\u7a7a"),this.base_data=t},e.prototype.isActor=function(){return this.objectType==_.MapObjectType.Actor},e.prototype.isBuilding=function(){return this.objectType==_.MapObjectType.Building},e.prototype.setObjectType=function(t){this.objectType=t,this.objectType==_.MapObjectType.Actor?this.a=this:this.b=this},e.prototype.haveStatus=function(t){return!!this.activeStatus_dict&&!!this.activeStatus_dict.has(t)},e.prototype.hasAnyStatusEffect=function(){return!!this.activeStatusEffects&&this.activeStatusEffects.length>0},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.statsDirty&&this.updateStats()},e.prototype.updateStatusEffects=function(t){if(this.activeStatusEffects&&cc.isValid(this.node)&&this.activeStatusEffects)for(var e=this.activeStatusEffects.length;e-- >0&&this.activeStatusEffects.length>0;){var i=this.activeStatusEffects[e];i.logicUpdate(t),i.finished&&this.removeStatusEffect(i.asset.id,i,e)}},e.prototype.updateStats=function(){this.statsDirty=!1},e.prototype.isInLiquid=function(){return this.currentTile.type.liquid},e.prototype.isInAir=function(){return!1},e.prototype.getZ=function(){return 0},e.prototype.getHit=function(t,e,i,o,a){void 0===e&&(e=!0),void 0===i&&(i=c.AttackType.Other),void 0===o&&(o=null),void 0===a&&(a=!0)},e.prototype.findEnemyObjectTarget=function(){if(this._tempDist=0,this._bestDist=0,this._bestObject=null,p.Toolbox.temp_list_objects_enemies_chunk!=this.currentTile.chunk||p.Toolbox.temp_list_objects_enemies_kingdom!=this.kingdom){p.Toolbox.temp_list_objects_enemies=[],p.Toolbox.temp_list_objects_enemies_chunk=this.currentTile.chunk,p.Toolbox.temp_list_objects_enemies_kingdom=this.kingdom,p.Toolbox.findEnemiesOfKingdomInChunk(this.currentTile.chunk,this.kingdom);for(var t=0;t<this.currentTile.chunk.neighboursAll.length;t++)p.Toolbox.findEnemiesOfKingdomInChunk(this.currentTile.chunk.neighboursAll[t],this.kingdom)}if(p.Toolbox.temp_list_objects_enemies.length>0)for(var e=0;e<p.Toolbox.temp_list_objects_enemies.length&&(this.checkObjectList(p.Toolbox.temp_list_objects_enemies[e]),!this._bestObject);e++);return this._bestObject?this._bestObject:null},e.prototype.checkObjectList=function(t){for(var e,i=0;i<t.length;i++){var o=t[i];!(o&&o!=this&&(null===(e=o.base_data)||void 0===e?void 0:e.alive)&&this.canAttackTarget(o)&&(!this.isActor()||0!=this.a.s_attackType||o.currentTile.isSameIsland(this.currentTile)||h.default.getResult(this.currentTile,o.currentTile,this.a.stats)!=h.RaycastResult.NotPossible&&!o.currentTile.type.block&&this.currentTile.region.island.connectedWith(o.currentTile.region.island)))||o.isBuilding()&&this.kingdom.isCiv()&&o.b.stats.cityBuilding&&!o.b.stats.tower&&o.kingdom.race==this.kingdom.race||this.targetsToIgnore.has(o)||(this._tempDist=p.Toolbox.distTile(o.currentTile,this.currentTile),(!this._bestObject||this._tempDist<this._bestDist)&&(this._bestObject=o,this._bestDist=this._tempDist))}},e.prototype.canAttackTarget=function(t){var e,i;if(!(null===(e=null==t?void 0:t.node)||void 0===e?void 0:e.active))return!1;if(!(null===(i=null==t?void 0:t.base_data)||void 0===i?void 0:i.alive))return!1;var o=this.isActor(),a="",n=null;if(o?(a=this.a.race.id,n=this.a.s_attackType):(a=this.b.stats.race,n=u.WeaponType.Range),t.isActor()){var r=t.a;if(!r.stats.canBeKilledByStuff)return!1;if(r.ai.action&&r.ai.action.special_inside_object)return!1;if(!r.kingdom.asset.mad&&!this.kingdom.asset.mad&&!m.default.inst.worldLaws.world_law_angry_civilians.boolVal){if(r.race.id==a&&r.professionAsset.is_civilian)return!1;if(r.race.id==a&&o&&this.a.professionAsset.is_civilian)return!1}if(t.a.isInAir()&&n==u.WeaponType.Melee)return!1}else{var s=t.b;if(this.kingdom.isCiv()&&s.stats.cityBuilding&&s.stats.tower&&o&&this.a.professionAsset.is_civilian&&!m.default.inst.worldLaws.world_law_angry_civilians.boolVal&&s.kingdom.race==this.kingdom.race)return!1;if(o&&!this.a.stats.canAttackBuildings)return!!(this.a.stats.canAttackBrains&&t.kingdom&&t.kingdom.asset.brain)}if(o)if(this.a.stats.oceanCreature&&!this.a.stats.landCreature){if(!t.isInLiquid())return!1;if(!t.currentTile.isSameIsland(this.currentTile))return!1}else if(n==u.WeaponType.Melee&&t.isInLiquid()&&!this.a.stats.oceanCreature)return!1;return!0},e.prototype.getHashCode=function(){return this.hash_id},e.prototype.equals=function(t){return this.hash_id==t.hash_id},e.LAST_HASH_ID=0,s([k(cc.Prefab)],e.prototype,"pbEffects",void 0),s([k({type:cc.Enum(_.MapObjectType)})],e.prototype,"objectType",void 0),s([k(v.default)],e.prototype,"base_data",void 0),i=s([T],e)}(y.default);n.default=B,cc._RF.pop()},{}],BaseStats:[function(t,e,i){"use strict";cc._RF.push(e,"e2b4ffnlTVH1awqY428OVyE","BaseStats");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MathUtils"),r=function(){function t(){this.personality_aggression=0,this.personality_administration=0,this.personality_diplomatic=0,this.personality_rationality=0,this.diplomacy=0,this.warfare=0,this.stewardship=0,this.intelligence=0,this.army=0,this.cities=0,this.zones=0,this.bonus_towers=0,this.s_crit_chance=0,this.damage=0,this.speed=0,this.health=0,this.armor=0,this.dodge=0,this.accuracy=0,this.targets=0,this.projectiles=0,this.crit=0,this.damageCritMod=0,this.range=0,this.size=0,this.areaOfEffect=0,this.attackSpeed=0,this.knockback=0,this.loyalty_traits=0,this.loyalty_mood=0,this.opinion=0,this.knockbackReduction=0,this.mod_health=0,this.mod_damage=0,this.mod_armor=0,this.mod_crit=0,this.mod_diplomacy=0,this.mod_speed=0,this.mod_attackSpeed=0,this.scale=0,this.mod_supply_timer=0}return t.prototype.addStats=function(t){this.personality_rationality+=t.personality_rationality,this.personality_aggression+=t.personality_aggression,this.personality_diplomatic+=t.personality_diplomatic,this.personality_administration+=t.personality_administration,this.opinion+=t.opinion,this.loyalty_traits+=t.loyalty_traits,this.loyalty_mood+=t.loyalty_mood,this.scale+=t.scale,this.damage+=t.damage,this.attackSpeed+=t.attackSpeed,this.speed+=t.speed,this.health+=t.health,this.armor+=t.armor,this.diplomacy+=t.diplomacy,this.warfare+=t.warfare,this.stewardship+=t.stewardship,this.intelligence+=t.intelligence,this.army+=t.army,this.cities+=t.cities,this.zones+=t.zones,this.bonus_towers+=t.bonus_towers,this.dodge+=t.dodge,this.accuracy+=t.accuracy,this.targets+=t.targets,this.projectiles+=t.projectiles,this.crit+=t.crit,this.damageCritMod+=t.damageCritMod,this.range+=t.range,this.size+=t.size,this.areaOfEffect+=t.areaOfEffect,this.knockback+=t.knockback,this.knockbackReduction+=t.knockbackReduction,this.mod_health+=t.mod_health,this.mod_damage+=t.mod_damage,this.mod_armor+=t.mod_armor,this.mod_crit+=t.mod_crit,this.mod_diplomacy+=t.mod_diplomacy,this.mod_speed+=t.mod_speed,this.mod_supply_timer+=t.mod_supply_timer},t.prototype.clear=function(){this.s_crit_chance=0,this.personality_rationality=0,this.personality_aggression=0,this.personality_diplomatic=0,this.personality_administration=0,this.opinion=0,this.loyalty_mood=0,this.loyalty_traits=0,this.mod_supply_timer=0,this.scale=0,this.damage=0,this.attackSpeed=0,this.projectiles=0,this.speed=0,this.health=0,this.armor=0,this.diplomacy=0,this.warfare=0,this.stewardship=0,this.intelligence=0,this.army=0,this.cities=0,this.zones=0,this.bonus_towers=0,this.dodge=0,this.accuracy=0,this.targets=0,this.crit=0,this.damageCritMod=0,this.range=0,this.size=0,this.areaOfEffect=0,this.knockback=0,this.knockbackReduction=0,this.mod_health=0,this.mod_damage=0,this.mod_armor=0,this.mod_crit=0,this.mod_diplomacy=0,this.mod_speed=0,this.mod_attackSpeed=0},t.prototype.normalize=function(){this.intelligence=n.default.clamp(this.intelligence,0,999),this.stewardship=n.default.clamp(this.stewardship,0,999),this.warfare=n.default.clamp(this.warfare,0,999),this.diplomacy=n.default.clamp(this.diplomacy,0,999),this.personality_aggression=n.default.clamp(this.personality_aggression,0,1),this.personality_diplomatic=n.default.clamp(this.personality_diplomatic,0,1),this.personality_administration=n.default.clamp(this.personality_administration,0,1),this.personality_rationality=n.default.clamp(this.personality_rationality,0,1)},t}();a.default=r,cc._RF.pop()},{}],BatchActors:[function(t,e,i){"use strict";cc._RF.push(e,"79d1d9XE15PPJMVVmiqr+hK","BatchActors");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(a("Batch").default);n.default=s,cc._RF.pop()},{}],BatchBuildings:[function(t,e,i){"use strict";cc._RF.push(e,"57e113jHcRH3qHtRktzfrPt","BatchBuildings");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameCommon"),l=a("MapBox"),c=a("Batch"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zone_id=0,e.zone=null,e.dirty=!1,e.c_main=null,e.c_components=null,e.c_resource_shaker=null,e.c_shake=null,e.c_position_dirty=null,e.c_status_effects=null,e.c_tiles_dirty=null,e.c_sprite_dirty=null,e.c_stats_dirty=null,e.c_auto_remove=null,e.l_parallel_scale=[],e.l_parallel_update_sprites=[],e._building=null,e._render_dirty=!1,e._last_enabled=!1,e}return r(e,t),e.prototype.createJobs=function(){this.addJob(null,this.prepare.bind(this),c.JobType.Parallel),this.c_main=this.createJob(this.updateScale.bind(this),c.JobType.Parallel),this.c_resource_shaker=this.createJob(this.updateResourceShaker.bind(this),c.JobType.Parallel),this.c_sprite_dirty=this.createJob(this.checkSpriteConstructor.bind(this),c.JobType.Parallel),this.addUpdaterOnly(this.c_main,this.updateRenderer.bind(this),c.JobType.Post),this.c_tiles_dirty=this.createJob(this.updateTilesDirty.bind(this),c.JobType.Post),this.c_auto_remove=this.createJob(this.updateAutoRemove.bind(this),c.JobType.Post),this.c_stats_dirty=this.createJob(this.updateStatsDirty.bind(this),c.JobType.Post),this.c_components=this.createJob(this.updateComponents.bind(this),c.JobType.Post),this.c_shake=this.createJob(this.updateShake.bind(this),c.JobType.Post),this.c_position_dirty=this.createJob(this.updatePositionsDirty.bind(this),c.JobType.Post),this.c_status_effects=this.createJob(this.updateStatusEffects.bind(this),c.JobType.Post),this.main=this.c_main,this.applyParallelResults.add(this.applyParallelScale.bind(this)),this.clearParallelResults.add(this.clearParallelScale.bind(this)),this.applyParallelResults.add(this.applyParallelSprites.bind(this)),this.clearParallelResults.add(this.clearParallelSprites.bind(this))},e.prototype.updateScale=function(){if(this.check(this.c_main))for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updateScale(this._elapsed)},e.prototype.updateRenderer=function(){if(this.check(this._cur_container)){var t=l.default.inst.qualityChanger.renderBuildings;if(this._last_enabled!=t&&(this._render_dirty=!0),this._render_dirty){this._last_enabled=t,this._render_dirty=!1;for(var e=0;e<this._list.length;e++)this._building=this._list[e],this._building.spriteAnimation.spriteRenderer.enabled=t}this._cur_container.checkAddRemove()}},e.prototype.applyParallelScale=function(){for(var t=0;t<this.l_parallel_scale.length;t++)this.l_parallel_scale[t].applyScale()},e.prototype.clearParallelScale=function(){this.l_parallel_scale=[]},e.prototype.updateTilesDirty=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.checkDirtyTiles();this._cur_container.checkAddRemove()}},e.prototype.updateAutoRemove=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updateAutoRemove(this._elapsed);this._cur_container.checkAddRemove()}},e.prototype.updateStatsDirty=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updateStats();this._cur_container.checkAddRemove()}},e.prototype.checkSpriteConstructor=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.checkSpriteConstructor();this._cur_container.checkAddRemove()}},e.prototype.applyParallelSprites=function(){for(var t=0;t<this.l_parallel_update_sprites.length;t++)this.l_parallel_update_sprites[t].applyConstructedSprite()},e.prototype.clearParallelSprites=function(){this.l_parallel_update_sprites=[]},e.prototype.updateComponents=function(){var t;if(this.check(this._cur_container)&&!s.default.isPaused){for(var e=0;e<this._list.length;e++)this._building=this._list[e],(null===(t=this._building.data)||void 0===t?void 0:t.alive)&&this._building.updateComponents(this._elapsed);this._cur_container.checkAddRemove()}},e.prototype.updateResourceShaker=function(){var t;if(this.check(this._cur_container)&&!s.default.isPaused){for(var e=0;e<this._list.length;e++)this._building=this._list[e],(null===(t=this._building.data)||void 0===t?void 0:t.alive)&&this._building.updateTimerShakeResources(this._elapsed);this._cur_container.checkAddRemove()}},e.prototype.updateShake=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updateShake(this._elapsed);this._cur_container.checkAddRemove()}},e.prototype.updatePositionsDirty=function(){if(this.check(this._cur_container)){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updatePosition();this._cur_container.checkAddRemove()}},e.prototype.updateStatusEffects=function(){if(this.check(this._cur_container)&&!s.default.isPaused){for(var t=0;t<this._list.length;t++)this._building=this._list[t],this._building.updateStatusEffects(this._elapsed);this._cur_container.checkAddRemove()}},e.prototype.add=function(e){t.prototype.add.call(this,e),e.batch=this,this._render_dirty=!0},e.prototype.remove=function(e){t.prototype.remove.call(this,e),e.batch=null},e}(c.default);n.default=d,cc._RF.pop()},{}],Batch:[function(t,e,i){"use strict";cc._RF.push(e,"b77a0JCqOhGZIpAF8Yxpw/0","Batch");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.JobType=a.Job=void 0;var n,r=o("WorldAction"),s=o("BaseContainer"),l=function(){this.job_updater=null,this.container=null};a.Job=l,function(t){t[t.Pre=0]="Pre",t[t.Post=1]="Post",t[t.Parallel=2]="Parallel"}(n=a.JobType||(a.JobType={}));var c=function(){function t(){this.main=null,this.free_slots=!1,this.containers=[],this.jobs_pre=[],this.jobs_post=[],this.jobs_parallel=[],this._list=[],this._elapsed=0,this._cur_container=null,this.clearParallelResults=r.default.create(),this.applyParallelResults=r.default.create()}return t.prototype.createJobs=function(){},t.prototype.updateJobsPre=function(t){this._elapsed=t;for(var e=0;e<this.jobs_pre.length;e++){var i=this.jobs_pre[e];this._cur_container=i.container,i.job_updater()}},t.prototype.updateJobsParallel=function(){for(var t=0;t<this.jobs_parallel.length;t++){var e=this.jobs_parallel[t];this._cur_container=e.container,e.job_updater()}},t.prototype.updateJobsPost=function(t){this._elapsed=t;for(var e=0;e<this.jobs_post.length;e++){var i=this.jobs_post[e];this._cur_container=i.container,i.job_updater()}},t.prototype.prepare=function(){for(var t=0;t<this.containers.length;t++)this.containers[t].doChecks()},t.prototype.createJob=function(t,e){var i=new s.ObjectContainer;return this.containers.push(i),t&&this.addJob(i,t,e),i},t.prototype.addJob=function(t,e,i){switch(i){case n.Pre:this.putJob(t,e,this.jobs_pre);break;case n.Parallel:this.putJob(t,e,this.jobs_parallel);break;case n.Post:this.putJob(t,e,this.jobs_post)}},t.prototype.putJob=function(t,e,i){var o=new l;o.container=t,o.job_updater=e,i.push(o)},t.prototype.addUpdaterOnly=function(t,e,i){this.containers.push(t),this.addJob(t,e,i)},t.prototype.clear=function(){for(var t=0;t<this.containers.length;t++)this.containers[t].clear()},t.prototype.remove=function(t){for(var e=0;e<this.containers.length;e++)this.containers[e].remove(t)},t.prototype.add=function(t){this.main.add(t)},t.prototype.check=function(t){return this._list=null,t.length>0&&(t.checkAddRemove(),this._list=t.getSimpleList(),!0)},t}();a.default=c,cc._RF.pop()},{}],Beehive:[function(t,e,i){"use strict";cc._RF.push(e,"f7e5cJ51IpJcaGLnRGqMT8l","Beehive");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.honey=0,e}return r(e,t),e.prototype.addHoney=function(){this.honey<10&&this.honey++},e}(a("BaseBuilding").BaseBuildingComponent);n.default=s,cc._RF.pop()},{}],Bee:[function(t,e,i){"use strict";cc._RF.push(e,"2918arebyRP3Yvu6Pna08ZI","Bee");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseActorComponent"),c=a("HoverModule"),d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pollen=0,e.hoverModule=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.hoverModule=this.getComponent(c.default)},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),this.actor.data.alive){if(!this.actor.is_moving&&this.actor.ai.task&&"pollinate"==this.actor.ai.task.id)return this.hoverModule.hoverState=c.HoverState.Down,void this.actor.changeMoveJumpOffset(3*(0-e));this.hoverModule.hoverState=c.HoverState.Up,this.actor.moveJumpOffset.y<this.actor.stats.hovering_max&&this.actor.changeMoveJumpOffset(3*e)}},s([u],e)}(l.default));n.default=h,cc._RF.pop()},{}],BehActiveCrabDangerCheck:[function(t,e,i){"use strict";cc._RF.push(e,"e591f87XC9IMbw+CqNJc/jU","BehActiveCrabDangerCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehActiveCrabDangerCheck",e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.data)||void 0===e?void 0:e.hunger)<50?s.BehResult.Continue:(l.Toolbox.findNotSameRaceInChunkAround(t.currentTile.chunk,t.race.id),l.Toolbox.temp_list_units.length>0&&(t.cancelAllBeh(),t.stopMovement(),t.ai.setJob("crab_burrow")),s.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehAngleAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"c4084cxZJdHzZCJ8RNW5ouM","BehAngleAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(e,i,o){void 0===i&&(i=0),void 0===o&&(o=40);var a=t.call(this)||this;return a.target="",a.timer_action=0,a.angle=0,a.id="BehAngleAnimation",a.angle=o,a.target=e,a.timer_action=i,"tile_target"==a.target?a.null_check_tile_target=!0:"building_target"==a.target&&(a.null_check_building_target=!0),a}return r(e,t),e.prototype.execute=function(t){var e;return"tile_target"==this.target?t.punchTargetAnimation(t.beh_tile_target.posV3,t.beh_tile_target,!1,!1,this.angle):"building_target"==this.target&&((null===(e=t.beh_building_target)||void 0===e?void 0:e.base_data)?(t.punchTargetAnimation(t.beh_building_target.currentTile.posV3,t.beh_building_target.currentTile,!0,!1,this.angle),t.beh_building_target.startShake(.3)):t.cancelAllBeh()),t.timer_action=this.timer_action,s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehAnimalCheckHungry:[function(t,e,i){"use strict";cc._RF.push(e,"ca8acUE9FdO37Sb0oAxTQRC","BehAnimalCheckHungry");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehAnimalCheckHungry",e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.data)||void 0===e?void 0:e.hunger)>50?s.BehResult.Stop:s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehAnimalFindTile:[function(t,e,i){"use strict";cc._RF.push(e,"20be8RkmuRCAZEBNpOeiaPS","BehAnimalFindTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehAnimalFindTile",e}return r(e,t),e.prototype.execute=function(t){if(l.Toolbox.randomChance(.8)&&(l.Toolbox.findSameUnitInChunkAround(t.currentTile.chunk,"druid"),0!=l.Toolbox.temp_list_units.length)){var e=l.Toolbox.temp_list_units.getRandom();return t.beh_tile_target=e.currentTile.region.tiles.getRandom(),s.BehResult.Continue}var i=t.currentTile.region;return i.neighbours.length>0&&l.Toolbox.randomBool()&&(i=i.neighbours.getRandom()),i.tiles.length>0?(t.beh_tile_target=i.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehAttackActorTarget:[function(t,e,i){"use strict";cc._RF.push(e,"c97bekttDFDBKqZyCDnyVQn","BehAttackActorTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehAttackActorTarget",e.null_check_actor_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a,n;return(null===(i=null===(e=t.beh_actor_target)||void 0===e?void 0:e.base_data)||void 0===i?void 0:i.alive)?(t.isInAttackRange(t.beh_actor_target)&&t.tryToAttack(t.beh_actor_target),(null===(n=null===(a=null===(o=t.beh_actor_target)||void 0===o?void 0:o.a)||void 0===a?void 0:a.data)||void 0===n?void 0:n.alive)?s.BehResult.RestartTask:s.BehResult.Continue):(t.clearBeh(),s.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBabymakingTime:[function(t,e,i){"use strict";cc._RF.push(e,"609eeIYLT1JApCDP7vtFuDD","BehBabymakingTime");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBabymakingTime",e.null_check_actor_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.beh_actor_target)||void 0===e?void 0:e.a)?l.Toolbox.distTile(t.currentTile,t.beh_actor_target.currentTile)>1?s.BehResult.Stop:(t.beh_actor_target.a.startShake(),t.startShake(),t.beh_actor_target.a.timer_action=2,s.BehResult.Continue):(t.clearBeh(),s.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehBeeCheckHome:[function(t,e,i){"use strict";cc._RF.push(e,"0f197RYWh1MupEH4/5SbjDY","BehBeeCheckHome");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorAsset"),l=a("BaseBuilding"),c=a("BehaviourActionBase"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBeeCheckHome",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.homeBuilding)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive)||t.setHomeBuilding(null),t.homeBuilding||(t.currentTile.type.grow_type_selector_plants&&d.default.inst.tryGrowVegetationRandom(t.currentTile,l.VegetationType.Plants),t.killHimself(!0,s.AttackType.None,!1)),c.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehBeeCheckReturnHome:[function(t,e,i){"use strict";cc._RF.push(e,"29aafwrWOZG/bZM4LI5bdfV","BehBeeCheckReturnHome");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBeeCheckReturnHome",e}return r(e,t),e.prototype.execute=function(t){return t.homeBuilding?(t.beh_building_target=t.homeBuilding,s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBeePollinate:[function(t,e,i){"use strict";cc._RF.push(e,"6a48bbPPgxLvq2Zr1PXhMWD","BehBeePollinate");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Bee"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehBeePollinate",e}return r(e,t),e.prototype.execute=function(t){var e=t.getComponent(s.default);return t.currentTile.building?("flower"==t.currentTile.building.stats.type&&(e.pollen++,t.currentTile.pollinate()),t.timer_action=c.Toolbox.randomFloat(4,10),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehBeeReturnHome:[function(t,e,i){"use strict";cc._RF.push(e,"b877bWc2G9PgZEFnDgB5sTR","BehBeeReturnHome");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Bee"),l=a("BehaviourActionBase"),c=a("Beehive"),d=a("ToolBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBeeReturnHome",e}return r(e,t),e.prototype.execute=function(t){var e,i;if(!(null===(i=null===(e=t.homeBuilding)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive))return t.setHomeBuilding(null),l.BehResult.Stop;var o=t.getComponent(s.default);return d.Toolbox.distTile(t.currentTile,t.homeBuilding.currentTile)>3?l.BehResult.Stop:(3==o.pollen&&t.currentTile.building==t.homeBuilding&&(o.pollen=0,t.homeBuilding.getComponent(c.default).addHoney(),t.timer_action=3),l.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehBoatCheckFishingRepeat:[function(t,e,i){"use strict";cc._RF.push(e,"5452f1VPphH/qV1RA471Qpd","BehBoatCheckFishingRepeat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatCheckFishingRepeat",e}return r(e,t),e.prototype.execute=function(t){return t.inventory.getResource("fish")<=10?s.BehResult.RestartTask:this.forceTask(t,"boat_return_to_dock")},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBoatCheckHomeDocks:[function(t,e,i){"use strict";cc._RF.push(e,"3c9e7SS/wBDd4WB7TfP7Z12","BehBoatCheckHomeDocks");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatCheckHomeDocks",e}return r(e,t),e.prototype.execute=function(t){return this.checkHomeDocks(t),t.homeBuilding?s.BehResult.Continue:s.BehResult.Stop},e}(a("BehBoat").default);n.default=l,cc._RF.pop()},{}],BehBoatCollectFish:[function(t,e,i){"use strict";cc._RF.push(e,"963ceIMF5JNSZi+AKHPu6vP","BehBoatCollectFish");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatCollectFish",e}return r(e,t),e.prototype.execute=function(t){return t.inventory.add("fish",1),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBoatDamageCheck:[function(t,e,i){"use strict";cc._RF.push(e,"5312bI1v7hM8YOIc9MI2zVZ","BehBoatDamageCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatDamageCheck",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(e=t.data)||void 0===e?void 0:e.health)<.8*(null===(i=t.curStats)||void 0===i?void 0:i.health)?(t.cancelAllBeh(),t.stopMovement(),this.forceTask(t,"boat_return_to_dock")):s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBoatDangerCheck:[function(t,e,i){"use strict";cc._RF.push(e,"f82a4Bnl01OCoZQG+Of5u2Z","BehBoatDangerCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatDangerCheck",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(e=t.data)||void 0===e?void 0:e.alive)&&t.attackedBy?t.data.health<.25*(null===(i=t.curStats)||void 0===i?void 0:i.health)?(t.cancelAllBeh(),t.stopMovement(),this.forceTask(t,"boat_return_to_dock")):s.BehResult.Continue:s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBoatFindOceanNeutralTile:[function(t,e,i){"use strict";cc._RF.push(e,"b99b8fZHflOKrSfVQYnrRjC","BehBoatFindOceanNeutralTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("Boat"),c=a("BehaviourActionBase"),d=a("Docks"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFindOceanNeutralTile",e}return r(e,t),e.prototype.execute=function(t){if(this.checkHomeDocks(t),null==t?void 0:t.homeBuilding){if(t.getComponent(l.default).isNearDock())return c.BehResult.Stop;var e=t.homeBuilding.getComponent(d.default).getOceanTileInSameOcean(t.currentTile);if(e)return t.beh_tile_target=e,c.BehResult.Continue}var i=s.default.getRandomTileForBoat(t);return i?i.zone.city&&i.zone.city.kingdom.isEnemy(t.kingdom)?c.BehResult.Stop:(t.beh_tile_target=i,c.BehResult.Continue):c.BehResult.Stop},e}(a("BehBoat").default);n.default=u,cc._RF.pop()},{}],BehBoatFindRequest:[function(t,e,i){"use strict";cc._RF.push(e,"b48c5+IbelHIKd/UXbbVWWi","BehBoatFindRequest");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFindRequest",e}return r(e,t),e.prototype.execute=function(t){var e=this.getBoat(t);return e.taxiRequest=s.default.getNewRequestForBoat(t),e.taxiRequest?(e.taxiRequest.assign(e),this.forceTask(t,"boat_transport_go_load")):l.BehResult.Stop},e}(a("BehBoat").default);n.default=c,cc._RF.pop()},{}],BehBoatFindTargetForTrade:[function(t,e,i){"use strict";cc._RF.push(e,"73353/U/ElAkLhEDpnVXbNX","BehBoatFindTargetForTrade");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFindTargetForTrade",e}return r(e,t),e.prototype.execute=function(t){var e=s.default.getDockTradeTarget(t);return e?(t.beh_building_target=e.building,l.BehResult.Continue):l.BehResult.Stop},e}(a("BehBoat").default);n.default=c,cc._RF.pop()},{}],BehBoatFindTileInDock:[function(t,e,i){"use strict";cc._RF.push(e,"83907FegXFEWoKfRGY0lQGC","BehBoatFindTileInDock");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("BehaviourActionBase"),c=a("Docks"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFindTileInDock",e.check_building_target_non_usable=!0,e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i;if((null===(i=null===(e=t.beh_building_target)||void 0===e?void 0:e.data)||void 0===i?void 0:i.state)!=s.BuildingState.CivKingdom)return l.BehResult.Stop;var o=t.beh_building_target.getComponent(c.default).getOceanTileInSameOcean(t.currentTile);return o?(t.beh_tile_target=o,l.BehResult.Continue):l.BehResult.Stop},e}(a("BehBoat").default);n.default=d,cc._RF.pop()},{}],BehBoatFindWaterTile:[function(t,e,i){"use strict";cc._RF.push(e,"b53a8c9MPxFRr8cZuq8mPGu","BehBoatFindWaterTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFindWaterTile",e}return r(e,t),e.prototype.execute=function(t){return t.beh_tile_target=s.default.getRandomTileForBoat(t),l.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehBoatFishing:[function(t,e,i){"use strict";cc._RF.push(e,"b4dceiWoV1L9o4jIdHftkbK","BehBoatFishing");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("MathUtils"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatFishing",e}return r(e,t),e.prototype.execute=function(t){return this.spawnFishnet(t),l.BehResult.Continue},e.prototype.spawnFishnet=function(t){if(!d.default.inst.qualityChanger.lowRes){var e=c.Toolbox.randomPointOnCircle(3,4),i=d.default.inst.getTile(t.currentTile.pos.x+s.default.intCast(e.x),t.currentTile.pos.y+s.default.intCast(e.y));i&&i.type.ocean&&d.default.inst.stackEffects.get("fx_fishnet").spawnAt(i,t.stats.baseStats.scale)}},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehBoatMakeTrade:[function(t,e,i){"use strict";cc._RF.push(e,"2dc01vjNZBOIr4jzwVLtVzr","BehBoatMakeTrade");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatMakeTrade",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){return t.inventory.add("gold",5),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehBoatSetHomeDockTarget:[function(t,e,i){"use strict";cc._RF.push(e,"4797ftpHD9OS5uXaRxwk12E","BehBoatSetHomeDockTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatSetHomeDockTarget",e}return r(e,t),e.prototype.execute=function(t){return this.checkHomeDocks(t),t.homeBuilding?(t.beh_building_target=t.homeBuilding,s.BehResult.Continue):s.BehResult.Stop},e}(a("BehBoat").default);n.default=l,cc._RF.pop()},{}],BehBoatTransportCheck:[function(t,e,i){"use strict";cc._RF.push(e,"37a90t0BLdCqZUaxr+SLHBo","BehBoatTransportCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatTransportCheck",e}return r(e,t),e.prototype.execute=function(t){var e,i,o;this.checkHomeDocks(t);var a=this.getBoat(t);if(a.unitsInside.size>0){var n=null;return a.unitsInside.size>5&&(null===(e=t.city)||void 0===e?void 0:e.attackZone)&&(n=null===(i=t.city)||void 0===i?void 0:i.attackZone.centerTile),n||(n=null===(o=t.city)||void 0===o?void 0:o.getTile()),n?(a.taxiTarget=n,t.beh_tile_target=n,this.forceTask(t,"boat_transport_go_unload",!1)):s.BehResult.Stop}return this.forceTask(t,"boat_transport_check_taxi")},e}(a("BehBoat").default);n.default=l,cc._RF.pop()},{}],BehBoatTransportDoLoading:[function(t,e,i){"use strict";cc._RF.push(e,"bb39fkhGqhP9qnq77NmzlV4","BehBoatTransportDoLoading");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiRequest"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatTransportDoLoading",e}return r(e,t),e.prototype.execute=function(t){var e=this.getBoat(t);if(!e.taxiRequest)return e.cancelWork(t),l.BehResult.Stop;var i=!0;return e.passengerWaitCounter>4||e.unitsInside.size>=100?i=!1:e.taxiRequest.everyoneEmbarked()&&(i=!1),i?(e.taxiRequest.setState(s.TaxiRequestState.Loading),t.timer_action=12,e.passengerWaitCounter++,l.BehResult.RepeatStep):0==e.unitsInside.size?(e.cancelWork(t),l.BehResult.Stop):(e.taxiRequest.cancelForLatePassengers(),e.taxiTarget=e.taxiRequest.target,l.BehResult.Continue)},e}(a("BehBoat").default);n.default=c,cc._RF.pop()},{}],BehBoatTransportFindTilePickUp:[function(t,e,i){"use strict";cc._RF.push(e,"69837u32+5IQImqODv0zOSd","BehBoatTransportFindTilePickUp");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("BehaviourActionBase"),c=a("Docks"),d=a("OceanHelper"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatTransportFindTilePickUp",e}return r(e,t),e.prototype.execute=function(t){var e,i=this.getBoat(t);if(!i.taxiRequest||!i.taxiRequest.isStillLegit())return i.cancelWork(t),l.BehResult.Stop;if(i.pickup_near_dock=!1,s.default.checkHomeDocks(t),t.homeBuilding){var o=t.homeBuilding.getComponent(c.default).getOceanTileInSameOcean(t.currentTile);if(o&&o.isSameIsland(i.taxiRequest.requestTile))return i.pickup_near_dock=!0,i.isNearDock()?(i.passengerWaitCounter=0,t.beh_tile_target=t.currentTile,l.BehResult.Continue):(t.beh_tile_target=o,l.BehResult.Continue)}return(e=d.default.findTileForBoat(t.currentTile,i.taxiRequest.requestTile))?(i.passengerWaitCounter=0,t.beh_tile_target=e,l.BehResult.Continue):(i.cancelWork(t),l.BehResult.Stop)},e}(a("BehBoat").default);n.default=u,cc._RF.pop()},{}],BehBoatTransportFindTileUnload:[function(t,e,i){"use strict";cc._RF.push(e,"2d790IwuHFK07bl6t3QbXcS","BehBoatTransportFindTileUnload");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("OceanHelper"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatTransportFindTileUnload",e}return r(e,t),e.prototype.execute=function(t){var e=this.getBoat(t);if(!e.taxiTarget)return s.BehResult.Stop;var i=l.default.findTileForBoat(t.currentTile,e.taxiTarget);return i?(t.beh_tile_target=i,s.BehResult.Continue):(e.cancelWork(t),s.BehResult.Stop)},e}(a("BehBoat").default);n.default=c,cc._RF.pop()},{}],BehBoatTransportUnloadUnits:[function(t,e,i){"use strict";cc._RF.push(e,"694d2E6CKhI6pJLvvDncdWv","BehBoatTransportUnloadUnits");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiManager"),l=a("BehaviourActionBase"),c=a("PathfinderTools"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoatTransportUnloadUnits",e}return r(e,t),e.prototype.execute=function(t){var e=this.getBoat(t),i=c.default.raycastTileForUnitLandingFromOcean(t.currentTile,e.taxiTarget);return e.unloadUnits(i),e.taxiRequest&&(s.default.finish(e.taxiRequest),e.taxiRequest=null,e.cancelWork(t)),l.BehResult.Continue},e}(a("BehBoat").default);n.default=d,cc._RF.pop()},{}],BehBoat:[function(t,e,i){"use strict";cc._RF.push(e,"5a3beB9qOdKCoCydw77Ilni","BehBoat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("Boat"),c=a("BehaviourActionBase"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehBoat",e}return r(e,t),e.prototype.checkHomeDocks=function(t){s.default.checkHomeDocks(t)},e.prototype.execute=function(){return c.BehResult.Continue},e.prototype.getBoat=function(t){return t.getComponent(l.default)},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehBuildTargetProgress:[function(t,e,i){"use strict";cc._RF.push(e,"25b4bNAYDtFu4/jK/wfgM7b","BehBuildTargetProgress");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("GameAudio"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehBuildTargetProgress",e.check_building_target_non_usable=!0,e.null_check_city=!0,e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.beh_building_target)||void 0===e?void 0:e.data)||void 0===i?void 0:i.underConstruction)?(l.default.playHammer1(t.node.position),t.beh_building_target.updateBuild(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehBurnTumorTiles:[function(t,e,i){"use strict";cc._RF.push(e,"17897WXjAlJKIZxt/83Dk81","BehBurnTumorTiles");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AssetManager"),c=a("BehaviourActionBase"),d=a("ToolBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehBurnTumorTiles",e}return r(e,t),e.prototype.execute=function(t){var i,o,a,n;if(!d.Toolbox.randomChance(.7))return c.BehResult.Stop;if(!(null===(n=null===(a=t.currentTile)||void 0===a?void 0:a.type)||void 0===n?void 0:n.ground))return c.BehResult.Stop;var r=null;if(e.tiles=[],this.checkRegion(t.currentTile.region),0!=e.tiles.length)r=d.Toolbox.getRandom(e.tiles);else try{for(var u=s(t.currentTile.region.neighbours),h=u.next();!h.done;h=u.next()){var p=h.value;if(this.checkRegion(p),0!=e.tiles.length){r=d.Toolbox.getRandom(e.tiles);break}}}catch(f){i={error:f}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}return r?(l.default.spells.get("fire").action.do(null,r),t.doCastAnimation(),c.BehResult.Continue):c.BehResult.Stop},e.prototype.checkRegion=function(t){for(var i=0;i<t.tiles.length;i++){var o=t.tiles[i];o.type.creep&&e.tiles.push(o)}},e.tiles=[],e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehCheckBuildCity:[function(t,e,i){"use strict";cc._RF.push(e,"b678edOyllBFLFXIXw0MB/H","BehCheckBuildCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("Config"),c=a("MapBox"),d=a("WorldLog"),u=a("ModModule"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckBuildCity",e}return r(e,t),e.prototype.execute=function(t){var e=t.kingdom;if(!e.isNomads()){if(!e.isCiv())return s.BehResult.Stop;if(!c.default.inst.worldLaws.world_law_kingdom_expansion.boolVal)return s.BehResult.Stop}var i=t.currentTile.zone.city,o=t.currentTile.zone;if(!o.goodForNewCity)return s.BehResult.Stop;if((null==e?void 0:e.isNomads())&&(e=null),!(i=c.default.inst.buildNewCity(o,null,t.race,!1,e)))return s.BehResult.Stop;i.newCityEvent(),i.race=t.race,i.setCulture(t.data.culture);var a=t.city;return a&&(a.kingdom.newCityBuiltEvent(i),a.removeCitizen(t),t.removeFromCity()),t.becomeCitizen(i),d.default.logNewCity(i),l.default.mode_sandBox||!t.haveTrait("ancestor")||u.default.inst.kingdom||(u.default.inst.kingdom=i.kingdom,u.default.inst.placeEnemy()),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=h,cc._RF.pop()},{}],BehCheckCitizenJob:[function(t,e,i){"use strict";cc._RF.push(e,"e2212zqhvJBOqBPzOjOESHx","BehCheckCitizenJob");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckCitizenJob",e}return r(e,t),e.prototype.execute=function(t){return t.city?(t.ai.setJob("citizen"),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehCheckCityArmyGroup:[function(t,e,i){"use strict";cc._RF.push(e,"e66a2kLim9JUKkzTs1YC4rE","BehCheckCityArmyGroup");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckCityArmyGroup",e.null_check_city=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i,o;return(null===(e=t.city)||void 0===e?void 0:e.army)?(null===(i=t.unitGroup)||void 0===i?void 0:i.isAlive())?s.BehResult.Stop:((null===(o=t.kingdom)||void 0===o?void 0:o.isCiv())||(t.unitGroup=null),t.city.army.addUnit(t),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehCheckCure:[function(t,e,i){"use strict";cc._RF.push(e,"1d26fTjD8tInIeJ57wrdG8P","BehCheckCure");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("AssetManager"),c=a("BehaviourActionBase"),d=a("ToolBox"),u=a("MapLayer"),h=a("MapBox"),p=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckCure",e}return r(e,t),e.prototype.execute=function(t){var e,i;if(!d.Toolbox.randomChance(.9))return c.BehResult.Stop;if(!(null===(i=null===(e=t.currentTile)||void 0===e?void 0:e.type)||void 0===i?void 0:i.ground))return c.BehResult.Stop;h.default.inst.getObjectsInChunks(t.currentTile,0,u.MapObjectType.Actor);for(var o=null,a=0;a<h.default.inst.temp_map_objects.length;a++){var n=h.default.inst.temp_map_objects[a];if(s.default.canBeCuredFromTraits(n)){o=n;break}}return o?(l.default.spells.get("cure").action.do(o,o.currentTile),t.doCastAnimation(),c.BehResult.Continue):c.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=p,cc._RF.pop()},{}],BehCheckHunger:[function(t,e,i){"use strict";cc._RF.push(e,"a247dFwumJH/I4ufMkuK3wv","BehCheckHunger");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("MapBox"),c=a("BehaviourActionActor"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckHunger",e}return r(e,t),e.prototype.execute=function(t){var e,i,o;return l.default.inst.worldLaws.world_law_hunger.boolVal?!(null===(e=t.data)||void 0===e?void 0:e.alive)||(null===(i=t.data)||void 0===i?void 0:i.hunger)>(null===(o=t.stats)||void 0===o?void 0:o.maxHunger)/2?s.BehResult.Stop:(c.default.temp_tasks=[],t.stats.diet_berries&&c.default.temp_tasks.push("eat_fruits"),t.stats.diet_flowers&&c.default.temp_tasks.push("eat_flowers"),t.stats.diet_crops&&c.default.temp_tasks.push("eat_crops"),t.stats.diet_grass&&c.default.temp_tasks.push("eat_grass"),(t.stats.diet_meat||t.stats.diet_meat_insect)&&c.default.temp_tasks.push("hunting_attack"),c.default.temp_tasks.length>0?(t.diet_index>=c.default.temp_tasks.length&&(t.diet_index=0),this.forceTask(t,c.default.temp_tasks[t.diet_index++])):s.BehResult.Continue):s.BehResult.Stop},e}(c.default);n.default=d,cc._RF.pop()},{}],BehCheckIfInLiquid:[function(t,e,i){"use strict";cc._RF.push(e,"91fe5dALKRMTaWTkogL9yrs","BehCheckIfInLiquid");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckIfInLiquid",e}return r(e,t),e.prototype.execute=function(t){return t.isInLiquid()?s.BehResult.Continue:s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehCheckIfOnGround:[function(t,e,i){"use strict";cc._RF.push(e,"f3e08mL28NK17i17PImO53S","BehCheckIfOnGround");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckIfOnGround",e}return r(e,t),e.prototype.execute=function(t){return t.isInLiquid()?s.BehResult.Stop:s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehCheckIfOnSmallLand:[function(t,e,i){"use strict";cc._RF.push(e,"1d4bdWJpNFKF4vasSIR32oB","BehCheckIfOnSmallLand");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCheckIfOnSmallLand",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.currentTile)||void 0===e?void 0:e.region)||void 0===i?void 0:i.island.getTileCount())>5?s.BehResult.Stop:s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehChuckTargetBuildProgress:[function(t,e,i){"use strict";cc._RF.push(e,"8936069YnpK6LuYMtkBWI3B","BehChuckTargetBuildProgress");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehChuckTargetBuildProgress",e.check_building_target_non_usable=!0,e.null_check_city=!0,e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.beh_building_target)||void 0===e?void 0:e.data)||void 0===i?void 0:i.underConstruction)?s.BehResult.RestartTask:s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehCityCheckAttack:[function(t,e,i){"use strict";cc._RF.push(e,"b7705Q89KNCn6BCJr8mXl0P","BehCityCheckAttack");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityCheckAttack",e}return r(e,t),e.prototype.execute=function(t){return t.city.attackZone&&t.city.attackZone.centerTile.isSameIsland(t.currentTile)?(t.beh_tile_target=t.city.attackZone.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehCityCreateRoad:[function(t,e,i){"use strict";cc._RF.push(e,"be42bOznEhIgYnYce63e7yZ","BehCityCreateRoad");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("MapAction"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityCreateRoad",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){return s.default.createRoad(t.beh_tile_target),l.BehResult.Continue},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCityFindBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"201c4s5nXRHpYQE4eOv3H3o","BehCityFindBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorTool"),l=a("BehaviourActionBase"),c=function(t){function e(e){var i=t.call(this)||this;return i.type="",i.types=[],i.id="BehCityFindBuilding",i.type=e,i.id=e,e.includes(",")&&(i.types=e.split(",")),i}return r(e,t),e.prototype.execute=function(t){return this.types.length>0&&(this.type=this.types.getRandom(),this.id=this.type),t.beh_building_target=s.default.findNewBuildingTarget(t,this.type),l.BehResult.Continue},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCityFindFireZone:[function(t,e,i){"use strict";cc._RF.push(e,"df901Pj1PpLnqn+EcWZoZvZ","BehCityFindFireZone");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r},l=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var d=a("BehaviourActionBase"),u=a("ToolBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityFindFireZone",e}return r(e,t),e.prototype.execute=function(t){var i,o;e.chosenTile=null,e.tNewTile=null,e.tAllZones=l(t.city.zones).concat(t.city.neighbourZones);try{for(var a=c(e.tAllZones),n=a.next();!n.done;n=a.next()){var r=n.value;0!=r.tilesOnFire&&(e.tNewTile=r.centerTile,e.chosenTile?(e.newDist=u.Toolbox.dist(t.currentTile.pos.x,t.currentTile.pos.y,e.tNewTile.pos.x,e.tNewTile.pos.y),e.chosenTile=e.tNewTile,e.chosenDist=e.newDist):(e.chosenTile=e.tNewTile,e.chosenDist=u.Toolbox.dist(t.currentTile.pos.x,t.currentTile.pos.y,e.chosenTile.pos.x,e.chosenTile.pos.y)))}}catch(h){i={error:h}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}if(!e.chosenTile)return d.BehResult.Stop;if(e.chosenTile=u.Toolbox.getClosestTile(e.chosenTile.zone.tiles,t.currentTile),e.chosenTile.data.fire||e.chosenTile.building)for(var s=0;s<10&&(e.chosenTile=u.Toolbox.getRandom(e.chosenTile.zone.tiles),e.chosenTile.data.fire||e.chosenTile.building);s++);return t.beh_tile_target=e.chosenTile,d.BehResult.Continue},e.tAllZones=[],e.chosenTile=null,e.tNewTile=null,e.chosenDist=0,e.newDist=0,e}(a("BehCity").default);n.default=h,cc._RF.pop()},{}],BehCityFindNewJob:[function(t,e,i){"use strict";cc._RF.push(e,"f7702Gh3URN5YG81GGrTqE3","BehCityFindNewJob");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityFindNewJob",e}return r(e,t),e.prototype.execute=function(t){return t.isInCityIsland()?(t.city.findNewJob(t),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehCityFindStorage:[function(t,e,i){"use strict";cc._RF.push(e,"3ac8bSxulNE3JPMnu7Uumvh","BehCityFindStorage");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityFindStorage",e}return r(e,t),e.prototype.execute=function(t){if(t.city){var e=t.city.getStorageNear(t.currentTile);if(e)return t.beh_building_target=e,s.BehResult.Continue}return s.BehResult.Stop},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehCityGetRandomZoneTile:[function(t,e,i){"use strict";cc._RF.push(e,"1adccwCEXpP25FIEMPY5EEA","BehCityGetRandomZoneTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityGetRandomZoneTile",e}return r(e,t),e.prototype.execute=function(t){if(!t.city||0==t.city.zones.length)return s.BehResult.Stop;var e=null;if(t.currentTile.zone.city!=t.city||l.Toolbox.randomChance(.2)){if(!(e=t.city.zones.getRandom().tiles.getRandom()).isSameIsland(t.currentTile))return s.BehResult.Stop}else e=t.currentTile.region.tiles.getRandom();return t.beh_tile_target=e,s.BehResult.Continue},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCityRemoveFire:[function(t,e,i){"use strict";cc._RF.push(e,"31117RlOiBOI5wz0+ioekIW","BehCityRemoveFire");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityRemoveFire",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){if(t.currentTile.zone.tilesOnFire>0)for(var e=0;e<t.currentTile.zone.tiles.length;e++){var i=t.currentTile.zone.tiles[e];i.data.fire&&i.stopFire(),i.building&&i.building.stopFire()}return s.BehResult.Continue},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehCitySettlerFindTileSameIsland:[function(t,e,i){"use strict";cc._RF.push(e,"500b9BRuSVL3az8v9uwq5r8","BehCitySettlerFindTileSameIsland");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("MapBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCitySettlerFindTileSameIsland",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(e=t.city)||void 0===e?void 0:e.settleTarget)&&l.default.inst.worldLaws.world_law_kingdom_expansion.boolVal&&(null===(i=t.currentTile)||void 0===i?void 0:i.isSameIsland(t.city.settleTarget.centerTile))?(t.beh_tile_target=t.city.settleTarget.centerTile,s.BehResult.Continue):s.BehResult.Stop},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCitySettlerTaxiCheck:[function(t,e,i){"use strict";cc._RF.push(e,"0ad22tJAjhHC49ym+vQLt/s","BehCitySettlerTaxiCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCitySettlerTaxiCheck",e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.city)||void 0===e?void 0:e.settleTarget)?t.city.settleTarget.centerTile.isSameIsland(t.currentTile)?l.BehResult.Stop:(s.default.newRequest(t,t.city.settleTarget.centerTile),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCityWarriorTaxiCheck:[function(t,e,i){"use strict";cc._RF.push(e,"50b3eW5fVRG/a2Q5JuxaFm2","BehCityWarriorTaxiCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCityWarriorTaxiCheck",e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.city)||void 0===e?void 0:e.attackZone)||void 0===i?void 0:i.centerTile)&&!t.city.attackZone.centerTile.isSameIsland(t.currentTile)?(s.default.newRequest(t,t.city.attackZone.centerTile),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehCity:[function(t,e,i){"use strict";cc._RF.push(e,"535151v/ktNf4Gc2/gdBXmx","BehCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.id="BehCity",e.null_check_city=!0,e}return r(e,t),e}(a("BehaviourActionActor").default);n.default=s,cc._RF.pop()},{}],BehConsumeActorTarget:[function(t,e,i){"use strict";cc._RF.push(e,"40d1dlHHSZPM62sPqsrKpSm","BehConsumeActorTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorAsset"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehConsumeActorTarget",e.null_check_actor_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a;return c.Toolbox.distTile(t.currentTile,t.beh_actor_target.currentTile)>1?this.forceTask(t,"hunting_attack",!1):(this.consume(t,null===(e=t.beh_actor_target)||void 0===e?void 0:e.a),(null===(a=null===(o=null===(i=t.beh_actor_target)||void 0===i?void 0:i.a)||void 0===o?void 0:o.data)||void 0===a?void 0:a.alive)?l.BehResult.RepeatStep:l.BehResult.Continue)},e.prototype.consume=function(t,e){t.timer_action=.3,e&&(t.node.x>e.node.x?e.targetAngle.z>-45&&(e.targetAngle.z-=100*d.default.inst.elapsed,e.targetAngle.z<-90&&(e.targetAngle.z=-90),e.rotationCooldown=1):e.targetAngle.z<45&&(e.targetAngle.z+=100*d.default.inst.elapsed,e.rotationCooldown=1),0==t.targetAngle.z&&(t.punchTargetAnimation(e.node.position,t.currentTile,!1),e.getHit(t.curStats.damage,!0,s.AttackType.Eaten,t,!1),e.startShake(.2),t.restoreStatsFromEating(t.curStats.damage)),e.cancelAllBeh(),e.timer_action=c.Toolbox.randomFloat(1,2))},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehConsumeFlowers:[function(t,e,i){"use strict";cc._RF.push(e,"264d0ypUfdEVIgEmgZExYNS","BehConsumeFlowers");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehConsumeFlowers",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.beh_tile_target)||void 0===e?void 0:e.building)?"flower"!=t.beh_tile_target.building.stats.type?s.BehResult.Stop:(t.punchTargetAnimation(t.beh_tile_target.posV3,t.beh_tile_target,!1),t.restoreStatsFromEating(),t.beh_tile_target.building.startRemove(!1),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehConsumeGrass:[function(t,e,i){"use strict";cc._RF.push(e,"3ae03PRW39CsLfSq6OI2A7w","BehConsumeGrass");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehConsumeGrass",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(i=null===(e=t.beh_tile_target)||void 0===e?void 0:e.type)||void 0===i?void 0:i.grass)?(t.punchTargetAnimation(t.beh_tile_target.posV3,t.beh_tile_target,!1),t.restoreStatsFromEating(),t.beh_tile_target.eatGreens(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehConsumeTargetBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"93ac2cFTv9JIpgU1eIopqMn","BehConsumeTargetBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehConsumeTargetBuilding",e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a,n,r,l,c,d,u;if(!(null===(e=t.data)||void 0===e?void 0:e.alive)||!(null===(o=null===(i=t.beh_building_target)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive))return s.BehResult.Stop;"fruits"==(null===(n=null===(a=t.beh_building_target)||void 0===a?void 0:a.stats)||void 0===n?void 0:n.type)?t.beh_building_target.haveResources&&(t.beh_building_target.extractResources(t),t.restoreStatsFromEating()):"crops"==(null===(l=null===(r=t.beh_building_target)||void 0===r?void 0:r.stats)||void 0===l?void 0:l.type)&&(null===(d=null===(c=t.beh_building_target)||void 0===c?void 0:c.data)||void 0===d?void 0:d.alive)&&(t.beh_building_target.startDestroyBuilding(!0),t.restoreStatsFromEating());var h=null===(u=t.beh_building_target)||void 0===u?void 0:u.currentTile;return t.punchTargetAnimation(h.posV3,h,!1),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehConvertOre:[function(t,e,i){"use strict";cc._RF.push(e,"92380uaB6xH/JewWsV6fngh","BehConvertOre");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehConvertOre",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return(null===(e=t.city)||void 0===e?void 0:e.data)&&0!=t.city.data.storage.get("ore")?(t.city.data.storage.change("ore",-1),t.inventory.add("metals",1),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehCrabBurrow:[function(t,e,i){"use strict";cc._RF.push(e,"b5e44iu7mZNn58TsPb619pt","BehCrabBurrow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehCrabBurrow",e.forceAnimation="burrow",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return!(null===(e=t.data)||void 0===e?void 0:e.alive)||t.data.hunger<50?(t.ai.setJob(null),s.BehResult.Stop):(l.Toolbox.findNotSameRaceInChunkAround(t.currentTile.chunk,t.race.id),0==l.Toolbox.temp_list_units.length?(t.ai.setJob(null),s.BehResult.Stop):(t.timer_action=l.Toolbox.randomFloat(10,20),s.BehResult.RepeatStep))},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehEndJob:[function(t,e,i){"use strict";cc._RF.push(e,"ec1eacJjTZDJbOxv+suofDX","BehEndJob");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehEndJob",e}return r(e,t),e.prototype.execute=function(t){return t.ai.setJob(null),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehExitBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"fa595yps/dNpIJaJ+KpnEvK","BehExitBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehExitBuilding",e.null_check_building_target=!0,e.check_building_target_non_usable=!0,e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return t.exitHouse(),null===(e=t.beh_building_target)||void 0===e||e.startShake(.01),s.BehResult.Continue},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehExtractResourcesFromBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"87b1cV688ZCu7N/yI1Cc3YG","BehExtractResourcesFromBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehExtractResourcesFromBuilding",e.null_check_building_target=!0,e.check_building_target_non_usable=!0,e}return r(e,t),e.prototype.execute=function(t){var e;if(null===(e=t.beh_building_target)||void 0===e?void 0:e.stats){var i=t.beh_building_target.extractResources(t,t.beh_building_target.stats.resources_given);t.inventory.add(t.beh_building_target.stats.resource_id,i)}else t.cancelAllBeh();return s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehFightCheckEnemyIsOk:[function(t,e,i){"use strict";cc._RF.push(e,"63a02tq/wJEGJmNw8t0EZbo","BehFightCheckEnemyIsOk");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehFightCheckEnemyIsOk",e}return r(e,t),e.prototype.execute=function(t){var e,i;if(!(null===(i=null===(e=t.attackTarget)||void 0===e?void 0:e.base_data)||void 0===i?void 0:i.alive))return t.attackTarget=null,s.BehResult.Stop;if(!t.kingdom.isEnemy(t.attackTarget.kingdom))return t.attackTarget=null,s.BehResult.Stop;if(!t.canAttackTarget(t.attackTarget))return t.targetsToIgnore.add(t.attackTarget),t.attackTarget=null,s.BehResult.Stop;if(!t.isInAttackRange(t.attackTarget))if(t.stats.oceanCreature){if(!t.attackTarget.isInLiquid()&&!t.stats.landCreature||t.attackTarget.isInAir())return t.targetsToIgnore.add(t.attackTarget),t.attackTarget=null,s.BehResult.Stop}else if(t.attackTarget.isInLiquid()&&!t.stats.oceanCreature||t.attackTarget.isInAir())return t.targetsToIgnore.add(t.attackTarget),t.attackTarget=null,s.BehResult.Stop;return l.Toolbox.dist(t.currentTile.chunk.x,t.currentTile.chunk.y,t.attackTarget.currentTile.chunk.x,t.attackTarget.currentTile.chunk.y)>2&&!t.currentTile.chunk.neighboursAll.includes(t.attackTarget.currentTile.chunk)?(t.attackTarget=null,s.BehResult.Stop):(t.beh_actor_target=t.attackTarget,s.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehFindBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"36d58svjNpMtpwqJfDHcABH","BehFindBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(e){var i=t.call(this)||this;return i.type="",i.id="BehFindBuilding",i.type=e,i}return r(e,t),e.prototype.execute=function(t){return t.beh_building_target=e.findBuildingType(t,this.type),t.beh_building_target?s.BehResult.Continue:s.BehResult.Stop},e.findBuildingType=function(t,e){var i,o=null;l.Toolbox.temp_list_buildings_2=[],l.Toolbox.addToTempChunksBuildingsType(t.currentTile.chunk,e);for(var a=0;a<t.currentTile.chunk.neighboursAll.length;a++){var n=t.currentTile.chunk.neighboursAll[a];l.Toolbox.addToTempChunksBuildingsType(n,e)}if(0==l.Toolbox.temp_list_buildings_2.length)return null;for(l.Toolbox.temp_list_buildings_2.shuffle(),a=0;a<l.Toolbox.temp_list_buildings_2.length;a++){var r=l.Toolbox.temp_list_buildings_2[a];(null===(i=r.currentTile)||void 0===i?void 0:i.isSameIsland(t.currentTile))&&(o=r)}return o||(o=l.Toolbox.temp_list_buildings_2.getRandom()),o},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehFindConstructionTile:[function(t,e,i){"use strict";cc._RF.push(e,"ab7f2jtCA5P1ZhY0xOBUvFG","BehFindConstructionTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindConstructionTile",e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){var e;return t.beh_tile_target=null===(e=t.beh_building_target)||void 0===e?void 0:e.getConstructionTile(),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehFindEmptyNearbyCity:[function(t,e,i){"use strict";cc._RF.push(e,"4b725qxXIpKMJlP23UeKdeo","BehFindEmptyNearbyCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapBox"),d=a("BehaviourActionActor"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindEmptyNearbyCity",e}return r(e,t),e.prototype.execute=function(t){var i=e.getEmptyCity(t.currentTile,t.race);return i?(t.becomeCitizen(i),s.BehResult.Continue):s.BehResult.Stop},e.getEmptyCity=function(t,e){return d.default.temp_cities=[],c.default.inst.citiesList.forEach(function(i){var o;i.race==e&&i.status&&i.status.population<=40&&(i.status.population<=5||0!=i.status.homesFree)&&(null===(o=i.getTile())||void 0===o?void 0:o.isSameIsland(t))&&d.default.temp_cities.push(i)}),l.Toolbox.getRandom(d.default.temp_cities)},e}(d.default);n.default=u,cc._RF.pop()},{}],BehFindFarmField:[function(t,e,i){"use strict";cc._RF.push(e,"d0d9flldXxBy5DXLf6GP4fD","BehFindFarmField");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("TopTileLibrary"),c=a("BehaviourActionBase"),d=a("ToolBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindFarmField",e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a,n,r,u;if(!(null===(o=t.data)||void 0===o?void 0:o.alive)||!(null===(a=t.city)||void 0===a?void 0:a.alive)||0==(null===(r=null===(n=t.city)||void 0===n?void 0:n.zones)||void 0===r?void 0:r.length))return c.BehResult.Stop;t.city.zones.shuffle();for(var h=0,p=0,f=null,_=0,m=0;m<t.city.zones.length;m++){var g=t.city.zones[m].getTilesOfType(l.default.field);if(g&&0!=g.size){try{for(var y=(e=void 0,s(g)),v=y.next();!v.done;v=y.next()){var b=v.value;!b.targetedBy&&(null===(u=t.currentTile)||void 0===u?void 0:u.isSameIsland(b))&&!b.building&&(h=d.Toolbox.distTile(t.currentTile,b),(!f||h<p)&&(p=h,f=b))}}catch(w){e={error:w}}finally{try{v&&!v.done&&(i=y.return)&&i.call(y)}finally{if(e)throw e.error}}if(++_>3&&f)break}}return f?(t.beh_tile_target=f,c.BehResult.Continue):c.BehResult.Stop},e}(a("BehCity").default);n.default=u,cc._RF.pop()},{}],BehFindGoldenBrain:[function(t,e,i){"use strict";cc._RF.push(e,"10fcd4gYZFAooBPSuRvYsys","BehFindGoldenBrain");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindGoldenBrain",e}return r(e,t),e.prototype.execute=function(t){if(c.default.inst.worldLaws.world_law_peaceful_monsters.boolVal)return s.BehResult.Stop;var e=null,i=0,o=0;return c.default.inst.kingdoms.getKingdomByID("goldenBrain").buildings.forEach(function(a){var n;(null===(n=a.currentTile)||void 0===n?void 0:n.isSameIsland(t.currentTile))&&(i=l.Toolbox.distTile(a.currentTile,t.currentTile),(!e||i<o)&&(e=a,o=i))}),e?(t.beh_building_target=e,e&&t.goTo(t.beh_building_target.currentTile),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehFindMeatSource:[function(t,e,i){"use strict";cc._RF.push(e,"4642f7XIydLhJr4L18B3MbM","BehFindMeatSource");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapLayer"),d=a("MapBox"),u=a("BehaviourActionActor"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindMeatSource",e}return r(e,t),e.prototype.execute=function(t){return t.stats.diet_meat||t.stats.diet_meat_insect?t.beh_actor_target&&this.isTargetOk(t,t.beh_actor_target.a)?s.BehResult.Continue:(t.beh_actor_target=this.getClosestMeatActor(t),t.beh_actor_target&&t.data.hunger<20&&(t.beh_actor_target=this.getClosestMeatActor(t,0,!0)),t.beh_actor_target?s.BehResult.Continue:s.BehResult.Stop):s.BehResult.Stop},e.prototype.getClosestMeatActor=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),u.default.temp_actors=[],d.default.inst.getObjectsInChunks(t.currentTile,10,c.MapObjectType.Actor);for(var o=0;o<d.default.inst.temp_map_objects.length;o++){var a=d.default.inst.temp_map_objects[o];if(this.isTargetOk(t,a)){if(t.stats.diet_meat){if(!a.stats.source_meat)continue}else if(t.stats.diet_meat_insect&&!a.stats.source_meat_insect)continue;if(i){if(!t.stats.diet_meat_same_race&&a.isRace(t))continue}else if(a.isRace(t))continue;(e<=0||a.data.age>=e)&&u.default.temp_actors.push(a)}}return l.Toolbox.getClosestActor(u.default.temp_actors,t.currentTile)},e.prototype.isTargetOk=function(t,e){var i;return!(e==t||!t.canAttackTarget(e)||e.stats.actorSize>t.stats.actorSize||null===(i=e.currentTile)||void 0===i||!i.isSameIsland(t.currentTile))},e}(u.default);n.default=h,cc._RF.pop()},{}],BehFindRandomCivBuildingTile:[function(t,e,i){"use strict";cc._RF.push(e,"1690eKlwRZI9LAjG8qcssUY","BehFindRandomCivBuildingTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("MapLayer"),u=a("MapBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindRandomCivBuildingTile",e}return r(e,t),e.prototype.execute=function(t){var e,i=t.currentTile.region;if(c.Toolbox.randomChance(.65)&&i.tiles.length>0)return t.beh_tile_target=i.tiles.getRandom(),l.BehResult.Continue;u.default.inst.getObjectsInChunks(t.currentTile,0,d.MapObjectType.Building);var o=null;u.default.inst.temp_map_objects.shuffle();for(var a=0;a<u.default.inst.temp_map_objects.length;a++){var n=u.default.inst.temp_map_objects[a];if((null===(e=n.currentTile)||void 0===e?void 0:e.isSameIsland(t.currentTile))&&n.stats.cityBuilding&&n.data.state==s.BuildingState.CivKingdom){o=n;break}}return o?(t.beh_tile_target=o.currentTile.region.tiles.getRandom(),l.BehResult.Continue):i.tiles.length>0?(t.beh_tile_target=i.tiles.getRandom(),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=h,cc._RF.pop()},{}],BehFindRandomFrontBuildingTile:[function(t,e,i){"use strict";cc._RF.push(e,"b0676mV0V9Kup6tidmnMN8W","BehFindRandomFrontBuildingTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindRandomFrontBuildingTile",e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){return t.beh_tile_target=t.beh_building_target&&t.beh_building_target.currentTile,s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehFindRandomTile:[function(t,e,i){"use strict";cc._RF.push(e,"6a360Pp3Q9LTIUYwYppcpib","BehFindRandomTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindRandomTile",e}return r(e,t),e.prototype.execute=function(t){var e=t.currentTile.region;return l.Toolbox.randomChance(.65)&&e.tiles.length>0?(t.beh_tile_target=e.tiles.getRandom(),s.BehResult.Continue):(e.neighbours.length>0&&l.Toolbox.randomBool()&&(e=e.neighbours.getRandom()),e.tiles.length>0?(t.beh_tile_target=e.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehFindSameRaceActor:[function(t,e,i){"use strict";cc._RF.push(e,"de3bcauT6FAko8VAW2UZyrJ","BehFindSameRaceActor");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindSameRaceActor",e}return r(e,t),e.prototype.execute=function(t){var e=null;return t.currentTile.region.island.actors.shuffle(),t.currentTile.region.island.actors.forEach(function(i){var o,a;i!=t&&(null===(o=i.data)||void 0===o?void 0:o.alive)&&(null===(a=i.currentTile)||void 0===a?void 0:a.isSameIsland(t.currentTile))&&i.isRace(t)&&i.data.bornTime<=t.data.bornTime&&(e=i)}),t.beh_actor_target=e,t.beh_actor_target?s.BehResult.Continue:s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehFindTargetForHunter:[function(t,e,i){"use strict";cc._RF.push(e,"1cc5a2wFfBMloqTIWJgbfXI","BehFindTargetForHunter");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapLayer"),d=a("MapBox"),u=a("BehaviourActionActor"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTargetForHunter",e}return r(e,t),e.prototype.execute=function(t){return t.beh_actor_target&&this.isTargetOk(t,t.beh_actor_target.a)?s.BehResult.Continue:(t.beh_actor_target=this.getClosestMeatActor(t,3),t.beh_actor_target?s.BehResult.Continue:s.BehResult.Stop)},e.prototype.getClosestMeatActor=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),u.default.temp_actors=[],d.default.inst.getObjectsInChunks(t.currentTile,10,c.MapObjectType.Actor);for(var o=0;o<d.default.inst.temp_map_objects.length;o++){var a=d.default.inst.temp_map_objects[o];this.isTargetOk(t,a)&&a.stats.source_meat&&(e<=0||a.data.age>=e)&&u.default.temp_actors.push(a)}return l.Toolbox.getClosestActor(u.default.temp_actors,t.currentTile)},e.prototype.isTargetOk=function(t,e){var i;return e!=t&&!!t.canAttackTarget(e)&&!(null===(i=e.currentTile)||void 0===i||!i.isSameIsland(t.currentTile))},e}(a("BehCity").default);n.default=h,cc._RF.pop()},{}],BehFindTileBeach:[function(t,e,i){"use strict";cc._RF.push(e,"9b9b9G1e7ZP/4gzLNy+PPQi","BehFindTileBeach");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("BehaviourActionActor"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTileBeach",e}return r(e,t),e.prototype.execute=function(t){if(c.default.possible_moves=[],this.findCornersInRegion(t.currentTile.region),0==c.default.possible_moves.length)for(var e=0;e<t.currentTile.region.neighbours.length;e++){var i=t.currentTile.region.neighbours[e];this.findCornersInRegion(i)}return 0==c.default.possible_moves.length?l.BehResult.Stop:(t.beh_tile_target=c.default.possible_moves.getRandom(),l.BehResult.Continue)},e.prototype.findCornersInRegion=function(t){var e,i;t.getTileCorners().shuffle();try{for(var o=s(t.getTileCorners()),a=o.next();!a.done;a=o.next()){var n=a.value;if(n.type.ocean){c.default.possible_moves.push(n);break}}}catch(d){e={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},e}(c.default);n.default=d,cc._RF.pop()},{}],BehFindTileForCity:[function(t,e,i){"use strict";cc._RF.push(e,"a609alpanJGn56iTbO9ke6k","BehFindTileForCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTileForCity",e}return r(e,t),e.prototype.execute=function(t){var e,i,o;if(0==d.default.inst.cityPlaceFinder.zones.length)return l.BehResult.Stop;var a=null,n=1e5,r=1e5;d.default.inst.cityPlaceFinder.zones.shuffle();var u=null;try{for(var h=s(d.default.inst.cityPlaceFinder.zones),p=h.next();!p.done;p=h.next()){var f=p.value;if(f.goodForNewCity&&f.tiles[0].isSameIsland(t.currentTile)){if(u=f,!(null===(o=t.kingdom)||void 0===o?void 0:o.capital))return t.beh_tile_target=c.Toolbox.getRandom(u.tiles),l.BehResult.Continue;n>(r=c.Toolbox.distVec3(t.kingdom.capital.cityCenter,f.centerTile.posV3))&&(n=r,a=f)}}}catch(m){e={error:m}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(e)throw e.error}}if(a)return t.beh_tile_target=c.Toolbox.getRandom(a.tiles),l.BehResult.Continue;if(u)return t.beh_tile_target=c.Toolbox.getRandom(u.tiles),l.BehResult.Continue;var _=d.default.inst.islandsCalculator.getRandomIslandGround();return _?(t.beh_tile_target=_.getRandomTile(),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehFindTileForFarm:[function(t,e,i){"use strict";cc._RF.push(e,"74f60ZNXDpPi4EKfoFcoJsm","BehFindTileForFarm");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("TopTileLibrary"),c=a("BehaviourActionBase"),d=a("BehaviourActionActor"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTileForFarm",e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a,n,r,u,h;if(t.city.tasks.wheats>0)return c.BehResult.Stop;t.city.zones.shuffle(),d.default.possible_moves=[];for(var p=0;p<t.city.zones.length;p++){var f=t.city.zones[p];try{for(var _=(e=void 0,s(f.canBeFarms)),m=_.next();!m.done;m=_.next()){var g=m.value;if((k=f.getTilesOfType(g))&&0!=k.size)try{for(var y=(o=void 0,s(k)),v=y.next();!v.done;v=y.next()){var b=v.value;!b.targetedBy&&(null===(u=t.currentTile)||void 0===u?void 0:u.isSameIsland(b))&&b.zone==f&&!b.building&&b.isTypeAround(l.default.field)&&d.default.possible_moves.push(b)}}catch(A){o={error:A}}finally{try{v&&!v.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}}}catch(P){e={error:P}}finally{try{m&&!m.done&&(i=_.return)&&i.call(_)}finally{if(e)throw e.error}}}if(0==d.default.possible_moves.length)for(p=0;p<t.city.zones.length;p++)for(var w=t.city.zones[p],T=0;T<w.canBeFarms.length;T++){var k,B=w.canBeFarms[T];if(k=w.getTilesOfType(B))try{for(var S=(n=void 0,s(k)),C=S.next();!C.done;C=S.next()){var x=C.value;!x.building&&!x.targetedBy&&(null===(h=t.currentTile)||void 0===h?void 0:h.isSameIsland(x))&&d.default.possible_moves.push(x)}}catch(O){n={error:O}}finally{try{C&&!C.done&&(r=S.return)&&r.call(S)}finally{if(n)throw n.error}}}return 0==d.default.possible_moves.length?c.BehResult.Stop:(t.beh_tile_target=d.default.possible_moves.getRandom(),c.BehResult.Continue)},e}(a("BehCity").default);n.default=u,cc._RF.pop()},{}],BehFindTileNearbyGroupLeader:[function(t,e,i){"use strict";cc._RF.push(e,"28ea6sRioRPDLVaRpKwtVIs","BehFindTileNearbyGroupLeader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTileNearbyGroupLeader",e}return r(e,t),e.prototype.execute=function(t){var e;return t.unitGroup&&(null===(e=t.unitGroup.groupLeader)||void 0===e?void 0:e.currentTile)?(t.beh_tile_target=t.unitGroup.groupLeader.currentTile.region.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehFindTileWhenOnFire:[function(t,e,i){"use strict";cc._RF.push(e,"382b8W5WfFIxruUvYN8lvGg","BehFindTileWhenOnFire");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("TileTypeBase"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindTileWhenOnFire",e}return r(e,t),e.prototype.execute=function(t){var e,i,o=this.findWaterIn(t.currentTile.chunk);if(!o)try{for(var a=s(t.currentTile.chunk.neighboursAll),n=a.next();!n.done;n=a.next()){var r=n.value;if(o=this.findWaterIn(r))break}}catch(c){e={error:c}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return o?(t.beh_tile_target=o,l.BehResult.Continue):l.BehResult.Stop},e.prototype.findWaterIn=function(t){var e,i;t.tiles.shuffle();try{for(var o=s(t.regions),a=o.next();!a.done;a=o.next()){var n=a.value;if(n.type==c.TileLayerType.Ocean||n.type==c.TileLayerType.Swamp)return n.tiles.getRandom()}}catch(d){e={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return null},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehFindTile:[function(t,e,i){"use strict";cc._RF.push(e,"f5191o3++5DBIMJg2X1+giU","BehFindTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("BehaviourActionActor"),d=function(t){function e(e){var i=t.call(this)||this;return i.type="",i.id="BehFindTile",i.type=e,i}return r(e,t),e.prototype.execute=function(t){if(c.default.possible_moves=[],"new_road"==this.type){var e=t.city.getRoadTileToBuild(t);e&&c.default.possible_moves.push(e)}else this.findInChunks(t);return 0==c.default.possible_moves.length?s.BehResult.Stop:(t.beh_tile_target=l.Toolbox.getRandom(c.default.possible_moves),s.BehResult.Continue)},e.prototype.findInChunks=function(t){for(var e=l.Toolbox.getAllChunksFromTile(t.currentTile),i=0;i<e.length;i++)for(var o=e[i],a=0;a<o.regions.length;a++)for(var n=o.regions[a],r=0;r<n.tiles.length;r++){var s=n.tiles[r];switch(this.type){case"sand":if(!s.type.sand)continue;break;case"water":if(s.targetedBy||!s.type.ocean)continue;break;case"grass":if(!s.isSameIsland(t.currentTile)||s.targetedBy||!s.type.grass||s.building)continue;break;default:if(!s.isSameIsland(t.currentTile))continue}c.default.possible_moves.push(s)}},e}(c.default);n.default=d,cc._RF.pop()},{}],BehFindWheat:[function(t,e,i){"use strict";cc._RF.push(e,"f90ealHgSROe6EY0VeH5Br1","BehFindWheat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("TopTileLibrary"),c=a("BehaviourActionBase"),d=a("ToolBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehFindWheat",e}return r(e,t),e.prototype.execute=function(t){var e,i;t.city.zones.shuffle();for(var o=0,a=0,n=null,r=0,u=0;u<t.city.zones.length;u++){var h=t.city.zones[u].getTilesOfType(l.default.field);if(h&&0!=h.size){o=0,a=0,n=null;try{for(var p=(e=void 0,s(h)),f=p.next();!f.done;f=p.next()){var _=f.value;_.building&&_.building.stats.canBeHarvested&&_.isSameIsland(t.currentTile)&&!_.targetedBy&&(o=d.Toolbox.distTile(t.currentTile,_),(!n||o<a)&&(a=o,n=_))}}catch(m){e={error:m}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(e)throw e.error}}if(++r>3&&n)break}}return n?(t.beh_tile_target=n,t.beh_building_target=t.beh_tile_target.building,c.BehResult.Continue):c.BehResult.Stop},e}(a("BehCity").default);n.default=u,cc._RF.pop()},{}],BehGetResourcesFromMine:[function(t,e,i){"use strict";cc._RF.push(e,"090afY9iqZA6rbRNa4t+ilj","BehGetResourcesFromMine");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){var e=s.default.resources.poolMine.getRandom();return t.haveTrait("miner")&&"stone"==e.id&&(e=s.default.resources.poolMine.getRandom()),t.inventory.add(e.id,1),l.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehGoOrSwimToTileTarget:[function(t,e,i){"use strict";cc._RF.push(e,"986a6I9uKFBjJNA1eI2mQs4","BehGoOrSwimToTileTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.id="BehGoOrSwimToTileTarget",e.walkOnWater=!0,e}return r(e,t),e}(a("BehGoToTileTarget").default);n.default=s,cc._RF.pop()},{}],BehGoToActorTarget:[function(t,e,i){"use strict";cc._RF.push(e,"c6357ouwRtPEKUpH6rkSpJg","BehGoToActorTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorMove"),l=a("BehaviourActionBase"),c=function(t){function e(e,i){void 0===e&&(e="sameTile"),void 0===i&&(i=!1);var o=t.call(this)||this;return o.type="",o.pathOnWater=!1,o.pathOnWater=i,o.type=e,o.id="BehGoToActorTarget",o.null_check_actor_target=!0,o}return r(e,t),e.prototype.execute=function(t){var e=t.beh_actor_target.currentTile;switch(this.type){case"sameTile":e=t.beh_actor_target.currentTile;break;case"sameRegion":e=t.beh_actor_target.currentTile.region.tiles.getRandom()}return t.goTo(e,this.pathOnWater)==s.ExecuteEvent.True?l.BehResult.Continue:(t.targetsToIgnore.has(t.beh_actor_target)||t.targetsToIgnore.add(t.beh_actor_target),l.BehResult.Stop)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehGoToBuildingTarget:[function(t,e,i){"use strict";cc._RF.push(e,"3c702/TjkRO64qFx/pxNg52","BehGoToBuildingTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i.pathOnWater=!1,i.id="BehGoToBuildingTarget",i.pathOnWater=e,i.null_check_building_target=!0,i}return r(e,t),e.prototype.execute=function(t){return this.goToBuilding(t),s.BehResult.Continue},e.prototype.goToBuilding=function(t){var e,i=null===(e=t.beh_building_target)||void 0===e?void 0:e.currentTile;i?t.goTo(i,this.pathOnWater):t.clearBeh()},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehGoToTileTarget:[function(t,e,i){"use strict";cc._RF.push(e,"2aac513iglDsY1GeRXX2sG0","BehGoToTileTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorMove"),l=a("BehaviourActionBase"),c=function(t){function e(e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=t.call(this)||this;return o.walkOnWater=!1,o.walkOnBlocks=!1,o.id="BehGoToTileTarget",o.walkOnWater=e,o.walkOnBlocks=i,o.null_check_tile_target=!0,o}return r(e,t),e.prototype.execute=function(t){return t.beh_tile_target&&t.goTo(t.beh_tile_target,this.walkOnWater,this.walkOnBlocks)==s.ExecuteEvent.False?l.BehResult.Stop:l.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehHeal:[function(t,e,i){"use strict";cc._RF.push(e,"bb8e7pUBkRMsIUsE8aJXRbV","BehHeal");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehHeal",e}return r(e,t),e.prototype.execute=function(t){return t.data.health==t.curStats.health?l.BehResult.Stop:(s.default.spells.get("bloodRain").action.do(t,t.currentTile),t.doCastAnimation(),l.BehResult.Continue)},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehJoinCity:[function(t,e,i){"use strict";cc._RF.push(e,"17bc4+x/8JJz6CWehUmRlq6","BehJoinCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehJoinCity",e}return r(e,t),e.prototype.execute=function(t){var e=t.currentTile.zone.city;if(!e)return s.BehResult.Stop;if(e==t.city)return s.BehResult.Stop;if(e.kingdom==t.kingdom||t.kingdom.isNomads()&&t.race==e.race){var i=null;return t.city&&(i=t.city,t.city.removeCitizen(t),t.removeFromCity()),t.becomeCitizen(e),i&&i.checkSettleTarget(),s.BehResult.Continue}return s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehJumpingAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"92543pr5KRBKpvfZv9dT1Yt","BehJumpingAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(e){var i=t.call(this)||this;return i.timer_action=0,i.id="BehJumpingAnimation",i.timer_action=e,i.null_check_tile_target=!0,i}return r(e,t),e.prototype.execute=function(t){return t.timer_jump_animation=this.timer_action,t.timer_action=this.timer_action,s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehLookAtTarget:[function(t,e,i){"use strict";cc._RF.push(e,"fd8008J12BB05fFKNC/8Y/r","BehLookAtTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(e){var i=t.call(this)||this;return i.type="",i.id="BehLookAtTarget",i.type=e,i.null_check_building_target=!0,i}return r(e,t),e.prototype.execute=function(t){var e,i;return(null===(e=t.beh_building_target)||void 0===e?void 0:e.currentTile)||t.clearBeh(),"building_target"==this.type&&t.stats.flipAnimation&&(null===(i=t.beh_building_target)||void 0===i?void 0:i.currentTile)&&(t.node.x<t.beh_building_target.currentTile.x?t.setFlip(!0):t.setFlip(!1)),t.timer_action=.3,s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehMagicMakeSkeleton:[function(t,e,i){"use strict";cc._RF.push(e,"1e50esVV79OEJBIlmOe0emB","BehMagicMakeSkeleton");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehMagicMakeSkeleton",e}return r(e,t),e.prototype.execute=function(t){var e,i;if(l.Toolbox.findSameUnitInChunkAround(t.currentTile.chunk,"skeleton"),l.Toolbox.temp_list_units.length>6)return s.BehResult.Stop;var o=null===(i=null===(e=t.currentTile)||void 0===e?void 0:e.region)||void 0===i?void 0:i.tiles.getRandom();if(!o)return s.BehResult.Stop;if(o.units.length>0)return s.BehResult.Stop;var a=c.default.inst.stackEffects.get("fx_create_skeleton").spawnAt(o.posV3,t.stats.baseStats.scale);return t.doCastAnimation(),a.setCallback(19,function(){c.default.inst.createNewUnit("skeleton",o).makeWait(1)}),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehMakeBaby:[function(t,e,i){"use strict";cc._RF.push(e,"a64f8FzpbpKfqso301WNQ5r","BehMakeBaby");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AchievData"),c=a("ActorTool"),d=a("BehaviourActionBase"),u=a("ToolBox"),h=a("MapBox"),p=function(t){function e(){var e=t.call(this)||this;return e.id="BehMakeBaby",e.null_check_actor_target=!0,e}return r(e,t),e.prototype.execute=function(t){return t.beh_actor_target?this.makeBaby(t,t.beh_actor_target.a):t.clearBeh(),d.BehResult.Continue},e.prototype.makeBaby=function(t,e){var i,o;t.startBabymakingTimeout(),e.startBabymakingTimeout(),t.data.children++,e.data.children++;var a=u.Toolbox.randomBool()?t.stats.id:e.stats.id,n=null;try{for(var r=s(t.currentTile.neighbours),d=r.next();!d.done;d=r.next()){var p=d.value;if(p!=t.currentTile&&p!=t.currentTile&&!p.type.liquid){n=p;break}}}catch(_){i={error:_}}finally{try{d&&!d.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}n||(n=t.currentTile);var f=h.default.inst.createNewUnit(a,n,null,6);f.justBorn(),f.data.hunger=f.stats.maxHunger/2,f.stats.useSkinColors&&(u.Toolbox.randomBool()?f.data.skin_set=t.data.skin_set:f.data.skin_set=e.data.skin_set,f.data.skin=c.default.getBabyColor(t,e)),h.default.inst.gameStats.creaturesBorn++,f.stats.animal&&(l.default.update(9),l.default.update(68))},e}(a("BehaviourActionActor").default);n.default=p,cc._RF.pop()},{}],BehMakeFarm:[function(t,e,i){"use strict";cc._RF.push(e,"d55f2axbYdOaYdqVm0Ywi0o","BehMakeFarm");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AchievData"),l=a("MapAction"),c=a("TopTileLibrary"),d=a("BehaviourActionBase"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehMakeFarm",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){return t.beh_tile_target.type.canBeFarmField&&!t.beh_tile_target.building?(s.default.update(5),l.default.terraformTop(t.beh_tile_target,c.default.field),d.BehResult.Continue):d.BehResult.Stop},e}(a("BehCity").default);n.default=u,cc._RF.pop()},{}],BehMakeItem:[function(t,e,i){"use strict";cc._RF.push(e,"f881cF6oflBoagCj1l28S+I","BehMakeItem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehMakeItem",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){return t.city.tryProduceItem(t),s.BehResult.Continue},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehMoveAwayFromBlock:[function(t,e,i){"use strict";cc._RF.push(e,"3563b0DktVFQ6M3nVXgRjwJ","BehMoveAwayFromBlock");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("TileTypeBase"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehMoveAwayFromBlock",e}return r(e,t),e.prototype.execute=function(t){if(t.currentTile.region.island.type!=c.TileLayerType.Block)return s.BehResult.Stop;for(var i=null,o=0,a=0,n=t.currentTile.region.island,r=0;r<n.regionsCorners.length;r++){var d=n.regionsCorners[r];if(0!=d.getTileCorners().length)for(var u=d.getTileCorners(),h=0;h<u.length;h++){var p=u[h];e.isGoodTileRegion(p.region,t)&&p.region.island!=n&&p.region.island.getTileCount()>=5&&(o=l.Toolbox.distTile(t.currentTile,p),(!i||o<a)&&(i=p,a=o))}}return i?(t.beh_tile_target=i,s.BehResult.Continue):s.BehResult.Stop},e.isGoodTileRegion=function(t,e){return!(t.type==c.TileLayerType.Ocean&&e.stats.damagedByOcean||t.type==c.TileLayerType.Lava&&e.stats.dieInLava)},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehPlantCrops:[function(t,e,i){"use strict";cc._RF.push(e,"3339bC5CZJBuL1MPZ/X4kf8","BehPlantCrops");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TopTileLibrary"),l=a("BehaviourActionBase"),c=a("MapBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehPlantCrops",e.null_check_tile_target=!0,e}return r(e,t),e.prototype.execute=function(t){return t.beh_tile_target.type!=s.default.field||t.beh_tile_target.building?l.BehResult.Stop:(c.default.inst.addBuilding("0wheat",t.beh_tile_target),l.BehResult.Continue)},e}(a("BehCity").default);n.default=d,cc._RF.pop()},{}],BehRandomSwim:[function(t,e,i){"use strict";cc._RF.push(e,"37262m7zOxOsLzscCihDtlS","BehRandomSwim");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("BehaviourActionActor"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehRandomSwim",e}return r(e,t),e.prototype.execute=function(t){return c.default.possible_moves=[],t.currentTile.neighboursAll.forEach(function(t){t.type.liquid&&c.default.possible_moves.push(t)}),c.default.possible_moves.length>0&&t.moveTo(l.Toolbox.getRandom(c.default.possible_moves)),s.BehResult.Continue},e}(c.default);n.default=d,cc._RF.pop()},{}],BehRandomTeleport:[function(t,e,i){"use strict";cc._RF.push(e,"73997e14zJENo5BxLZ/DQHE","BehRandomTeleport");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetManager"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehRandomTeleport",e}return r(e,t),e.prototype.execute=function(t){return t.data.health<t.curStats.health?l.BehResult.Stop:c.Toolbox.randomChance(.3)&&s.default.spells.get("teleportRandom").action.do(t,t.currentTile)?(t.doCastAnimation(),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehRandomWait:[function(t,e,i){"use strict";cc._RF.push(e,"16385tOZ/5JX49xnPrDldZk","BehRandomWait");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=1);var o=t.call(this)||this;return o.min=0,o.max=0,o.min=e,o.max=i,o.id="BehRandomWait",o}return r(e,t),e.prototype.execute=function(t){return t.timer_action=l.Toolbox.randomFloat(this.min,this.max),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehRemoveRuins:[function(t,e,i){"use strict";cc._RF.push(e,"34b42WeZRlNm7tgElMO8Zcv","BehRemoveRuins");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehRemoveRuins",e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){return t.beh_building_target.startRemove(),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehRepairInDock:[function(t,e,i){"use strict";cc._RF.push(e,"0a4a39EjbdLvpXk+Shxw7ca","BehRepairInDock");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehRepairInDock",e.special_inside_object=!0,e.check_building_target_non_usable=!0,e.null_check_building_target=!0,e}return r(e,t),e.prototype.execute=function(t){if(t.curStats.health<=t.data.health)return s.BehResult.Continue;var e=t.curStats.health-t.data.health;e=e>100?100:e,t.restoreHealth(e);var i=e/25;return t.timer_action=Math.ceil(i),t.stayInBuilding(t.beh_building_target),t.beh_tile_target=null,t.beh_building_target.startShake(.5),t.curStats.health>t.data.health?s.BehResult.RepeatStep:s.BehResult.Continue},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehReplenishHunger:[function(t,e,i){"use strict";cc._RF.push(e,"32b37h0uEFHN5B+u27bFkrO","BehReplenishHunger");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehReplenishHunger",e}return r(e,t),e.prototype.execute=function(t){return t.restoreStatsFromEating(t.stats.maxHunger),s.BehResult.Continue},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehResourceGatheringAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"c6919npmEZAr64z+8H7nh0T","BehResourceGatheringAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("MapBox"),c=function(t){function e(e){var i=t.call(this)||this;return i.timer_action=0,i.id="BehResourceGatheringAnimation",i.timer_action=e,i.null_check_building_target=!0,i.check_building_target_non_usable=!0,i}return r(e,t),e.prototype.execute=function(t){return"fruits"!=t.beh_building_target.stats.type||t.beh_building_target.haveResources?(t.beh_building_target.getConstructionTile(),t.punchTargetAnimation(t.beh_building_target.currentTile.posV3,t.beh_building_target.currentTile),t.beh_building_target.resourceGathering(l.default.inst.elapsed),t.timer_action=this.timer_action,s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehRestartTask:[function(t,e,i){"use strict";cc._RF.push(e,"a04e38Yu/RPH5u+Wl7Tz+ic","BehRestartTask");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehRestartTask",e}return r(e,t),e.prototype.execute=function(){return s.BehResult.RestartTask},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehSetNextTask:[function(t,e,i){"use strict";cc._RF.push(e,"101f2820JBI257b48pydivo","BehSetNextTask");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(e,i){void 0===i&&(i=!0);var o=t.call(this)||this;return o.clean=!1,o.task_id="",o.id="BehSetNextTask",o.task_id=e,o.clean=i,o}return r(e,t),e.prototype.execute=function(t){return this.forceTask(t,this.task_id,this.clean)},e}(a("BehaviourActionActor").default);n.default=s,cc._RF.pop()},{}],BehShortRandomMove:[function(t,e,i){"use strict";cc._RF.push(e,"c7e4bvkVApGlKOYIfAG1QkG","BehShortRandomMove");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehShortRandomMove",e}return r(e,t),e.prototype.execute=function(t){var e=null;t.currentTile.neighboursAll.shuffle();for(var i=0;i<t.currentTile.neighboursAll.length;i++){var o=t.currentTile.neighboursAll[i];if(o.type.layerType==t.currentTile.type.layerType){e=o;break}}return e?(t.beh_tile_target=e,s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=l,cc._RF.pop()},{}],BehSitInsideBoat:[function(t,e,i){"use strict";cc._RF.push(e,"40e6am3RolFYpPtrF5BCpwp","BehSitInsideBoat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=t.call(this)||this;return e.id="BehSitInsideBoat",e.special_inside_object=!0,e}return r(e,t),e}(a("BehaviourActionActor").default);n.default=s,cc._RF.pop()},{}],BehSkeletonFindTile:[function(t,e,i){"use strict";cc._RF.push(e,"d5d5fuGwn5APYwLXnE3QOXy","BehSkeletonFindTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehSkeletonFindTile",e}return r(e,t),e.prototype.execute=function(t){if(l.Toolbox.findSameUnitInChunkAround(t.currentTile.chunk,"necromancer"),0!=l.Toolbox.temp_list_units.length){var e=l.Toolbox.temp_list_units.getRandom();return t.beh_tile_target=e.currentTile.region.tiles.getRandom(),s.BehResult.Continue}var i=t.currentTile.region;return i.neighbours.length>0&&l.Toolbox.randomBool()&&(i=i.neighbours.getRandom()),i.tiles.length>0?(t.beh_tile_target=i.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop},e}(a("BehaviourActionActor").default);n.default=c,cc._RF.pop()},{}],BehSpawnGrassSeeds:[function(t,e,i){"use strict";cc._RF.push(e,"38788j0YrRFmI9RDDKOyL2c","BehSpawnGrassSeeds");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetManager"),l=a("BehaviourActionBase"),c=a("ToolBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehSpawnGrassSeeds",e}return r(e,t),e.prototype.execute=function(t){if(!c.Toolbox.randomChance(.3))return l.BehResult.Stop;if(!t.currentTile.type.ground)return l.BehResult.Stop;var i=s.default.spells.get("spawnGrassSeeds");e._tiles=[];for(var o=0;o<t.currentTile.region.tiles.length;o++){var a=t.currentTile.region.tiles[o];"grass"!=a.type.biome&&a.type.canGrowBiomeGrass&&e._tiles.push(a)}return 0==e._tiles.length?l.BehResult.Stop:(i.action.do(t,c.Toolbox.getRandom(e._tiles)),t.doCastAnimation(),l.BehResult.Continue)},e._tiles=[],e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehSpecialRat:[function(t,e,i){"use strict";cc._RF.push(e,"204f8h7wF5G9brtrMSarDac","BehSpecialRat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("MapLayer"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="BehSpecialRat",e}return r(e,t),e.prototype.execute=function(t){if(t.haveTrait("rat")&&l.Toolbox.randomChance(.7)){var e=this.findNearbyRatKingTile(t);if(e)return t.beh_tile_target=e,s.BehResult.Continue}var i=t.currentTile.region;return i.neighbours.length>0&&l.Toolbox.randomBool()&&(i=i.neighbours.getRandom()),i.tiles.length>0?(t.beh_tile_target=i.tiles.getRandom(),s.BehResult.Continue):s.BehResult.Stop},e.prototype.findNearbyRatKingTile=function(t){if(0==d.default.inst.kingdoms.getKingdomByID("ratKings").units.length)return null;var e=this.findRatKing(t);return e&&l.Toolbox.getRandom(e.currentTile.neighboursAll)||null},e.prototype.findRatKing=function(t){d.default.inst.getObjectsInChunks(t.currentTile,10,c.MapObjectType.Actor);for(var e=0;e<d.default.inst.temp_map_objects.length;e++){var i=d.default.inst.temp_map_objects[e];if(i!=t&&i.haveTrait("ratKing"))return i}return null},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehStayInBuildingTarget:[function(t,e,i){"use strict";cc._RF.push(e,"aa60aamV3dE9LJTyh8rHm3H","BehStayInBuildingTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=1);var o=t.call(this)||this;return o.min=0,o.max=0,o.min=e,o.max=i,o.id="BehStayInBuildingTarget",o.special_inside_object=!0,o.check_building_target_non_usable=!0,o.null_check_building_target=!0,o}return r(e,t),e.prototype.execute=function(t){return t.beh_building_target&&(t.timer_action=l.Toolbox.randomFloat(this.min,this.max),t.stayInBuilding(t.beh_building_target),t.beh_tile_target=null,t.beh_building_target.startShake(.5)),s.BehResult.Continue},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehSwimToIsland:[function(t,e,i){"use strict";cc._RF.push(e,"7f3b9vjfYFAQbThUIw3NV5F","BehSwimToIsland");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("TileTypeBase"),u=a("MapBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehSwimToIsland",e}return r(e,t),e.prototype.execute=function(t){var i,o;if(e.isGoodIsland(t.currentTile.region.island,t))return l.BehResult.Stop;e.best_region=null,e.dist=0,e.best_dist=0;var a=t.currentTile.region.island;if(e.best_region=e.findIslandNearby(t),e.best_region)return t.beh_tile_target=e.best_region.tiles.getRandom(),l.BehResult.Continue;try{for(var n=s(u.default.inst.islandsCalculator.islands),r=n.next();!r.done;r=n.next()){var d=r.value;if(e.checkIsland(a,d,t)){var h=d.regionsCorners.getRandom();0!=h.getTileCorners().length&&(e.dist=c.Toolbox.distTile(t.currentTile,h.getTileCorners().getRandom()),(!e.best_region||e.dist<e.best_dist)&&(e.best_region=h,e.best_dist=e.dist))}}}catch(f){i={error:f}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}if(c.Toolbox.randomChance(.8)&&e.best_region)t.beh_tile_target=e.best_region.tiles.getRandom();else{var p=c.Toolbox.randomChance(.5)?t.currentTile.region:c.Toolbox.getRandom(t.currentTile.region.neighbours);p&&(t.beh_tile_target=c.Toolbox.getRandom(p.tiles))}return l.BehResult.Continue},e.findIslandNearby=function(t){for(var i=c.Toolbox.getAllChunksFromTile(t.currentTile),o=t.currentTile.region.island,a=0;a<i.length;a++)for(var n=i[a],r=0;r<n.regions.length;r++){var s=n.regions[r];e.checkIsland(o,s.island,t)&&0!=s.getTileCorners().length&&(e.dist=c.Toolbox.distTile(t.currentTile,s.getTileCorners().getRandom()),(!e.best_region||e.dist<e.best_dist)&&(e.best_region=s,e.best_dist=e.dist))}return e.best_region},e.checkIsland=function(t,i,o){return t!=i&&!!e.isGoodIsland(i,o)&&!(t.getTileCount()<=i.getTileCount()?!t.connectedWith(i):!i.connectedWith(t))&&0!=i.regionsCorners.length},e.isGoodIsland=function(t){return t.type!=d.TileLayerType.Block&&t.type!=d.TileLayerType.Ocean&&t.type!=d.TileLayerType.Lava&&t.type!=d.TileLayerType.Swamp&&!(t.getTileCount()<=5)},e.best_region=null,e.dist=0,e.best_dist=0,e}(a("BehaviourActionActor").default);n.default=h,cc._RF.pop()},{}],BehTaxiCheck:[function(t,e,i){"use strict";cc._RF.push(e,"7ea3drEr9lB8L4CSN6piv4d","BehTaxiCheck");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("TaxiManager"),l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e.id="BehTaxiCheck",e}return r(e,t),e.prototype.execute=function(t){var e,i;if(!(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.alive)||!t.city||!t.currentTile)return l.BehResult.Stop;var o=t.city.getTile();if(!o)return l.BehResult.Stop;var a=!1;return t.isCurrentJob("attacker")?t.currentTile.isSameIsland(o)||t.city.attackZone&&t.city.attackZone.centerTile.isSameIsland(t.currentTile)||(a=!0):t.isCurrentJob("settler")?(null===(i=t.city)||void 0===i?void 0:i.settleTarget)||o.isSameIsland(t.currentTile)||(a=!0):t.currentTile.isSameIsland(o)||(a=!0),a?(s.default.newRequest(t,o),l.BehResult.Continue):l.BehResult.Stop},e}(a("BehCity").default);n.default=c,cc._RF.pop()},{}],BehTaxiEmbark:[function(t,e,i){"use strict";cc._RF.push(e,"d21015TRGRFn6gtWbEFIC5s","BehTaxiEmbark");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Boat"),l=a("TaxiManager"),c=a("TaxiRequest"),d=a("BehaviourActionBase"),u=a("ToolBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehTaxiEmbark",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){var e=l.default.getRequestForActor(t);if(!e||!e.taxi||e.state!=c.TaxiRequestState.Loading)return d.BehResult.Stop;var i=e.taxi.actor.getComponent(s.default),o=i.isNearDock();return u.Toolbox.distTile(i.actor.currentTile,t.currentTile)<5||o?(t.beh_tile_target=null,t.embarkInto(e.taxi),d.BehResult.Continue):d.BehResult.Stop},e}(a("BehCity").default);n.default=h,cc._RF.pop()},{}],BehTaxiFindShipTile:[function(t,e,i){"use strict";cc._RF.push(e,"50248/ihVhEf7+0qCP28Hv3","BehTaxiFindShipTile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Boat"),l=a("TaxiManager"),c=a("TaxiRequest"),d=a("BehaviourActionBase"),u=a("PathfinderTools"),h=function(t){function e(){var e=t.call(this)||this;return e.id="BehTaxiFindShipTile",e}return r(e,t),e.prototype.execute=function(t){var e=l.default.getRequestForActor(t);if(!e||!e.taxi||e.state!=c.TaxiRequestState.Loading)return d.BehResult.Stop;var i=e.taxi.actor.getComponent(s.default),o=null;if(i.pickup_near_dock){var a=i.actor.homeBuilding;if(a){var n=a.getConstructionTile();n&&(o=n.region.tiles.getRandom())}}return o||(o=u.default.raycastTileForUnitToEmbark(t.currentTile,e.taxi.actor.currentTile)),o?(t.beh_tile_target=o,d.BehResult.Continue):d.BehResult.Stop},e}(a("BehCity").default);n.default=h,cc._RF.pop()},{}],BehTryBabymaking:[function(t,e,i){"use strict";cc._RF.push(e,"a4dc69TqhhIdaU6A8SWRycI","BehTryBabymaking");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e._units=[],e.id="BehTryBabymaking",e}return r(e,t),e.prototype.execute=function(t){var e;if(!(null===(e=t.currentTile)||void 0===e?void 0:e.region.island))return l.BehResult.Stop;if(!this.isAvailableForReproduction(t))return l.BehResult.Stop;if(this.countUnitsInChunks(t.currentTile)>=t.stats.animal_baby_making_around_limit)return l.BehResult.Stop;if(!t.timerReproduction.isActive){if(this.tryStartBabymaking(t))return l.BehResult.RepeatStep;t.timerReproduction.startTimer(20)}return l.BehResult.Stop},e.prototype.countUnitsInChunks=function(t){this._units=[],c.Toolbox.fillListWithUnitsFromChunk(t.chunk,this._units);for(var e=0;e<t.chunk.neighboursAll.length;e++){var i=t.chunk.neighboursAll[e];c.Toolbox.fillListWithUnitsFromChunk(i,this._units)}return this._units.length},e.prototype.tryStartBabymaking=function(t){if(t.race.units.length>30)return!1;if(c.Toolbox.findSameRaceInChunkAround(t.currentTile.chunk,t.stats.race),c.Toolbox.temp_list_units.length>=4)return!1;if(t.stats.layEggs&&!t.isAffectedByLiquid())return this.makeEgg(t),!0;var e=this.findPartner(t);return!!e&&(t.ai.setTask("babymaking",!0,!0),t.beh_actor_target=e,t.beh_actor_target.a.makeWait(),!0)},e.prototype.findPartner=function(t){var e=this,i=0,o=0,a=null;return t.race.units.list.forEach(function(n){var r,s=n;s!=t&&e.isAvailableForReproduction(s)&&(null===(r=s.currentTile)||void 0===r?void 0:r.isSameIsland(t.currentTile))&&((i=c.Toolbox.distTile(t.currentTile,s.currentTile))>50||a&&!(i<o)||(o=i,a=s))}),a},e.prototype.isAvailableForReproduction=function(t){var e,i;return!(null===(e=t.data)||void 0===e||!e.alive||null===(i=t.stats)||void 0===i||!i.procreate||t.data.hunger<60||t.data.age<=t.stats.procreate_age||t.timerReproduction.isActive)},e.prototype.makeEgg=function(t){var e,i;t.startBabymakingTimeout(),t.data.children++;var o=null;try{for(var a=s(t.currentTile.neighbours),n=a.next();!n.done;n=a.next()){var r=n.value;if(r!=t.currentTile&&r!=t.currentTile&&!r.type.liquid){o=r;break}}}catch(c){e={error:c}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}o||(o=t.currentTile);var l=d.default.inst.createNewUnit(t.stats.eggStatsID,o,null,6);t.stats.useSkinColors&&(l.data.skin_set=t.data.skin_set)},e}(a("BehaviourActionActor").default);n.default=u,cc._RF.pop()},{}],BehUnloadResources:[function(t,e,i){"use strict";cc._RF.push(e,"dc687GmHslMNJb+hubxG53h","BehUnloadResources");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="BehUnloadResources",e.special_inside_object=!0,e}return r(e,t),e.prototype.execute=function(t){return t.inventory.resource?(t.city.data.storage.change(t.inventory.resource,t.inventory.amount),t.inventory.empty(),s.BehResult.Continue):s.BehResult.Continue},e}(a("BehCity").default);n.default=l,cc._RF.pop()},{}],BehWalkIntoWaterCorner:[function(t,e,i){"use strict";cc._RF.push(e,"5e496LEkW9PV5iUIV95NCJM","BehWalkIntoWaterCorner");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("TileTypeBase"),d=function(t){function e(){var e=t.call(this)||this;return e.id="BehWalkIntoWaterCorner",e}return r(e,t),e.prototype.execute=function(t){if(e.isGoodIsland(t.currentTile.region.island,t))return s.BehResult.Stop;for(var i=null,o=0,a=0,n=t.currentTile.region.island,r=0;r<n.regionsCorners.length;r++)for(var c=n.regionsCorners[r].getTileCorners(),d=0;d<c.length;d++){var u=c[d];u.type.ocean&&(o=l.Toolbox.distTile(t.currentTile,u),(!i||o<a)&&(i=u,a=o))}return i?(t.beh_tile_target=i,s.BehResult.Continue):s.BehResult.Stop},e.isGoodIsland=function(t,e){return!(t.type==c.TileLayerType.Block||t.type==c.TileLayerType.Ocean||t.type==c.TileLayerType.Swamp||t.type==c.TileLayerType.Lava&&e.stats.dieInLava||t.getTileCount()<=5)},e}(a("BehaviourActionActor").default);n.default=d,cc._RF.pop()},{}],BehaviourActionActor:[function(t,e,i){"use strict";cc._RF.push(e,"4e29dNDUmlOdIL1Nsbq/2mS","BehaviourActionActor");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.null_check_city=!1,e.null_check_kingdom=!1,e.null_check_tile_target=!1,e.null_check_building_target=!1,e.null_check_actor_target=!1,e.check_building_target_non_usable=!1,e.special_inside_object=!1,e.forceAnimation=null,e.id="BehaviourActionActor",e}return r(e,t),e.prototype.forceTask=function(t,e,i){return void 0===i&&(i=!0),t.ai.setTask(e,i),s.BehResult.Skip},e.prototype.errorsFound=function(e){var i,o,a,n,r;return null===(i=e.currentTile.region)||void 0===i||!i.island||!(!this.null_check_city||(null===(o=e.city)||void 0===o?void 0:o.alive))||!(!this.null_check_actor_target||(null===(n=null===(a=e.beh_actor_target)||void 0===a?void 0:a.base_data)||void 0===n?void 0:n.alive))||!(!this.null_check_tile_target||e.beh_tile_target)||!(!this.null_check_building_target||e.beh_building_target)||!!(this.check_building_target_non_usable&&(null===(r=e.beh_building_target)||void 0===r?void 0:r.isNonUsable()))||t.prototype.errorsFound.call(this,e)},e.temp_actors=[],e.temp_cities=[],e.temp_tasks=[],e.possible_moves=[],e}(s.default);n.default=l,cc._RF.pop()},{}],BehaviourActionBase:[function(t,e,i){"use strict";cc._RF.push(e,"612aeEKRCdMo5y0AbQQV1nr","BehaviourActionBase");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.BehaviourActionKingdom=n.BehResult=void 0;var s,l=a("AssetLibrary");(function(t){t[t.Continue=0]="Continue",t[t.Stop=1]="Stop",t[t.RepeatStep=2]="RepeatStep",t[t.Skip=3]="Skip",t[t.RestartTask=4]="RestartTask",t[t.ActiveTaskReturn=5]="ActiveTaskReturn"})(s=n.BehResult||(n.BehResult={}));var c=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.startExecute=function(t){return this.errorsFound(t)?s.Stop:this.execute(t)},e.prototype.execute=function(){return s.Continue},e.prototype.errorsFound=function(){return!1},e}(l.Asset);n.default=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(c);n.BehaviourActionKingdom=d,cc._RF.pop()},{}],BehaviourActionCity:[function(t,e,i){"use strict";cc._RF.push(e,"97f635/AB9Es6y3ry83RUHR","BehaviourActionCity");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.errorsFound=function(e){return 0==e.zones.length||0==e.getPopulationTotal()||t.prototype.errorsFound.call(this,e)},e}(a("BehaviourActionBase").default);n.default=s,cc._RF.pop()},{}],BehaviourTaskActorLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"4e0e4X5upJF0qybM7hr5ubC","BehaviourTaskActorLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehActiveCrabDangerCheck"),l=a("BehAngleAnimation"),c=a("BehAnimalCheckHungry"),d=a("BehAnimalFindTile"),u=a("BehAttackActorTarget"),h=a("BehaviourTaskActor"),p=a("BehBabymakingTime"),f=a("BehBeeCheckHome"),_=a("BehBeeCheckReturnHome"),m=a("BehBeePollinate"),g=a("BehBeeReturnHome"),y=a("BehBoatCheckFishingRepeat"),v=a("BehBoatCheckHomeDocks"),b=a("BehBoatCollectFish"),w=a("BehBoatDamageCheck"),T=a("BehBoatDangerCheck"),k=a("BehBoatFindOceanNeutralTile"),B=a("BehBoatFindRequest"),S=a("BehBoatFindTargetForTrade"),C=a("BehBoatFindTileInDock"),x=a("BehBoatFindWaterTile"),A=a("BehBoatFishing"),P=a("BehBoatMakeTrade"),O=a("BehBoatSetHomeDockTarget"),R=a("BehBoatTransportCheck"),F=a("BehBoatTransportDoLoading"),L=a("BehBoatTransportFindTilePickUp"),D=a("BehBoatTransportFindTileUnload"),M=a("BehBoatTransportUnloadUnits"),I=a("BehBuildTargetProgress"),j=a("BehBurnTumorTiles"),E=a("BehCheckBuildCity"),N=a("BehCheckCitizenJob"),z=a("BehCheckCityArmyGroup"),G=a("BehCheckCure"),U=a("BehCheckHunger"),W=a("BehCheckIfInLiquid"),q=a("BehCheckIfOnGround"),H=a("BehCheckIfOnSmallLand"),V=a("BehChuckTargetBuildProgress"),Z=a("BehCityCheckAttack"),K=a("BehCityCreateRoad"),J=a("BehCityFindBuilding"),Y=a("BehCityFindFireZone"),Q=a("BehCityFindNewJob"),X=a("BehCityFindStorage"),$=a("BehCityGetRandomZoneTile"),tt=a("BehCityRemoveFire"),et=a("BehCitySettlerFindTileSameIsland"),it=a("BehCitySettlerTaxiCheck"),ot=a("BehCityWarriorTaxiCheck"),at=a("BehConsumeActorTarget"),nt=a("BehConsumeFlowers"),rt=a("BehConsumeGrass"),st=a("BehConsumeTargetBuilding"),lt=a("BehConvertOre"),ct=a("BehCrabBurrow"),dt=a("BehEndJob"),ut=a("BehExitBuilding"),ht=a("BehExtractResourcesFromBuilding"),pt=a("BehFightCheckEnemyIsOk"),ft=a("BehFindBuilding"),_t=a("BehFindConstructionTile"),mt=a("BehFindEmptyNearbyCity"),gt=a("BehFindFarmField"),yt=a("BehFindGoldenBrain"),vt=a("BehFindMeatSource"),bt=a("BehFindRandomCivBuildingTile"),wt=a("BehFindRandomFrontBuildingTile"),Tt=a("BehFindRandomTile"),kt=a("BehFindSameRaceActor"),Bt=a("BehFindTargetForHunter"),St=a("BehFindTile"),Ct=a("BehFindTileBeach"),xt=a("BehFindTileForCity"),At=a("BehFindTileForFarm"),Pt=a("BehFindTileNearbyGroupLeader"),Ot=a("BehFindTileWhenOnFire"),Rt=a("BehFindWheat"),Ft=a("BehGetResourcesFromMine"),Lt=a("BehGoOrSwimToTileTarget"),Dt=a("BehGoToActorTarget"),Mt=a("BehGoToBuildingTarget"),It=a("BehGoToTileTarget"),jt=a("BehHeal"),Et=a("BehJoinCity"),Nt=a("BehJumpingAnimation"),zt=a("BehLookAtTarget"),Gt=a("BehMagicMakeSkeleton"),Ut=a("BehMakeBaby"),Wt=a("BehMakeFarm"),qt=a("BehMakeItem"),Ht=a("BehMoveAwayFromBlock"),Vt=a("BehPlantCrops"),Zt=a("BehRandomSwim"),Kt=a("BehRandomTeleport"),Jt=a("BehRandomWait"),Yt=a("BehRemoveRuins"),Qt=a("BehRepairInDock"),Xt=a("BehReplenishHunger"),$t=a("BehResourceGatheringAnimation"),te=a("BehRestartTask"),ee=a("BehSetNextTask"),ie=a("BehShortRandomMove"),oe=a("BehSkeletonFindTile"),ae=a("BehSpawnGrassSeeds"),ne=a("BehSpecialRat"),re=a("BehStayInBuildingTarget"),se=a("BehSwimToIsland"),le=a("BehTaxiCheck"),ce=a("BehTaxiEmbark"),de=a("BehTaxiFindShipTile"),ue=a("BehTryBabymaking"),he=a("BehUnloadResources"),pe=a("BehWalkIntoWaterCorner"),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.initTasksBoats(),this.initTasksMobs();var e=new h.default;e.id="nothing",this.add(e);var i=new h.default;i.id="fight",i.fighting=!0,this.add(i),this.t.addBeh(new pt.default),this.t.addBeh(new Dt.default("sameTile",!0)),this.t.addBeh(new te.default);var o=new h.default;o.id="move_from_block",o.moveFromBlock=!0,o.ignoreFightCheck=!0,this.add(o),this.t.addBeh(new Ht.default),this.t.addBeh(new It.default(!0,!0));var a=new h.default;a.id="swim_to_island",a.ignoreFightCheck=!0,a.swim_to_island=!0,this.add(a),this.t.addBeh(new se.default),this.t.addBeh(new Lt.default);var n=new h.default;n.id="check_if_stuck_on_small_land",n.ignoreFightCheck=!0,this.add(n),this.t.addBeh(new H.default),this.t.addBeh(new pe.default),this.t.addBeh(new Lt.default);var r=new h.default;r.id="pollinate",this.add(r),this.t.addBeh(new f.default),this.t.addBeh(new ft.default("flowers")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,3)),this.t.addBeh(new m.default),this.t.addBeh(new _.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new g.default);var s=new h.default;s.id="random_move",this.add(s),this.t.addBeh(new Tt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,6));var c=new h.default;c.id="random_animal_move",this.add(c),this.t.addBeh(new d.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(3,6));var p=new h.default;p.id="random_move_towards_civ_building",this.add(p),this.t.addBeh(new bt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,4));var y=new h.default;y.id="stay_in_house",this.add(y),this.t.addBeh(new J.default("random_house_building")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new re.default(10,60)),this.t.addBeh(new ut.default);var v=new h.default;v.id="random_swim",this.add(v),this.t.addBeh(new Zt.default),this.t.addBeh(new Jt.default(0,2));var b=new h.default;b.id="check_join_city",this.add(b),this.t.addBeh(new Et.default),this.t.addBeh(new dt.default);var w=new h.default;w.id="check_join_empty_nearby_city",this.add(w),this.t.addBeh(new mt.default),this.t.addBeh(new dt.default);var T=new h.default;T.id="become_citizen",this.add(T),this.t.addBeh(new N.default);var k=new h.default;k.id="end_job",this.add(k),this.t.addBeh(new dt.default);var B=new h.default;B.id="build_city_here",this.add(B),this.t.addBeh(new E.default),this.t.addBeh(new dt.default);var S=new h.default;S.id="nomad_try_build_city",this.add(S),this.t.addBeh(new Jt.default(1,5)),this.t.addBeh(new xt.default),this.t.addBeh(new It.default),this.t.addBeh(new E.default),this.t.addBeh(new dt.default);var C=new h.default;C.id="citizen",this.add(C),this.t.addBeh(new Jt.default(1,5)),this.t.addBeh(new Tt.default),this.t.addBeh(new It.default);var x=new h.default;x.id="city_idle_walking",this.add(x),this.t.addBeh(new $.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(3,6));var A=new h.default;A.id="find_city_job",this.add(A),this.t.addBeh(new Jt.default(1,5)),this.t.addBeh(new Q.default);var P=new h.default;P.id="look_for_animals",this.add(P),this.t.addBeh(new Bt.default),this.t.addBeh(new Dt.default),this.t.addBeh(new u.default);var O=new h.default;O.id="convert_ore",this.add(O),this.t.addBeh(new J.default("random_house_building")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new re.default(10,15)),this.t.addBeh(new lt.default),this.t.addBeh(new ut.default),this.t.addBeh(new he.default);var R=new h.default;R.id="make_items",this.add(R),this.t.addBeh(new J.default("random_house_building")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new re.default(10,15)),this.t.addBeh(new qt.default),this.t.addBeh(new ut.default);var F=new h.default;F.id="cleaning",F.force_item_sprite="tool_hammer",this.add(F),this.t.addBeh(new J.default("ruins")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(.3,.3)),this.t.addBeh(new zt.default("building_target")),this.t.addBeh(new l.default("building_target",1)),this.t.addBeh(new l.default("building_target",1)),this.t.addBeh(new l.default("building_target",1)),this.t.addBeh(new l.default("building_target")),this.t.addBeh(new Yt.default),this.t.addBeh(new Jt.default(1,2));var L=new h.default;L.id="put_out_fire",L.force_item_sprite="tool_bucket",this.add(L),this.t.addBeh(new Y.default),this.t.addBeh(new It.default),this.t.addBeh(new Nt.default(1)),this.t.addBeh(new tt.default),this.t.addBeh(new Jt.default(1,2));var D=new h.default;D.id="build_new_building",D.force_item_sprite="tool_hammer",this.add(D),this.t.addBeh(new J.default("new_building")),this.t.addBeh(new _t.default),this.t.addBeh(new It.default),this.t.addBeh(new zt.default("building_target")),this.t.addBeh(new l.default("building_target")),this.t.addBeh(new I.default),this.t.addBeh(new Jt.default(.5)),this.t.addBeh(new V.default);var M=new h.default;M.id="build_road",M.force_item_sprite="tool_hammer",this.add(M);var j=new St.default("new_road");j.null_check_city=!0,this.t.addBeh(j),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(.2)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target")),this.t.addBeh(new K.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var G=new h.default;G.id="collect_fruits",G.force_item_sprite="tool_basket",this.add(G),this.t.addBeh(new J.default("fruitBush")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new zt.default("building_target")),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(0)),this.t.addBeh(new ht.default),this.t.addBeh(new Jt.default(2,3)),this.t.addBeh(new X.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new he.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var U=new h.default;U.id="chop_trees",U.force_item_sprite="tool_axe",this.add(U),this.t.addBeh(new J.default("trees")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new zt.default("building_target")),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(0)),this.t.addBeh(new ht.default),this.t.addBeh(new X.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new he.default),this.t.addBeh(new Jt.default(1,2));var W=new h.default;W.id="mine_deposit",W.force_item_sprite="tool_pickaxe",this.add(W),this.t.addBeh(new J.default("gold,ore,stone")),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new zt.default("building_target")),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(0)),this.t.addBeh(new ht.default),this.t.addBeh(new X.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new he.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var q=new h.default;q.id="farming_make_field",q.force_item_sprite="tool_hoe",this.add(q),this.t.addBeh(new At.default),this.t.addBeh(new It.default),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new Wt.default),this.t.addBeh(new Jt.default(1,2));var at=new h.default;at.id="plant_crops",at.force_item_sprite="tool_hoe",this.add(at),this.t.addBeh(new gt.default),this.t.addBeh(new It.default),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new Vt.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var nt=new h.default;nt.id="harvest",nt.force_item_sprite="tool_hoe",this.add(nt),this.t.addBeh(new Rt.default),this.t.addBeh(new Mt.default),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(0)),this.t.addBeh(new ht.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new X.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new he.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var rt=new h.default;rt.id="mine",rt.force_item_sprite="tool_pickaxe",this.add(rt),this.t.addBeh(new J.default("mine")),this.t.addBeh(new Mt.default),this.t.addBeh(new re.default(10,15)),this.t.addBeh(new Ft.default),this.t.addBeh(new ut.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new X.default),this.t.addBeh(new wt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new he.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new te.default);var st=new h.default;st.id="try_to_return_home",this.add(st),this.t.addBeh(new le.default),this.t.addBeh(new Jt.default(1)),this.t.addBeh(new de.default),this.t.addBeh(new It.default),this.t.addBeh(new ce.default);var ct=new h.default;ct.id="warrior_check_city_army_group",this.add(ct),this.t.addBeh(new z.default),this.t.addBeh(new Jt.default(1,2));var yt=new h.default;yt.id="warrior_army_leader_move_random",this.add(yt),this.t.addBeh(new Tt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(10,20));var vt=new h.default;vt.id="warrior_army_leader_move_to_attack_target",this.add(vt),this.t.addBeh(new Z.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,4));var kt=new h.default;kt.id="warrior_army_follow_leader",this.add(kt),this.t.addBeh(new Pt.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(1,2));var Ct=new h.default;Ct.id="check_warrior_transport",this.add(Ct),this.t.addBeh(new ot.default),this.t.addBeh(new Jt.default(1,5)),this.t.addBeh(new de.default),this.t.addBeh(new It.default),this.t.addBeh(new ce.default);var Ot=new h.default;Ot.id="settler_same_island",this.add(Ot),this.t.addBeh(new Jt.default(1)),this.t.addBeh(new et.default),this.t.addBeh(new It.default);var jt=new h.default;jt.id="sit_inside_boat",this.add(jt),this.t.addBeh(new ce.default);var Gt=new h.default;Gt.id="settler_check_transport",this.add(Gt),this.t.addBeh(new it.default),this.t.addBeh(new Jt.default(1,5)),this.t.addBeh(new de.default),this.t.addBeh(new It.default),this.t.addBeh(new ce.default);var Ut=new h.default;Ut.id="wait",this.add(Ut),this.t.addBeh(new Jt.default(1));var Kt=new h.default;Kt.id="wait5",this.add(Kt),this.t.addBeh(new Jt.default(1,5));var Qt=new h.default;Qt.id="wait10",this.add(Qt),this.t.addBeh(new Jt.default(1,10))},e.prototype.initTasksMobs=function(){var t=new h.default;t.id="check_hunger_animal",this.add(t),this.t.addBeh(new U.default),this.t.addBeh(new U.default),this.t.addBeh(new U.default);var e=new h.default;e.id="eat_fruits",this.add(e),this.t.addBeh(new ft.default("fruits")),this.t.addBeh(new Mt.default),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new st.default),this.t.addBeh(new Jt.default(1,2));var i=new h.default;i.id="eat_flowers",this.add(i),this.t.addBeh(new St.default("flowers")),this.t.addBeh(new It.default),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new nt.default),this.t.addBeh(new Jt.default(1,2));var o=new h.default;o.id="eat_crops",this.add(o),this.t.addBeh(new ft.default("crops")),this.t.addBeh(new Mt.default),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new $t.default(1)),this.t.addBeh(new st.default),this.t.addBeh(new Jt.default(1,2));var a=new h.default;a.id="eat_grass",this.add(a),this.t.addBeh(new St.default("grass")),this.t.addBeh(new It.default),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new l.default("tile_target",1)),this.t.addBeh(new rt.default),this.t.addBeh(new Jt.default(1,2));var n=new h.default;n.id="hunting_attack",this.add(n),this.t.addBeh(new vt.default),this.t.addBeh(new Dt.default),this.t.addBeh(new at.default);var r=new h.default;r.id="try_babymaking",this.add(r),this.t.addBeh(new ue.default);var d=new h.default;d.id="babymaking",this.add(d),this.t.addBeh(new Dt.default),this.t.addBeh(new Jt.default(.5)),this.t.addBeh(new p.default),this.t.addBeh(new Jt.default(.5)),this.t.addBeh(new p.default),this.t.addBeh(new Jt.default(.5)),this.t.addBeh(new p.default),this.t.addBeh(new Jt.default(.5)),this.t.addBeh(new Ut.default),this.t.addBeh(new Jt.default(1,3));var u=new h.default;u.id="follow_same_race",this.add(u),this.t.addBeh(new kt.default),this.t.addBeh(new Dt.default("sameRegion"));var f=new h.default;f.id="attack_golden_brain",this.add(f),this.t.addBeh(new yt.default),this.t.addBeh(new Mt.default);var _=new h.default;_.id="rat",this.add(_),this.t.addBeh(new Jt.default(1)),this.t.addBeh(new ne.default),this.t.addBeh(new It.default);var m=new h.default;m.id="crab",this.add(m),this.t.addBeh(new c.default),this.t.addBeh(new Jt.default(2,5)),this.t.addBeh(new Ct.default),this.t.addBeh(new Lt.default),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new Xt.default);var g=new h.default;g.id="crab_danger_check",this.add(g),this.t.addBeh(new q.default),this.t.addBeh(new s.default);var y=new h.default;y.id="water_feeding",this.add(y),this.t.addBeh(new c.default),this.t.addBeh(new St.default("water")),this.t.addBeh(new Lt.default),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new l.default("tile_target",1,20)),this.t.addBeh(new Xt.default);var v=new h.default;v.id="crab_burrow",this.add(v),this.t.addBeh(new q.default),this.t.addBeh(new Tt.default),this.t.addBeh(new It.default),this.t.addBeh(new ct.default);var b=new h.default;b.id="make_skeleton",this.add(b),this.t.addBeh(new Gt.default),this.t.addBeh(new Jt.default(3,3));var w=new h.default;w.id="skeleton_move",this.add(w),this.t.addBeh(new oe.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(3,6));var T=new h.default;T.id="spawn_grass_seeds",this.add(T),this.t.addBeh(new ae.default),this.t.addBeh(new Jt.default(1,3));var k=new h.default;k.id="check_cure",this.add(k),this.t.addBeh(new G.default),this.t.addBeh(new Jt.default(1,3));var B=new h.default;B.id="burn_tumors",this.add(B),this.t.addBeh(new j.default),this.t.addBeh(new Jt.default(1,3));var S=new h.default;S.id="check_heal",this.add(S),this.t.addBeh(new jt.default),this.t.addBeh(new Jt.default(1,3));var C=new h.default;C.id="random_teleport",this.add(C),this.t.addBeh(new Kt.default),this.t.addBeh(new Jt.default(.5));var x=new h.default;x.id="run_to_water",this.add(x),this.t.addBeh(new Ot.default),this.t.addBeh(new Lt.default);var A=new h.default;A.id="short_move",this.add(A),this.t.addBeh(new ie.default),this.t.addBeh(new It.default)},e.prototype.initTasksBoats=function(){var t=new h.default;t.id="boat_idle",this.add(t),this.t.addBeh(new w.default),this.t.addBeh(new k.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(3,10));var e=new h.default;e.id="boat_danger_check",this.add(e),this.t.addBeh(new W.default),this.t.addBeh(new T.default),this.t.addBeh(new x.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(3,10));var i=new h.default;i.id="boat_transport_check",this.add(i),this.t.addBeh(new Jt.default),this.t.addBeh(new R.default);var o=new h.default;o.id="boat_transport_check_taxi",this.add(o),this.t.addBeh(new B.default);var a=new h.default;a.id="boat_transport_go_load",this.add(a),this.t.addBeh(new L.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default),this.t.addBeh(new F.default),this.t.addBeh(new ee.default("boat_transport_go_unload",!1));var n=new h.default;n.id="boat_transport_go_unload",this.add(n),this.t.addBeh(new Jt.default),this.t.addBeh(new D.default),this.t.addBeh(new It.default(!0)),this.t.addBeh(new Jt.default),this.t.addBeh(new M.default),this.t.addBeh(new Jt.default(3,10)),this.t.addBeh(new dt.default);var r=new h.default;r.id="boat_trading",this.add(r),this.t.addBeh(new v.default),this.t.addBeh(new S.default),this.t.addBeh(new C.default),this.t.addBeh(new It.default),this.t.addBeh(new re.default(2,5)),this.t.addBeh(new P.default),this.t.addBeh(new ut.default),this.t.addBeh(new ee.default("boat_return_to_dock"));var s=new h.default;s.id="boat_fishing",this.add(s),this.t.addBeh(new v.default),this.t.addBeh(new x.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default),this.t.addBeh(new A.default),this.t.addBeh(new Jt.default(5,10)),this.t.addBeh(new b.default),this.t.addBeh(new Jt.default(1,2)),this.t.addBeh(new y.default);var l=new h.default;l.id="boat_return_to_dock",this.add(l),this.t.addBeh(new v.default),this.t.addBeh(new O.default),this.t.addBeh(new C.default),this.t.addBeh(new It.default),this.t.addBeh(new Jt.default(0,3)),this.t.addBeh(new re.default(2,4)),this.t.addBeh(new he.default),this.t.addBeh(new Qt.default),this.t.addBeh(new ut.default),this.t.addBeh(new dt.default)},e}(a("AssetLibrary").default);n.default=fe,cc._RF.pop()},{}],BehaviourTaskActor:[function(t,e,i){"use strict";cc._RF.push(e,"03288fg7K1EbL2D0CFAz6O7","BehaviourTaskActor");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveFromBlock=!1,e.swim_to_island=!1,e.ignoreFightCheck=!1,e.fighting=!1,e.force_item_sprite="",e}return r(e,t),e}(a("BehaviourTaskBase").default);n.default=s,cc._RF.pop()},{}],BehaviourTaskBase:[function(t,e,i){"use strict";cc._RF.push(e,"48981FuT9FJppRU5k6zHRm5","BehaviourTaskBase");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.BehaviourTaskKingdom=n.BehaviourTaskCity=void 0;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=[],e}return r(e,t),e.prototype.get=function(t){return this.list[t]},e.prototype.addBeh=function(t){this.list.push(t)},e}(a("AssetLibrary").Asset);n.default=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(s);n.BehaviourTaskCity=l;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(s);n.BehaviourTaskKingdom=c,cc._RF.pop()},{}],BehaviourTaskCityLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"24b52toWnRBnJSSVzusiQih","BehaviourTaskCityLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("CityBehBorderGrowth"),l=a("CityBehBorderSteal"),c=a("CityBehBuild"),d=a("CityBehBuildDocks"),u=a("CityBehCheckArmy"),h=a("CityBehCheckAttackZone"),p=a("CityBehCheckCitizenTasks"),f=a("CityBehCheckCulture"),_=a("CityBehCheckPopPoints"),m=a("CityBehCheckSettleTarget"),g=a("CityBehFindLeader"),y=a("CityBehGiveInventoryItem"),v=a("CityBehProduceBoat"),b=a("CityBehProduceResources"),w=a("CityBehProduceUnit"),T=a("CityBehRandomWait"),k=a("CityBehSupplyKingdomCities"),B=a("CityBehUpgradeRandomBuilding"),S=a("BehaviourTaskBase"),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new S.BehaviourTaskCity;e.id="check_culture",this.add(e),this.t.addBeh(new f.default);var i=new S.BehaviourTaskCity;i.id="nothing",this.add(i);var o=new S.BehaviourTaskCity;o.id="wait1",this.add(o),this.t.addBeh(new T.default);var a=new S.BehaviourTaskCity;a.id="wait5",this.add(a),this.t.addBeh(new T.default(5,5));var n=new S.BehaviourTaskCity;n.id="random_wait_test",this.add(n),this.t.addBeh(new T.default(5,10)),this.t.addBeh(new T.default(5,10)),this.t.addBeh(new T.default(5,10));var r=new S.BehaviourTaskCity;r.id="do_checks",this.add(r),this.t.addBeh(new g.default),this.t.addBeh(new T.default(.1)),this.t.addBeh(new h.default),this.t.addBeh(new T.default(.1)),this.t.addBeh(new m.default),this.t.addBeh(new T.default(.1)),this.t.addBeh(new p.default),this.t.addBeh(new T.default(.1));var C=new S.BehaviourTaskCity;C.id="produce_unit",this.add(C),this.t.addBeh(new w.default);var x=new S.BehaviourTaskCity;x.id="produce_boat",this.add(x),this.t.addBeh(new v.default);var A=new S.BehaviourTaskCity;A.id="border_growth",this.add(A),this.t.addBeh(new s.default);var P=new S.BehaviourTaskCity;P.id="border_steal",this.add(P),this.t.addBeh(new l.default);var O=new S.BehaviourTaskCity;O.id="give_inventory_item",this.add(O),this.t.addBeh(new y.default);var R=new S.BehaviourTaskCity;R.id="build",this.add(R),this.t.addBeh(new c.default);var F=new S.BehaviourTaskCity;F.id="build_docks",this.add(F),this.t.addBeh(new d.default);var L=new S.BehaviourTaskCity;L.id="upgrade_random_building",this.add(L),this.t.addBeh(new B.default);var D=new S.BehaviourTaskCity;D.id="supply_kingdom_cities",this.add(D),this.t.addBeh(new k.default);var M=new S.BehaviourTaskCity;M.id="produce_resources",this.add(M),this.t.addBeh(new b.default);var I=new S.BehaviourTaskCity;I.id="check_army",this.add(I),this.t.addBeh(new u.default);var j=new S.BehaviourTaskCity;j.id="check_pop_points",this.add(j),this.t.addBeh(new _.default)},e}(a("AssetLibrary").default);n.default=C,cc._RF.pop()},{}],BehaviourTaskKingdomLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"feb120S3kpDjK1JkO2pSDzp","BehaviourTaskKingdomLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("KingdomBehCheckCapital"),l=a("KingdomBehCheckCulture"),c=a("KingdomBehCheckKing"),d=a("KingdomBehRandomWait"),u=a("KingdomCheckAttackTarget"),h=a("KingdomCheckDeadKingdom"),p=a("KingdomCheckDiplomacy"),f=a("KingdomCheckRevolts"),_=a("BehaviourTaskBase"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new _.BehaviourTaskKingdom;e.id="nothing",this.add(e);var i=new _.BehaviourTaskKingdom;i.id="check_culture",this.add(i),this.t.addBeh(new l.default);var o=new _.BehaviourTaskKingdom;o.id="wait1",this.add(o),this.t.addBeh(new d.default);var a=new _.BehaviourTaskKingdom;a.id="wait_random",this.add(a),this.t.addBeh(new d.default(0,5));var n=new _.BehaviourTaskKingdom;n.id="do_checks",this.add(n),this.t.addBeh(new s.default),this.t.addBeh(new c.default),this.t.addBeh(new d.default);var r=new _.BehaviourTaskKingdom;r.id="check_dead_kingdom",this.add(r),this.t.addBeh(new h.default);var m=new _.BehaviourTaskKingdom;m.id="check_attack_target",this.add(m),this.t.addBeh(new u.default);var g=new _.BehaviourTaskKingdom;g.id="check_revolts",this.add(g),this.t.addBeh(new f.default);var y=new _.BehaviourTaskKingdom;y.id="check_diplomacy",this.add(y),this.t.addBeh(new p.default)},e}(a("AssetLibrary").default);n.default=m,cc._RF.pop()},{}],Boat:[function(t,e,i){"use strict";cc._RF.push(e,"5813dA4D2JH/Iqo5t1jCJeA","Boat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.AnimationDataBoat=n.BoatState=void 0;var s,l=a("MathUtils"),c=a("GameCommon"),d=a("ActorAnimationLoader"),u=a("BaseActorComponent"),h=a("Docks"),p=a("ToolBox"),f=a("MapBox"),_=a("ActorAsset"),m=a("TaxiManager");(function(t){t[t.Idle=0]="Idle",t[t.IdleInsideDock=1]="IdleInsideDock",t[t.GoToHomeDock=2]="GoToHomeDock",t[t.StayInDock=3]="StayInDock",t[t.GoTrading=4]="GoTrading",t[t.MakeTrade=5]="MakeTrade",t[t.TransportGoLoading=6]="TransportGoLoading",t[t.TransportDoLoading=7]="TransportDoLoading",t[t.TransportGoUnloading=8]="TransportGoUnloading",t[t.TransportDoUnloading=9]="TransportDoUnloading"})(s=n.BoatState||(n.BoatState={})),n.AnimationDataBoat=function(){this.id="",this.dict=new Map,this.broken=null,this.normal=null};var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curState=s.Idle,e.animationDataBoat=null,e.unitsInside=new Set,e.isTransport=!1,e.taxiRequest=null,e.passengerWaitCounter=0,e._textureId="",e.taxiTarget=null,e.pickup_near_dock=!1,e.lastStep=cc.Vec3.ZERO,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.actor.callbacks_on_death.push(this.deathAction.bind(this)),this.actor.callbacks_on_death.push(this.updateBoatAnim.bind(this)),this.actor.callbacks_on_death.push(this.spawnBoatExplosion.bind(this)),this.actor.callbacks_landed.push(this.setWaterFrame.bind(this)),this.actor.callbacks_landed.push(this.cancelWork.bind(this)),this.actor.callbacks_added_madness.push(this.madnessAdded.bind(this)),this.actor.callbacks_cancel_path_movement.push(this.cancelPathfinderMovement.bind(this)),this.setState(s.Idle)},e.prototype.isNearDock=function(){try{if(this.actor.homeBuilding.getComponent(h.default).tiles_ocean.includes(this.actor.currentTile))return!0}catch(t){return!1}return!1},e.prototype.cancelPathfinderMovement=function(t){this.cancelWork(t)},e.prototype.cancelWork=function(){this.setState(s.Idle),this.actor.cancelAllBeh(),this.taxiRequest&&(m.default.cancelRequest(this.taxiRequest),this.taxiRequest=null,this.taxiTarget=null)},e.prototype.updateTexture=function(){if(this._textureId="boat_fishing",this.actor.kingdom){var t="";switch(this.actor.kingdom.race?(t=this.actor.kingdom.race.id,t=this.actor.kingdom.isCiv()?this.actor.kingdom.data.raceID:"human"):t="human",this.actor.stats.id){case"boat_fishing":this._textureId="boat_fishing";break;case"boat_trading":this._textureId="boat_trading_"+t;break;case"boat_transport":this._textureId="boat_transport_"+t}}this.animationDataBoat=d.default.loadAnimationBoat(this._textureId);var e=this.animationDataBoat.dict.get(0);this.actor.spriteAnimation.setFrames(e.frames),this.actor.spriteAnimation.timeBetweenFrames=e.timeBetweenFrames,this.actor.spriteAnimation.resetAnim()},e.prototype.madnessAdded=function(t){t.getHit(1e5)},e.prototype.spawnBoatExplosion=function(){f.default.inst.stackEffects.get("boatExplosion").spawnAt(this.actor.currentPosition,this.actor.stats.baseStats.scale)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),c.default.isPaused||this.updateBoatAnim(),this.actor.setBodySprite(this.actor.spriteAnimation.currentSpriteGraphic)},e.prototype.deathAction=function(){this.taxiRequest&&(m.default.finish(this.taxiRequest),this.taxiRequest=null),this.unloadUnits(this.actor.currentTile,!0)},e.prototype.unloadUnits=function(t,e){var i=this;void 0===e&&(e=!1),this.unitsInside.forEach(function(o){var a;(null===(a=o.data)||void 0===a?void 0:a.alive)&&(o.disembarkTo(i,t),e&&o.applyRandomForce())}),this.unitsInside.clear(),this.taxiTarget=null},e.prototype.removeFromTaxi=function(t){this.unitsInside.delete(t)},e.prototype.setState=function(t){t==s.StayInDock?this.node.active=!1:this.node.active=!0,this.curState=t},e.prototype.isState=function(t){return this.curState==t},e.prototype.addUnitInto=function(t){this.unitsInside.add(t)&&(this.passengerWaitCounter=0)},e.prototype.updateBoatAnim=function(t){var e;if(void 0===t&&(t=null),this.animationDataBoat||this.updateTexture(),null===(e=this.actor.data)||void 0===e?void 0:e.alive){if(0!=this.actor.zPosition.y)this.setFrames(this.animationDataBoat.normal);else if(this.actor.is_moving&&this.lastStep!=this.actor.nextStepPosition){this.lastStep=this.actor.nextStepPosition,Math.abs(this.actor.currentPosition.x-this.actor.nextStepPosition.x),Math.abs(this.actor.currentPosition.y-this.actor.nextStepPosition.y);var i=l.default.intCast(57.29578*p.Toolbox.getAngle(this.actor.currentPosition.x,this.actor.currentPosition.y,this.actor.nextStepPosition.x,this.actor.nextStepPosition.y));this.animationDataBoat.dict.has(i)&&this.setFrames(this.animationDataBoat.dict.get(i))}}else this.setFrames(this.animationDataBoat.broken)},e.prototype.setWaterFrame=function(){var t;(null===(t=this.actor.data)||void 0===t?void 0:t.alive)&&this.setFrames(this.animationDataBoat.dict.get(0))},e.prototype.checkBoatLimit=function(){var t,e;(null===(e=null===(t=this.actor.homeBuilding)||void 0===t?void 0:t.data)||void 0===e?void 0:e.alive)&&this.actor.homeBuilding.getComponent(h.default).isMoreLimit(this.actor.stats)&&(this.actor.homeBuilding.getComponent(h.default).removeBoatFromDock(this.actor),this.actor.killHimself(!0,_.AttackType.Other,!1,!1))},e.prototype.setFrames=function(t){this.actor.spriteAnimation.setFrames(t.frames)},e}(u.default);n.default=g,cc._RF.pop()},{}],Boulder:[function(t,e,i){"use strict";cc._RF.push(e,"84862gCk91AJ78/Y245H0Yw","Boulder");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("MapAction"),d=a("AssetManager"),u=a("Brush"),h=a("ToolBox"),p=a("GameAudio"),f=a("MapBox"),_=a("Actor"),m=a("ActorAsset"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentBounce=3,e.dirX=0,e.dirY=0,e.angle=0,e.angleRotation=0,e.impactEffect=0,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.angleRotation=h.Toolbox.randomFloat(-200,200)},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.impactEffect>0&&(this.impactEffect-=e),0!=this.zPosition.y&&(this.angle+=this.angleRotation*e,this.node.angle=this.angle)},e.prototype.updateForce=function(e){t.prototype.updateForce.call(this,e)},e.prototype.spawnEffect=function(t){if(!(this.impactEffect>0)){this.impactEffect=.8;var e=this.currentPosition.clone();e.y-=2,f.default.inst.stackEffects.get(t).spawnAt(e,this.node.scaleX)}},e.prototype.actionLanded=function(){var e;if(this._currentTileDirty=!0,this.findCurrentTile(!0),this._positionDirty=!0,this.updatePos(),t.prototype.actionLanded.call(this),this.currentBounce>.3){if(this.currentBounce>1.5){var o=this.currentPosition.clone();o.y-=2,null===(e=f.default.inst.stackEffects.get("explosionWave").spawnNew())||void 0===e||e.startFlash(cc.v3(o),l.default.intCast(this.currentBounce),6)}3==this.currentBounce&&f.default.inst.startShake(),this.currentBounce*=.7,this.dirX/=2,this.dirY/=2,this.addForce(this.dirX,this.dirY,this.currentBounce),this.inMapBorder()?this.currentTile&&(this.currentTile.type.ocean||this.currentTile.type.swamp?this.spawnEffect("boulderImpactWater"):this.spawnEffect("boulderImpact"),f.default.inst.loopWithBrush(this.currentTile,u.default.getBrushBySize(5),i.tileDrawBoulder,"boulder"),f.default.inst.applyForce(this.currentTile,5,.5,!1),f.default.inst.conwayLayer.checkKillRange(this.currentTile.pos,5)):this.spawnEffect("boulderImpactWater")}else this.currentTile.type.ocean||this.currentTile.type.swamp?this.spawnEffect("boulderImpactWater"):this.spawnEffect("boulderImpact"),this.impactEffect=0,this.inMapBorder()&&c.default.damageWorld(this.currentTile,10,d.default.terraform.get("bomb")),this.spawnEffect("explosionSmall"),p.default.playExplosionMeteorite(),this.killHimself(!0,m.AttackType.None,!1)},e.tileDrawBoulder=function(t){for(var e=0;e<t.units.length;e++)t.units[e].getHit(1e3);return(t.type.ocean||t.type.swamp)&&h.Toolbox.randomChance(.3)&&f.default.inst.dropManager.spawnBurstPixel(t,"rain",h.Toolbox.randomFloat(.3,.8),h.Toolbox.randomFloat(.6,1.2)),t.type.lava&&h.Toolbox.randomChance(.3)&&f.default.inst.dropManager.spawnBurstPixel(t,"lava",h.Toolbox.randomFloat(.3,.8),h.Toolbox.randomFloat(.6,1.2)),c.default.decreaseTile(t,"destroy"),!0},e.prototype.spawnOn=function(e,i){void 0===i&&(i=0),t.prototype.spawnOn.call(this,e,0),this.dirX=h.Toolbox.randomFloat(-3,3),this.dirY=h.Toolbox.randomFloat(-3,3),this.addForce(this.dirX,this.dirY,this.currentBounce),this.zPosition.y=50,this.forceVector.z=-6},i=s([y],e)}(_.default));n.default=v,cc._RF.pop()},{}],BoxGift:[function(t,e,i){"use strict";cc._RF.push(e,"01564FlzDJC6Y0lLKnVQvNk","BoxGift");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("DateUtils"),c=a("AdsManager"),d=a("UserData"),u=a("GamePopBase"),h=a("MsgCache"),p=a("ViewController"),f=a("UiController"),_=a("AwardView"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.video=null,e.btnCancel=null,e}return r(e,t),e.prototype.onLoad=function(){this.btnCancel.active=BYTEDANCE_GAME,this.video.active=!1;var t=l.default.formatDayTime();d.default.member.BoxGiftNum[t]?this.video.active=BYTEDANCE_GAME||JSB_233:(d.default.member.BoxGiftNum={},d.default.member.BoxGiftNum[t]=!0)},e.prototype.clickClose=function(e){t.prototype.close.call(this,e),f.default.inst.showBoxGift()},e.prototype.click=function(){var t=this;(QQ_GAME||JSB_OPPO||JSB_VIVO||BYTEDANCE_GAME||JSB_233||JSB_MMY)&&(this.video.active?c.default.showVideoAds(function(e){if(1==e)t.reward();else{var i=0==e?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";h.default.pushToast(i)}}):this.reward())},e.prototype.reward=function(){p.default.open(p.view_type.AwardView,null,null,!1,function(t){t.getComponent(_.default).init(_.Reward_type.boxGift,17),QQ_GAME&&setTimeout(function(){c.default.showInterstitialAd(function(){})},1e3)},function(){f.default.inst.showBoxGift()})},s([y(cc.Node)],e.prototype,"video",void 0),s([y(cc.Node)],e.prototype,"btnCancel",void 0),s([g],e)}(u.GamePopBase);n.default=v,cc._RF.pop()},{}],BoxMonster:[function(t,e,i){"use strict";cc._RF.push(e,"eafe1nrEaJCmadlLUc4YE3V","BoxMonster");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GlobalEvent"),c=a("AdsManager"),d=a("GameTdd"),u=a("GamePopBase"),h=a("SpriteAnimation"),p=a("ToolBox"),f=a("ViewController"),_=a("TextureLoader"),m=a("WorldTimer"),g=a("AwardView"),y=cc._decorator,v=y.ccclass,b=y.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kirbySprite=null,e.monsterSprite=null,e.enemySprite=null,e.hpProgress=null,e.btnAttack=null,e.maxHp=8,e.currentHp=0,e.damagePerClick=1,e.recoverPerSecond=2,e.monsterDead=!1,e.clickCount=0,e.bannerTimer=-1,e.adShow=!1,e.shakeTimer=new m.default(.3,!0),e.shakeOffsetMonster=cc.v3(0,0),e.monsterPos=cc.v3(0,0),e.shakeOffsetIcon=cc.v3(0,0),e.iconPos=cc.v3(0,0),e.shakeIntervalMonster=0,e.shakeIntervalIcon=0,e}return r(e,t),e.prototype.start=function(){this.currentHp=this.maxHp,this.bg.getChildByName("btnClose").active=!1,l.default.on(l.Global_Event_Type.BACKGROUND_TO_GAME,this.onBackToGame,this)},e.prototype.onBackToGame=function(){console.log("banner\u663e\u793a\u65f6\u95f4\uff1a",this.bannerTimer),this.bannerTimer>0&&(this.bannerTimer=0,this.currentHp=0)},e.prototype.onClickAttack=function(){var t=this;this.bannerTimer>0||(this.clickCount++,!this.adShow&&this.clickCount>5&&p.Toolbox.randomBool()?(this.adShow=!0,this.bg.getChildByName("btnClose").active=!0,this.isVideoAd()?c.default.showVideoAds(function(){t.currentHp=0}):(this.bannerTimer=3,c.default.showBannerAd())):(this.currentHp-=this.damagePerClick,this.kirbySprite.isOn=!0,this.kirbySprite.resetAnim(),this.shakeTimer.startTimer(.5)))},e.prototype.update=function(t){this.shakeTimer.logicUpdate(t),this.kirbySprite.logicUpdate(t),this.shakeTimer.isActive?(this.shakeIntervalMonster-=t,this.shakeIntervalMonster<=0&&(this.shakeOffsetMonster.x=p.Toolbox.randomRange(-10,10),this.shakeOffsetMonster.y=p.Toolbox.randomRange(-10,10),this.shakeIntervalMonster=.05)):this.shakeOffsetMonster=cc.Vec3.ZERO,this.kirbySprite.currentFrameIndex>=12&&this.kirbySprite.currentFrameIndex<this.kirbySprite.frames.length-1?(this.shakeIntervalIcon-=t,this.shakeIntervalIcon<=0&&(this.shakeOffsetIcon.x=p.Toolbox.randomRange(-5,5),this.shakeOffsetIcon.y=p.Toolbox.randomRange(-5,5),this.shakeIntervalIcon=.05)):this.shakeOffsetIcon=cc.Vec3.ZERO,this.monsterSprite.spriteFrame=this.shakeTimer.isActive?_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"reward/treasure_box_monster_1"):_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"reward/treasure_box_monster_0"),this.monsterSprite.node.position=this.monsterPos.add(this.shakeOffsetMonster),this.enemySprite.node.position=this.iconPos.add(this.shakeOffsetIcon),this.bannerTimer>=0&&(this.bannerTimer-=t,this.bannerTimer<0&&c.default.hideBannerAd(cc.sys.platform!=cc.sys.WECHAT_GAME)),this.currentHp<=0?this.doKill():this.monsterDead||(this.currentHp+=this.recoverPerSecond*t,this.currentHp>=this.maxHp&&(this.currentHp=this.maxHp)),this.hpProgress.progress=this.currentHp/this.maxHp},e.prototype.doKill=function(){this.monsterDead||(this.currentHp=0,this.monsterDead=!0,this.btnAttack.getComponent(cc.Button).interactable=!1,setTimeout(function(){f.default.open(f.view_type.AwardView,null,null,!1,function(t){t.getComponent(g.default).init(g.Reward_type.achiev,19)})},1e3))},e.prototype.isVideoAd=function(){var t=(new Date).getHours(),e=d.default.success?d.default.getData("p12",d.v_type.NumberList):[12,16];return t>=e[0]&&t<=e[1]},s([b({type:h.SpriteAnimation,tooltip:"\u653b\u51fb\u5c0f\u4eba"})],e.prototype,"kirbySprite",void 0),s([b({type:cc.Sprite,tooltip:"\u5b9d\u7bb1\u602a"})],e.prototype,"monsterSprite",void 0),s([b({type:cc.Sprite,tooltip:"\u5b9d\u7bb1\u602a"})],e.prototype,"enemySprite",void 0),s([b({type:cc.ProgressBar,tooltip:"\u8840\u91cf\u8fdb\u5ea6\u6761"})],e.prototype,"hpProgress",void 0),s([b(cc.Node)],e.prototype,"btnAttack",void 0),s([v],e)}(u.GamePopBase);n.default=w,cc._RF.pop()},{}],BrushWindow:[function(t,e,i){"use strict";cc._RF.push(e,"d88bdkRoyVHea/Bntw2MQ/g","BrushWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("Constants"),d=a("AdsManager"),u=a("UserData"),h=a("GamePopBase"),p=a("MsgCache"),f=a("Config"),_=cc._decorator,m=_.ccclass,g=_.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.guideNode=null,e.brushs=[],e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){var t,e;i.inst=this;try{for(var o=l(this.brushs),a=o.next();!a.done;a=o.next()){var n=a.value;n.getChildByName("video").active=!u.default.member.brushUnlock[n.name]}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},e.prototype.selectBrush=function(t){var e=this,i=t.getCurrentTarget(),o=i.getChildByName("video");(null==o?void 0:o.active)?(c.default.REPORT_ID="unLockBrush",d.default.showVideoAds(function(t){if(1==t)u.default.member.brushUnlock[i.name]=!0,u.default.save(),o.active=!1,e.doSelect(i);else{var a=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";p.default.pushToast(a)}})):this.doSelect(i)},e.prototype.doSelect=function(t){f.default.currentBrush=t.name,this.clickCB&&this.clickCB(t),this.close()},e.inst=null,s([g(cc.Node)],e.prototype,"guideNode",void 0),s([g([cc.Node])],e.prototype,"brushs",void 0),i=s([m],e)}(h.GamePopBase);n.default=y,cc._RF.pop()},{}],Brush:[function(t,e,i){"use strict";cc._RF.push(e,"ce81a4rEtZCsrvbY1oXRQoT","Brush");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.BrushData=a.BrushPixelData=void 0;var r=o("MathUtils"),s=o("ToolBox"),l=o("TextureLoader"),c=function(t,e,i,o){this.x=0,this.y=0,this.dist=0,this.percentMode=0,this.x=t,this.y=e,this.dist=o,this.percentMode=o/i};a.BrushPixelData=c;var d=function(){this.size=1,this.pos=[],this.continuous=!1};a.BrushData=d;var u=function(){function t(){}return t.getRandom=function(){return Array.from(t.dictionary.keys()).getRandom()},t.init=function(){t.addCircle(1,!0),t.addCircle(2,!0),t.addCircle(4,!0),t.addCircle(5,!0),t.addCircle(10),t.addCircle(11),t.addCircle(15),t.addDot(!0),t.addSquare(1,!0),t.addSquare(5,!0),t.addSquare(10),t.addSquare(15),t.addSpecial("diamond_1",-1,!0),t.addSpecial("diamond_2",-1,!0),t.addSpecial("diamond_4",-1,!0),t.addSpecial("diamond_5"),t.addSpecial("diamond_7"),t.addSpecial("special_1",-1,!0),t.addSpecial("special_2",-1,!0),t.addSpecial("special_3",-1,!0),t.addSpecial("special_4"),t.addSpecial("special_5")},t.getBrushBySize=function(e,i){if(void 0===i&&(i="circ_"),!t.dictionary.has(i+e)){var o=!1;e<=5&&(o=!0),"circ_"==i&&t.addCircle(e,o)}return t.dictionary.get(i+e)},t.getBrushByID=function(t){return this.dictionary.get(t)},t.addDot=function(e){void 0===e&&(e=!1);var i=new d;i.continuous=e,i.size=1,i.pos.push(new c(0,0,0,0)),t.add("sqr_0",i),t.add("circ_0",i)},t.addSquare=function(e,i){void 0===i&&(i=!1);var o=new d;o.continuous=i,o.size=e;for(var a=-e;a<=e;a++)for(var n=-e;n<=e;n++)o.pos.push(new c(a,n,e,e));t.add("sqr_"+e,o)},t.add=function(e,i){var o,a;i.pos.shuffle();var r=0;try{for(var s=n(i.pos),l=s.next();!l.done;l=s.next()){var c=l.value;if(0==c.x&&0==c.y){r=i.pos.indexOf(c);break}}}catch(h){o={error:h}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}var d=i.pos[0],u=i.pos[r];i.pos[0]=u,i.pos[r]=d,t.dictionary.set(e,i)},t.addCircle=function(e,i){void 0===i&&(i=!1);var o=new d;o.continuous=i,o.size=e;for(var a=r.default.intCast(e/2),n=cc.v2(a,a),l=0,u=0,h=-e;h<=e;h++)for(var p=-e;p<=e;p++){l=n.x+h,u=n.y+p;var f=s.Toolbox.dist(n.x,n.y,l,u);f>e||o.pos.push(new c(h,p,e,f))}t.add("circ_"+e,o)},t.addSpecial=function(e,i,o){void 0===i&&(i=-1),void 0===o&&(o=!1);var a="brush_"+e,n=new d;n.continuous=o;var s=l.TextureLoader.inst.getTexture(l.BIN_TYPE.brushes,a),u=s.width,h=s.height;-1==i&&(i=u/2),n.size=i;for(var p=cc.v2(r.default.intCast(u/2),r.default.intCast(h/2)),f=0,_=0,m=0;m<u;m++)for(var g=0;g<h;g++)255==s.getPixel(m,g).a&&(f=p.x-m,_=p.y-g,n.pos.push(new c(f,_,i,i)));t.add(e,n)},t.dictionary=new Map,t}();a.default=u,cc._RF.pop()},{}],BuildingCreepHUB:[function(t,e,i){"use strict";cc._RF.push(e,"1603aChbzdFa6USNpY6PZKB","BuildingCreepHUB");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("BuildingCreepWorker"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._interval=.1,e._timer=.1,e._workers=[],e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this);for(var e=0;e<this.building.stats.grow_creep_workers;e++)this._workers.push(new l.default(this));this._interval=this.building.stats.grow_creep_step_inteval,this._timer=this._interval},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),this._timer>0)this._timer-=e;else{this._timer=this._interval;for(var i=0;i<this._workers.length;i++)this._workers[i].logicUpdate()}},e}(s.BaseBuildingComponent);n.default=c,cc._RF.pop()},{}],BuildingCreepWorker:[function(t,e,i){"use strict";cc._RF.push(e,"717e5Y+1mFFqomc1eVGOSDQ","BuildingCreepWorker");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapAction"),r=o("ActorAsset"),s=o("AssetManager"),l=o("TerraformLibrary"),c=o("BaseBuilding"),d=o("ToolBox"),u=o("TileTypeBase"),h=o("MapBox"),p=function(){function t(t){this.steps_max=0,this.cur_tile=null,this.cur_direction=null,this._parent=null,this._total_step_counter=0,this._this_creep_biome="",this._direction_step_amount=0,this._parent=t,this._this_creep_biome=this._parent.building.stats.grow_creep_type,this.steps_max=this._parent.building.stats.grow_creep_steps_max}return t.prototype.logicUpdate=function(){this.cur_tile||(this._total_step_counter=0,this.cur_tile=this._parent.building.currentTile,this.cur_direction=d.Toolbox.getRandom(d.Toolbox.directions)),this.checkRandomDirectionChange(),this.updateMovement(this.cur_tile),this._total_step_counter>this.steps_max&&(this.cur_tile=null)},t.prototype.checkRandomDirectionChange=function(){this._parent.building.stats.grow_creep_random_new_direction&&(this._direction_step_amount>=this._parent.building.stats.grow_creep_steps_before_new_direction&&(this.cur_direction=d.Toolbox.getRandom(d.Toolbox.directions),this._direction_step_amount=0),this._direction_step_amount++)},t.prototype.creepFlash=function(){this._parent.building.stats.grow_creep_flash&&h.default.inst.flashEffects.flashPixel(this.cur_tile,15),this._parent.building.stats.grow_creep_redraw_tile&&h.default.inst.redrawRenderedTile(this.cur_tile)},t.prototype.updateMovement=function(t){this.cur_tile=t,this.canPlaceWorkerOn(this.cur_tile)?(this.makeCreep(this.cur_tile),this.creepFlash(),this._total_step_counter++):this.cur_tile.type.biome==this._this_creep_biome&&(this.creepFlash(),(t=this.getNextRandomTile(this.cur_tile))?this.canPlaceWorkerOn(t)?this.cur_tile=t:t.type.biome==this._this_creep_biome?this.cur_tile=t:t.type.creepRankType==u.TileRank.Nothing&&(t=this.cur_tile,this.cur_direction=d.Toolbox.getRandom(d.Toolbox.directions)):this.cur_tile=null)},t.prototype.canPlaceWorkerOn=function(t){return t.type.creepRankType!=u.TileRank.Nothing||!!t.type.creep&&t.type.biome!=this._this_creep_biome},t.prototype.makeCreep=function(t){var e=null;t.main_type.creepRankType==u.TileRank.High?e=s.default.topTiles.get(this._parent.building.stats.grow_creep_type_high):t.main_type.creepRankType==u.TileRank.Low&&(e=s.default.topTiles.get(this._parent.building.stats.grow_creep_type_low)),e&&n.default.terraformTop(t,e,l.default.flash)},t.prototype.getNextRandomTile=function(t){switch(this._parent.building.stats.grow_creep_movement_type){case c.CreepWorkerMovementType.Direction:return this.getDirectionTile(t,this._parent.building.stats.grow_creep_direction_random_position);case c.CreepWorkerMovementType.RandomNeighbour:return t.neighbours.getRandom();case c.CreepWorkerMovementType.RandomNeighbourAll:default:return t.neighboursAll.getRandom()}},t.prototype.getDirectionTile=function(t,e){void 0===e&&(e=!0);var i=t.pos.x,o=t.pos.y;switch(this.cur_direction){case r.ActorDirection.Up:e&&(i+=d.Toolbox.randomRange(-1,2)),o++;break;case r.ActorDirection.Right:i++,e&&(o+=d.Toolbox.randomRange(-1,2));break;case r.ActorDirection.Down:e&&(i+=d.Toolbox.randomRange(-1,2)),o--;break;case r.ActorDirection.Left:i--,e&&(o+=d.Toolbox.randomRange(-1,2))}return h.default.inst.getTile(i,o)},t}();a.default=p,cc._RF.pop()},{}],BuildingEffectSpawnPixel:[function(t,e,i){"use strict";cc._RF.push(e,"733c8YRGgxCcrObRiARg5rj","BuildingEffectSpawnPixel");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("ToolBox"),c=a("MapBox"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spawnPixelTimer=0,e}return r(e,t),e.prototype.logicUpdate=function(t){if(this.building.data.spawnPixelActive)if(this.spawnPixelTimer>0)this.spawnPixelTimer-=t;else{this.spawnPixelTimer=this.building.stats.spawnPixelInterval;var e=c.default.inst.getTile(this.building.currentTile.pos.x,this.building.currentTile.pos.y);e||(e=this.building.currentTile),c.default.inst.dropManager.spawnBurstPixel(e,this.building.stats.spawnDropID,l.Toolbox.randomFloat(.5,.5),l.Toolbox.randomFloat(1,1.3),this.building.stats.spawnPixelStartZ)}},e}(s.BaseBuildingComponent);n.default=d,cc._RF.pop()},{}],BuildingFruitGrowth:[function(t,e,i){"use strict";cc._RF.push(e,"859cbYse9RNOo4veXnzemnL","BuildingFruitGrowth");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resourceResetTime=0,e}return r(e,t),e.prototype.logicUpdate=function(t){if(this.building.data.state==s.BuildingState.Normal&&!this.building.haveResources){if(this.resourceResetTime>0)return void(this.resourceResetTime-=t);this.building.setHaveResources(!0),this.building.setScaleTween(.75)}},e}(s.BaseBuildingComponent);n.default=l,cc._RF.pop()},{}],BuildingLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"1e2f6/o0vdPh4ceL1hC7860","BuildingLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.BuildingAsset=void 0;var l=a("Tools"),c=a("BaseBuilding"),d=a("BaseStats"),u=a("BuildingMapIcon"),h=a("CityBuildOrder"),p=a("TextureLoader"),f=a("AssetLibrary"),_=function(t){function e(){var e=t.call(this)||this;return e.kingdom="",e.fundament=null,e.mod_use_streaming_assets=!1,e.mod_streaming_assets_path=!1,e.mod_streaming_assets_pivot=cc.v2(.5,0),e.sprite_path="",e.grow_creep=!1,e.grow_creep_movement_type=null,e.grow_creep_type="",e.grow_creep_type_low="",e.grow_creep_type_high="",e.grow_creep_steps_max=0,e.grow_creep_step_inteval=0,e.grow_creep_workers=1,e.grow_creep_direction_random_position=!1,e.grow_creep_random_new_direction=!1,e.grow_creep_flash=!1,e.grow_creep_redraw_tile=!1,e.grow_creep_steps_before_new_direction=7,e.ruins="same_id",e.destroyedSound="",e.isRuin=!1,e.orderInLayer=0,e.buildingType=c.BuildingType.None,e.resource_id="",e.resources_given=0,e.canBeHarvested=!1,e.maxTreesInZone=0,e.vegetationRandomChance=.5,e.hasKingdomColor=!1,e.cityBuilding=!1,e.canBeAbandoned=!1,e.destroyOnLiquid=!1,e.canBeUpgraded=!1,e.upgradeTo="",e.upgradeLevel=0,e.type="",e.priority=0,e.shadow=!0,e.auto_remove_ruin=!1,e.iceTower=!1,e.spawnUnits=!1,e.beehive=!1,e.spawnUnits_asset="-",e.tower=!1,e.tower_projectile="",e.tower_projectile_offset=0,e.tower_projectile_reload=3,e.tower_projectile_amount=1,e.ignoreOtherBuildingsForUpgrade=!1,e.randomFlip=!1,e.cost=null,e.baseStats=new d.default,e.ignoredByCities=!1,e.buildRoadTo=!1,e.canBeDamagedByTornado=!1,e.canBePlacedOnLiquid=!1,e.canBePlacedOnBlocks=!1,e.damagedByRain=!1,e.onlyBuildTiles=!1,e.buildingPlacement=h.CityBuildingPlacement.Everywhere,e.checkForCloseBuilding=!1,e.ignoreBuildings=!1,e.ignoreDemolish=!1,e.burnable=!1,e.affectedByLava=!1,e.affectedByAcid=!1,e.housing=0,e.storage=!1,e.canBeLivingHouse=!0,e.canBeLivingPlant=!0,e.limit_per_zone=0,e.docks=!1,e.canBePlacedOnlyOn=[],e.race="",e.smoke=!1,e.smokeInterval=.5,e.smokeOffset=cc.Vec2.ZERO,e.spawnPixel=!1,e.spawnDropID="",e.spawnPixelInterval=.3,e.spawnPixelStartZ=0,e.transformTilesToTileType="",e.transformTilesToTopTiles="",e.sfx="none",e.spawnRats=!1,e.fauna=!1,e.tech="",e.sprites=null,e.updated=!0,e.baseStats.health=100,e.baseStats.size=2,e}return r(e,t),e}(f.Asset);n.BuildingAsset=_;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){var e,i;t.prototype.init.call(this);var o=new _;o.id="tree",o.fundament=new c.BuildingFundament(1,0,1,0),o.ruins="tree_dead",o.buildingType=c.BuildingType.Tree,o.resource_id="wood",o.type="trees",o.resources_given=3,o.destroyOnLiquid=!0,o.randomFlip=!0,o.ignoredByCities=!0,o.ignoreDemolish=!0,o.burnable=!0,o.affectedByAcid=!0,o.maxTreesInZone=5,o.affectedByLava=!0,o.sfx="spawn_tree",o.fauna=!0,o.canBeDamagedByTornado=!0,o.race="nature",o.kingdom="nature",o.checkForCloseBuilding=!1,o.canBePlacedOnlyOn=["grass_high","grass_low"],this.add(o),this.t.limit_per_zone=3,this.t.canBeLivingPlant=!0,this.t.baseStats.health=10,this.clone("tree_dead","tree"),this.t.isRuin=!0,this.t.burnable=!1,this.t.buildingType=c.BuildingType.None,this.t.ruins=null,this.t.ignoreBuildings=!0,this.t.baseStats.health=1e3,this.clone("corrupted_tree","tree"),this.t.limit_per_zone=6,this.t.canBePlacedOnlyOn=["corrupted_high","corrupted_low"],this.clone("corrupted_tree_big","tree"),this.t.fundament=new c.BuildingFundament(2,2,1,0),this.clone("enchanted_tree","tree"),this.t.limit_per_zone=4,this.t.canBePlacedOnlyOn=["enchanted_high","enchanted_low"],this.clone("swamp_tree","tree"),this.t.fundament=new c.BuildingFundament(1,1,1,0),this.t.limit_per_zone=2,this.t.canBePlacedOnlyOn=["swamp_high","swamp_low"],this.t.canBePlacedOnLiquid=!0,this.clone("savanna_tree","tree"),this.t.limit_per_zone=7,this.t.canBePlacedOnlyOn=["savanna_high","savanna_low"],this.clone("savanna_tree_big","savanna_tree"),this.t.fundament=new c.BuildingFundament(2,2,1,0),this.clone("mushroom_tree","tree"),this.t.limit_per_zone=2,this.t.canBePlacedOnlyOn=["mushroom_high","mushroom_low"],this.t.updated=!1,this.clone("jungle_tree","tree"),this.t.limit_per_zone=8,this.t.canBePlacedOnlyOn=["jungle_high","jungle_low"],this.clone("infernal_tree","tree"),this.t.canBePlacedOnlyOn=["infernal_high","infernal_low"],this.t.burnable=!1,this.t.updated=!1,this.clone("infernal_tree_small","infernal_tree"),this.t.fundament=new c.BuildingFundament(0,0,1,0),this.clone("infernal_tree_big","infernal_tree"),this.t.fundament=new c.BuildingFundament(2,2,1,0),this.clone("cacti","tree"),this.t.maxTreesInZone=1,this.t.vegetationRandomChance=.2,this.t.canBePlacedOnlyOn=["sand"],this.clone("palm","tree"),this.t.maxTreesInZone=1,this.t.vegetationRandomChance=.1,this.t.canBePlacedOnlyOn=["sand"],this.clone("pine","tree"),this.t.maxTreesInZone=3,this.t.vegetationRandomChance=.5,this.t.canBePlacedOnlyOn=["snow_low","snow_high","grass_high","grass_low","soil_low","soil_high"],this.clone("wasteland_tree","tree"),this.t.maxTreesInZone=3,this.t.vegetationRandomChance=.5,this.t.canBePlacedOnlyOn=["wasteland_high","wasteland_low"],this.t.affectedByAcid=!1;var a=new _;a.id="!vegetation",a.fundament=new c.BuildingFundament(0,0,0,0),a.ruins=null,a.destroyOnLiquid=!0,a.randomFlip=!0,a.ignoredByCities=!0,a.ignoreDemolish=!0,a.burnable=!0,a.affectedByAcid=!0,a.affectedByLava=!0,a.race="nature",a.kingdom="nature",a.buildingType=c.BuildingType.Plant,this.add(a),this.t.limit_per_zone=3,this.t.priority=-1,this.t.canBePlacedOnBlocks=!1,this.t.baseStats.health=10,this.t.shadow=!1,this.clone("snow_plant","!vegetation"),this.t.canBePlacedOnlyOn=["snow_low","snow_high"],this.clone("green_herb","!vegetation"),this.t.canBePlacedOnlyOn=["grass_low","grass_high"],this.clone("corrupted_plant","!vegetation"),this.t.canBePlacedOnlyOn=["corrupted_low","corrupted_high"],this.clone("jungle_plant","!vegetation"),this.t.canBePlacedOnlyOn=["jungle_low","jungle_high"],this.t.limit_per_zone=6,this.clone("savanna_plant","!vegetation"),this.t.canBePlacedOnlyOn=["savanna_low","savanna_high"],this.clone("mushroom","!vegetation"),this.t.canBePlacedOnlyOn=["grass_low","grass_high","mushroom_high","mushroom_low"],this.clone("flower","!vegetation"),this.t.canBePlacedOnlyOn=["grass_low","grass_high","mushroom_high","mushroom_low","enchanted_low","enchanted_high"],this.t.type="flower",this.clone("flame_flower","flower"),this.t.canBePlacedOnlyOn=["infernal_high","infernal_low"],this.t.burnable=!1,this.clone("jungle_flower","flower"),this.t.canBePlacedOnlyOn=["jungle_low","jungle_high"],this.clone("wasteland_flower","flower"),this.t.canBePlacedOnlyOn=["wasteland_low","wasteland_high"],this.t.affectedByAcid=!1,this.clone("swamp_plant","!vegetation"),this.t.canBePlacedOnlyOn=["swamp_low","swamp_high"],this.t.fundament=new c.BuildingFundament(0,0,0,0),this.t.canBePlacedOnLiquid=!0,this.t.limit_per_zone=4,this.clone("swamp_plant_big","swamp_plant"),this.t.limit_per_zone=4,this.t.fundament=new c.BuildingFundament(1,1,1,0);var n=new _;n.id="!resource",n.fundament=new c.BuildingFundament(1,1,1,0),n.ruins=null,n.destroyOnLiquid=!0,n.randomFlip=!0,n.ignoredByCities=!1,n.ignoreDemolish=!0,n.burnable=!1,n.affectedByAcid=!0,n.affectedByLava=!0,n.race="nature",n.kingdom="nature",this.add(n),this.t.canBePlacedOnBlocks=!1,this.t.baseStats.health=10,this.clone("!rock_temp","!resource"),this.t.destroyedSound="buildingDestroyed",this.t.ignoreBuildings=!0,this.clone("stone","!rock_temp"),this.t.buildingType=c.BuildingType.Stone,this.t.resource_id="stone",this.t.destroyOnLiquid=!1,this.t.resources_given=3,this.t.sfx="spawn_stone",this.clone("stone_m","stone"),this.t.resources_given=2,this.clone("stone_s","stone"),this.t.resources_given=1,this.clone("ore_deposit","!rock_temp"),this.t.buildingType=c.BuildingType.Ore,this.t.resource_id="ore",this.t.sfx="spawn_ore_deposit",this.t.resources_given=3,this.clone("ore_deposit_m","ore_deposit"),this.t.resources_given=2,this.clone("ore_deposit_s","ore_deposit"),this.t.resources_given=1,this.clone("gold","!rock_temp"),this.t.buildingType=c.BuildingType.Gold,this.t.resource_id="gold",this.t.sfx="spawn_gold",this.t.resources_given=3,this.clone("gold_m","gold"),this.t.resources_given=2,this.clone("gold_s","gold"),this.t.resources_given=1,this.clone("fruit_bush","!resource"),this.t.canBeLivingPlant=!0,this.t.buildingType=c.BuildingType.Fruits,this.t.resource_id="berries",this.t.resources_given=3,this.t.type="fruits",this.t.burnable=!0,this.t.sfx="spawn_bush",this.t.fauna=!0,this.t.canBeDamagedByTornado=!0,this.t.ignoredByCities=!0,this.t.vegetationRandomChance=.02,this.t.limit_per_zone=2,this.t.canBePlacedOnlyOn=["jungle_low","jungle_high","grass_low","grass_high","mushroom_low","mushroom_high","enchanted_low","enchanted_high","savanna_low","savanna_high"];var r=new _;r.id="0wheat",r.fundament=new c.BuildingFundament(0,0,0,0),r.type="crops",r.resource_id="wheat",r.resources_given=3,r.buildingType=c.BuildingType.Wheat,r.destroyOnLiquid=!0,r.randomFlip=!0,r.ignoredByCities=!0,r.ignoreDemolish=!0,r.burnable=!0,r.affectedByAcid=!0,r.affectedByLava=!0,r.sfx="spawn_tree",r.fauna=!0,r.canBeDamagedByTornado=!0,r.race="nature",r.kingdom="nature",r.canBeUpgraded=!0,r.upgradeTo="1wheat",r.orderInLayer=-2,r.shadow=!1,r.canBePlacedOnlyOn=["field"],r.ruins=null,this.add(r),this.t.baseStats.health=10,this.t.canBeLivingPlant=!1,this.clone("1wheat","0wheat"),this.t.orderInLayer=0,this.t.upgradeTo="2wheat",this.clone("2wheat","1wheat"),this.t.upgradeTo="3wheat",this.clone("3wheat","2wheat"),this.t.upgradeTo="4wheat",this.clone("4wheat","3wheat"),this.t.upgradeTo="",this.t.canBeUpgraded=!1,this.t.canBeLivingPlant=!0,this.t.canBeHarvested=!0;var l=new _;l.id="!building",l.fundament=new c.BuildingFundament(3,3,2,0),l.destroyedSound="buildingDestroyed",l.burnable=!0,l.destroyOnLiquid=!0,l.buildRoadTo=!0,l.affectedByAcid=!0,l.affectedByLava=!0,l.canBeDamagedByTornado=!0,l.onlyBuildTiles=!0,l.checkForCloseBuilding=!0,this.add(l),this.t.baseStats.health=1500,this.clone("!city_building","!building"),this.t.cityBuilding=!0,this.t.canBeAbandoned=!0,this.clone("!city_colored_building","!city_building"),this.t.hasKingdomColor=!0,this.clone("bonfire","!city_building"),this.t.canBeAbandoned=!1,this.t.priority=1,this.t.type="bonfire",this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.cost=new c.ConstructionCost,this.t.smoke=!0,this.t.smokeInterval=2.5,this.t.smokeOffset=cc.v2(2,3),this.t.canBeLivingHouse=!1,this.clone("well","!city_building"),this.t.priority=21,this.t.type="well",this.t.fundament=new c.BuildingFundament(1,1,1,0),this.t.cost=new c.ConstructionCost(0,20,1,5),this.t.burnable=!1,this.t.tech="building_well",this.clone("watch_tower_human","!city_colored_building"),this.t.baseStats.health=3e3,this.t.baseStats.targets=1,this.t.baseStats.areaOfEffect=1,this.t.baseStats.damage=50,this.t.baseStats.knockback=1.4,this.t.priority=22,this.t.type="watch_tower",this.t.fundament=new c.BuildingFundament(1,1,1,0),this.t.cost=new c.ConstructionCost(0,20,1,5),this.t.burnable=!1,this.t.tech="building_watch_tower",this.t.race="human",this.t.tower=!0,this.t.tower_projectile="arrow",this.t.tower_projectile_offset=4,this.t.tower_projectile_amount=6,this.t.buildingPlacement=h.CityBuildingPlacement.Borders,this.t.updated=!1,this.clone("watch_tower_elf","watch_tower_human"),this.t.race="elf",this.clone("watch_tower_orc","watch_tower_human"),this.t.race="orc",this.clone("watch_tower_dwarf","watch_tower_human"),this.t.race="dwarf",this.clone("statue","!city_building"),this.t.priority=27,this.t.type="statue",this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.cost=new c.ConstructionCost(0,5,0,25),this.t.burnable=!1,this.t.tech="building_statues",this.clone("docks_human","!city_colored_building"),this.t.race="human",this.t.priority=20,this.t.type="docks",this.t.fundament=new c.BuildingFundament(2,2,4,0),this.t.cost=new c.ConstructionCost(10,6),this.t.burnable=!1,this.t.docks=!0,this.t.canBePlacedOnLiquid=!0,this.t.destroyOnLiquid=!1,this.t.buildRoadTo=!1,this.t.onlyBuildTiles=!1,this.t.auto_remove_ruin=!0,this.t.tech="building_docks",this.clone("docks_elf","docks_human"),this.t.race="elf",this.clone("docks_dwarf","docks_human"),this.t.race="dwarf",this.clone("docks_orc","docks_human"),this.t.race="orc",this.clone("mine","!city_building"),this.t.priority=50,this.t.type="mine",this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.cost=new c.ConstructionCost(0,0,0,15),this.t.burnable=!1,this.t.tech="building_mine",this.clone("barracks_human","!city_colored_building"),this.t.priority=22,this.t.burnable=!1,this.t.type="barracks",this.t.race="human",this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.cost=new c.ConstructionCost(0,5,2,15),this.t.tech="building_barracks",this.clone("barracks_orc","barracks_human"),this.t.race="orc",this.clone("barracks_dwarf","barracks_human"),this.t.race="dwarf",this.clone("barracks_elf","barracks_human"),this.t.race="elf",this.clone("temple_human","!city_colored_building"),this.t.priority=26,this.t.type="temple",this.t.fundament=new c.BuildingFundament(2,2,3,0),this.t.cost=new c.ConstructionCost(0,10,2,30),this.t.burnable=!1,this.t.race="human",this.t.tech="building_temple",this.clone("temple_orc","temple_human"),this.t.race="orc",this.clone("temple_dwarf","temple_human"),this.t.race="dwarf",this.clone("temple_elf","temple_human"),this.t.race="elf",this.clone("windmill_human","!city_colored_building"),this.t.priority=23,this.t.burnable=!1,this.t.type="windmill",this.t.race="human",this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.cost=new c.ConstructionCost(0,5,2,15),this.t.tech="building_windmill",this.t.updated=!1,this.clone("windmill_orc","windmill_human"),this.t.race="orc",this.clone("windmill_dwarf","windmill_human"),this.t.race="dwarf",this.clone("windmill_elf","windmill_human"),this.t.race="elf",this.clone("tent_human","!city_colored_building"),this.t.race="human",this.t.type="house",this.t.cost=new c.ConstructionCost,this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.canBeUpgraded=!0,this.t.housing=3,this.t.burnable=!0,this.t.upgradeTo="house_human",this.t.storage=!0,this.clone("house_human","!city_colored_building"),this.t.type="house",this.t.cost=new c.ConstructionCost(5),this.t.housing=3,this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.canBeUpgraded=!0,this.t.burnable=!0,this.t.upgradeTo="1house_human",this.t.storage=!0,this.t.race="human",this.t.tech="house_tier_0",this.clone("1house_human","house_human"),this.t.cost=new c.ConstructionCost(4),this.t.housing=4,this.t.upgradeLevel=1,this.t.upgradeTo="2house_human",this.t.baseStats.health=150,this.t.race="human",this.t.tech="house_tier_1",this.clone("2house_human","1house_human"),this.t.cost=new c.ConstructionCost(0,5),this.t.upgradeLevel=2,this.t.burnable=!1,this.t.upgradeTo="3house_human",this.t.baseStats.health=200,this.t.race="human",this.t.tech="house_tier_2",this.clone("3house_human","2house_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.cost=new c.ConstructionCost(0,10),this.t.housing=5,this.t.upgradeLevel=3,this.t.upgradeTo="4house_human",this.t.baseStats.health=250,this.t.race="human",this.t.tech="house_tier_3",this.clone("4house_human","3house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.cost=new c.ConstructionCost(0,15),this.t.housing=6,this.t.upgradeLevel=4,this.t.upgradeTo="5house_human",this.t.baseStats.health=350,this.t.race="human",this.t.tech="house_tier_4",this.clone("5house_human","4house_human"),this.t.cost=new c.ConstructionCost(0,20,2,10),this.t.housing=7,this.t.upgradeLevel=5,this.t.canBeUpgraded=!1,this.t.baseStats.health=400,this.t.race="human",this.t.tech="house_tier_5",this.clone("hall_human","house_human"),this.t.priority=100,this.t.type="hall",this.t.cost=new c.ConstructionCost(10,0,0,10),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.canBeUpgraded=!0,this.t.baseStats.health=200,this.t.burnable=!0,this.t.housing=5,this.t.upgradeTo="1hall_human",this.t.ignoreOtherBuildingsForUpgrade=!0,this.t.race="human",this.t.tech="house_tier_1",this.clone("1hall_human","hall_human"),this.t.cost=new c.ConstructionCost(0,10,1,20),this.t.housing=8,this.t.upgradeLevel=1,this.t.burnable=!1,this.t.upgradeTo="2hall_human",this.t.baseStats.health=400,this.t.race="human",this.t.tech="house_tier_3",this.clone("2hall_human","1hall_human"),this.t.cost=new c.ConstructionCost(0,15,1,100),this.t.housing=12,this.t.upgradeLevel=2,this.t.canBeUpgraded=!1,this.t.baseStats.health=600,this.t.race="human",this.t.tech="house_tier_5",this.clone("tent_orc","tent_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="house_orc",this.t.race="orc",this.clone("house_orc","house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="1house_orc",this.t.race="orc",this.clone("1house_orc","1house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="2house_orc",this.t.race="orc",this.clone("2house_orc","2house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="3house_orc",this.t.race="orc",this.clone("3house_orc","3house_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="4house_orc",this.t.race="orc",this.clone("4house_orc","4house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.upgradeTo="5house_orc",this.t.race="orc",this.clone("5house_orc","5house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.race="orc",this.clone("tent_elf","tent_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="house_elf",this.t.race="elf",this.clone("house_elf","house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="1house_elf",this.t.race="elf",this.clone("1house_elf","1house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="2house_elf",this.t.race="elf",this.clone("2house_elf","2house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="3house_elf",this.t.race="elf",this.clone("3house_elf","3house_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="4house_elf",this.t.race="elf",this.clone("4house_elf","4house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.upgradeTo="5house_elf",this.t.race="elf",this.clone("5house_elf","5house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.race="elf",this.clone("tent_dwarf","tent_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="house_dwarf",this.t.race="dwarf",this.clone("house_dwarf","house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="1house_dwarf",this.t.race="dwarf",this.clone("1house_dwarf","1house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="2house_dwarf",this.t.race="dwarf",this.clone("2house_dwarf","2house_human"),this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.upgradeTo="3house_dwarf",this.t.race="dwarf",this.clone("3house_dwarf","3house_human"),this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.upgradeTo="4house_dwarf",this.t.race="dwarf",this.t.housing=6,this.clone("4house_dwarf","4house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.upgradeTo="5house_dwarf",this.t.race="dwarf",this.t.housing=8,this.clone("5house_dwarf","5house_human"),this.t.fundament=new c.BuildingFundament(3,3,2,0),this.t.race="dwarf",this.t.housing=10,this.clone("hall_orc","hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="1hall_orc",this.t.race="orc",this.clone("1hall_orc","1hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="2hall_orc",this.t.race="orc",this.clone("2hall_orc","2hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.race="orc",this.clone("hall_elf","hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="1hall_elf",this.t.race="elf",this.clone("1hall_elf","1hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="2hall_elf",this.t.race="elf",this.clone("2hall_elf","2hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.race="elf",this.clone("hall_dwarf","hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="1hall_dwarf",this.t.race="dwarf",this.clone("1hall_dwarf","1hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.upgradeTo="2hall_dwarf",this.t.race="dwarf",this.clone("2hall_dwarf","2hall_human"),this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.race="dwarf",this.clone("tumor","!building"),this.t.transformTilesToTopTiles="tumor_low",this.t.fundament=new c.BuildingFundament(1,1,1,0),this.t.race="tumor",this.t.kingdom="tumor",this.t.canBePlacedOnBlocks=!1,this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!1,this.t.spawnUnits=!0,this.t.spawnUnits_asset="tumor_monster_animal",this.setGrowBiomeAround("tumor",5,2,.1,c.CreepWorkerMovementType.Direction),this.t.grow_creep_direction_random_position=!0,this.t.grow_creep_flash=!0,this.t.grow_creep_redraw_tile=!0,this.t.baseStats.health=3e3,this.clone("biomass","tumor"),this.t.race="biomass",this.t.kingdom="biomass",this.t.spawnUnits_asset="bioblob",this.t.transformTilesToTopTiles="biomass_low",this.setGrowBiomeAround("biomass",10,4,.7,c.CreepWorkerMovementType.RandomNeighbourAll),this.clone("superPumpkin","tumor"),this.t.race="super_pumpkins",this.t.kingdom="super_pumpkins",this.t.spawnUnits_asset="lil_pumpkin",this.t.transformTilesToTopTiles="pumpkin_low",this.setGrowBiomeAround("pumpkin",10,3,.2,c.CreepWorkerMovementType.Direction),this.t.grow_creep_direction_random_position=!0,this.t.grow_creep_random_new_direction=!0,this.t.grow_creep_steps_before_new_direction=20,this.t.grow_creep_flash=!0,this.t.grow_creep_redraw_tile=!0,this.clone("cybercore","tumor"),this.t.race="assimilators",this.t.kingdom="assimilators",this.t.spawnUnits_asset="assimilator",this.t.transformTilesToTopTiles="cybertile_low",this.setGrowBiomeAround("cybertile",20,6,2,c.CreepWorkerMovementType.Direction),this.t.grow_creep_steps_before_new_direction=7,this.t.grow_creep_direction_random_position=!1,this.t.grow_creep_random_new_direction=!0,this.t.damagedByRain=!0,this.t.burnable=!1,this.clone("goldenBrain","!building"),this.t.baseStats.health=2e3,this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.race="goldenBrain",this.t.kingdom="goldenBrain",this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!0,this.t.burnable=!1,this.clone("corruptedBrain","!building"),this.t.baseStats.health=2e3,this.t.fundament=new c.BuildingFundament(1,1,2,0),this.t.race="corruptedBrain",this.t.kingdom="corruptedBrain",this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!0,this.t.burnable=!1,this.t.tower=!0,this.t.tower_projectile="madness",this.t.tower_projectile_offset=6,this.clone("beehive","!building"),this.t.baseStats.health=100,this.t.fundament=new c.BuildingFundament(1,0,1,0),this.t.race="nature",this.t.kingdom="nature",this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!0,this.t.burnable=!0,this.t.spawnUnits=!0,this.t.beehive=!0,this.t.canBePlacedOnlyOn=["grass_high","grass_low","soil_low","soil_high","enchanted_high","enchanted_low","savanna_low","savanna_high","jungle_high","jungle_high","mushroom_high","mushroom_high"],this.t.spawnUnits_asset="bee",this.clone("flameTower","!building"),this.t.baseStats.health=2e3,this.t.fundament=new c.BuildingFundament(2,2,3,0),this.t.race="demon",this.t.kingdom="demons",this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!0,this.t.burnable=!1,this.t.spawnUnits=!0,this.t.spawnUnits_asset="demon",this.t.tower=!0,this.t.tower_projectile="fireball",this.t.tower_projectile_offset=6,this.clone("iceTower","!building"),this.t.baseStats.health=2e3,this.t.fundament=new c.BuildingFundament(3,3,4,0),this.t.race="walker",this.t.kingdom="walkers",this.t.canBePlacedOnLiquid=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!0,this.t.burnable=!1,this.t.tower=!0,this.t.iceTower=!0,this.t.spawnUnits=!0,this.t.spawnUnits_asset="walker",this.t.tower_projectile="snowball",this.t.tower_projectile_offset=6,this.clone("volcano","!building"),this.t.race="nature",this.t.kingdom="nature",this.t.burnable=!1,this.t.fundament=new c.BuildingFundament(2,2,2,0),this.t.canBePlacedOnBlocks=!0,this.t.destroyOnLiquid=!1,this.t.ignoredByCities=!1,this.t.affectedByLava=!1,this.t.canBePlacedOnLiquid=!0,this.t.smoke=!0,this.t.smokeInterval=1.5,this.t.smokeOffset=cc.v2(2,2),this.t.spawnPixel=!0,this.t.spawnDropID="lava",this.t.spawnPixelStartZ=4,this.t.spawnPixelInterval=.1,this.t.canBeDamagedByTornado=!1,this.t.ignoreBuildings=!0,this.t.checkForCloseBuilding=!1,this.t.canBeLivingHouse=!1,this.clone("geyser","volcano"),this.t.smoke=!0,this.t.smokeInterval=2.5,this.t.spawnDropID="rain",this.t.spawnPixelStartZ=3,this.clone("geyserAcid","geyser"),this.t.smoke=!0,this.t.smokeInterval=3.5,this.t.spawnDropID="acid",this.t.affectedByAcid=!1,this.t.spawnPixelStartZ=2;try{for(var d=s(this.list),u=d.next();!u.done;u=d.next()){var p=u.value;this.loadSprites(p)}}catch(f){e={error:f}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(e)throw e.error}}},e.prototype.setGrowBiomeAround=function(t,e,i,o,a){this.t.grow_creep=!0,this.t.grow_creep_type=t,this.t.grow_creep_type_low=t+"_low",this.t.grow_creep_type_high=t+"_high",this.t.grow_creep_steps_max=e,this.t.grow_creep_workers=i,this.t.grow_creep_step_inteval=o,this.t.grow_creep_movement_type=a},e.prototype.loadSprites=function(t){var e=p.TextureLoader.inst.getSpriteFrames(p.ATLAS_TYPE.WORLDATLAS,"buildings/"+t.id.toLocaleLowerCase());t.sprites=new c.BuildingSprites,e.size>0&&e.forEach(function(e,i){var o=i.split("_"),a=o[0],n=parseInt(o[1]);t.sprites.animationData[n]||(t.sprites.animationData[n]=new c.BuildingAnimationData);var r=t.sprites.animationData[n];"main"==a?(r.main.push(e),r.main.length>1&&(r.animated=!0)):"roof"==a?r.roof.push(e):"ruin"==a?r.ruins.push(e):"shadow"==a?r.shadows.push(e):"special"==a?r.special.push(e):"construction"==a?t.sprites.construction=e:"constructionShadow"==a?t.sprites.construction_shadow=e:"mini"==a&&(t.sprites.mapIcon=new u.default(e,t.id.toLocaleLowerCase()))})},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=l.default.fromJson(i,new _);return o.id=t,this.add(o)},e}(f.default);n.default=m,cc._RF.pop()},{}],BuildingMapIcon:[function(t,e,i){"use strict";cc._RF.push(e,"98ae3THwzJLRrbKymV7yjyw","BuildingMapIcon");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.BuildingColorPixel=void 0;var n=o("ToolBox"),r=o("TextureBuffer"),s=o("TextureLoader"),l=function(){};a.BuildingColorPixel=l;var c=function(){function t(t,e){this.tex=[],this.width=0,this.height=0,this.width=t.getOriginalSize().width,this.height=t.getOriginalSize().height;for(var i=s.TextureLoader.inst.getBuildIcon(e),o=new Uint8Array(i._buffer),a=new r.TextureBuffer(e,o,this.width,this.height,!1),c=0;c<this.height;c++){for(var d=[],u=0;u<this.width;u++){var h=a.getPixel(u,c);0==h.a&&(h=cc.Color.TRANSPARENT),d[u]=new l,d[u].color=h,0==h.a?(d[u].color_ruin=cc.Color.TRANSPARENT,d[u].color_abandoned=cc.Color.TRANSPARENT):(d[u].color_abandoned=n.Toolbox.makeDarkerColor(h,.9),d[u].color_ruin=n.Toolbox.makeDarkerColor(h,.6))}this.tex[c]=d}}return t.prototype.getColor=function(t,e,i){if(t>=this.width||e>=this.height)return n.Toolbox.clear;var o=this.tex[e][t].color,a=!1;return i.kingdom.kingdomColor&&(n.Toolbox.areColorsEqual(o,n.Toolbox.color_magenta_0)?(o=i.kingdom.kingdomColor.k_color_0,a=!0):n.Toolbox.areColorsEqual(o,n.Toolbox.color_magenta_1)?(o=i.kingdom.kingdomColor.k_color_1,a=!0):n.Toolbox.areColorsEqual(o,n.Toolbox.color_magenta_2)?(o=i.kingdom.kingdomColor.k_color_2,a=!0):n.Toolbox.areColorsEqual(o,n.Toolbox.color_magenta_3)?(o=i.kingdom.kingdomColor.k_color_3,a=!0):n.Toolbox.areColorsEqual(o,n.Toolbox.color_magenta_4)&&(o=i.kingdom.kingdomColor.k_color_4,a=!0)),a||(i.isAbandoned()?o=this.tex[e][t].color_abandoned:i.isRuin()&&(o=this.tex[e][t].color_ruin)),o},t}();a.default=c,cc._RF.pop()},{}],BuildingSmokeEffect:[function(t,e,i){"use strict";cc._RF.push(e,"b978cQFq8FF/7qvuCgOeC4h","BuildingSmokeEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("MapBox"),c=a("Building"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.smokeTimer=0,e.centerTopVec=cc.Vec3.ZERO,e}return r(e,t),e.prototype.create=function(){var e,i,o;t.prototype.create.call(this);var a=this.building;this.centerTopVec.x=a.currentTile.pos.x,this.centerTopVec.y=a.currentTile.pos.y+(null===(o=null===(i=null===(e=a.spriteRenderer)||void 0===e?void 0:e.spriteFrame)||void 0===i?void 0:i.getOriginalSize())||void 0===o?void 0:o.height)*c.default.defaultScale.y},e.prototype.logicUpdate=function(){var t,e,i,o;if((null===(e=null===(t=this.building)||void 0===t?void 0:t.stats)||void 0===e?void 0:e.smoke)&&!(null===(o=null===(i=this.building)||void 0===i?void 0:i.data)||void 0===o?void 0:o.underConstruction)){if(this.smokeTimer>0)return void(this.smokeTimer-=cc.director.getDeltaTime());this.smokeTimer=this.building.stats.smokeInterval,l.default.inst.particlesSmoke.spawn(this.centerTopVec.x,this.centerTopVec.y,!0)}},e}(s.BaseBuildingComponent);n.default=d,cc._RF.pop()},{}],BuildingTower:[function(t,e,i){"use strict";cc._RF.push(e,"8d6b3nCYlhOEL/snBaSUHBq","BuildingTower");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("ToolBox"),c=a("MapBox"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.check_enemies_timeout=1,e.check_enemies_interval=3,e.chunksInRadius=[],e._shootingAmount=0,e._shootingActive=!1,e._shootingTarget=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.chunksInRadius=[]},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),!this.building.data.underConstruction){if(this._shootingActive)return void this.shootAtTarget();if(this.check_enemies_timeout>0)return void(this.check_enemies_timeout-=e);this.check_enemies_interval=this.building.stats.tower_projectile_reload,this.check_enemies_timeout=this.check_enemies_interval+l.Toolbox.randomFloat(0,this.check_enemies_interval),this.checkEnemies()}},e.prototype.shootAtTarget=function(){var t;if(null===(t=this._shootingTarget)||void 0===t?void 0:t.currentTile){this._shootingAmount--,this._shootingAmount<=0&&(this._shootingActive=!1);var e=cc.v3(this.building.currentTile.posV3.x,this.building.currentTile.posV3.y);e.y+=this.building.stats.tower_projectile_offset;var i=this._shootingTarget.currentTile.posV3;i.x+=l.Toolbox.randomFloat(0-(this._shootingTarget.curStats.size+1),this._shootingTarget.curStats.size+1),i.y+=l.Toolbox.randomFloat(0-this._shootingTarget.curStats.size,this._shootingTarget.curStats.size);var o=0;this._shootingTarget.isInAir()&&(o=this._shootingTarget.getZ());var a=c.default.inst.stackEffects.startProjectile(e,i,this.building.stats.tower_projectile,o);a&&(a.byWho=this.building,a.setStats(a.byWho.curStats))}else this._shootingActive=!1},e.prototype.checkEnemies=function(){this._shootingTarget=null,this._shootingActive=!1,this._shootingAmount=0,this.chunksInRadius.length<=0&&(this.chunksInRadius.push(this.building.currentTile.chunk),this.chunksInRadius.addRange(this.building.currentTile.chunk.neighboursAll)),l.Toolbox.temp_list_objects_enemies=[];var t=this.building.findEnemyObjectTarget();t&&(this.building.startShake(.1),this._shootingActive=!0,this._shootingTarget=t,this._shootingAmount=this.building.stats.tower_projectile_amount)},e}(s.BaseBuildingComponent);n.default=d,cc._RF.pop()},{}],Building:[function(t,e,i){"use strict";cc._RF.push(e,"5fc317DfkdAbKl12VhAMNTG","Building");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("ObjectUtils"),d=a("iTween"),u=a("Log"),h=a("AchievData"),p=a("MapAction"),f=a("ActorAsset"),_=a("MapObjectShadow"),m=a("AssetManager"),g=a("BuildingLibrary"),y=a("TerraformLibrary"),v=a("BaseBuilding"),b=a("BaseSimObject"),w=a("SmoothLoader"),T=a("ToolBox"),k=a("Config"),B=a("GameAudio"),S=a("MapLayer"),C=a("MapBox"),x=a("Beehive"),A=a("BuildingCreepHUB"),P=a("BuildingEffectSpawnPixel"),O=a("BuildingFruitGrowth"),R=a("BuildingSmokeEffect"),F=a("BuildingTower"),L=a("Docks"),D=a("IceTower"),M=a("UnitSpawner"),I=a("Wheat"),j=cc._decorator,E=j.ccclass,N=(j.property,[0,25,50,100]),z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.batch=null,e.positionDirty=!1,e.sprite_dirty=!1,e.tiles_dirty=!1,e.s_main_sprite=null,e.id_sprite_building=0,e.data=new v.BuildingData,e.stats=new g.BuildingAsset,e.haveResources=!1,e.tiles=[],e.frontTiles=[],e.doorTile=null,e.animData=null,e.animData_index=0,e.curTween=null,e.shakeTimer=.3,e.shakeOffset=cc.Vec3.ZERO,e.zones=[],e.animationState=v.BuildingAnimationState.Normal,e.components=[],e.roof=null,e.scaleVal=0,e.tween_scale_start=0,e.tween_scale_target=1,e.tween_scale_time=0,e.tween_scale_duration=1,e.tween_value=1,e.tween_active=!1,e.chopped=!1,e._is_visible=!0,e._last_contructed_sprite_id=-1,e._autoRemoveTimer=0,e.angle=0,e.goingLeft=!0,e.angle_timer=0,e.interval=0,e.timerShakeResource=0,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.setObjectType(S.MapObjectType.Building),this.tiles=[];var e=this.node.getChildByName("main");this.spriteRenderer=e.getComponent(cc.Sprite),this.spriteAnimation=e.addComponent(v.BuildingSpriteAnimation),this.startShake(.3)},e.prototype.isBurnable=function(){var t,e;return!((null===(t=this.data)||void 0===t?void 0:t.health)<=0)&&(null===(e=this.stats)||void 0===e?void 0:e.burnable)},e.prototype.setAnimData=function(t){(t>=this.stats.sprites.animationData.length||t<0)&&(t=0),this.animData=this.stats.sprites.animationData[t],this.animData_index=t},e.prototype.applyAnimDataToAnimation=function(){this.data.state==v.BuildingState.Ruins||this.data.state==v.BuildingState.CivAbandoned?this.spriteAnimation.isOn=!1:this.spriteAnimation.isOn=this.animData.animated,this.data.state==v.BuildingState.Ruins?this.spriteAnimation.frames=this.animData.ruins:this.spriteAnimation.frames=this.animData.main},e.prototype.stopFire=function(){this.removeStatusEffect("burning")},e.prototype.addComp=function(t){this.components.push(t),t.create(),this.batch.c_components.add(this)},e.prototype.setBuilding=function(t,e,i){var o,a,n,r;if(C.default.inst.job_manager_buildings.addNewObject(this),i?(this.setData(i),this.setTemplate(e),this.stats.cityBuilding||(null===(o=this.data)||void 0===o?void 0:o.state)!=v.BuildingState.Null||this.setState(v.BuildingState.Normal),e.buildingType!=v.BuildingType.None&&this.setHaveResources(!0),this.stats.cityBuilding&&!(null===(a=this.data)||void 0===a?void 0:a.cityID)&&!(null===(n=this.data)||void 0===n?void 0:n.alive)&&this.stats.canBeAbandoned&&this.makeAbandoned()):(this.setData(new v.BuildingData),this.setTemplate(e),this.data.objectID=C.default.inst.mapStats.getNextId("building"),this.data.mainX=t.pos.x,this.data.mainY=t.pos.y,this.setState(v.BuildingState.Normal),this.updateStats(),this.data.health=this.curStats.health,e.buildingType!=v.BuildingType.None&&this.setHaveResources(!0),this.data.spawnPixelActive=this.stats.spawnPixel),this.setStatsDirty(),this.currentTile=t,this.currentPosition=this.currentTile.posV3,this.currentTile.tile_down?this.doorTile=this.currentTile.tile_down:this.doorTile=this.currentTile,this.defaultScale=e.updated?cc.v3(.125,.125,.125):cc.v3(.25,.25,.25),this.node.setScale(cc.v3(this.defaultScale.x,0,this.defaultScale.z)),this.currentScale.x=this.defaultScale.x,this.currentScale.y=this.defaultScale.y,this.fillFrontTiles(),this.fillTiles(),this.stats.cityBuilding||(this.data.underConstruction=!1),null===(r=this.data)||void 0===r?void 0:r.underConstruction)this.setSpriteUnderConstruction();else{var s=-1;i&&(s=i.frameID),this.setSpriteMain(),-1!=s&&(this.finishScaleTween(),this.setAnimData(s))}this.setSpriteDirty(),this.setPositionDirty(),this.updatePosition(),e.smoke&&this.addComp(this.node.addComponent(R.default)),e.spawnPixel&&this.addComp(this.node.addComponent(P.default)),e.grow_creep&&this.addComp(this.node.addComponent(A.default)),e.buildingType==v.BuildingType.Wheat&&this.addComp(this.node.addComponent(I.default)),e.buildingType==v.BuildingType.Fruits&&this.addComp(this.node.addComponent(O.default)),e.iceTower&&this.addComp(this.node.addComponent(D.default)),e.spawnUnits&&this.addComp(this.node.addComponent(M.default)),e.beehive&&this.addComp(this.node.addComponent(x.default)),e.docks&&this.addComp(this.node.addComponent(L.default)),e.tower&&this.addComp(this.node.addComponent(F.default)),i||e.cityBuilding||(this.setAnimationState(v.BuildingAnimationState.Normal),this.setScaleTween()),this.data.state==v.BuildingState.Ruins&&this.setSpriteRuin(),this.stats.cityBuilding&&!this.kingdom&&(this.setKingdom(C.default.inst.kingdoms.getKingdomByID("abandoned")),this.setState(v.BuildingState.CivAbandoned),this.setSpriteDirty())},e.prototype.setStatsDirty=function(){this.statsDirty=!0,this.batch.c_stats_dirty.add(this)},e.prototype.setSpriteDirty=function(){this.sprite_dirty=!0,this.batch.c_sprite_dirty.add(this)},e.prototype.setPositionDirty=function(){this.positionDirty=!0,this.batch.c_position_dirty.remove(this)},e.prototype.setData=function(e){this.data=e,t.prototype.setData.call(this,e)},e.prototype.setHaveResources=function(t){var e;switch(this.haveResources=t,null===(e=this.stats)||void 0===e?void 0:e.buildingType){case v.BuildingType.Fruits:this.setSpriteMain(),this.haveResources?this.spriteAnimation.frames=this.animData.main:this.spriteAnimation.frames=this.animData.special,this.spriteAnimation.forceUpdateFrame();break;case v.BuildingType.None:case v.BuildingType.Tree:case v.BuildingType.Stone:case v.BuildingType.Ore:case v.BuildingType.Gold:}},e.prototype.setSpriteUnderConstruction=function(){this.stats.sprites.construction&&(this.setAnimData(0),this.setMainSprite(this.stats.sprites.construction),this.spriteAnimation.isOn=!1,this.spriteAnimation.node.color=cc.Color.WHITE,this.spriteChanged(),this.setScaleTween())},e.prototype.setScaleTween=function(t,e){void 0===t&&(t=0),void 0===e&&(e=.2),w.default.isLoading()?this.finishScaleTween():this.animationState==v.BuildingAnimationState.Normal&&(this.tween_scale_start=t,this.tween_scale_target=1,this.tween_scale_time=0,this.tween_scale_duration=e,this.tween_active=!0)},e.prototype.finishScaleTween=function(){this.setAnimationState(v.BuildingAnimationState.Normal),this.tween_scale_start=0,this.tween_scale_target=1,this.tween_scale_duration=1,this.tween_scale_time=this.tween_scale_duration,this.tween_value=1,this.tween_active=!1,this.currentScale.y=-100},e.prototype.onEnable=function(){this._is_visible=!0},e.prototype.onDisable=function(){this._is_visible=!1},e.prototype.canBeUpgraded=function(){var t,e,i;if((null===(t=this.data)||void 0===t?void 0:t.underConstruction)||!(null===(e=this.data)||void 0===e?void 0:e.alive))return!1;var o=null===(i=this.stats)||void 0===i?void 0:i.canBeUpgraded;if(o){var a=m.default.buildings.get(this.stats.upgradeTo);if(a.tech){var n=this.city.getCulture();n&&!n.haveTech(a.tech)&&(o=!1)}}return o},e.prototype.upgradeBulding=function(){if(this.canBeUpgraded()){var t=m.default.buildings.get(this.stats.upgradeTo);(t.fundament.left==this.stats.fundament.left&&t.fundament.right==this.stats.fundament.right&&t.fundament.top==this.stats.fundament.top&&t.fundament.bottom==this.stats.fundament.bottom||this.checkTilesForUpgrade(this.currentTile,t))&&(this.city&&this.city.setBuildingDictID(this,!1),this.setTemplate(t),this.city&&this.city.setBuildingDictID(this,!0),this.setSpriteMain(),this.updateStats(),this.data.health=this.curStats.health,this.fillTiles(),C.default.inst.qualityChanger.isFullLowRes()&&(this._is_visible=!1),this.checkBuildingUpgradeAchievement())}},e.prototype.setTemplate=function(t){t||cc.log("pTemplate\u4e3a\u7a7a"),this.stats=t,this.data.templateID=this.stats.id,this.data.resourceNum=N[t.resources_given],this.stats.kingdom&&this.setKingdom(C.default.inst.kingdoms.dict_hidden.get(this.stats.kingdom)),this.node.name=this.stats.id},e.prototype.setKingdom=function(t,e){var i,o,a,n,r,s,l;void 0===e&&(e=!0),t?(this.kingdom?this.kingdom!=t&&(this.kingdom.buildings.remove(this),this.kingdom=t,this.kingdom.buildings.add(this)):(this.kingdom=t,this.kingdom.buildings.add(this)),(null===(i=this.stats)||void 0===i?void 0:i.docks)&&this.kingdom.isCiv()&&this.getComponent(L.default).setKingdom(t)):(this.kingdom&&this.kingdom.buildings.remove(this),this.kingdom=null,this.setSpriteDirty()),(null===(o=this.stats)||void 0===o?void 0:o.cityBuilding)&&(null===(a=this.data)||void 0===a?void 0:a.alive)&&((null===(n=this.kingdom)||void 0===n?void 0:n.isCiv())&&!this.isRuin()?(this.setState(v.BuildingState.CivKingdom),this.setSpriteDirty()):this.setState(v.BuildingState.CivAbandoned)),e&&(null===(r=this.stats)||void 0===r?void 0:r.cityBuilding)&&!this.kingdom&&((null===(s=this.data)||void 0===s?void 0:s.state)==v.BuildingState.Ruins?(this.kingdom=C.default.inst.kingdoms.getKingdomByID("ruins"),this.kingdom.buildings.add(this)):(null===(l=this.data)||void 0===l?void 0:l.state)==v.BuildingState.CivAbandoned&&(this.kingdom=C.default.inst.kingdoms.getKingdomByID("abandoned"),this.kingdom.buildings.add(this))),this.setTilesDirty()},e.prototype.setState=function(t){this.checkAutoRemove(),this.data.state!=v.BuildingState.Removed&&this.data.state!=v.BuildingState.Ruins&&(t==v.BuildingState.Ruins&&(this.data.health=5*this.curStats.health,this.curStats.health=this.data.health,this.setSpriteDirty()),this.data.state=t,this.updateColors(),this.checkAnimated())},e.prototype.checkAnimated=function(){this.spriteAnimation&&(this.data.state==v.BuildingState.CivAbandoned?this.spriteAnimation.isOn=!1:this.animData&&this.animData.animated&&(this.spriteAnimation.isOn=!0))},e.prototype.updateColors=function(){this.data.state==v.BuildingState.CivAbandoned||this.stats.cityBuilding&&this.data.state==v.BuildingState.Ruins?this.spriteAnimation.node.color=T.Toolbox.color_abandoned_building:this.spriteAnimation.node.color=T.Toolbox.color_white},e.prototype.checkTilesForUpgrade=function(t,e){for(var i=null,o=t.pos.x-e.fundament.left,a=t.pos.y-e.fundament.bottom,n=e.fundament.right+e.fundament.left+1,r=e.fundament.top+e.fundament.bottom+1,s=0;s<n;s++)for(var l=0;l<r;l++){if(!(i=C.default.inst.getTile(o+s,a+l)))return!1;if(!i.type.canBuildOn)return!1;if(i.zone.city!=this.city)return!1;var c=i.building;if(c&&c!=this){if(c.stats.priority>=this.stats.priority)return!1;if(c.stats.upgradeLevel>=this.stats.upgradeLevel)return!1}}return!0},e.prototype.setRandomTemplate=function(){var t=[];"house"==this.stats.type&&(this.stats.id.includes("human")?(t.push("tent_human"),t.push("house_human"),t.push("1house_human"),t.push("2house_human"),t.push("3house_human"),t.push("4house_human"),t.push("5house_human")):this.stats.id.includes("elf")?(t.push("tent_elf"),t.push("house_elf"),t.push("1house_elf"),t.push("2house_elf"),t.push("3house_elf"),t.push("4house_elf"),t.push("5house_elf")):this.stats.id.includes("orc")?(t.push("tent_orc"),t.push("house_orc"),t.push("1house_orc"),t.push("2house_orc"),t.push("3house_orc"),t.push("4house_orc"),t.push("5house_orc")):this.stats.id.includes("dwarf")&&(t.push("tent_dwarf"),t.push("house_dwarf"),t.push("1house_dwarf"),t.push("2house_dwarf"),t.push("3house_dwarf"),t.push("4house_dwarf"),t.push("5house_dwarf"))),"hall"==this.stats.type&&(this.stats.id.includes("human")?(t.push("hall_human"),t.push("1hall_human"),t.push("2hall_human")):this.stats.id.includes("elf")?(t.push("hall_elf"),t.push("1hall_elf"),t.push("2hall_elf")):this.stats.id.includes("orc")?(t.push("hall_orc"),t.push("1hall_orc"),t.push("2hall_orc")):this.stats.id.includes("dwarf")&&(t.push("hall_dwarf"),t.push("1hall_dwarf"),t.push("2hall_dwarf"))),0!=t.length&&(this.setTemplate(m.default.buildings.get(t.getRandom())),this.setSpriteMain())},e.prototype.setSpriteMain=function(t){void 0===t&&(t=!0);var e=T.Toolbox.randomInt(0,this.stats.sprites.animationData.length);if(this.setAnimData(e),this.spriteAnimation.isOn=this.animData.animated,this.spriteAnimation.setFrames(this.animData.main),this.animData.animated&&(this.spriteAnimation.timeBetweenFrames=.1),this.spriteChanged(),this.stats.randomFlip){var i=T.Toolbox.randomBool()?1:-1;this.node.scaleX*=i}this.setSpriteDirty(),!w.default.isLoading()&&t&&this.setScaleTween()},e.prototype.checkSpriteConstructor=function(){if(this.sprite_dirty&&this._is_visible&&!C.default.inst.qualityChanger.lowRes){var t=this.getBuildingSpriteID(this.id_sprite_building,this.kingdom.kingdomColor);this.sprite_dirty=!1,this.batch.c_sprite_dirty.remove(this),t!=this._last_contructed_sprite_id&&this.batch.l_parallel_update_sprites.push(this)}},e.prototype.getBuildingSpriteID=function(t,e){return 1e7*((e?e.id+1:-1e6)+1)+t},e.prototype.checkSpriteLayers=function(){this.checkRoof(),this.checkShadow(),this.data.state==v.BuildingState.CivAbandoned?this.spriteAnimation.node.color=T.Toolbox.color_abandoned_building:this.spriteAnimation.node.color=T.Toolbox.color_white},e.prototype.checkShadow=function(){if(this.stats.shadow&&(this.shadow||(this.shadow=this.node.getChildByName("shadow").getComponent(_.default)),this.shadow&&this.spriteAnimation.currentSpriteGraphic)){var t=this.animData.shadows[this.spriteAnimation.currentFrameIndex];t?this.shadow.spriteRenderer.spriteFrame=t:u.default.d("Sprite is missing: "+this.spriteAnimation.currentSpriteGraphic.name)}},e.prototype.checkRoof=function(){var t;if(this.roof||(this.roof=cc.find("main/roof",this.node).getComponent(cc.Sprite)),this.stats.hasKingdomColor&&!this.isAnimationState(v.BuildingAnimationState.OnRuin)&&this.data.state!=v.BuildingState.Ruins){if(this.roof.node.active=!0,this.spriteAnimation.currentSpriteGraphic){var e=this.animData.roof[this.spriteAnimation.currentFrameIndex];this.roof.spriteFrame=e,this.roof&&((null===(t=this.kingdom)||void 0===t?void 0:t.isCiv())?this.roof.node.color=this.kingdom.kingdomColor.colorBorderInside:this.roof.node.color=m.default.raceLibrary.get(this.stats.race).color_abandoned)}}else this.roof.node.active=!1},e.prototype.applyConstructedSprite=function(){this.s_main_sprite&&(this._last_contructed_sprite_id=this.getBuildingSpriteID(this.id_sprite_building,this.kingdom.kingdomColor),this.spriteRenderer.spriteFrame=this.s_main_sprite,this.checkSpriteLayers())},e.prototype.setMainSprite=function(t){this.s_main_sprite=t,this.id_sprite_building=c.default.getHashCode(t.name),this.setSpriteDirty()},e.prototype.fillFrontTiles=function(){this.frontTiles=[];for(var t=this.currentTile.pos.x-this.stats.fundament.left,e=this.stats.fundament.right+this.stats.fundament.left+1,i=0;i<e;i++){var o=C.default.inst.getTile(t+i,this.doorTile.pos.y);this.frontTiles.push(o)}},e.prototype.fillTiles=function(){0!=this.tiles.length&&this.clearTiles();for(var t=this.currentTile.pos.x-this.stats.fundament.left,e=this.currentTile.pos.y-this.stats.fundament.bottom,i=this.stats.fundament.right+this.stats.fundament.left+1,o=this.stats.fundament.top+this.stats.fundament.bottom+1,a=0;a<i;a++)for(var n=0;n<o;n++){var r=C.default.inst.getTile(t+a,e+n);r&&this.setBuildingTile(r,a,n)}this.setTilesDirty()},e.prototype.checkDirtyTiles=function(){var t;if(this.tiles_dirty){this.tiles_dirty=!1;for(var e=0;e<this.tiles.length;e++){var i=this.tiles[e];C.default.inst.setTileDirty(i)}null===(t=this.batch)||void 0===t||t.c_tiles_dirty.remove(this)}},e.prototype.setTilesDirty=function(){var t;this.tiles_dirty=!0,null===(t=this.batch)||void 0===t||t.c_tiles_dirty.add(this)},e.prototype.forceUpdateTilesDirty=function(){this.setTilesDirty(),this.checkDirtyTiles()},e.prototype.setBuildingTile=function(t,e,i){t.building&&t.building!=this&&t.building.startRemove(),t.building=this,t.buildingX=e,t.buildingY=i,this.tiles.includes(t)||(this.tiles.push(t),this.zones.includes(t.zone)||(this.zones.push(t.zone),t.zone.addBuilding(this)));var o=null,a=null;this.stats.transformTilesToTileType&&(o=m.default.tiles.get(this.stats.transformTilesToTileType)),this.stats.transformTilesToTopTiles&&(a=m.default.topTiles.get(this.stats.transformTilesToTopTiles)),(o||a)&&(o||(o=t.main_type),p.default.terraformTile(t,o,a,y.default.nothing))},e.prototype.retake=function(){this.setState(v.BuildingState.CivKingdom),this.data.alive=!0,this.setSpriteDirty();for(var t=0;t<this.zones.length;t++){var e=this.zones[t];e.removeBuilding(this),e.addBuilding(this)}},e.prototype.makeAbandoned=function(){if(this.data&&(this.data.cityID=""),0!=this.zones.length)for(var t=0;t<this.zones.length;t++){var e=this.zones[t];e.buildings.delete(this),e.addBuilding(this)}this.setTilesDirty()},e.prototype.isRuin=function(){var t,e;return!(this.stats&&(null===(t=this.stats)||void 0===t||!t.isRuin)&&null!==(e=this.data)&&void 0!==e&&e.alive&&this.data.state!=v.BuildingState.Ruins)},e.prototype.isAbandoned=function(){var t;return(null===(t=this.data)||void 0===t?void 0:t.state)==v.BuildingState.CivAbandoned},e.prototype.prepareForSave=function(){this.data.frameID=this.animData_index},e.prototype.isNonUsable=function(){return!(!this.isRuin()&&!this.isAbandoned())},e.prototype.startDestroyBuilding=function(t){var e,i;void 0===t&&(t=!1),this.clearCity(),this.setSpriteDirty(),this.setOnMakeRuin(),this.setState(v.BuildingState.Ruins),(!(null===(e=this.stats)||void 0===e?void 0:e.ruins)||(null===(i=this.data)||void 0===i?void 0:i.underConstruction))&&(t=!0),t?(this.setSpriteRuin(),this.startRemove()):this.setKingdom(C.default.inst.kingdoms.getKingdomByID("ruins"))},e.prototype.clearZoneBuilding=function(){for(var t=0;t<this.zones.length;t++)this.zones[t].removeBuilding(this)},e.prototype.clearCity=function(){this.city&&(this.city.removeBuilding(this),this.clearCityZones(),this.setCity(null,!1),this.setKingdom(C.default.inst.kingdoms.getKingdomByID("ruins")))},e.prototype.kill=function(){var t;if(null===(t=this.data)||void 0===t?void 0:t.alive){this.clearZoneBuilding(),this.data.alive=!1,this.stats.cityBuilding&&!this.stats.isRuin&&C.default.inst.mapStats.housesDestroyed++,this.clearCity();for(var e=0;e<this.zones.length;e++)this.zones[e].addBuilding(this)}},e.prototype.clearCityZones=function(){if(this.clearZoneBuilding(),this.city)for(var t=0;t<this.zones.length;t++){var e=this.zones[t];e.buildings.size<=0&&this.city.removeZone(e)}},e.prototype.clearZones=function(){this.clearZoneBuilding(),this.zones=[]},e.prototype.setCity=function(t,e){var i;void 0===e&&(e=!0),this.city=t,t&&this.data&&(null===(i=this.city)||void 0===i?void 0:i.data)?(this.data.cityID=this.city.data.cityID,e&&this.setKingdom(t.kingdom)):(this.data&&(this.data.cityID=""),e&&this.setKingdom(null))},e.prototype.setSpriteRuin=function(){var t,e;if(null===(t=this.stats)||void 0===t?void 0:t.ruins){if(this.clearZoneBuilding(),this.zones=[],this.clearTiles(),!(null===(e=this.data)||void 0===e?void 0:e.underConstruction)){var i=this.stats.ruins;this.animData.animated&&(this.spriteAnimation.currentFrameIndex=0,this.spriteAnimation.forceUpdateFrame()),"same_id"==this.stats.ruins?(this.spriteAnimation.currentSpriteGraphic&&(this.spriteAnimation.setFrames(this.animData.ruins),this.setMainSprite(this.animData.ruins[0])),w.default.isLoading()||this.setScaleTween()):(this.setTemplate(m.default.buildings.get(i)),this.setSpriteMain(!1)),this.spriteAnimation.isOn=!1}this.fillTiles()}},e.prototype.spriteChanged=function(){this.spriteAnimation.isOn&&!this.getComponent(v.BuildingAnimationUpdated)&&this.addComp(this.addComponent(v.BuildingAnimationUpdated))},e.prototype.updateStats=function(){t.prototype.updateStats.call(this),this.curStats.clear(),this.curStats.addStats(this.stats.baseStats),this.batch.c_stats_dirty.remove(this)},e.prototype.chopTree=function(){if(!this.chopped){this.removeAllStatusEffects(),B.default.playTreeFall(this.node.position),this.chopped=!0,this.haveResources=!1;var t=T.Toolbox.randomBool()?90:-90;this.curTween=cc.tween(this.node).to(1/k.default.timeScale,{angle:t},{easing:"expoIn"}).to(.5/k.default.timeScale,{scaleX:0},{easing:"expoIn"}).call(this.finishChop.bind(this)).start(),this.shadow&&(this.shadow.node.active=!1)}},e.prototype.finishChop=function(){this.cancelTween(),this.startRemove()},e.prototype.startRemove=function(t){void 0===t&&(t=!0),this.isAnimationState(v.BuildingAnimationState.OnRemove)||(this.cancelTween(),this.setAnimationState(v.BuildingAnimationState.OnRemove),this.clearTiles())},e.prototype.isAnimationState=function(t){return this.animationState==t},e.prototype.setOnMakeRuin=function(){var t,e,i;this.isAnimationState(v.BuildingAnimationState.OnRuin)||(null===(t=this.data)||void 0===t?void 0:t.state)==v.BuildingState.Ruins||(this.setAnimationState(v.BuildingAnimationState.OnRuin),!(null===(e=this.data)||void 0===e?void 0:e.underConstruction)&&(null===(i=this.data)||void 0===i?void 0:i.alive)&&(B.default.playBuildingDestroyed(this.currentTile.posV3),h.default.update(73,C.default.inst.mapStats.housesDestroyed,!0)))},e.prototype.destroyBuilding=function(){this.setState(v.BuildingState.Removed),this.cancelTween(),this.setAnimationState(v.BuildingAnimationState.Normal),this.clearZones(),this.kill(),this.setKingdom(null,!1),C.default.inst.removeBuildingFully(this),this.clearTiles()},e.prototype.clearTiles=function(){this.forceUpdateTilesDirty();for(var t=0;t<this.tiles.length;t++)this.tiles[t].building=null;this.tiles=[]},e.prototype.cancelTween=function(){this.curTween&&(this.curTween.stop(),this.curTween=null),this.tween_scale_start=1,this.tween_scale_target=1},e.prototype.checkTweens=function(){if(!this.curTween)switch(this.animationState){case v.BuildingAnimationState.OnRuin:this.cancelTween(),k.default.timeScale>10?this.completeMakingRuin():cc.isValid(this.node)?this.curTween=cc.tween(this.node).to(.1,{scaleY:.7*this.defaultScale.y},{easing:"cubicIn"}).call(this.completeMakingRuin.bind(this)).start():this.completeMakingRuin();break;case v.BuildingAnimationState.OnRemove:this.cancelTween();var t=0,e="backIn";this.chopped&&(e="cubicIn",t=this.defaultScale.y),cc.isValid(this.node)?this.curTween=cc.tween(this.node).to(.5,{scaleY:t},{easing:e}).call(this.destroyBuilding.bind(this)).start():this.destroyBuilding(),this.stats.cityBuilding&&this.startShake(.5)}},e.prototype.setAnimationState=function(t){this.animationState=t,this.checkTweens()},e.prototype.completeMakingRuin=function(){this.kill(),this.cancelTween(),this.setSpriteDirty(),this.setAnimationState(v.BuildingAnimationState.Normal),this.setSpriteRuin(),this.node.setScale(this.defaultScale),this.setScaleTween()},e.prototype.forceScale=function(){this._is_visible=!0,this.scaleVal=0,this.currentScale.y!=this.scaleVal&&(this.currentScale.x=this.defaultScale.x,this.currentScale.y=this.scaleVal,this.currentScale.z=this.defaultScale.z,this.node.setScale(this.currentScale))},e.prototype.updateScale=function(t){this._is_visible&&(this.tween_active||this.scaleVal!=C.default.inst.qualityChanger.getTweenBuildings(this.defaultScale.y))&&(this.tween_active&&this.tween_scale_time<this.tween_scale_duration?(this.tween_scale_time+=t,this.tween_scale_time>=this.tween_scale_duration&&(this.tween_scale_time=this.tween_scale_duration,this.tween_active=!1),this.tween_scale_time==this.tween_scale_duration?this.tween_value=1:this.tween_value=d.default.easeOutBack(this.tween_scale_start,this.tween_scale_target,this.tween_scale_time/this.tween_scale_duration)):this.tween_value=1,this.scaleVal=C.default.inst.qualityChanger.getTweenBuildings(this.defaultScale.y)*this.tween_value,this.currentScale.y!=this.scaleVal&&(this.currentScale.y=this.scaleVal,this.currentScale.z=this.defaultScale.z,this.batch.l_parallel_scale.push(this)))},e.prototype.applyScale=function(){this.node.setScale(this.currentScale)},e.prototype.angleEffect=function(t){this.stats.fauna&&(0==this.interval&&(this.interval=.1+T.Toolbox.randomFloat(0,.1)),this.angle_timer+=t*this.interval,this.angle_timer>=1&&(this.goingLeft=!this.goingLeft,this.angle_timer=0),this.goingLeft?this.angle=d.default.easeOutBack(-5,5,this.angle_timer):this.angle=d.default.easeOutBack(5,-5,this.angle_timer),this.node.angle=this.angle)},e.prototype.checkAutoRemove=function(){!this.stats.auto_remove_ruin||this.data.state!=v.BuildingState.Ruins&&this.data.state!=v.BuildingState.CivAbandoned?this.batch.c_auto_remove.remove(this):this.batch.c_auto_remove.add(this)},e.prototype.updateAutoRemove=function(t){this._autoRemoveTimer<300?this._autoRemoveTimer+=t:(this._autoRemoveTimer=0,this.batch.c_auto_remove.remove(this),this.startRemove())},e.prototype.addStatusEffect=function(e,i){void 0===i&&(i=-1),t.prototype.addStatusEffect.call(this,e,i),this.hasAnyStatusEffect()&&this.batch.c_status_effects.add(this)},e.prototype.removeStatusEffect=function(e,i,o){void 0===i&&(i=null),void 0===o&&(o=-1),t.prototype.removeStatusEffect.call(this,e,i,o),this.hasAnyStatusEffect()||this.batch.c_status_effects.remove(this)},e.prototype.updateTimerShakeResources=function(t){this.timerShakeResource>0&&(this.timerShakeResource-=t,this.timerShakeResource<=0&&this.batch.c_resource_shaker.remove(this))},e.prototype.updateComponents=function(t){for(var e=0;e<this.components.length;e++)this.components[e].logicUpdate(t)},e.prototype.updatePosition=function(){if(this.positionDirty){this.positionDirty=!1,this.batch.c_position_dirty.remove(this);var t=this.currentTile.posV3;t.z=t.y+.15,t.z<0&&(t.z=0),this.node.position=t.add(this.shakeOffset)}},e.prototype.spawnBurstSpecial=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1);for(var o=0;o<t;o++)C.default.inst.dropManager.spawnBurstPixel(this.currentTile,this.stats.spawnDropID,T.Toolbox.randomFloat(.2,.5*e),T.Toolbox.randomFloat(1.3,1*i))},e.prototype.updateBuild=function(t){void 0===t&&(t=1),this.data.progress+=t,this.startShake(.3),this.data.progress>10?(this.data.progress=10,this.data.underConstruction=!1,this.setSpriteMain(),this.setScaleTween(.25),this.checkBuildingCompleteAchievement()):this.setScaleTween(.75)},e.prototype.startShake=function(t){var e;this.shakeTimer=t,null===(e=this.batch)||void 0===e||e.c_shake.add(this)},e.prototype.resourceGathering=function(){var t;if(!(this.timerShakeResource>0))switch(this.batch.c_resource_shaker.add(this),this.startShake(.3),this.timerShakeResource=1,null===(t=this.stats)||void 0===t?void 0:t.buildingType){case v.BuildingType.Tree:B.default.playChopping(this.node.position);break;case v.BuildingType.Stone:case v.BuildingType.Ore:case v.BuildingType.Gold:B.default.playMining(this.node.position);break;case v.BuildingType.None:case v.BuildingType.Fruits:}},e.prototype.updateShake=function(t){this.shakeTimer>0&&(this.shakeOffset.set(cc.v3(T.Toolbox.randomFloat(-.2,.2),T.Toolbox.randomFloat(-.2,.2),0)),this.setPositionDirty(),this.shakeTimer-=t,this.shakeTimer<0&&(this.setPositionDirty(),this.shakeOffset.set(cc.Vec3.ZERO),this.batch.c_shake.remove(this)))},e.prototype.getHit=function(t,e,i,o,a){void 0===e&&(e=!0),void 0===i&&(i=f.AttackType.Other),void 0===o&&(o=null),void 0===a&&(a=!0),this.isAnimationState(v.BuildingAnimationState.OnRuin)&&this.curTween||(this.data.health-=l.default.intCast(t),this.setScaleTween(.75),this.startShake(.3),this.data.health<=0&&(this.data.state==v.BuildingState.Ruins?this.startDestroyBuilding(!0):this.startDestroyBuilding()))},e.prototype.extractResources=function(t,e){var i;void 0===e&&(e=1),this.setScaleTween(.75);var o=t.getCulture(),a=e;switch(null===(i=this.stats)||void 0===i?void 0:i.buildingType){case v.BuildingType.Wheat:this.startDestroyBuilding(!0);break;case v.BuildingType.Tree:(null==o?void 0:o.haveTech("sharp_axes"))&&T.Toolbox.randomChance(o.stats.bonus_res_chance_wood.value)&&(a+=l.default.intCast(o.stats.bonus_res_wood_amount.value)),this.chopTree();break;case v.BuildingType.Stone:case v.BuildingType.Ore:case v.BuildingType.Gold:a=1,(null==o?void 0:o.haveTech("mining_efficiency"))&&T.Toolbox.randomChance(o.stats.bonus_res_chance_ores.value)&&(a+=l.default.intCast(o.stats.bonus_res_ore_amount.value)),this.data.resourceNum-=a,this.checkResourceAmount(this.data.resourceNum);break;case v.BuildingType.Fruits:this.getComponent(O.default).resourceResetTime=90,this.setHaveResources(!1)}return a},e.prototype.checkResourceAmount=function(t){t<=0?this.startRemove():t<=N[this.stats.resources_given-1]&&(2==this.stats.resources_given?this.changeResource(!0):3==this.stats.resources_given&&this.changeResource(!1))},e.prototype.changeResource=function(t){var e=this.stats.id;e=e.replace("_m",""),e+=t?"_s":"_m",this.stats=m.default.buildings.get(e),this.setTemplate(this.stats),this.setSpriteMain(),this.setScaleTween(.5*this.defaultScale.y)},e.prototype.getColor=function(t){var e,i,o;return k.default.EVERYTHING_MAGIC_COLOR?T.Toolbox.EVERYTHING_MAGIC_COLOR32:null===(o=null===(i=null===(e=this.stats)||void 0===e?void 0:e.sprites)||void 0===i?void 0:i.mapIcon)||void 0===o?void 0:o.getColor(t.buildingX,t.buildingY,this)},e.prototype.getConstructionTile=function(){var t,e=null;if(T.Toolbox.temp_list_tiles=[],null===(t=this.stats)||void 0===t?void 0:t.docks){this.checkZoneForDockConstruction(this.currentTile.zone);for(var i=0;i<this.currentTile.zone.neighboursAll.length;i++){var o=this.currentTile.zone.neighboursAll[i];this.checkZoneForDockConstruction(o)}T.Toolbox.temp_list_tiles.length>0&&(e=T.Toolbox.getRandom(T.Toolbox.temp_list_tiles))}else e=T.Toolbox.getRandom(this.tiles);return e},e.prototype.checkZoneForDockConstruction=function(t){if(t.city&&t.city==this.city)for(var e=0;e<t.tiles.length;e++){var i=t.tiles[e];!i.type.ground||T.Toolbox.distTile(this.currentTile,i)>7||T.Toolbox.temp_list_tiles.push(i)}},e.prototype.checkBuildingCompleteAchievement=function(){"house"==this.stats.type?"human"==this.stats.race&&h.default.update(1):"mine"==this.stats.type?h.default.update(27):"docks"==this.stats.type&&h.default.update(30)},e.prototype.checkBuildingUpgradeAchievement=function(){if("hall"==this.stats.type)if(1==this.stats.upgradeLevel)h.default.update(25);else if(2==this.stats.upgradeLevel&&(h.default.update(31),this.kingdom.cities.length>=10)){var t=0;this.kingdom.cities.forEach(function(e){2==e.getHallLevel()&&t++}),t==this.kingdom.cities.length&&h.default.update(55,10,!0)}},e.defaultScale=cc.v3(.125,.125,.125),s([E],e)}(b.default);n.default=z,cc._RF.pop()},{}],BurnedTilesLayer:[function(t,e,i){"use strict";cc._RF.push(e,"66c3ev2l4NCuKPzVj2ZISeU","BurnedTilesLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ToolBox"),c=a("MapLayer"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.color=cc.Color.TRANSPARENT,e.worldBehaviour=null,e}return r(e,t),e.prototype.onLoad=function(){this.colorValues=cc.color(this.color.r,this.color.g,this.color.b,127.5),this.colors_amount=15,this.autoDisable=!1,this.enabled=!0,t.prototype.create.call(this)},e.prototype.setTileDirty=function(t){this.pixels_to_update.contains(t)||this.pixels_to_update.add(t)},e.prototype.updateDirty=function(){var t=this;this.pixels_to_update.length()<=0||(this.pixels_to_update.dict.forEach(function(e,i){i.burned_stages>0?t.updateSinglePixel(i.data.tile_id,t.colors[i.burned_stages-1]):t.updateSinglePixel(i.data.tile_id,l.Toolbox.clear)}),this.pixels_to_update.clear(),this.updatePixels())},s([h(cc.Color)],e.prototype,"color",void 0),s([u],e)}(c.default);n.default=p,cc._RF.pop()},{}],CachedRaycastIslands:[function(t,e,i){"use strict";cc._RF.push(e,"cd6ec+vh/hFgroSBbtNZ5hd","CachedRaycastIslands");var o,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.RaycastResult=void 0,function(t){t[t.Possible=0]="Possible",t[t.NotPossible=1]="NotPossible",t[t.NotCalculated=2]="NotCalculated"}(o=a.RaycastResult||(a.RaycastResult={}));var n=function(){function t(){}return t.debug=function(){return t.hash.size.toString()},t.add=function(e,i,a,n){var r=t.getID(e,i,a);n?t.hash.set(r,o.Possible):t.hash.set(r,o.NotPossible)},t.getResult=function(e,i,a){var n=t.getID(e,i,a);return t.hash.has(n)?t.hash.get(n):o.NotCalculated},t.getID=function(t,e,i){return t.chunk.x+"_"+t.chunk.y+"_"+t.region.island.id+"_"+e.region.island.id+"_"+i.dieInLava.toString()+"_"+i.damagedByOcean.toString()+"_"+i.isBoat.toString()},t.clear=function(){t.hash.clear()},t.hash=new Map,t}();a.default=n,cc._RF.pop()},{}],CensusInfo:[function(t,e,i){"use strict";cc._RF.push(e,"8098fV78fhNMa/QBAXieDyx","CensusInfo");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.CensusInfo=void 0;var c=a("GamePopBase"),d=a("StatsHelper"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueNode=null,e}return r(e,t),e.prototype.start=function(){this.showValues()},e.prototype.showValues=function(){var t,e;try{for(var i=l(this.valueNode.children),o=i.next();!o.done;o=i.next()){var a=o.value,n=d.default.getStatistic(a.name);a.getComponent(cc.RichText).string=n}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},s([p(cc.Node)],e.prototype,"valueNode",void 0),s([h],e)}(c.GamePopBase);n.CensusInfo=f,cc._RF.pop()},{}],ChineseNameGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"ab5c21XmWlKV7UbkkFwKvP9","ChineseNameGenerator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("AssetManager"),r=o("ToolBox"),s=function(){function t(){}return t.getChineseName=function(e){var i;return i=n.default.chineseName.dict.has(e)?n.default.chineseName.get(e):n.default.chineseName.get("default_name"),t.getNameFromTemplate(i)},t.getCreatureName=function(e,i,o){void 0===o&&(o=!0);var a=n.default.chineseName.get(e),s=t.getNameFromTemplate(a,!1);return o?s=i+s:s+=i,!a.onlyByTemplate&&a.fixedList&&a.fixedList.length>0&&r.Toolbox.randomChance(a.fixedNameChance)?a.fixedList.getRandom():s},t.getNameFromTemplate=function(e,i){void 0===i&&(i=!0);var o="";if(i&&!e.onlyByTemplate&&e.fixedList&&e.fixedList.length>0&&r.Toolbox.randomChance(e.fixedNameChance))return e.fixedList.getRandom();if(!e.templates||0==e.templates.length)return"";for(var a=e.templates.length,n=e.templates,s=0;s<a;s++)o+=t.addPartsByChance(o,n[s],e,1,!1);return o},t.addPartsByChance=function(e,i,o,a,n){return void 0===a&&(a=1),void 0===n&&(n=!1),n?r.Toolbox.randomChance(a)&&(e=t.getPart(i,o)):e=t.getPart(i,o),e},t.getPart=function(t,e){return t.includes("addition_start")?e.addition_startList.getRandom():t.includes("addition_end")?e.addition_endList.getRandom():t.includes("part1")?e.partsList.getRandom():t.includes("part2")?e.partsList2.getRandom():t.includes("special1")?e.special1.getRandom():t.includes("special2")?e.special2.getRandom():"\u8bf7\u68c0\u67e5\u8be5\u751f\u7269\u547d\u540d\u6a21\u677f"},t}();a.default=s,cc._RF.pop()},{}],ChineseNameLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"d3a54wM5cxDoJAEwKaaMmhb","ChineseNameLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ChineseNameAsset=void 0;var s=a("Tools"),l=a("AssetLibrary"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templates=["addition_start","part","addition_end"],e.addition_startList=[],e.addition_endList=[],e.partsList=[],e.partsList2=[],e.fixedList=[],e.special1=[],e.special2=[],e.onlyByTemplate=!1,e.fixedNameChance=.005,e}return r(e,t),e.familyNameTotal=["\u8d75","\u94b1","\u5b59","\u674e","\u5468","\u5434","\u90d1","\u738b","\u51af","\u9648","\u891a","\u536b","\u848b","\u6c88","\u97e9","\u6768","\u6731","\u79e6","\u5c24","\u8bb8","\u4f55","\u5415","\u65bd","\u5f20","\u5b54","\u66f9","\u4e25","\u534e","\u91d1","\u9b4f","\u9676","\u59dc","\u8d39","\u5ec9","\u5c91","\u859b","\u96f7","\u8d3a","\u502a","\u6c64","\u6ed5","\u6bb7","\u7f57","\u6bd5","\u90dd","\u90ac","\u5b89","\u5e38","\u4e50","\u4e8e","\u65f6","\u5085","\u76ae","\u535e","\u9f50","\u5eb7","\u4f0d","\u4f59","\u5143","\u535c","\u987e","\u5b5f","\u5e73","\u9ec4","\u675c","\u962e","\u84dd","\u95f5","\u5e2d","\u5b63","\u9ebb","\u5f3a","\u8d3e","\u8def","\u5a04","\u5371","\u6c5f","\u7ae5","\u989c","\u90ed","\u6885","\u76db","\u6797","\u5201","\u949f","\u5f90","\u90b1","\u9a86","\u9ad8","\u590f","\u8521","\u7530","\u6a0a","\u80e1","\u51cc","\u970d","\u7a0b","\u5d47","\u90a2","\u6ed1","\u88f4","\u9646","\u8363","\u7fc1","\u8340","\u7f8a","\u65bc","\u60e0","\u7504","\u9b4f","\u52a0","\u5c01","\u82ae","\u7fbf","\u50a8","\u9773","\u6c72","\u90b4","\u7cdc","\u677e","\u4e95","\u6bb5","\u5bcc","\u5deb","\u4e4c","\u7126","\u5df4","\u5f13","\u53f6","\u5e78","\u53f8","\u97f6","\u90dc","\u9ece","\u84df","\u8584","\u5370","\u5bbf","\u767d","\u6000","\u84b2","\u53f0","\u4ece","\u9102","\u7d22","\u54b8","\u7c4d","\u8d56","\u5353","\u853a","\u5c60","\u8499","\u6c60","\u4e54","\u9634","\u90c1","\u80e5","\u80fd","\u82cd","\u53cc","\u6e29","\u522b","\u5e84","\u664f","\u67f4","\u77bf","\u960e","\u5145","\u6155","\u8fde","\u8339","\u4e60","\u5ba6","\u827e","\u9c7c","\u5bb9","\u5411","\u53e4","\u6613","\u614e","\u6208","\u5ed6","\u5e9a","\u7ec8","\u66a8","\u5c45","\u8861","\u6b65","\u90fd","\u803f","\u6ee1","\u5f18","\u66fe","\u6bcb","\u6c99","\u4e5c","\u517b","\u97a0","\u987b","\u4e30","\u5984","\u90aa","\u5e7d","\u9634","\u846c","\u9986","\u591c","\u51a5","\u6e9f","\u4ea1","\u5929","\u5149","\u9053","\u6e90","\u7075","\u7384","\u8000","\u9633","\u59ec","\u6781","\u8be1","\u592a","\u5b87","\u5b99","\u7b80","\u6613","\u521d","\u59cb","\u7687","\u6743","\u5e1d","\u5c0a","\u519b","\u541b","\u745e","\u767d","\u96ea","\u4ed9","\u5723","\u795e","\u6b66","\u82cd","\u7a79","\u7a7a","\u9b54","\u7981","\u55dc","\u566c","\u5239","\u6740","\u9006","\u5a9a","\u715e","\u72f1","\u9aa8","\u589f","\u70bc","\u960e","\u711a","\u5deb","\u708e","\u96f7","\u51b0","\u91d1","\u6728","\u6c34","\u706b","\u571f","\u98ce","\u5492","\u9738","\u9547","\u5fa1","\u86ca","\u796d","\u7f6a","\u68a6","\u8352","\u796d","\u6218","\u9668","\u5bc2","\u72f1","\u7956","\u5c01","\u5370","\u591c\u6e9f","\u51a5\u53f8","\u5e7d\u66ae","\u6c38\u6697","\u65e0\u6781","\u592a\u4e0a","\u7d2b\u8587","\u73b2\u73d1","\u6df1\u6e0a","\u711a\u5929","\u81ea\u5728","\u9053","\u900d\u9065","\u5f52\u7075","\u6743","\u902f","\u76d6","\u76ca","\u6853","\u516c","\u4e07\u4fdf","\u53f8\u9a6c","\u4e0a\u5b98","\u6b27\u9633","\u516c\u5b59","\u4e50\u6b63","\u8f69\u8f95","\u4ee4\u72d0","\u949f\u79bb","\u95fe\u4e18","\u957f\u5b59","\u6155\u5bb9","\u9c9c\u4e8e","\u5b87\u6587","\u53f8\u5f92","\u53f8\u7a7a","\u4e93\u5b98","\u53f8\u5bc7","\u4ec9\u7763","\u5b50\u8f66","\u6bb5\u5e72","\u767e\u91cc","\u4e1c\u90ed","\u5357\u95e8","\u547c\u5ef6","\u59ab\u6d77","\u7f8a\u820c","\u5fae\u751f","\u5cb3\u5e05","\u7f11\u4ea2","\u51b5\u5f8c","\u6709\u7434","\u6881\u4e18","\u5de6\u4e18","\u4e1c\u95e8","\u897f\u95e8","\u5909\u614b","\u7532","\u706b","\u708e","\u7130","\u7131","\u7075","\u9f99","\u5723","\u708e","\u5343\u5b98","\u70bc","\u6218","\u6b66","\u5929\u5de5","\u695a\u4e0a","\u65e0\u53cc","\u7089","\u5e7d\u4ec1","\u5e1d\u660a","\u5c06","\u8f69\u8f95","\u65a9\u5175"],e.rankName=["\u51e1","\u9ec4","\u7384","\u5730","\u5929","\u8352","\u6d2a","\u5b99","\u5b87","\u5723"],e.rankName1=["(\u51e1\u9636)","(\u9ec4\u9636)","(\u7384\u9636)","(\u5730\u9636)","(\u5929\u9636)","(\u5e1d\u9636)"],e}(l.Asset);n.ChineseNameAsset=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c;e.id="human_kingdom",e.onlyByTemplate=!1,e.fixedNameChance=.005,this.add(e),this.t.addition_startList=["\u8fdc\u53e4","\u4e0a\u53e4","\u6c38\u6052","\u65e0\u4e0a"," "," "],this.t.addition_endList=["\u738b\u671d","\u5e1d\u56fd","\u56fd","\u671d","\u56fd","\u5468\u671d","\u5929\u5ead","\u9b54\u5ead","\u7687\u5ead","\u5996\u5ead","\u795e\u6bbf","\u4ed9\u57df","\u4ed9\u56fd","\u7384\u57df","\u795e\u5e99","\u5723\u9662","\u5b87\u5b99","\u9053\u89c2","\u79e6\u671d","\u5b8b\u671d","\u6c49\u671d","\u5510\u671d","\u5143\u671d","\u695a\u671d","\u9f50\u671d","\u4ed9\u5bab","\u5723\u65cf","\u795e\u65cf","\u5723\u5730","\u795e\u5b97","\u7075\u65cf","\u5251\u5b97","\u5251\u57df","\u9053\u5b97","\u706b\u57df","\u5200\u5b97","\u5200\u57df","\u6587\u57df","\u64ce\u57df","\u5929\u57df","\u5723\u5b97","\u5723\u57df","\u5bab","\u71d5\u671d","\u9b4f\u671d","\u8700\u671d","\u5434\u671d","\u53e4\u671d","\u4e7e\u671d","\u5546\u671d","\u968b\u671d","\u590f\u671d","\u5251\u5b97","\u664b\u671d","\u5929\u671d","\u6b66\u671d","\u5e86\u671d","\u9b54\u65cf","\u795e\u6bbf","\u795e\u56fd","\u4f5b\u56fd","\u7075\u57df","\u67aa\u5b97","\u7075\u5b97","\u708e\u5b97","\u5996\u65cf","\u5e1d\u65cf","\u5723\u65cf","\u795e\u65cf","\u5927\u9646","\u5927\u9646","\u4e4b\u5730","\u9b54\u65cf","\u4ed9\u65cf","\u5e1d\u65cf","\u7687\u65cf","\u6e90\u65cf","\u5929\u65cf","\u5929\u5ead","\u6e90\u5b97"],this.t.partsList=["\u66e6\u65e5","\u4e5d\u9633","\u4e5d\u9634","\u4e5d\u52ab","\u4e5d\u5929","\u96f7\u9706","\u4e91\u9704","\u6d69\u701a","\u9f99\u864e","\u8840\u864e","\u5929\u706b","\u90aa\u706b","\u90aa\u864e","\u795e\u864e","\u767d\u864e","\u73b2\u73d1","\u6731\u96c0","\u51e4\u51f0","\u8d64\u96c0","\u7384\u6b66","\u9b3c\u72d0","\u5929\u72d0","\u5723\u9f99","\u87d2\u96c0","\u9752\u9f99","\u708e\u9f99","\u51b0\u661f","\u9b54\u9f99","\u795e\u9f99","\u5996\u9f99","\u9e92\u9e9f","\u5996\u5143","\u661f\u6cb3","\u98d8\u6e3a","\u65f6\u7a7a","\u65f6\u5149","\u708e","\u4e7e\u5764","\u6613","\u6c34","\u6b66","\u5929","\u5317","\u91d1","\u7389","\u6728","\u6b63\u7384","\u571f","\u706b","\u5730","\u795e","\u6e90","\u5143","\u6e05","\u6797","\u8349","\u5317","\u65e0\u6781","\u65e0\u60c5","\u4e71","\u53e4","\u7434","\u68cb","\u4e66","\u753b","\u6b63","\u6d2a","\u5c71","\u6d77","\u7687","\u9f99","\u539f","\u5c38","\u8840","\u90aa","\u738b","\u5996","\u7075","\u6c38","\u661f","\u5149","\u6697","\u592a\u6781","\u75d5","\u5b9d","\u7d2b","\u6781","\u8000","\u6cb3","\u90aa","\u5aba","\u70fd","\u6b66\u5e9a","\u964c\u5468","\u795e\u5a01","\u5c1a\u4e66","\u6625\u79cb","\u4e5d\u9f0e","\u574e\u6c34","\u795e\u519c","\u71ce\u91ce","\u9e3f\u8499","\u5929\u547d","\u4e09\u7687","\u5947\u95e8","\u5929\u9053","\u8f69\u8f95","\u4e1c\u7687","\u4f0f\u7fb2","\u960e\u7f57","\u4e0a\u6e05","\u5973\u5a32","\u5947\u7ecf","\u795e\u519c","\u4e94\u5e1d","\u795e\u5949","\u4ec1\u5584","\u51a5\u5492","\u5deb\u7956","\u5c79\u6602","\u5c71\u6d77","\u4e07\u6c0f","\u795e\u796d","\u5929\u7075","\u706b\u7130","\u5927\u6c34","\u6e90\u6728","\u91d1\u547d","\u571f\u7075","\u4f0a\u59cb","\u661f\u5bf0","\u661f\u5b87","\u5929\u51b0","\u98ce\u96f7","\u59cb\u5149","\u661f\u68cb\u76d8","\u7cbe\u7075","\u4e94\u884c","\u7075\u589f","\u957f\u751f","\u592a\u9633","\u6708\u4eae","\u9634\u9633","\u5927\u6697","\u5e73\u7b49","\u51a5\u672f","\u5143\u7d20","\u65f6\u5149","\u6613\u7a7a","\u795e\u953b","\u795e\u6b66","\u4f0a\u547d","\u661f\u953b","\u661f\u5b87","\u7cb9\u70bc","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u5929\u517d","\u5de8\u7075","\u5deb\u65cf","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5deb\u7956","\u5927\u7f8c","\u86ee\u5175","\u5f81\u4f10","\u547d\u6218","\u8840\u72f1","\u8d64\u5e1d","\u4e0d\u6b7b","\u8f6e\u56de","\u5730\u72f1","\u5929\u707e","\u4e07\u5996","\u5815\u843d","\u592a\u53e4","\u795e\u8bdd","\u4e5d\u5dde","\u534e\u590f","\u5929\u6cc9","\u5357\u9ed8","\u91d1\u971e","\u7075\u865a","\u7389\u9f0e","\u592a\u4e59","\u592a\u4e00","\u70df\u971e","\u7d2b\u9633","\u5915\u6708","\u900d\u9065","\u62dc\u6708","\u5408\u6b22","\u4e07\u52ab","\u6052\u5b87","\u5e7b\u706d","\u5e7f\u5bd2","\u5c01\u9b54","\u7d2b\u8587","\u4e5d\u9704","\u865a\u65e0","\u7384\u6e90","\u592a\u7384","\u592a\u865a","\u7389\u865a","\u53e4\u534e","\u6f20\u5317","\u6b63\u5317","\u5e73\u6d32","\u8f69\u5b87","\u660a\u5929","\u5929\u7fbd","\u609f\u7a7a","\u59d1\u82cf","\u6708\u795e","\u77f3\u5ddd","\u5e73\u6c5f","\u6c38\u5e74","\u8f6e\u56de","\u65e0\u6781","\u957f\u751f","\u9752\u534e","\u7d2b\u8587","\u52fe\u9648","\u5929\u542f","\u4e91\u70df","\u4e91\u5ca9","\u5c01","\u6708","\u9b3c","\u9b3c\u9b45","\u7434","\u97f3","\u70bc\u5668","\u795e\u5668","\u953b\u5668","\u4e07\u836f","\u70bc\u4e39","\u98de\u4e91","\u58a8\u9690","\u4e5d\u5929","\u4fee\u7f57","\u540e\u571f","\u592a\u521d","\u6052\u53e4","\u672b\u5f71","\u5929\u9704","\u9f99\u9706","\u5fd8\u60c5","\u5929\u5e08","\u900d\u9065","\u4e5d\u52ab","\u5929\u8c34","\u5c01\u5370","\u73b2\u73d1","\u9b3c\u8c37","\u5deb\u5c71","\u5251","\u5929\u5251","\u9b54\u5251","\u4e07\u5251","\u4e07\u52ab","\u5200","\u9b54\u5200","\u5929\u5200","\u67aa","\u5996","\u7389\u6e05","\u5f00\u5929","\u4e1c\u90e8","\u4e0d\u706d","\u897f\u6f20","\u5317\u6781","\u5357\u86ee","\u592a\u4e0a","\u592a\u7384","\u9547\u9b54","\u592a\u521d","\u8fdc\u53e4","\u51a5\u53e4","\u592a\u5e73","\u59cb\u6e90","\u6d2a\u8352","\u592a\u53e4","\u4e0a\u53e4","\u4e2d\u90e8","\u5916\u57df","\u4e1c\u7687","\u661f\u8fb0","\u90aa\u5984","\u4e07\u53e4","\u566c\u5143","\u9b42","\u5723\u5251","\u5929\u9b54","\u9738\u67aa","\u7075\u5251","\u4e7e\u5143","\u9b3c\u5203","\u5929\u5f13","\u7384\u673a","\u79bb\u706b","\u795e\u65a7","\u9f99\u6e90","\u9f99\u5ca9","\u9f99\u6e0a","\u771f\u6b66","\u83e9\u63d0","\u7389\u6e05","\u4e94\u8574","\u7384\u6b66","\u56da\u9f99","\u81ea\u5728","\u6781\u610f","\u65e0\u57a2","\u7075\u865a","\u7389\u865a","\u5343\u7fbd","\u9752\u7fbd","\u65e0\u6daf","\u8d64\u9633","\u7ea2\u5c18","\u4e09\u5c38","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u5927\u98df","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u8680\u7cbe","\u4e03\u661f","\u897f\u82cd","\u4e1c\u8d6b","\u9f99\u627f","\u5929\u82e5","\u5929\u6148","\u7834\u822a","\u897f\u6b66","\u5929\u627f","\u4f5b\u6b66","\u6b66\u5929","\u6d77\u7edc","\u5317\u9b54","\u96bc\u7edc","\u4e5d\u661f","\u51e4\u5251","\u5723","\u711a\u5929","\u51f6\u51a5","\u5929\u6781","\u70bc\u5668","\u70bc\u4e39","\u7ec3\u6c14","\u8679\u5149","\u9752\u5149","\u906e\u90a3","\u9006\u5929","\u7409\u7130","\u60b2\u95ee","\u5927\u6613","\u51b0\u8695","\u5c71\u6d77","\u5929\u517d","\u5de8\u7075","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5927\u7f8c","\u86ee\u5175","\u68ee\u7f57","\u767d\u8679","\u5bf0\u5b87","\u609f\u9053","\u795e\u76d7","\u5929\u715e","\u53e4\u5251","\u5996\u5200"],this.t.fixedList=["\u661f\u68cb\u76d8\u738b\u671d","\u5c79\u6602\u5e1d\u56fd","\u542f\u6e90\u5929\u671d","\u5927\u5510\u5e1d\u56fd","\u5927\u660e\u5e1d\u56fd","\u5927\u79e6\u5e1d\u56fd","\u534e\u590f\u5929\u671d","\u8499\u53e4\u5e1d\u56fd","\u6f20\u5317\u6c57\u56fd","\u79bb\u9633\u738b\u671d","\u5929\u5a01\u5e1d\u56fd","\u5b54\u5b50\u6587\u56fd","\u6d1b\u9633\u76db\u4e16","\u5929\u7532\u56fd","\u516c\u5b59\u6c57\u56fd","\u8f69\u8f95\u5e1d\u56fd","\u957f\u5b59\u516c\u56fd","\u6155\u5bb9\u6c57\u56fd","\u9c9c\u4e8e\u6c57\u56fd","\u5b87\u6587\u4e16\u5bb6","\u767e\u91cc\u4e16\u5bb6","\u5317\u51c9\u5e1d\u56fd","\u592a\u5e73\u76db\u4e16","\u9707\u79bb\u53e4\u56fd","\u5b50\u8f69\u6c57\u56fd","\u7b56\u6b63\u516c\u56fd","\u6d2a\u6b66\u5e1d\u56fd","\u5c71\u6d77\u56fd","\u89c2\u6d77\u56fd","\u5938\u7236\u53e4\u56fd","\u70fd\u9f0e\u56fd","\u6b66\u5e9a\u56fd","\u5929\u5357\u56fd","\u5357\u9633\u56fd","\u5e73\u5b89\u53e4\u65cf","\u5c71\u4e1c\u56fd","\u957f\u57ce\u519b","\u5efa\u5143\u5e1d\u56fd","\u9ec4\u9f99\u5e1d\u56fd","\u5251\u662d\u56fd","\u9e3f\u5609\u56fd","\u5efa\u6b66\u56fd","\u5609\u5e73\u671d","\u666f\u5e73\u671d","\u4e49\u7199\u5929\u671d","\u5929\u9274\u56fd","\u6c38\u5b9a\u56fd"],this.t.templates=["R.3Faddition_start","part1","addition_end"];var i=new c;i.id="tianming_kingdom",i.onlyByTemplate=!1,i.fixedNameChance=.005,this.add(i),this.t.addition_endList=["\u738b\u671d","\u5e1d\u56fd","\u56fd","\u5929\u671d","\u76db\u4e16","\u65cf"],this.t.partsList=["\u592a\u6b66","\u592a\u793c","\u592a\u521d","\u5b54\u5723","\u7384\u796d","\u661f\u547d","\u5929\u535c","\u4eba\u5723","\u542f\u660e","\u795e\u8ff9","\u4e5d\u5b97","\u71ce\u91ce","\u9e3f\u8499","\u5929\u547d","\u4e09\u7687","\u708e\u9ec4","\u4e94\u5e1d","\u795e\u5949","\u5929\u5ead","\u4ec1\u5584","\u51a5\u5492","\u5deb\u7956","\u5c71\u6d77","\u4e07\u6c0f","\u5929\u6cb3","\u71ce\u91ce","\u5468\u6613","\u5947\u95e8","\u5947\u7ecf","\u795e\u519c","\u7075\u5dde","\u7075\u6708","\u4e5d\u7075","\u4e07\u7269","\u81ea\u7136","\u795e\u796d","\u5929\u7075","\u795e\u7136","\u5929\u660e","\u706b\u7130","\u5927\u6c34","\u6e90\u6728","\u91d1\u547d","\u571f\u7075","\u4f0a\u59cb","\u661f\u5bf0","\u661f\u5b87","\u5929\u51b0","\u98ce\u96f7","\u59cb\u5149","\u661f\u68cb\u76d8","\u5927\u6697","\u5929\u57df","\u5e73\u7b49","\u51a5\u672f","\u59cb\u7956","\u5143\u7d20","\u65f6\u5149","\u6613\u7a7a","\u59cb\u7075","\u7075\u6b66","\u5723\u6b66","\u71e7\u4eba","\u9c81\u73ed","\u7075\u5c06","\u795e\u953b","\u5929\u9547","\u9547\u57df","\u5929\u706b","\u5723\u706b","\u70bc\u795e","\u91d1\u7075","\u795e\u6b66","\u661f\u953b","\u661f\u5b87","\u7cb9\u70bc","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u5929\u57df","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u795d\u878d","\u706b\u795e","\u7130\u97f5","\u706b\u7075","\u5927\u98df","\u51f6\u795e","\u51a5\u65cf","\u90e8\u843d","\u795e\u817e","\u56fe\u817e","\u5929\u517d","\u5de8\u7075","\u5deb\u65cf","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5deb\u7956","\u661f\u56fe","\u5927\u7f8c","\u86ee\u5175","\u547d\u6218","\u5929\u5308","\u8840\u72f1","\u8d64\u5e1d","\u9f99\u65cf","\u795e\u8bdd","\u795e\u7947","\u5c11\u660a","\u4e5d\u86ee","\u51f6\u7075"],this.t.fixedList=["\u542f\u6e90\u5929\u671d","\u5927\u5510\u5e1d\u56fd","\u5927\u660e\u5e1d\u56fd","\u5927\u79e6\u5e1d\u56fd","\u534e\u590f\u5929\u671d","\u8499\u53e4\u5e1d\u56fd","\u6f20\u5317\u6c57\u56fd","\u79bb\u9633\u738b\u671d","\u5929\u5a01\u5e1d\u56fd","\u5b54\u5b50\u6587\u56fd","\u6d1b\u9633\u76db\u4e16","\u5929\u7532\u56fd","\u516c\u5b59\u6c57\u56fd","\u8f69\u8f95\u5e1d\u56fd","\u957f\u5b59\u516c\u56fd","\u6155\u5bb9\u6c57\u56fd","\u9c9c\u4e8e\u6c57\u56fd","\u5b87\u6587\u4e16\u5bb6","\u767e\u91cc\u4e16\u5bb6","\u5317\u51c9\u5e1d\u56fd","\u592a\u5e73\u76db\u4e16","\u9707\u79bb\u53e4\u56fd","\u5b50\u8f69\u6c57\u56fd","\u7b56\u6b63\u516c\u56fd","\u6d2a\u6b66\u5e1d\u56fd","\u5c71\u6d77\u56fd","\u89c2\u6d77\u56fd","\u5938\u7236\u53e4\u56fd","\u70fd\u9f0e\u56fd","\u6b66\u5e9a\u56fd","\u5929\u5357\u56fd","\u5357\u9633\u56fd","\u5e73\u5b89\u53e4\u65cf","\u5c71\u4e1c\u56fd","\u957f\u57ce\u519b","\u5efa\u5143\u5e1d\u56fd","\u9ec4\u9f99\u5e1d\u56fd","\u5251\u662d\u56fd","\u9e3f\u5609\u56fd","\u5efa\u6b66\u56fd","\u5609\u5e73\u671d","\u666f\u5e73\u671d","\u4e49\u7199\u5929\u671d","\u5929\u9274\u56fd","\u6c38\u5b9a\u56fd"],this.t.templates=["part1","addition_end"],this.clone("Tian_kingdom","tianming_kingdom"),this.clone("Ming_kingdom","tianming_kingdom");var o=new c;o.id="orc_kingdom",o.onlyByTemplate=!1,o.fixedNameChance=.001,this.add(o),this.t.addition_endList=["\u738b\u671d","\u5e1d\u56fd","\u6c57\u56fd","\u65cf","\u90e8\u843d","\u8054\u76df","\u5996\u671d","\u5996\u5ead","\u5996\u65cf","\u7075\u65cf","\u517d\u65cf","\u4e4b\u5730","\u7981\u5730","\u7687\u65cf","\u4ed9\u65cf","\u738b\u65cf","\u9057\u65cf","\u53e4\u65cf","\u5723\u65cf","\u5723\u5730","\u7586\u57df","\u7981\u57df"],this.t.partsList=["\u4e5d\u9ece","\u86a9\u5c24","\u663c\u864e","\u713a\u7ffc","\u5929\u72d7","\u6012\u8c79","\u5914\u725b","\u7384\u9e1f","\u5e7d\u72f1","\u8c94\u8c85","\u5927\u98df","\u70db\u9f99","\u5317\u83bd","\u5de8\u8c61","\u5929\u72fc","\u52fe\u9648","\u817e\u86c7","\u91d1\u72bc","\u5c11\u660a","\u9752\u72ee","\u51f6\u517d","\u4ea2\u9f99","\u6f5c\u86df","\u5929\u9cb2","\u775a\u7726","\u9f99\u817e","\u5929\u517d","\u8840\u7259","\u91d1\u4e4c","\u5927\u86ee","\u72ac\u7ed2","\u5357\u51a5","\u7a77\u5947","\u91d1\u6672","\u9955\u992e","\u68bc\u674c","\u5df3\u86c7","\u767d\u718a","\u767d\u6cfd","\u5317\u7f8c","\u53e4\u9f99","\u5929\u51e4","\u795e\u51e4","\u9b3c\u51e4","\u51e4\u51f0","\u6731\u96c0","\u8d64\u96c0","\u5996\u9f99","\u767d\u864e","\u5929\u72d0","\u5929\u517d","\u5de8\u7075","\u5c71\u6d77","\u795e\u9f99","\u5929\u9f99","\u9b54\u9f99","\u9f99\u864e","\u9f99\u9b42","\u9f99\u51e4","\u91d1\u9f99","\u9752\u9f99","\u4e07\u5996","\u5929\u5996","\u90aa\u864e","\u795e\u864e","\u767d\u864e","\u73b2\u73d1","\u8d64\u96c0","\u7384\u6b66","\u9b3c\u72d0","\u5929\u72d0","\u5723\u9f99","\u87d2\u96c0","\u708e\u9f99","\u51b0\u661f","\u9b54\u9f99","\u795e\u9f99","\u5996\u9f99","\u9e92\u9e9f","\u5996\u5143"],this.t.fixedList=["\u542f\u6e90\u5929\u671d","\u5927\u5510\u5e1d\u56fd","\u5927\u660e\u5e1d\u56fd","\u5927\u79e6\u5e1d\u56fd","\u534e\u590f\u5929\u671d","\u8499\u53e4\u5e1d\u56fd","\u6f20\u5317\u6c57\u56fd","\u79bb\u9633\u738b\u671d","\u5929\u5a01\u5e1d\u56fd","\u5b54\u5b50\u6587\u56fd","\u6d1b\u9633\u76db\u4e16","\u5929\u7532\u56fd","\u516c\u5b59\u6c57\u56fd","\u8f69\u8f95\u5e1d\u56fd","\u957f\u5b59\u516c\u56fd","\u6155\u5bb9\u6c57\u56fd","\u9c9c\u4e8e\u6c57\u56fd","\u5b87\u6587\u4e16\u5bb6","\u767e\u91cc\u4e16\u5bb6","\u5317\u51c9\u5e1d\u56fd","\u592a\u5e73\u76db\u4e16","\u9707\u79bb\u53e4\u56fd","\u5b50\u8f69\u6c57\u56fd","\u7b56\u6b63\u516c\u56fd","\u6d2a\u6b66\u5e1d\u56fd","\u5c71\u6d77\u56fd","\u89c2\u6d77\u56fd","\u5938\u7236\u53e4\u56fd","\u70fd\u9f0e\u56fd","\u6b66\u5e9a\u56fd","\u5929\u5357\u56fd","\u5357\u9633\u56fd","\u5e73\u5b89\u53e4\u65cf","\u5c71\u4e1c\u56fd","\u957f\u57ce\u519b","\u5efa\u5143\u5e1d\u56fd","\u9ec4\u9f99\u5e1d\u56fd","\u5251\u662d\u56fd","\u9e3f\u5609\u56fd","\u5efa\u6b66\u56fd","\u5609\u5e73\u671d","\u666f\u5e73\u671d","\u4e49\u7199\u5929\u671d","\u5929\u9274\u56fd","\u6c38\u5b9a\u56fd"],this.t.templates=["part1","addition_end"],this.clone("Yao_kingdom","orc_kingdom");var a=new c;a.id="dwarf_kingdom",a.onlyByTemplate=!1,a.fixedNameChance=.001,this.add(a),this.t.addition_endList=["\u8054\u90a6","\u516c\u56fd","\u5e1d\u56fd","\u9886\u57df","\u90a6\u56fd","\u8054\u76df","\u56fd","\u7687\u5ead","\u7384\u57df","\u795e\u5e99","\u5723\u9662","\u4ed9\u5bab","\u5723\u65cf","\u795e\u65cf","\u5723\u5730","\u795e\u5b97","\u7075\u65cf","\u5251\u5b97","\u5251\u57df","\u706b\u57df","\u5200\u5b97","\u5200\u57df","\u6587\u57df","\u64ce\u57df","\u5929\u57df","\u5723\u5b97","\u5723\u57df","\u5bab","\u6b66\u671d","\u795e\u6bbf","\u4f5b\u56fd","\u7075\u57df","\u67aa\u5b97","\u7075\u5b97","\u708e\u5b97","\u5e1d\u65cf","\u5723\u65cf","\u795e\u65cf","\u5927\u9646","\u5927\u9646","\u4e4b\u5730","\u4ed9\u65cf","\u5e1d\u65cf","\u7687\u65cf","\u6e90\u65cf","\u5929\u65cf","\u5668\u5b97","\u6e90\u5b97"],this.t.partsList=["\u5929\u5de5","\u795e\u953b","\u767e\u70bc","\u6218\u9524","\u5723\u6b66","\u6d74\u706b","\u795e\u6b66","\u7120\u7130","\u706b\u795e","\u795e\u5175","\u662d\u70c8","\u706b\u51e4","\u70c8\u9633","\u706b\u5de5","\u795d\u878d","\u8d64\u7130","\u70bc\u5668","\u7075\u6b66","\u5343\u7145","\u5320\u4eba","\u795e\u5320","\u5929\u706b","\u5de8\u5320","\u771f\u708e","\u795e\u673a","\u7130\u7089","\u5723\u5668","\u708e\u5e1d","\u708e\u540d","\u771f\u706b","\u6b66\u7131"],this.t.fixedList=["\u542f\u6e90\u5929\u671d","\u5927\u5510\u5e1d\u56fd","\u5927\u660e\u5e1d\u56fd","\u5927\u79e6\u5e1d\u56fd","\u534e\u590f\u5929\u671d","\u8499\u53e4\u5e1d\u56fd","\u6f20\u5317\u6c57\u56fd","\u79bb\u9633\u738b\u671d","\u5929\u5a01\u5e1d\u56fd","\u5b54\u5b50\u6587\u56fd","\u6d1b\u9633\u76db\u4e16","\u5929\u7532\u56fd","\u516c\u5b59\u6c57\u56fd","\u8f69\u8f95\u5e1d\u56fd","\u957f\u5b59\u516c\u56fd","\u6155\u5bb9\u6c57\u56fd","\u9c9c\u4e8e\u6c57\u56fd","\u5b87\u6587\u4e16\u5bb6","\u767e\u91cc\u4e16\u5bb6","\u5317\u51c9\u5e1d\u56fd","\u592a\u5e73\u76db\u4e16","\u9707\u79bb\u53e4\u56fd","\u5b50\u8f69\u6c57\u56fd","\u7b56\u6b63\u516c\u56fd","\u6d2a\u6b66\u5e1d\u56fd","\u5c71\u6d77\u56fd","\u89c2\u6d77\u56fd","\u5938\u7236\u53e4\u56fd","\u70fd\u9f0e\u56fd","\u6b66\u5e9a\u56fd","\u5929\u5357\u56fd","\u5357\u9633\u56fd","\u5e73\u5b89\u53e4\u65cf","\u5c71\u4e1c\u56fd","\u957f\u57ce\u519b","\u5efa\u5143\u5e1d\u56fd","\u9ec4\u9f99\u5e1d\u56fd","\u5251\u662d\u56fd","\u9e3f\u5609\u56fd","\u5efa\u6b66\u56fd","\u5609\u5e73\u671d","\u666f\u5e73\u671d","\u4e49\u7199\u5929\u671d","\u5929\u9274\u56fd","\u6c38\u5b9a\u56fd"],this.t.templates=["part1","addition_end"];var n=new c;n.id="elf_kingdom",n.onlyByTemplate=!1,n.fixedNameChance=.001,this.add(n),this.t.addition_endList=["\u8054\u90a6","\u5e1d\u56fd","\u9886\u57df","\u8054\u76df","\u5929\u5ead","\u7687\u5ead","\u795e\u6bbf","\u4ed9\u57df","\u4ed9\u56fd","\u7384\u57df","\u795e\u5e99","\u5723\u9662","\u5b87\u5b99","\u9053\u89c2","\u4ed9\u5bab","\u5723\u65cf","\u795e\u65cf","\u5723\u5730","\u795e\u5b97","\u7075\u65cf","\u5251\u5b97","\u5251\u57df","\u9053\u5b97","\u706b\u57df","\u5200\u5b97","\u5200\u57df","\u6587\u57df","\u64ce\u57df","\u5929\u57df","\u5723\u5b97","\u5723\u57df","\u5bab","\u5929\u671d","\u9b54\u65cf","\u795e\u6bbf","\u795e\u56fd","\u4f5b\u56fd","\u7075\u57df","\u67aa\u5b97","\u7075\u5b97","\u708e\u5b97","\u5e1d\u65cf","\u5723\u65cf","\u795e\u65cf","\u5927\u9646","\u5927\u9646","\u4e4b\u5730","\u4ed9\u65cf","\u5e1d\u65cf","\u7687\u65cf","\u6e90\u65cf","\u5929\u65cf","\u5929\u5ead","\u6e90\u5b97"],this.t.partsList=["\u708e\u7075","\u6b66\u7075","\u51a5\u52a8","\u51b0\u7075","\u5e7d\u6697","\u7075\u795e","\u5723\u6c34","\u7075\u51b0","\u96f7\u5deb","\u7075\u6728","\u6728\u5deb","\u706b\u5deb","\u7075\u51a5","\u7075\u52a8","\u51ac\u706d","\u5149\u660e","\u96f7\u7075","\u7d2b\u7075","\u91d1\u7075","\u81ea\u7136","\u5929\u665f","\u706b\u7075","\u51a5\u67f3","\u4f59\u70ec","\u7fbd\u5929","\u751f\u7075","\u9f99\u795e","\u96ea\u5deb","\u7075\u5deb","\u5723\u4f7f","\u73b2\u73d1","\u5171\u5de5","\u51b0\u9f99","\u5fa1\u98ce","\u8d64\u7fbd","\u9752\u7fbd","\u571f\u7075","\u7075\u6cb3","\u6708\u795e","\u5929\u662d","\u5929\u7075","\u66e6\u65e5","\u4e5d\u9633","\u4e5d\u9634","\u4e5d\u52ab","\u4e5d\u5929","\u96f7\u9706","\u4e91\u9704","\u6d69\u701a","\u9f99\u864e","\u8840\u864e","\u5929\u706b","\u90aa\u706b","\u661f\u6cb3","\u98d8\u6e3a","\u65f6\u7a7a","\u65f6\u5149","\u708e","\u4e7e\u5764","\u6613","\u6c34","\u6b66","\u5929","\u5317","\u91d1","\u7389","\u6728","\u6b63\u7384","\u571f","\u706b","\u5730","\u795e","\u6e90","\u5143","\u6e05","\u6797","\u8349","\u5317","\u65e0\u6781","\u65e0\u60c5","\u4e71","\u53e4","\u7434","\u68cb","\u4e66","\u753b","\u6b63","\u6d2a","\u5c71","\u6d77","\u7687","\u9f99","\u539f","\u5c38","\u8840","\u90aa","\u738b","\u5996","\u7075","\u6c38","\u661f","\u5149","\u6697","\u592a\u6781","\u75d5","\u5b9d","\u7d2b","\u6781","\u8000","\u6cb3","\u90aa","\u5aba","\u70fd","\u6b66\u5e9a","\u964c\u5468","\u795e\u5a01","\u5c1a\u4e66","\u6625\u79cb","\u4e5d\u9f0e","\u574e\u6c34","\u795e\u519c","\u71ce\u91ce","\u9e3f\u8499","\u5929\u547d","\u4e09\u7687","\u5947\u95e8","\u5929\u9053","\u8f69\u8f95","\u4e1c\u7687","\u4f0f\u7fb2","\u960e\u7f57","\u4e0a\u6e05","\u5973\u5a32","\u5947\u7ecf","\u795e\u519c","\u4e94\u5e1d","\u795e\u5949","\u4ec1\u5584","\u51a5\u5492","\u5deb\u7956","\u5c79\u6602","\u5c71\u6d77","\u4e07\u6c0f","\u795e\u796d","\u5929\u7075","\u706b\u7130","\u5927\u6c34","\u6e90\u6728","\u91d1\u547d","\u571f\u7075","\u4f0a\u59cb","\u661f\u5bf0","\u661f\u5b87","\u5929\u51b0","\u98ce\u96f7","\u59cb\u5149","\u661f\u68cb\u76d8","\u7cbe\u7075","\u4e94\u884c","\u7075\u589f","\u957f\u751f","\u592a\u9633","\u6708\u4eae","\u9634\u9633","\u5927\u6697","\u5e73\u7b49","\u51a5\u672f","\u5143\u7d20","\u65f6\u5149","\u6613\u7a7a","\u795e\u953b","\u795e\u6b66","\u4f0a\u547d","\u661f\u953b","\u661f\u5b87","\u7cb9\u70bc","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u5929\u517d","\u5de8\u7075","\u5deb\u65cf","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5deb\u7956","\u5927\u7f8c","\u86ee\u5175","\u5f81\u4f10","\u547d\u6218","\u8840\u72f1","\u8d64\u5e1d","\u4e0d\u6b7b","\u8f6e\u56de","\u5730\u72f1","\u5929\u707e","\u4e07\u5996","\u5815\u843d","\u592a\u53e4","\u795e\u8bdd","\u4e5d\u5dde","\u534e\u590f","\u5929\u6cc9","\u5357\u9ed8","\u91d1\u971e","\u7075\u865a","\u7389\u9f0e","\u592a\u4e59","\u592a\u4e00","\u70df\u971e","\u7d2b\u9633","\u5915\u6708","\u900d\u9065","\u62dc\u6708","\u5408\u6b22","\u4e07\u52ab","\u6052\u5b87","\u5e7b\u706d","\u5e7f\u5bd2","\u5c01\u9b54","\u7d2b\u8587","\u4e5d\u9704","\u865a\u65e0","\u7384\u6e90","\u592a\u7384","\u592a\u865a","\u7389\u865a","\u53e4\u534e","\u6f20\u5317","\u6b63\u5317","\u5e73\u6d32","\u8f69\u5b87","\u660a\u5929","\u5929\u7fbd","\u609f\u7a7a","\u59d1\u82cf","\u6708\u795e","\u77f3\u5ddd","\u5e73\u6c5f","\u6c38\u5e74","\u8f6e\u56de","\u65e0\u6781","\u957f\u751f","\u9752\u534e","\u7d2b\u8587","\u52fe\u9648","\u5929\u542f","\u4e91\u70df","\u4e91\u5ca9","\u5c01","\u6708","\u9b3c","\u9b3c\u9b45","\u7434","\u97f3","\u70bc\u5668","\u795e\u5668","\u953b\u5668","\u4e07\u836f","\u70bc\u4e39","\u98de\u4e91","\u58a8\u9690","\u4e5d\u5929","\u4fee\u7f57","\u540e\u571f","\u592a\u521d","\u6052\u53e4","\u672b\u5f71","\u5929\u9704","\u9f99\u9706","\u5fd8\u60c5","\u5929\u5e08","\u900d\u9065","\u4e5d\u52ab","\u5929\u8c34","\u5c01\u5370","\u73b2\u73d1","\u9b3c\u8c37","\u5deb\u5c71","\u5251","\u5929\u5251","\u9b54\u5251","\u4e07\u5251","\u4e07\u52ab","\u5200","\u9b54\u5200","\u5929\u5200","\u67aa","\u5996","\u7389\u6e05","\u5f00\u5929","\u4e1c\u90e8","\u4e0d\u706d","\u897f\u6f20","\u5317\u6781","\u5357\u86ee","\u592a\u4e0a","\u592a\u7384","\u9547\u9b54","\u592a\u521d","\u8fdc\u53e4","\u51a5\u53e4","\u592a\u5e73","\u59cb\u6e90","\u6d2a\u8352","\u592a\u53e4","\u4e0a\u53e4","\u4e2d\u90e8","\u5916\u57df","\u4e1c\u7687","\u661f\u8fb0","\u90aa\u5984","\u4e07\u53e4","\u566c\u5143","\u9b42","\u5723\u5251","\u5929\u9b54","\u9738\u67aa","\u7075\u5251","\u4e7e\u5143","\u9b3c\u5203","\u5929\u5f13","\u7384\u673a","\u79bb\u706b","\u795e\u65a7","\u9f99\u6e90","\u9f99\u5ca9","\u9f99\u6e0a","\u771f\u6b66","\u83e9\u63d0","\u7389\u6e05","\u4e94\u8574","\u7384\u6b66","\u56da\u9f99","\u81ea\u5728","\u6781\u610f","\u65e0\u57a2","\u7075\u865a","\u7389\u865a","\u5343\u7fbd","\u9752\u7fbd","\u65e0\u6daf","\u8d64\u9633","\u7ea2\u5c18","\u4e09\u5c38","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u5927\u98df","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u8680\u7cbe","\u4e03\u661f","\u897f\u82cd","\u4e1c\u8d6b","\u9f99\u627f","\u5929\u82e5","\u5929\u6148","\u7834\u822a","\u897f\u6b66","\u5929\u627f","\u4f5b\u6b66","\u6b66\u5929","\u6d77\u7edc","\u5317\u9b54","\u96bc\u7edc","\u4e5d\u661f","\u51e4\u5251","\u5723","\u711a\u5929","\u51f6\u51a5","\u5929\u6781","\u70bc\u5668","\u70bc\u4e39","\u7ec3\u6c14","\u8679\u5149","\u9752\u5149","\u906e\u90a3","\u9006\u5929","\u7409\u7130","\u60b2\u95ee","\u5927\u6613","\u51b0\u8695","\u5c71\u6d77","\u5929\u517d","\u5de8\u7075","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5927\u7f8c","\u86ee\u5175","\u68ee\u7f57","\u767d\u8679","\u5bf0\u5b87","\u609f\u9053","\u795e\u76d7","\u5929\u715e","\u53e4\u5251","\u5996\u5200"],this.t.fixedList=["\u542f\u6e90\u5929\u671d","\u5927\u5510\u5e1d\u56fd","\u5927\u660e\u5e1d\u56fd","\u5927\u79e6\u5e1d\u56fd","\u534e\u590f\u5929\u671d","\u8499\u53e4\u5e1d\u56fd","\u6f20\u5317\u6c57\u56fd","\u79bb\u9633\u738b\u671d","\u5929\u5a01\u5e1d\u56fd","\u5b54\u5b50\u6587\u56fd","\u6d1b\u9633\u76db\u4e16","\u5929\u7532\u56fd","\u516c\u5b59\u6c57\u56fd","\u8f69\u8f95\u5e1d\u56fd","\u957f\u5b59\u516c\u56fd","\u6155\u5bb9\u6c57\u56fd","\u9c9c\u4e8e\u6c57\u56fd","\u5b87\u6587\u4e16\u5bb6","\u767e\u91cc\u4e16\u5bb6","\u5317\u51c9\u5e1d\u56fd","\u592a\u5e73\u76db\u4e16","\u9707\u79bb\u53e4\u56fd","\u5b50\u8f69\u6c57\u56fd","\u7b56\u6b63\u516c\u56fd","\u6d2a\u6b66\u5e1d\u56fd","\u5c71\u6d77\u56fd","\u89c2\u6d77\u56fd","\u5938\u7236\u53e4\u56fd","\u70fd\u9f0e\u56fd","\u6b66\u5e9a\u56fd","\u5929\u5357\u56fd","\u5357\u9633\u56fd","\u5e73\u5b89\u53e4\u65cf","\u5c71\u4e1c\u56fd","\u957f\u57ce\u519b","\u5efa\u5143\u5e1d\u56fd","\u9ec4\u9f99\u5e1d\u56fd","\u5251\u662d\u56fd","\u9e3f\u5609\u56fd","\u5efa\u6b66\u56fd","\u5609\u5e73\u671d","\u666f\u5e73\u671d","\u4e49\u7199\u5929\u671d","\u5929\u9274\u56fd","\u6c38\u5b9a\u56fd"],this.t.templates=["part1","addition_end"];var r=new c;r.id="chengshi_name",this.add(r),this.t.addition_startList=["\u5929\u5357","\u5357\u9633","\u5e73\u5b89","\u5c71\u4e1c","\u957f\u57ce","\u5efa\u5143","\u9ec4\u9f99","\u5251\u662d","\u9e3f\u5609","\u5efa\u6b66","\u5609\u5e73","\u666f\u5e73","\u4e49\u7199","\u5929\u9274","\u6c38\u5b9a","\u5929\u5eb7","\u667a\u5fb7","\u5d07\u660e","\u592a\u6781","\u5929\u4f51","\u5b9d\u5143","\u5e7f\u660e","\u6c38\u9686","\u5f00\u8000","\u6cb3\u6e05","\u7687\u59cb","\u5764\u4ea5","\u9879\u71d5","\u5468\u6613","\u4e7e\u964c","\u6cb3\u5357","\u6b66\u662d","\u5929\u95ee","\u8fbd\u5b81","\u5317\u6d77","\u5929\u7737","\u7389\u95e8","\u7532\u5b50","\u6b63\u7384","\u7532\u620c","\u957f\u5b89","\u70b3\u58a8","\u795e\u6b66","\u5e84\u5b50","\u5251\u5357","\u5929\u5a01","\u5b54\u5b50","\u6d1b\u9633","\u5929\u7532","\u5317\u51c9","\u592a\u5e73","\u9707\u79bb","\u5b50\u8f69","\u7b56\u6b63","\u6d2a\u6b66","\u5c71\u6d77","\u89c2\u6d77","\u5938\u7236","\u70fd\u9f0e","\u6b66\u5e9a","\u964c\u5468","\u795e\u5a01","\u5c1a\u4e66","\u6625\u79cb","\u4e5d\u9f0e","\u574e\u6c34","\u592a\u5e73","\u4e5d\u5dde","\u534e\u590f","\u5929\u6cc9","\u5357\u9ed8","\u6f20\u5317","\u6b63\u5317","\u66f9\u53bf","\u5e73\u6d32","\u6c5f\u5357","\u62d2\u5317","\u8f69\u5b87","\u660a\u5929","\u5929\u7fbd","\u609f\u7a7a","\u6708\u795e","\u77f3\u5ddd","\u5e73\u6c5f","\u6c38\u5e74","\u5929\u5b9d","\u957f\u537f","\u51e4\u5e74","\u9f99\u8c61","\u4ed9\u829d","\u6e05","\u6881","\u5f90","\u8bb8","\u674e","\u8c2d","\u6b66","\u5b63","\u695a","\u4e01","\u5468","\u9e23","\u836f","\u8427","\u9f0e","\u7fbd","\u8f69","\u9676","\u5b97","\u865e","\u4e7e","\u9f50","\u66f9","\u79e6","\u82cf","\u660e","\u6cb3","\u536b","\u662d","\u5929","\u5b54","\u9633","\u6708","\u5546","\u970d","\u9b4f","\u5434","\u8700","\u96ea","\u590f","\u71d5","\u5510","\u6c49","\u5357","\u5251","\u660c","\u5218","\u9648","\u738b","\u94ed","\u6731","\u4f55","\u5143","\u695a","\u8881","\u66e6\u65e5","\u4e5d\u9633","\u4e5d\u9634","\u4e5d\u52ab","\u4e5d\u5929","\u96f7\u9706","\u4e91\u9704","\u6d69\u701a","\u9f99\u864e","\u8840\u864e","\u5929\u706b","\u90aa\u706b","\u90aa\u864e","\u795e\u864e","\u767d\u864e","\u73b2\u73d1","\u6731\u96c0","\u51e4\u51f0","\u8d64\u96c0","\u7384\u6b66","\u9b3c\u72d0","\u5929\u72d0","\u5723\u9f99","\u87d2\u96c0","\u9752\u9f99","\u708e\u9f99","\u51b0\u661f","\u9b54\u9f99","\u795e\u9f99","\u5996\u9f99","\u9e92\u9e9f","\u5996\u5143","\u661f\u6cb3","\u98d8\u6e3a","\u65f6\u7a7a","\u65f6\u5149","\u708e","\u4e7e\u5764","\u6613","\u6c34","\u6b66","\u5929","\u5317","\u91d1","\u7389","\u6728","\u6b63\u7384","\u571f","\u706b","\u5730","\u795e","\u6e90","\u5143","\u6e05","\u6797","\u8349","\u5317","\u65e0\u6781","\u65e0\u60c5","\u4e71","\u53e4","\u7434","\u68cb","\u4e66","\u753b","\u6b63","\u6d2a","\u5c71","\u6d77","\u7687","\u9f99","\u539f","\u5c38","\u8840","\u90aa","\u738b","\u5996","\u7075","\u6c38","\u661f","\u5149","\u6697","\u592a\u6781","\u75d5","\u5b9d","\u7d2b","\u6781","\u8000","\u6cb3","\u90aa","\u5aba","\u70fd","\u6b66\u5e9a","\u964c\u5468","\u795e\u5a01","\u5c1a\u4e66","\u6625\u79cb","\u4e5d\u9f0e","\u574e\u6c34","\u795e\u519c","\u71ce\u91ce","\u9e3f\u8499","\u5929\u547d","\u4e09\u7687","\u5947\u95e8","\u5929\u9053","\u8f69\u8f95","\u4e1c\u7687","\u4f0f\u7fb2","\u960e\u7f57","\u4e0a\u6e05","\u5973\u5a32","\u5947\u7ecf","\u795e\u519c","\u4e94\u5e1d","\u795e\u5949","\u4ec1\u5584","\u51a5\u5492","\u5deb\u7956","\u5c79\u6602","\u5c71\u6d77","\u4e07\u6c0f","\u795e\u796d","\u5929\u7075","\u706b\u7130","\u5927\u6c34","\u6e90\u6728","\u91d1\u547d","\u571f\u7075","\u4f0a\u59cb","\u661f\u5bf0","\u661f\u5b87","\u5929\u51b0","\u98ce\u96f7","\u59cb\u5149","\u661f\u68cb\u76d8","\u7cbe\u7075","\u4e94\u884c","\u7075\u589f","\u957f\u751f","\u592a\u9633","\u6708\u4eae","\u9634\u9633","\u5927\u6697","\u5e73\u7b49","\u51a5\u672f","\u5143\u7d20","\u65f6\u5149","\u6613\u7a7a","\u795e\u953b","\u795e\u6b66","\u4f0a\u547d","\u661f\u953b","\u661f\u5b87","\u7cb9\u70bc","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u5929\u517d","\u5de8\u7075","\u5deb\u65cf","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5deb\u7956","\u5927\u7f8c","\u86ee\u5175","\u5f81\u4f10","\u547d\u6218","\u8840\u72f1","\u8d64\u5e1d","\u4e0d\u6b7b","\u8f6e\u56de","\u5730\u72f1","\u5929\u707e","\u4e07\u5996","\u5815\u843d","\u592a\u53e4","\u795e\u8bdd","\u4e5d\u5dde","\u534e\u590f","\u5929\u6cc9","\u5357\u9ed8","\u91d1\u971e","\u7075\u865a","\u7389\u9f0e","\u592a\u4e59","\u592a\u4e00","\u70df\u971e","\u7d2b\u9633","\u5915\u6708","\u900d\u9065","\u62dc\u6708","\u5408\u6b22","\u4e07\u52ab","\u6052\u5b87","\u5e7b\u706d","\u5e7f\u5bd2","\u5c01\u9b54","\u7d2b\u8587","\u4e5d\u9704","\u865a\u65e0","\u7384\u6e90","\u592a\u7384","\u592a\u865a","\u7389\u865a","\u53e4\u534e","\u6f20\u5317","\u6b63\u5317","\u5e73\u6d32","\u8f69\u5b87","\u660a\u5929","\u5929\u7fbd","\u609f\u7a7a","\u59d1\u82cf","\u6708\u795e","\u77f3\u5ddd","\u5e73\u6c5f","\u6c38\u5e74","\u8f6e\u56de","\u65e0\u6781","\u957f\u751f","\u9752\u534e","\u7d2b\u8587","\u52fe\u9648","\u5929\u542f","\u4e91\u70df","\u4e91\u5ca9","\u5c01","\u6708","\u9b3c","\u9b3c\u9b45","\u7434","\u97f3","\u70bc\u5668","\u795e\u5668","\u953b\u5668","\u4e07\u836f","\u70bc\u4e39","\u98de\u4e91","\u58a8\u9690","\u4e5d\u5929","\u4fee\u7f57","\u540e\u571f","\u592a\u521d","\u6052\u53e4","\u672b\u5f71","\u5929\u9704","\u9f99\u9706","\u5fd8\u60c5","\u5929\u5e08","\u900d\u9065","\u4e5d\u52ab","\u5929\u8c34","\u5c01\u5370","\u73b2\u73d1","\u9b3c\u8c37","\u5deb\u5c71","\u5251","\u5929\u5251","\u9b54\u5251","\u4e07\u5251","\u4e07\u52ab","\u5200","\u9b54\u5200","\u5929\u5200","\u67aa","\u5996","\u7389\u6e05","\u5f00\u5929","\u4e1c\u90e8","\u4e0d\u706d","\u897f\u6f20","\u5317\u6781","\u5357\u86ee","\u592a\u4e0a","\u592a\u7384","\u9547\u9b54","\u592a\u521d","\u8fdc\u53e4","\u51a5\u53e4","\u592a\u5e73","\u59cb\u6e90","\u6d2a\u8352","\u592a\u53e4","\u4e0a\u53e4","\u4e2d\u90e8","\u5916\u57df","\u4e1c\u7687","\u661f\u8fb0","\u90aa\u5984","\u4e07\u53e4","\u566c\u5143","\u9b42","\u5723\u5251","\u5929\u9b54","\u9738\u67aa","\u7075\u5251","\u4e7e\u5143","\u9b3c\u5203","\u5929\u5f13","\u7384\u673a","\u79bb\u706b","\u795e\u65a7","\u9f99\u6e90","\u9f99\u5ca9","\u9f99\u6e0a","\u771f\u6b66","\u83e9\u63d0","\u7389\u6e05","\u4e94\u8574","\u7384\u6b66","\u56da\u9f99","\u81ea\u5728","\u6781\u610f","\u65e0\u57a2","\u7075\u865a","\u7389\u865a","\u5343\u7fbd","\u9752\u7fbd","\u65e0\u6daf","\u8d64\u9633","\u7ea2\u5c18","\u4e09\u5c38","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u6218\u795e","\u953b\u5929","\u711a\u706d","\u706b\u795e","\u7130\u97f5","\u5927\u86ee","\u5927\u98df","\u51f6\u795e","\u795e\u817e","\u56fe\u817e","\u8680\u7cbe","\u4e03\u661f","\u897f\u82cd","\u4e1c\u8d6b","\u9f99\u627f","\u5929\u82e5","\u5929\u6148","\u7834\u822a","\u897f\u6b66","\u5929\u627f","\u4f5b\u6b66","\u6b66\u5929","\u6d77\u7edc","\u5317\u9b54","\u96bc\u7edc","\u4e5d\u661f","\u51e4\u5251","\u5723","\u711a\u5929","\u51f6\u51a5","\u5929\u6781","\u70bc\u5668","\u70bc\u4e39","\u7ec3\u6c14","\u8679\u5149","\u9752\u5149","\u906e\u90a3","\u9006\u5929","\u7409\u7130","\u60b2\u95ee","\u5927\u6613","\u51b0\u8695","\u5c71\u6d77","\u5929\u517d","\u5de8\u7075","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5927\u7f8c","\u86ee\u5175","\u68ee\u7f57","\u767d\u8679","\u5bf0\u5b87","\u609f\u9053","\u795e\u76d7","\u5929\u715e","\u53e4\u5251","\u5996\u5200"],this.clone("human_city","chengshi_name"),this.t.addition_endList=["\u57ce","\u57df","\u5dde","\u795e\u5dde","\u57ce","\u9547","\u7981\u5730","\u5dde","\u4e4b\u5730"],this.t.fixedList=["\u661f\u68cb\u76d8\u5dde","\u4eba\u95f4\u5e9c"],this.t.templates=["addition_start","addition_end"],this.clone("Tian_city","human_city"),this.clone("Ming_city","human_city");var s=new c;s.id="aishoujing_name",this.add(s),this.t.addition_startList=["\u5929\u5de5","\u795e\u953b","\u767e\u70bc","\u6218\u9524","\u5723\u6b66","\u6d74\u706b","\u795e\u6b66","\u7120\u7130","\u706b\u795e","\u795e\u5175","\u662d\u70c8","\u706b\u51e4","\u70c8\u9633","\u706b\u5de5","\u795d\u878d","\u8d64\u7130","\u70bc\u5668","\u7075\u6b66","\u5343\u7145","\u5320\u4eba","\u795e\u5320","\u5929\u706b","\u5de8\u5320","\u771f\u708e","\u795e\u673a","\u7130\u7089","\u5723\u5668","\u708e\u5e1d","\u708e\u540d","\u771f\u706b","\u6b66\u7131","\u708e\u7075","\u6b66\u7075","\u51a5\u52a8","\u51b0\u7075","\u5e7d\u6697","\u7075\u795e","\u5723\u6c34","\u7075\u51b0","\u96f7\u5deb","\u7075\u6728","\u6728\u5deb","\u706b\u5deb","\u7075\u51a5","\u7075\u52a8","\u51ac\u706d","\u5149\u660e","\u96f7\u7075","\u7d2b\u7075","\u91d1\u7075","\u81ea\u7136","\u5929\u665f","\u706b\u7075","\u51a5\u67f3","\u4f59\u70ec","\u7fbd\u5929","\u751f\u7075","\u9f99\u795e","\u96ea\u5deb","\u7075\u5deb","\u5723\u4f7f","\u73b2\u73d1","\u5171\u5de5","\u51b0\u9f99","\u5fa1\u98ce","\u8d64\u7fbd","\u9752\u7fbd","\u571f\u7075","\u7075\u6cb3","\u6708\u795e","\u5929\u662d","\u5929\u7075","\u4e5d\u9ece","\u86a9\u5c24","\u663c\u864e","\u713a\u7ffc","\u5929\u72d7","\u6012\u8c79","\u5914\u725b","\u7384\u9e1f","\u5e7d\u72f1","\u8c94\u8c85","\u9752\u72ee","\u5927\u98df","\u70db\u9f99","\u5317\u83bd","\u5de8\u8c61","\u5929\u72fc","\u52fe\u9648","\u817e\u86c7","\u91d1\u72bc","\u5c11\u660a","\u51f6\u517d","\u4ea2\u9f99","\u6f5c\u86df","\u5929\u9cb2","\u775a\u7726","\u9f99\u817e","\u5929\u517d","\u8840\u7259","\u91d1\u4e4c","\u5927\u86ee","\u5317\u7f8c","\u72ac\u7ed2","\u5357\u51a5","\u7a77\u5947","\u91d1\u6672","\u9955\u992e","\u68bc\u674c","\u5df3\u86c7","\u767d\u718a","\u767d\u6cfd","\u90aa\u864e","\u795e\u864e","\u767d\u864e","\u73b2\u73d1","\u6731\u96c0","\u51e4\u51f0","\u8d64\u96c0","\u7384\u6b66","\u9b3c\u72d0","\u5929\u72d0","\u5723\u9f99","\u87d2\u96c0","\u9752\u9f99","\u708e\u9f99","\u51b0\u661f","\u9b54\u9f99","\u795e\u9f99","\u5996\u9f99","\u9e92\u9e9f","\u5996\u5143","\u795e\u9f99","\u5929\u9f99","\u9b54\u9f99","\u9f99\u864e","\u9f99\u9b42","\u9f99\u51e4","\u91d1\u9f99","\u9752\u9f99","\u4e07\u5996","\u5929\u5996"],this.t.addition_endList=["\u57ce","\u57ce\u90a6","\u4e4b\u5730","\u57df","\u5dde","\u57ce\u9547","\u57df"],this.t.templates=["addition_start","addition_end"],this.clone("orc_city","aishoujing_name"),this.clone("elf_city","orc_city"),this.clone("dwarf_city","orc_city");var l=new c;l.id="wenhua_name",this.add(l),this.t.addition_startList=["\u592a\u6b66","\u592a\u793c","\u592a\u521d","\u5b54\u5723","\u7384\u796d","\u661f\u547d","\u5929\u535c","\u4eba\u5723","\u542f\u660e","\u795e\u8ff9","\u4e5d\u5b97","\u71ce\u91ce","\u9e3f\u8499","\u5929\u547d","\u4e09\u7687","\u708e\u9ec4","\u4e94\u5e1d","\u795e\u5949","\u5929\u5ead","\u4ec1\u5584","\u51a5\u5492","\u5deb\u7956","\u5c71\u6d77","\u4e07\u6c0f","\u5929\u6cb3","\u71ce\u91ce","\u5468\u6613","\u5947\u95e8","\u5947\u7ecf","\u795e\u519c","\u7075\u5dde","\u7075\u6708","\u4e5d\u7075","\u4e07\u7269","\u81ea\u7136","\u795e\u796d","\u5929\u7075","\u795e\u7136","\u5929\u660e","\u706b\u7130","\u5927\u6c34","\u6e90\u6728","\u91d1\u547d","\u571f\u7075","\u4f0a\u59cb","\u661f\u5bf0","\u661f\u5b87","\u5929\u51b0","\u98ce\u96f7","\u59cb\u5149","\u661f\u68cb\u76d8","\u5927\u6697","\u5929\u57df","\u5e73\u7b49","\u51a5\u672f","\u59cb\u7956","\u5143\u7d20","\u65f6\u5149","\u6613\u7a7a","\u59cb\u7075","\u7075\u6b66","\u5723\u6b66","\u71e7\u4eba","\u9c81\u73ed","\u7075\u5c06","\u795e\u953b","\u5929\u9547","\u9547\u57df","\u5929\u706b","\u5723\u706b","\u70bc\u795e","\u91d1\u7075","\u795e\u6b66","\u661f\u953b","\u661f\u5b87","\u7cb9\u70bc","\u5929\u96f7","\u592a\u5149","\u547d\u5b9a","\u5929\u57df","\u771f\u8a00","\u8d64\u708e","\u708e\u7956","\u708e\u5e1d","\u795d\u878d","\u706b\u795e","\u7130\u97f5","\u706b\u7075","\u5927\u98df","\u51f6\u795e","\u51a5\u65cf","\u90e8\u843d","\u795e\u817e","\u56fe\u817e","\u5929\u517d","\u5de8\u7075","\u5deb\u65cf","\u5c71\u6d77","\u76d8\u53e4","\u5211\u5929","\u86a9\u5c24","\u4e5d\u9ece","\u5deb\u7956","\u661f\u56fe","\u5927\u7f8c","\u86ee\u5175","\u547d\u6218","\u5929\u5308","\u8840\u72f1","\u8d64\u5e1d","\u9f99\u65cf","\u795e\u8bdd","\u795e\u7947","\u5c11\u660a","\u4e5d\u86ee","\u51f6\u7075"],this.t.addition_endList=["\u6587\u5316","\u6c0f"],this.t.fixedList=["\u6709\u718a\u6c0f","\u4eba\u95f4\u6587\u5316"],this.t.templates=["addition_start","addition_end"],this.clone("human_culture","wenhua_name"),this.clone("orc_culture","human_culture"),this.clone("elf_culture","human_culture"),this.clone("dwarf_culture","human_culture"),this.clone("Tian_culture","human_culture"),this.clone("Ming_culture","human_culture"),this.clone("Yao_culture","human_culture");var d=new c;d.id="kingdom_mottos",d.onlyByTemplate=!1,d.fixedNameChance=1,this.add(d),this.t.fixedList=["\u6709\u5fd7\u8005\u81ea\u6709\u5343\u8ba1\u4e07\u8ba1\uff0c\u65e0\u5fd7\u8005\u53ea\u611f\u5343\u96be\u4e07\u96be\u3002","\u4e0d\u5b89\u4e8e\u73b0\u72b6\uff0c\u4e0d\u7518\u4e8e\u5e73\u5eb8\uff01","\u518d\u957f\u7684\u8def\uff0c\u4e00\u6b65\u6b65\u4e5f\u80fd\u8d70\u5b8c\u3002","\u81ea\u5df1\u6253\u8d25\u81ea\u5df1\u662f\u6700\u53ef\u60b2\u7684\u5931\u8d25\uff01","\u6709\u5fd7\u8005\uff0c\u4e8b\u7adf\u6210\uff0c\u7834\u91dc\u6c89\u821f\uff0c\u767e\u4e8c\u79e6\u5173\u7ec8\u5c5e\u695a\uff1b\u6709\u5fc3\u4eba\uff0c\u5929\u4e0d\u8d1f\uff0c\u5367\u85aa\u5c1d\u80c6\uff0c\u4e09\u5343\u8d8a\u7532\u53ef\u541e\u5434\u3002","\u4e07\u4e8b\u7686\u7531\u4eba\u7684\u610f\u5fd7\u521b\u9020\u3002","\u5fd7\u4e4b\u6240\u5411\uff0c\u91d1\u77f3\u4e3a\u5f00\uff0c\u8c01\u80fd\u5fa1\u4e4b\uff1f","\u4e0d\u5b89\u4e8e\u5c0f\u6210\uff0c\u7136\u540e\u8db3\u4ee5\u6210\u5927\u5668","\u4e0d\u8bf1\u4e8e\u5c0f\u5229\uff0c\u7136\u540e\u53ef\u4ee5\u7acb\u8fdc\u529f\u3002","\u201c\u5931\u8d25\u201d\u53ea\u5b58\u5728\u4e8e\u5e9f\u4eba\u7684\u5b57\u5178\u91cc\u3002","\u56fd\u8005\uff0c\u5929\u4e0b\u4e4b\u5927\u5668\u4e5f\uff0c\u91cd\u4efb\u4e5f\u3002","\u53e4\u4e4b\u5f97\u9053\u8005\uff0c\u7a77\u4ea6\u4e50\uff0c\u8fbe\u4ea6\u4e50\uff0c\u6240\u4e50\u975e\u7a77\u8fbe\u4e5f\u3002","\u5e08\u4e4b\u6240\u5904\uff0c\u8346\u68d8\u751f\u7109\u3002\u5927\u519b\u4e4b\u540e\uff0c\u5fc5\u6709\u51f6\u5e74\u3002","\u51e1\u6709\u8840\u6c14\uff0c\u7686\u6709\u4e89\u5fc3\u3002","\u4e0a\u4e0d\u5931\u5929\u65f6\uff0c\u4e0b\u4e0d\u5931\u5730\u5229\uff0c\u4e2d\u5f97\u4eba\u548c\uff0c\u800c\u767e\u4e8b\u4e0d\u5e9f\u3002","\u98ce\u6c34\u4eba\u95f4\u4e0d\u53ef\u65e0\uff0c\u4e5f\u987b\u9634\u9a98\u4e24\u76f8\u6276\u3002","\u53e4\u4e4b\u4e3a\u653f\uff0c\u7231\u4eba\u4e3a\u5927\u3002","\u5c14\u7b49\u4e0d\u8fc7\u4ee5\u4e94\u5341\u6b65\u7b11\u767e\u6b65\u3002","\u4e09\u676f\u901a\u5927\u9053\uff0c\u4e00\u9189\u89e3\u5343\u6101\u3002","\u5929\u4e0b\u7199\u7199\uff0c\u7686\u4e3a\u5229\u6765\uff1b\u5929\u4e0b\u6518\u6518\uff0c\u7686\u4e3a\u5229\u5f80\u3002","\u4efb\u529b\u8005\u6545\u52b3\uff0c\u4efb\u4eba\u8005\u6545\u9038\u3002","\u6020\u6162\u5fd8\u8eab\uff0c\u7978\u707e\u4e43\u4f5c\u3002","\u5fc3\u4ee5\u542f\u667a\uff0c\u667a\u4ee5\u542f\u8d22\uff0c\u8d22\u4ee5\u542f\u4f17\uff0c\u4f17\u4ee5\u542f\u8d24\uff0c\u8d24\u4e4b\u6709\u542f\uff0c\u4ee5\u738b\u5929\u4e0b\u3002","\u4e0a\u58eb\u95fb\u9053\uff0c\u52e4\u800c\u884c\u4e4b\uff1b\u4e2d\u58eb\u95fb\u9053\uff0c\u82e5\u5b58\u82e5\u4ea1\uff1b\u4e0b\u58eb\u95fb\u9053\uff0c\u5927\u7b11\u4e4b\u3002","\u5929\u9053\u8fdc\uff0c\u4eba\u9053\u8fe9\uff0c\u975e\u6240\u53ca\u4e5f\uff0c\u4f55\u4ee5\u77e5\u4e4b\uff1f","\u5b81\u6559\u6211\u8d1f\u5929\u4e0b\u4eba\uff0c\u5207\u83ab\u5929\u4e0b\u4eba\u8d1f\u6211\u3002","\u6cd5\uff0c\u5386\u5219\u56fd\u6b63","\u5584\uff0c\u5927\u7231\u4e8e\u5929\u4e0b\u3002","\u541b\u5b50\u4e4b\u56fd","\u5546\u8d38\u4e4b\u56fd","\u7a77\u5219\u72ec\u5584\u5176\u8eab\uff0c\u8fbe\u5219\u517c\u6d4e\u5929\u4e0b","\u86ee\u5937\u4e4b\u56fd","\u793c\u4e50\u5f81\u4f10\u81ea\u5929\u5b50\u51fa","\u95ee\u82cd\u832b\u5927\u5730\uff0c\u8c01\u4e3b\u6c89\u6d6e\uff1f","\u4e00\u751f\u4e8c\uff0c\u4e8c\u751f\u4e09\uff0c\u4e09\u751f\u4e07\u7269\u3002","\u5929\u5b50\u5b88\u56fd\u95e8\uff0c\u541b\u738b\u6b7b\u793e\u7a37\u3002","\u5c71\u6cb3\u65e0\u6059\uff0c\u7acb\u5f53\u81ea\u5f3a\u3002","\u6c5f\u5c71\u5982\u6b64\u591a\u5a07\uff0c\u5f15\u65e0\u6570\u82f1\u96c4\u7ade\u6298\u8170\u3002","\u6c99\u573a\u67d3\u8840\u4f55\u5fe7\u60e7\uff0c\u9a6c\u9769\u88f9\u5c38\u8fd8\uff01","\u96c4\u89c6\u5929\u4e0b","\u98ce\u8d77----","\u4e3a\u5929\u4e0b\u547d","\u96c4\u8e1e\u4e00\u65b9\uff0c\u8349\u89c6\u5929\u4e0b","\u6587\u5316\u660c\u76db","\u5929\u5730\u4e0d\u4ec1\uff0c\u4ee5\u4e07\u7269\u4e3a\u520d\u72d7\uff01","\u6587\u7ae0\u5343\u79cb\u6cbb\uff0c\u6b66\u8005\u7532\u5b50\u4f11\u3002","\u4e5d\u52ab\u7a7a\uff0c\u82cd\u5929\u9006\u3002\u65ed\u65e5\u817e\uff0c\u5723\u65cf\u5174\u3002","\u8d70\uff0c\u6211\u5e26\u4f60\u6740\u4eba\u53bb\u3002","\u4ea6\u6602\u725b\u6279\uff0cyyds\uff0c","\u9000\u4e00\u6b65\u662f\u4eba\u95f4\uff0c\u8fdb\u4e00\u6b65\u5c31\u5728\u5e7d\u51a5\u3002","\u9668\u9053\u6218\u5929\uff0c\u8c01\u4e0e\u4e89\u950b\u3002","\u4e49\uff0c\u4ee5\u547d\u4e3a\u62b5","\u5b81\u4e3a\u5200\u4e0b\u9b42\uff0c\u4e0d\u505a\u819d\u4e0b\u9b3c\u3002","\u9ec4\u6c99\u767e\u6218\u7a7f\u91d1\u7532\uff0c\u4e0d\u7834\u697c\u5170\u7ec8\u4e0d\u8fd8\u3002","\u5929\u56fd\u4e07\u5e74","\u4e0e\u5929\u535a\u5f08","\u6b64\u95f4\u4e50\uff0c\u4e0d\u601d\u8700\u3002","\u5175\u950b\u6240\u5411\uff0c\u6240\u5411\u62ab\u9761\u3002","\u5f00\u79d1\u4e3e\uff0c\u5174\u6587\u5316\uff0c\u5b89\u56db\u65b9\uff0c\u4e07\u56fd\u6765\u671d\u3002","\u613f\u6548\u592a\u5b97\uff0c\u518d\u5f00\u76db\u4e16\u3002","\u6587\u660e\u53e4\u56fd","\u6c34\u80fd\u8f7d\u821f\u4ea6\u80fd\u8986\u821f","\u4e3a\u5343\u79cb\u8c0b\u5927\u8ba1\uff0c\u4e3a\u4e07\u4e16\u5f00\u592a\u5e73","\u5927\u6c5f\u4e1c\u53bb\uff0c\u6d6a\u6dd8\u5c3d\uff0c\u5343\u53e4\u98ce\u6d41\u4eba\u7269\u3002","\u987a\u5929\u610f\uff0c\u884c\u5927\u9053\u3002","\u9886\u5929\u610f\uff0c\u5f81\u4f10\u5929\u4e0b\u3002","\u795d\u4fee\u4ed9\u7fa4\u6240\u6709\u7fa4\u53cb\uff0c\u524d\u7a0b\u4f3c\u9526","\u77e5\u5929\u610f\uff0c\u9006\u5929\u96be","\u738b\u4faf\u5c06\u76f8\u5b81\u6709\u79cd\u4e4e","\u795d\u4fee\u4ed9\u7fa4\u6240\u6709\u7fa4\u53cb\uff0c\u6b65\u6b65\u9ad8\u5347","\u4e00\u4ee3\u5929\u9a84---","\u7eb5\u6a2a\u4e4b\u9053\uff0c\u4ee5\u82cd\u751f\u4e3a\u68cb","\u5468\u6613\uff0c\u9634\u9633\u4e4b\u9053","\u795d\u4fee\u4ed9\u7fa4\u6240\u6709\u7fa4\u53cb\uff0c\u4e07\u4e8b\u987a\u610f","\u517c\u7231\u975e\u653b","\u9053\uff0c\u81ea\u7136\u4e5f","\u521d\u4e5d \u6f5c\u9f99\u52ff\u7528","\u51b2\u9635\u6740\u654c\uff0c\u65e0\u5f80\u4e0d\u5229","\u5343\u4e07\u4eba\u543e\u5f80\u77e3","\u6b4c\u821e\u7965\u548c\uff0c\u592a\u5e73\u76db\u666f\u4e50","\u4e5d\u4e94 \u98de\u9f99\u5728\u5929","\u5468\u516c\u5410\u54fa\uff0c\u5929\u4e0b\u5f52\u5fc3","\u6570\u98ce\u6d41\u4eba\u7269\uff0c\u8fd8\u770b\u4eca\u671d","\u4e07\u91cc\u957f\u5f81\u4eba\u672a\u8fd8","\u60a0\u60a0\u4e07\u56fd\uff0c\u543e\u4e3a\u6b63\u7edf\u3002","\u9884\u795d\u65b0\u5e74\u5feb\u4e50\uff01"];var u=new c;u.id="human_name",u.onlyByTemplate=!0,this.add(u),this.t.addition_startList=["\u8d75","\u94b1","\u5b59","\u674e","\u5468","\u5434","\u90d1","\u738b","\u51af","\u9648","\u891a","\u536b","\u848b","\u6c88","\u97e9","\u6768","\u6731","\u79e6","\u5c24","\u8bb8","\u4f55","\u5415","\u65bd","\u5f20","\u5b54","\u66f9","\u4e25","\u534e","\u91d1","\u9b4f","\u9676","\u59dc","\u8d39","\u5ec9","\u5c91","\u859b","\u96f7","\u8d3a","\u502a","\u6c64","\u6ed5","\u6bb7","\u7f57","\u6bd5","\u90dd","\u90ac","\u5b89","\u5e38","\u4e50","\u4e8e","\u65f6","\u5085","\u76ae","\u535e","\u9f50","\u5eb7","\u4f0d","\u4f59","\u5143","\u535c","\u987e","\u5b5f","\u5e73","\u9ec4","\u675c","\u962e","\u84dd","\u95f5","\u5e2d","\u5b63","\u9ebb","\u5f3a","\u8d3e","\u8def","\u5a04","\u5371","\u6c5f","\u7ae5","\u989c","\u90ed","\u6885","\u76db","\u6797","\u5201","\u949f","\u5f90","\u90b1","\u9a86","\u9ad8","\u590f","\u8521","\u7530","\u6a0a","\u80e1","\u51cc","\u970d","\u7a0b","\u5d47","\u90a2","\u6ed1","\u88f4","\u9646","\u8363","\u7fc1","\u8340","\u7f8a","\u65bc","\u60e0","\u7504","\u9b4f","\u52a0","\u5c01","\u82ae","\u7fbf","\u50a8","\u9773","\u6c72","\u90b4","\u7cdc","\u677e","\u4e95","\u6bb5","\u5bcc","\u5deb","\u4e4c","\u7126","\u5df4","\u5f13","\u53f6","\u5e78","\u53f8","\u97f6","\u90dc","\u9ece","\u84df","\u8584","\u5370","\u5bbf","\u767d","\u6000","\u84b2","\u53f0","\u4ece","\u9102","\u7d22","\u54b8","\u7c4d","\u8d56","\u5353","\u853a","\u5c60","\u8499","\u6c60","\u4e54","\u9634","\u90c1","\u80e5","\u80fd","\u82cd","\u53cc","\u6e29","\u522b","\u5e84","\u664f","\u67f4","\u77bf","\u960e","\u5145","\u6155","\u8fde","\u8339","\u4e60","\u5ba6","\u827e","\u9c7c","\u5bb9","\u5411","\u53e4","\u6613","\u614e","\u6208","\u5ed6","\u5e9a","\u7ec8","\u66a8","\u5c45","\u8861","\u6b65","\u90fd","\u803f","\u6ee1","\u5f18","\u66fe","\u6bcb","\u6c99","\u4e5c","\u517b","\u97a0","\u987b","\u4e30","\u5984","\u90aa","\u5e7d","\u9634","\u846c","\u9986","\u591c","\u51a5","\u6e9f","\u4ea1","\u5929","\u5149","\u9053","\u6e90","\u7075","\u7384","\u8000","\u9633","\u59ec","\u6781","\u8be1","\u592a","\u5b87","\u5b99","\u7b80","\u6613","\u521d","\u59cb","\u7687","\u6743","\u5e1d","\u5c0a","\u519b","\u541b","\u745e","\u767d","\u96ea","\u4ed9","\u5723","\u795e","\u6b66","\u82cd","\u7a79","\u7a7a","\u9b54","\u7981","\u55dc","\u566c","\u5239","\u6740","\u9006","\u5a9a","\u715e","\u72f1","\u9aa8","\u589f","\u70bc","\u960e","\u711a","\u5deb","\u708e","\u96f7","\u51b0","\u91d1","\u6728","\u6c34","\u706b","\u571f","\u98ce","\u5492","\u9738","\u9547","\u5fa1","\u86ca","\u796d","\u7f6a","\u68a6","\u8352","\u796d","\u6218","\u9668","\u5bc2","\u72f1","\u7956","\u5c01","\u5370","\u591c\u6e9f","\u51a5\u53f8","\u5e7d\u66ae","\u6c38\u6697","\u65e0\u6781","\u592a\u4e0a","\u7d2b\u8587","\u73b2\u73d1","\u6df1\u6e0a","\u711a\u5929","\u81ea\u5728","\u9053","\u900d\u9065","\u5f52\u7075","\u6743","\u902f","\u76d6","\u76ca","\u6853","\u516c","\u4e07\u4fdf","\u53f8\u9a6c","\u4e0a\u5b98","\u6b27\u9633","\u516c\u5b59","\u4e50\u6b63","\u8f69\u8f95","\u4ee4\u72d0","\u949f\u79bb","\u95fe\u4e18","\u957f\u5b59","\u6155\u5bb9","\u9c9c\u4e8e","\u5b87\u6587","\u53f8\u5f92","\u53f8\u7a7a","\u4e93\u5b98","\u53f8\u5bc7","\u4ec9\u7763","\u5b50\u8f66","\u6bb5\u5e72","\u767e\u91cc","\u4e1c\u90ed","\u5357\u95e8","\u547c\u5ef6","\u59ab\u6d77","\u7f8a\u820c","\u5fae\u751f","\u5cb3\u5e05","\u7f11\u4ea2","\u51b5\u5f8c","\u6709\u7434","\u6881\u4e18","\u5de6\u4e18","\u4e1c\u95e8","\u897f\u95e8","\u5909\u614b","\u706b","\u708e","\u7130","\u7131","\u7075","\u9f99","\u5723","\u708e","\u5343\u5b98","\u70bc","\u6218","\u6b66","\u5929\u5de5","\u695a\u4e0a","\u65e0\u53cc","\u7089","\u5e7d\u4ec1","\u5e1d\u660a","\u5c06","\u8f69\u8f95","\u65a9\u5175"],this.t.partsList=["\u8bda","\u6734","\u96c4","\u4f1f","\u52b1","\u5b66","\u6566","\u884c","\u5bcc","\u5f3a","\u6c11","\u4e3b","\u6587","\u660e","\u548c","\u8c10","\u81ea","\u7531","\u5e73","\u7b49","\u516c","\u6b63","\u6cd5","\u6cbb","\u7231","\u56fd","\u656c","\u4e1a","\u8bda","\u4fe1","\u53cb","\u5584","\u5929","\u5730","\u7384","\u9ec4","\u5b87","\u5b99","\u6d2a","\u8352","\u5b89","\u77f3","\u5bd3","\u4e1d","\u7af9","\u65b9","\u6714","\u6742","\u8bd9","\u8c10","\u6602","\u9704","\u6c14","\u6982","\u53e4","\u6765","\u65e0","\u5730","\u53ef","\u5bb9","\u624d","\u4e0d","\u89c1","\u9a91","\u9cb8","\u4ed9","\u4f2f","\u553e","\u624b","\u529f","\u540d","\u4e8b","\u4e86","\u733f","\u9e64","\u4e0e","\u540c","\u4faa","\u6709","\u610f","\u8c22","\u8f69","\u5195","\u65e0","\u8ba1","\u907f","\u5acc","\u731c","\u9759","\u4e2d","\u4e50","\u5c71","\u7167","\u5ea7","\u6708","\u6d6e","\u676f","\u5fd8","\u5f62","\u6e5b","\u8f88","\u4e00","\u7b11","\u4e18","\u58d1","\u5199","\u9ad8","\u6000","\u53ea","\u6050","\u5929","\u50ac","\u7389","\u65a7","\u4e3a","\u7834","\u70df","\u5c18","\u660f","\u7ff3","\u4eba","\u81ea","\u65e5","\u8fb9","\u6765","\u4e1c","\u9601","\u52a8","\u5929","\u4e59","\u5f00","\u8fd0","\u592a","\u5cb3","\u949f","\u82f1","\u8363","\u6cb3","\u6e29","\u6d1b","\u777f","\u54f2","\u521d","\u751f","\u7518","\u6cc9","\u6fef","\u8033","\u7574","\u4ea7","\u5e76","\u8015","\u5c1a","\u4e66","\u9053","\u535a","\u8bf4","\u6587","\u4e49","\u7cbe","\u5f25","\u7eb6","\u5f5d","\u5baa","\u6df3","\u5316","\u4f11","\u660e","\u5149","\u5dde","\u886e","\u5195","\u6c5d","\u5357","\u65e6","\u8bc4","\u52cb","\u7337","\u70b3","\u7115","\u70af","\u9274","\u6e0a","\u6e05","\u6709","\u5510","\u53d7","\u547d","\u51e4","\u7fe5","\u9f99","\u7fd4","\u5ba3","\u5a01","\u6f33","\u9547","\u96cd","\u7a46","\u5b81","\u5eb7","\u6276","\u4f26","\u7ffc","\u6559","\u529f","\u6210","\u7d2b","\u9633","\u540d","\u8d24","\u51a2","\u5bb0","\u5fb7","\u7acb","\u55e3","\u660c","\u5c11","\u5e08","\u79c9","\u653f","\u4e25","\u8083","\u7aef","\u5e84","\u73af","\u5947","\u90fd","\u9644","\u7235","\u79e9","\u5c0a","\u826f","\u4e91","\u5174","\u9aa5","\u5c55","\u6842","\u99a5","\u5170","\u9999","\u7f09","\u7199","\u666f","\u795a","\u798f","\u7949","\u7ef5","\u957f","\u4faf","\u884d","\u4f2f","\u6d69","\u957f","\u671d","\u56fd","\u6559","\u4fee","\u9f50","\u6cbb","\u5e73","\u4e2d","\u534e","\u4f4d","\u80b2","\u66e6","\u9633","\u4e5d","\u52ab","\u5929","\u9706","\u9704","\u701a","\u9f99","\u8840","\u706b","\u90aa","\u864e","\u795e","\u767d","\u73d1","\u96c0","\u51f0","\u8d64","\u6b66","\u72d0","\u5143","\u6cb3","\u6e3a","\u7a7a","\u5149","\u708e","\u5764","\u6613","\u6c34","\u6b66","\u5929","\u5317","\u91d1","\u7389","\u6728","\u7384","\u571f","\u706b","\u5730","\u795e","\u6e90","\u5143","\u6e05","\u6797","\u8349","\u5317","\u65e0\u6781","\u65e0","\u4e71","\u53e4","\u7434","\u68cb","\u4e66","\u753b","\u6b63","\u6d2a","\u5c71","\u6d77","\u7687","\u9f99","\u539f","\u5c38","\u8840","\u90aa","\u738b","\u5996","\u7075","\u6c38","\u661f","\u5149","\u6697","\u592a\u6781","\u75d5","\u5b9d","\u7d2b","\u6781","\u8000","\u6cb3","\u90aa","\u5aba","\u70fd","\u5e9a","\u964c","\u5a01","\u5c1a","\u6625","\u9f0e","\u8499","\u7687","\u95e8","\u9053","\u8f95","\u7687","\u7fb2","\u960e","\u6e05","\u5a32"],this.t.addition_endList=["\u5929\u5357","\u5357\u9633","\u5e73\u5b89","\u5c71\u4e1c","\u957f\u57ce","\u5efa\u5143","\u9ec4\u9f99","\u5251\u662d","\u9e3f\u5609","\u5efa\u6b66","\u5609\u5e73","\u666f\u5e73","\u4e49\u7199","\u5929\u9274","\u6c38\u5b9a","\u5929\u5eb7","\u667a\u5fb7","\u5d07\u660e","\u592a\u6781","\u5929\u4f51","\u5b9d\u5143","\u5e7f\u660e","\u6c38\u9686","\u5f00\u8000","\u6cb3\u6e05","\u7687\u59cb","\u5764\u4ea5","\u9879\u71d5","\u5468\u6613","\u4e7e\u964c","\u6cb3\u5357","\u6b66\u662d","\u5929\u95ee","\u8fbd\u5b81","\u5317\u6d77","\u5929\u7737","\u7389\u95e8","\u7532\u5b50","\u6b63\u7384","\u7532\u620c","\u957f\u5b89","\u70b3\u58a8","\u795e\u6b66","\u5e84\u5b50","\u5251\u5357","\u5929\u5a01","\u5b54\u5b50","\u6d1b\u9633","\u5929\u7532","\u5317\u51c9","\u592a\u5e73","\u9707\u79bb","\u5b50\u8f69","\u7b56\u6b63","\u6d2a\u6b66","\u5c71\u6d77","\u89c2\u6d77","\u5938\u7236","\u70fd\u9f0e","\u6b66\u5e9a","\u964c\u5468","\u795e\u5a01","\u5c1a\u4e66","\u6625\u79cb","\u4e5d\u9f0e","\u574e\u6c34","\u592a\u5e73","\u4e5d\u5dde","\u534e\u590f","\u5929\u6cc9","\u5357\u9ed8","\u6f20\u5317","\u6b63\u5317","\u66f9\u53bf","\u5e73\u6d32","\u6c5f\u5357","\u62d2\u5317","\u8f69\u5b87","\u660a\u5929","\u5929\u7fbd","\u609f\u7a7a","\u6708\u795e","\u77f3\u5ddd","\u5e73\u6c5f","\u6c38\u5e74","\u5929\u5b9d","\u957f\u537f","\u51e4\u5e74","\u9f99\u8c61","\u4ed9\u829d","\u4e16","\u821c","\u4e1e","\u4e3b","\u4ec1","\u4ed3","\u4ed5","\u4ede","\u5112","\u4fca","\u5251","\u6df3\u7f61","\u540f","\u55e3","\u58eb","\u5b7a","\u5b88","\u5bbe","\u5b8b","\u5b97","\u5b99","\u5ba3","\u5bb0","\u950b","\u5c0a","\u5cd9","\u5cfb","\u5d07","\u5ddd","\u5dde","\u5de1","\u5e05","\u5e9a","\u6218","\u624d","\u66f9","\u5c01","\u5c71","\u5cf0","\u749f","\u745c","\u751f","\u77e2","\u77f3","\u78ca","\u7956","\u7985","\u7a46","\u8f7c","\u8f69","\u5b50","\u6770","\u78a7","\u5929","\u4e50","\u4e1c","\u94e0","\u94f8","\u9547","\u9997","\u65ed","\u9a8f","\u9aa5","\u9a84","\u8bda","\u6155","\u7aef","\u5f81","\u575a","\u5efa","\u5f66","\u5fa1","\u64ce","\u6677","\u5180","\u51ef","\u5578","\u67f4","\u6728","\u6797","\u68ee","\u9a9e","\u5bd2","\u51fd","\u9ad8","\u9b41","\u9b4f","\u9c9b","\u9cb2","\u9e70","\u4e15","\u5019","\u5195","\u5baa","\u5f6a","\u5f6d","\u65e5","\u660e","\u662a","\u6634","\u80dc","\u6c49","\u6db5","\u6c57","\u6d69","\u6d9b","\u701a","\u701b","\u704f","\u6ca7","\u865a","\u8c6a","\u8c79","\u90b6","\u9706","\u9707","\u97e9","\u98ce","\u9a6c","\u4eae","\u4ed1","\u5e1d","\u5f29","\u5f70","\u5f81","\u5fb7","\u5fd7","\u5fe0","\u601d","\u632f","\u660a","\u662e","\u664b","\u665f","\u6678","\u6715","\u6717","\u6bbf","\u6cf0","\u98d2","\u98d9","\u98da","\u7085","\u709c","\u715c","\u714a","\u708e","\u7384","\u52c7","\u541b","\u6e05","\u5409","\u514b","\u5f13","\u9ece","\u8d24","\u91d1","\u946b","\u8f89","\u58a8","\u53cb","\u95fb","\u95ee","\u6f9c","\u662d","\u51b0","\u723d","\u7fbd","\u5e0c","\u82b3","\u96c5","\u829d","\u6587","\u6668","\u5b87","\u5168","\u5b50","\u51e1","\u5148","\u6d69","\u8431","\u96e8","\u6708","\u66e6","\u9732","\u4ea6","\u827a","\u7ffc","\u86a9","\u8966"],this.t.templates=["addition_end"],this.clone("orc_name","human_name"),this.clone("Tian_name","human_name"),this.clone("Ming_name","human_name");var h=new c;h.id="aijing_name",h.onlyByTemplate=!0,this.add(h),this.t.addition_endList=["\u5929\u5de5","\u795e\u953b","\u767e\u70bc","\u6218\u9524","\u5723\u6b66","\u6d74\u706b","\u795e\u6b66","\u7120\u7130","\u706b\u795e","\u795e\u5175","\u662d\u70c8","\u706b\u51e4","\u70c8\u9633","\u706b\u5de5","\u795d\u878d","\u8d64\u7130","\u70bc\u5668","\u7075\u6b66","\u5343\u7145","\u5320\u4eba","\u795e\u5320","\u5929\u706b","\u5de8\u5320","\u771f\u708e","\u795e\u673a","\u7130\u7089","\u5723\u5668","\u708e\u5e1d","\u708e\u540d","\u771f\u706b","\u6b66\u7131","\u708e\u7075","\u6b66\u7075","\u51a5\u52a8","\u51b0\u7075","\u5e7d\u6697","\u7075\u795e","\u5723\u6c34","\u7075\u51b0","\u96f7\u5deb","\u7075\u6728","\u6728\u5deb","\u706b\u5deb","\u7075\u51a5","\u7075\u52a8","\u51ac\u706d","\u5149\u660e","\u96f7\u7075","\u7d2b\u7075","\u91d1\u7075","\u81ea\u7136","\u5929\u665f","\u706b\u7075","\u51a5\u67f3","\u4f59\u70ec","\u7fbd\u5929","\u751f\u7075","\u9f99\u795e","\u96ea\u5deb","\u7075\u5deb","\u5723\u4f7f","\u73b2\u73d1","\u5171\u5de5","\u51b0\u9f99","\u5fa1\u98ce","\u8d64\u7fbd","\u9752\u7fbd","\u571f\u7075","\u7075\u6cb3","\u6708\u795e","\u5929\u662d","\u5929\u7075"],this.t.addition_startList=["\u706b","\u708e","\u7130","\u7131","\u7075","\u9f99","\u5723","\u708e","\u5343\u5b98","\u70bc","\u6218","\u6b66","\u5929\u5de5","\u695a\u4e0a","\u65e0\u53cc","\u7089","\u5e7d\u4ec1","\u5e1d\u660a","\u5c06","\u8f69\u8f95","\u65a9\u5175"],this.t.templates=["addition_end"],this.clone("elf_name","aijing_name"),this.clone("dwarf_name","elf_name");var p=new c;p.id="sheep_name",p.onlyByTemplate=!0,this.add(p),this.t.partsList=["\u7532","\u4e59","\u620a","\u5df1","\u5e9a","\u89d2","\u4ea2","\u7384","\u594e","\u865a","\u7075","\u5929","\u5730","\u5c71","\u5ca9","\u79bb","\u53e4","\u8352","\u7fbd","\u91d1","\u6728","\u6c34","\u706b","\u571f","\u98ce","\u96f7","\u5149","\u6697","\u8840","\u9b54","\u4ed9","\u5143","\u5723","\u7075","\u9b42","\u711a","\u708e","\u51b0","\u9752","\u96ea","\u72f1","\u7fbd","\u9053","\u58a8","\u51a5","\u5929","\u5730","\u4e9a","\u6218","\u7384","\u5e7b","\u5f71","\u795e","\u5947","\u5f02","\u6bd2","\u9aa8","\u86ee","\u6d74","\u5927"],this.t.partsList2=["\u5b50","\u91d1","\u6728","\u6c34","\u706b","\u571f","\u98ce","\u96f7","\u7535","\u96ea","\u7687","\u5e1d","\u5175","\u7532","\u4e7e","\u5764","\u7075","\u51b0","\u7131","\u708e","\u8d64","\u6708","\u65e5","\u6e90","\u865a","\u70ec","\u7fbd","\u7a7a","\u6c8c","\u865a","\u65e0","\u6e90","\u7075","\u6d1b","\u96f7","\u6cea","\u5bc6","\u5149","\u660e","\u6781","\u5f02","\u77f3","\u7ffc","\u6613","\u8d64","\u9633","\u5730","\u79bb","\u8840","\u7259","\u661f","\u865a","\u9053","\u6b66","\u7384"],this.addAddtion_endList(["\u7f8a","\u7075\u7f8a"]),this.t.templates=["part1","part2"],this.clone("penguin_name","sheep_name"),this.addAddtion_endList(["\u4f01\u9e45"]),this.clone("turtle_name","sheep_name"),this.addAddtion_endList(["\u9f9f","\u7384\u9f9f","\u7075\u9f9f","\u7384\u6b66","\u9b54\u9f9f","\u86c7\u9f9f","\u706b\u9f9f","\u68cb\u9f9f","\u5ca9\u9f9f"]),this.clone("wolf_name","sheep_name"),this.addAddtion_endList(["\u72fc","\u5996\u72fc","\u5929\u72fc","\u5929\u72d7","\u90aa\u72fc","\u706b\u72fc","\u51b0\u72fc","\u9b54\u72fc","\u795e\u72fc","\u7384\u72fc","\u7956\u72fc","\u8840\u72fc","\u5996\u72fc"]),this.clone("greg_name","sheep_name"),this.addAddtion_endList(["\u683c\u96f7\u683c"]),this.clone("chicken_name","sheep_name"),this.addAddtion_endList(["\u9e21","\u7384\u96cf","\u9e3e\u9e1f","\u51e4","\u7fc5\u96c0","\u8d64\u96c0","\u5996\u96c0","\u706b\u51e4","\u5f69\u51e4","\u51b0\u51e4","\u96f7\u51e4","\u51e4\u51f0","\u5996\u51e4","\u8be1\u51e4","\u7075\u51e4","\u8840\u51e4","\u53e4\u51e4","\u795e\u51e4","\u8d64\u51e4"]),this.clone("cock_name","chicken_name"),this.clone("alien_name","sheep_name"),this.addAddtion_endList(["\u5f02\u4eba","\u5f02\u8005"]),this.clone("ufo_name","sheep_name"),this.addAddtion_endList(["\u98de\u8239","\u5929\u821f","\u65b9\u821f"]),this.clone("cold_one_name","sheep_name"),this.addAddtion_endList(["\u51b0\u9b54","\u51b0\u7075","\u6076\u7075","\u9b54\u7075","\u6076\u9b54"]),this.clone("bug_name","sheep_name"),this.addAddtion_endList(["\u866b","\u8702","\u8776"]),this.clone("ant_name","sheep_name"),this.addAddtion_endList(["\u8681"]),this.clone("demon_name","sheep_name"),this.addAddtion_endList(["\u706b\u9b54","\u706b\u7075","\u6076\u7075","\u9b54\u7075","\u6076\u9b54"]),this.clone("fairy_name","sheep_name"),this.addAddtion_endList(["\u7cbe\u7075","\u5929\u7075"]),this.clone("crab_name","sheep_name"),this.addAddtion_endList(["\u8783\u87f9","\u7075\u87f9","\u708e\u87f9","\u795e\u87f9","\u5ca9\u87f9","\u5de8\u87f9","\u6c34\u87f9"]),this.clone("cow_name","sheep_name"),this.addAddtion_endList(["\u725b","\u7075\u725b","\u795e\u725b","\u5996\u725b","\u4ed9\u725b","\u91d1\u725b","\u9b54\u725b","\u6c34\u725b","\u5929\u725b","\u8840\u725b","\u725b"]),this.clone("evil_mage_name","sheep_name"),this.addAddtion_endList(["\u6cd5\u5e08","\u672f\u58eb","\u5929\u5e08"]),this.clone("rhino_name","sheep_name"),this.addAddtion_endList(["\u7280\u725b","\u89d2\u725b","\u7075\u7280","\u9b54\u7280","\u53e4\u7280","\u5de8\u7280","\u706b\u7280","\u51b0\u7280","\u7280\u725b"]),this.clone("monkey_name","sheep_name"),this.addAddtion_endList(["\u7334","\u733f","\u7075\u733f","\u795e\u7334","\u5996\u7334","\u77f3\u7334","\u6c34\u7334","\u91d1\u733f","\u6728\u7334","\u706b\u7334","\u795e\u733f","\u7075\u7334"]),this.clone("buffalo_name","sheep_name"),this.addAddtion_endList(["\u6c34\u725b","\u5914\u725b","\u7075\u725b","\u725b"]),this.clone("fox_name","sheep_name"),this.addAddtion_endList(["\u72d0","\u7075\u72d0","\u5996\u72d0","\u4e5d\u5c3e\u72d0","\u9b3c\u72d0","\u4ed9\u72d0","\u5929\u72d0"]),this.clone("hyena_name","sheep_name"),this.addAddtion_endList(["\u72d7","\u72ac","\u7075\u72ac","\u5929\u72d7"]),this.clone("dog_name","hyena_name"),this.clone("crocodile_name","sheep_name"),this.addAddtion_endList(["\u9cc4","\u5996\u9cc4","\u8840\u9cc4","\u7075\u9cc4"]),this.clone("snake_name","sheep_name"),this.addAddtion_endList(["\u86c7","\u5996\u86c7","\u7075\u86c7"]),this.clone("frog_name","sheep_name"),this.addAddtion_endList(["\u86d9"]),this.clone("bioblob_name","sheep_name"),this.addAddtion_endList(["\u751f\u7269\u8d28"]),this.clone("assimilator_name","sheep_name"),this.addAddtion_endList(["\u540c\u5316\u8005"]),this.clone("fire_skull_name","sheep_name"),this.addAddtion_endList(["\u706b\u7075"]),this.clone("acid_blob_name","sheep_name"),this.addAddtion_endList(["\u8150\u8680\u8005"]),this.clone("wraith_name","sheep_name"),this.addAddtion_endList(["\u5934\u9885","\u6b7b\u7075"]),this.clone("lil_pumpkin_name","sheep_name"),this.addAddtion_endList(["\u5357\u74dc","\u6728\u7075"]),this.clone("rat_name","sheep_name"),this.addAddtion_endList(["\u9f20","\u7075\u9f20","\u5996\u9f20"]),this.clone("ratKing_name","sheep_name"),this.addAddtion_endList(["\u9f20\u738b","\u7075\u9f20\u738b","\u5996\u9f20\u738b"]),this.clone("cat_name","sheep_name"),this.addAddtion_endList(["\u732b","\u7075\u732b","\u5996\u732b","\u732b"]),this.clone("rabbit_name","sheep_name"),this.addAddtion_endList(["\u5154","\u6708\u5154","\u7075\u5154"]),this.clone("piranha_name","sheep_name"),this.addAddtion_endList(["\u9c7c","\u9ca8","\u9cb8"]),this.clone("snowman_name","sheep_name"),this.addAddtion_endList(["\u96ea\u7075"]),this.clone("bear_name","sheep_name"),this.addAddtion_endList(["\u718a","\u9b54\u718a","\u5996\u718a","\u5de8\u718a"]),this.clone("skeleton_name","sheep_name"),this.addAddtion_endList(["\u6b7b\u7075"]),this.clone("homie_name","sheep_name"),this.addAddtion_endList(["\u623f\u5b50","\u5b85\u7075","\u6bbf\u7075"]),this.clone("living_plant_name","sheep_name"),this.addAddtion_endList(["\u5996\u6811","\u7075\u6811","\u7075\u6728","\u5996\u6728"]),this.clone("reindeer_name","sheep_name"),this.addAddtion_endList(["\u7075\u9e7f","\u5de8\u9e7f"]),this.clone("lobster_name","sheep_name"),this.addAddtion_endList(["\u7075\u867e","\u795e\u867e","\u5de8\u867e","\u6c34\u867e"]),this.clone("default_name","sheep_name"),this.addAddtion_endList(["\u5929\u7075","\u5723\u7075","\u9b54\u7075"]),this.clone("tiger_name","sheep_name"),this.addAddtion_endList(["\u864e"]);var f=new c;f.id="book_name",f.fixedNameChance=1e-4,f.onlyByTemplate=!1,f.templates=["part1","part2","addition_end"],this.add(f),this.t.addition_endList=["\u529f\u6cd5","\u5723\u5178","\u9053\u5377","\u5b9d\u5f55","\u53e4\u7ecf","\u7075\u8c31","\u5251\u7f61"],this.t.partsList=["\u5929","\u5730","\u7384","\u9ec4","\u7075","\u7532","\u4e59","\u4e19","\u4e01","\u620a","\u5df1","\u5e9a","\u8f9b","\u58ec","\u7678","\u9053","\u6cd5","\u5143","\u4ed9","\u9b54","\u5723","\u795e","\u715e"],this.t.partsList2=["\u6c34","\u706b","\u91d1","\u571f","\u6728","\u5143","\u7075","\u5a01","\u98ce","\u96f7","\u89c2","\u9b42","\u5143","\u51b0","\u7131","\u8840","\u4ed9","\u5b50","\u4e11","\u5bc5","\u8fb0","\u536f","\u5df3","\u5348","\u672a","\u7533","\u9149","\u620c","\u4ea5","\u9053"],this.t.fixedList=["\u9053\u5fc3\u79cd\u9b54\u5927\u6cd5","\u6df7\u6c8c\u4e5d\u8f6c\u706d\u795e\u9738\u51b3","\u964d\u5996\u4f0f\u9b54\u5f11\u795e\u8bdb\u4ed9\u7834\u5929\u88c2\u5730\u7eb5\u6a2a\u56db\u6d77\u6a2a\u626b\u516b\u8352\u552f\u6211\u72ec\u5c0a\u5723\u5178","\u542f\u6e90\u5723\u5178","\u68cb\u76d8\u5723\u5f55","\u4eba\u95f4\u9053\u5377","\u8475\u82b1\u5b9d\u5f55","\u7384\u7384\u5b50\u5fc3\u6cd5","\u76f2\u9c7c\u5723\u5f55","\u76df\u4e3b\u5fc3\u7ecf","\u4ed9\u5ead\u5b9d\u5178","\u661f\u5251\u5251\u9053","\u5c79\u6602\u5251\u8c31","\u9762\u5305\u4eba\u5fc3\u6cd5"];var _=new c;_.id="specialBody_name1",_.onlyByTemplate=!0,_.templates=["part1","addition_end"],this.add(_),this.t.partsList=["\u51e1"],this.t.addition_endList=["\u4f53"];var m=new c;m.id="specialBody_name2",m.onlyByTemplate=!0,m.templates=["part1","addition_end"],this.add(m),this.t.partsList=["\u7075\u529b","\u77f3\u5934","\u706b\u6c14","\u51b0\u4e4b","\u91d1\u4e4b","\u6728\u4e4b","\u6c34\u4e4b","\u706b\u4e4b","\u571f\u4e4b","\u91d1\u94f6","\u94c1\u4e4b","\u5251\u4e4b","\u5200\u4e4b","\u67aa\u4e4b","\u68cd\u4e4b","\u65a7\u4e4b","\u77db\u4e4b","\u76fe\u4e4b","\u5730\u7532","\u52fe\u9b42","\u593a\u9b44","\u86ee","\u517d","\u5996\u4e4b","\u9b3c\u4e4b","\u7075\u4e4b","\u9ec4\u5929","\u7384\u6c14","\u5143","\u6c14\u6e90","\u6e90\u529b","\u5de8\u529b","\u5927\u529b","\u864e\u72ee","\u5996\u529b","\u529b\u4e4b","\u7384\u4e4b","\u86ee\u529b","\u8fc5\u6377","\u654f\u4e4b","\u8840\u4e4b","\u94c1\u81c2","\u5996\u5a9a","\u9b45\u60d1","\u5343\u94a7","\u5f71\u5b50","\u6cbb\u7597","\u77b3\u4e4b","\u53cc\u77b3","\u706b\u77b3","\u6c34\u77b3","\u91d1\u77b3","\u6728\u77b3","\u571f\u77b3","\u5fa1\u7a7a","\u7075\u7738","\u907f\u6c34","\u907f\u706b","\u96fe\u4e4b","\u8131\u51e1","\u72c2\u66b4","\u72c2\u4e4b","\u5f71\u4e4b","\u6bd2\u4e4b","\u5730\u4e4b","\u9b42\u4e4b","\u98ce\u4e4b","\u7535\u4e4b","\u96f7\u4e4b","\u63a7\u6c34","\u63a7\u706b","\u63a7\u91d1","\u63a7\u6728","\u63a7\u571f","\u5251\u5fc3","\u5200\u5fc3","\u5c06\u4e4b","\u4e7e\u5929","\u5151\u6cfd","\u79bb\u706b","\u9707\u96f7","\u7c28\u98ce","\u574e\u6c34","\u826e\u5c71","\u5764\u5730","\u67af\u6728","\u8349\u6728","\u786c\u77f3"],this.t.addition_endList=["\u51e1\u4f53","\u4f53","\u8840\u8109","\u51e1\u8109"];var g=new c;g.id="specialBody_name3",g.onlyByTemplate=!0,g.templates=["part1","addition_end"],this.add(g),this.t.partsList=["\u9ec4\u91d1","\u767d\u94f6","\u767d\u4e91","\u98ce\u4e4b","\u96f7\u4e4b","\u51b0\u4e4b","\u6c34\u706b","\u6c34\u6728","\u91d1\u6c34","\u6c34\u571f","\u91d1\u706b","\u91d1\u6728","\u91d1\u571f","\u706b\u571f","\u706b\u6728","\u571f\u6728","\u9b3c\u5f71","\u5e7d\u4e4b","\u5149\u4e4b","\u6697\u4e4b","\u91d1\u4e4b","\u6728\u4e4b","\u706b\u4e4b","\u6c34\u4e4b","\u571f\u4e4b","\u541e\u708e","\u70c8\u7130","\u5bd2\u51b0","\u708e\u6708","\u706b\u708e","\u706b\u7130","\u706b\u9b54","\u91d1\u521a","\u94dc\u76ae","\u94c1\u9aa8","\u7384\u51b0","\u51b0\u5f26","\u7384\u51a5","\u90aa\u9b54","\u95ea\u7535","\u9b3c\u9b45","\u9b45\u60d1","\u96fe\u4e4b","\u767d\u96fe","\u5996","\u9b54","\u5730","\u7384\u9ec4","\u7384\u51a5","\u5e7d\u4e4b","\u7d2b\u6e5f","\u5deb\u5996","\u5deb\u4e4b","\u51b0\u5929","\u51b0\u96ea","\u90aa\u77b3","\u7d2b\u77b3","\u51b0\u78a7","\u96ea\u4e4b","\u4e5d\u5fc3","\u516d\u6b32","\u90aa\u706b","\u5bd2\u98ce","\u98ce\u706b","\u98ce\u7075","\u84dd\u94f6","\u78c1\u4e4b","\u6e90\u5929","\u6218\u4e4b","\u5251\u4e4b","\u5200\u4e4b","\u67aa\u4e4b","\u68cd\u4e4b","\u65a7\u4e4b","\u77db\u4e4b","\u5929\u661f","\u661f\u7075","\u5730\u715e","\u7d20\u5973","\u574e\u79bb","\u574e\u706b","\u574e\u6c34","\u574e\u571f","\u574e\u91d1","\u574e\u6728","\u70c8\u65e5","\u70c8\u9633","\u5e7d\u6708","\u5e7d\u5251","\u65e0\u5f71","\u9752\u708e","\u94f6\u971c","\u8ffd\u65e5","\u82cd\u708e","\u82cd\u7130","\u98ce\u96e8","\u5f52\u4e00","\u9752\u96f7","\u9634\u4e4b","\u9633\u4e4b","\u6b66","\u91d1","\u6728","\u6c34","\u706b","\u571f","\u96f7","\u7535","\u5996","\u517d","\u72c2\u6218","\u51b0","\u96fe","\u53cc\u5200","\u53cc\u5251","\u708e\u5251","\u4e7e\u5929","\u5151\u6cfd","\u79bb\u706b","\u9707\u96f7","\u7c28\u98ce","\u574e\u6c34","\u826e\u5c71","\u5764\u5730","\u6c34\u96f7","\u9634\u96f7","\u9633\u96f7","\u96f7\u706b","\u78d0\u77f3","\u745e\u91d1"],this.t.addition_endList=["\u7075\u4f53","\u8840\u8109","\u7075\u8109"];var y=new c;y.id="specialBody_name4",y.onlyByTemplate=!0,y.templates=["part1","addition_end"],this.add(y),this.t.partsList=["\u534a\u4ed9","\u5730\u4ed9","\u5316\u4ed9","\u51e1\u6781","\u4e03\u6740","\u8840\u715e","\u8ffd\u9b42","\u661f\u7f57","\u96f7\u7535","\u51b0\u706b","\u98ce\u66b4","\u98d3\u98ce","\u66b4\u98ce","\u96f7\u66b4","\u98ce\u96f7","\u51b0\u96f7","\u51b0\u98ce","\u5927\u611a","\u516b\u5366","\u63a2\u5929","\u63a2\u7981","\u7981\u5fcc","\u4fee\u7f57","\u5730\u72f1","\u70bc\u72f1","\u5929\u4f7f","\u4e07\u5996","\u91d1\u521a","\u660a\u5929","\u6740\u622e","\u72f1\u706b","\u91cd\u6c34","\u5929\u6781","\u5929\u91d1","\u4e07\u68ee","\u539a\u571f","\u751f\u6b7b","\u51a5","\u8840","\u6218\u5929","\u535a\u4ed9","\u5929\u6781","\u4ed9\u51e1","\u6b66\u9633","\u5929","\u5723\u83b2","\u5fa1\u9b42","\u7075\u5492","\u6e05\u6d9f","\u7409\u7483","\u75be\u98ce","\u72c2\u6218","\u6218\u9f99","\u96ea\u6f9c","\u5c01\u9b54","\u9053\u6e90","\u9053\u7075","\u592a\u5eb7","\u9f99\u6e0a","\u5200\u5251","\u5929\u5251","\u7edd\u5200","\u4e7e\u5143","\u4e03\u661f","\u5929\u5211","\u4e5d\u715e","\u5929\u715e","\u5929\u6b66","\u6781\u706b","\u711a\u4e16","\u90aa\u6708","\u79bb\u706b","\u662d\u5929","\u81ea\u5728","\u900d\u9065","\u711a\u6708","\u711a\u706b","\u9752\u4e91","\u5929\u706b","\u7d2b\u7535","\u9752\u971c","\u5bd2\u971c","\u7f57\u5239","\u5954\u96f7","\u7eaf\u9633","\u7eaf\u9634","\u9738\u5200","\u9738\u6c14","\u9738","\u7384\u9f9f","\u5730\u7f61","\u592a\u6613","\u9633\u96f7","\u9634\u96f7","\u5929\u6cfd","\u98ce\u5929","\u767b\u5929","\u7384\u96f7","\u7d2b\u5e9c","\u5927\u5730","\u4e09\u9634","\u6df7\u7075","\u957f\u751f","\u7384\u7075","\u5143\u7075","\u767b\u865a","\u711a\u5fc3","\u707e\u661f","\u6458\u661f","\u9006\u751f","\u767d\u9f99","\u5316\u9f99","\u51cc\u4e91","\u5c71\u6cb3","\u9aa8\u4e4b","\u9b54\u5316","\u5996\u5316"],this.t.addition_endList=["\u738b\u4f53","\u4f53","\u8840\u8109","\u6218\u4f53","\u5251\u4f53","\u7075\u8109","\u6218\u8109"];var v=new c;v.id="specialBody_name5",v.onlyByTemplate=!0,v.templates=["part1","addition_end"],this.add(v),this.t.partsList=["\u4eba\u7687","\u5996","\u4ed9","\u5723","\u9b54","\u70c8\u7130","\u6781\u5bd2","\u5384\u8fd0","\u5384\u6bd2","\u5927\u65e5","\u5927\u7f57","\u540e\u571f","\u4e0d\u6b7b","\u4e0d\u706d","\u541e\u566c","\u865a\u7a7a","\u5929\u5996","\u5148\u5929","\u9053","\u4e94\u884c","\u4ed9\u7075","\u6708\u4eae","\u5915\u65e5","\u661f\u6cb3","\u86ee\u96f7","\u96f7\u9706","\u98ce\u66b4","\u5996\u9b54","\u9b3c","\u5341\u65b9","\u516b\u65b9","\u8f6e\u56de","\u73b2\u73d1","\u4e07\u5384","\u5927\u711a","\u4e07\u53e4","\u957f\u9752","\u91cd\u77b3","\u5e7d\u5bd2","\u4e5d\u9633","\u4e5d\u9634","\u5341\u7edd","\u661f\u8fb0","\u6b7b\u4ea1","\u5815\u843d","\u65e5\u6708","\u4e07\u68ee","\u7a7a\u95f4","\u865a\u5e7b","\u51e4\u9f99","\u9006\u5929","\u90aa\u901a","\u5929","\u6597\u6218","\u7384\u59f9","\u4e07\u9053","\u6ce3\u8840","\u4e07\u836f","\u592a\u6781","\u65e0\u654c","\u9f99\u51e4","\u7384\u6b66","\u663c\u591c","\u663c\u5929","\u5dc5\u5cf0","\u98de\u4ed9","\u7834\u7a79","\u957f\u751f","\u5723\u6cc9","\u541e\u5730","\u65e0\u57a2","\u7fbd\u5316","\u5927\u8352","\u592a\u4e0a","\u9738\u8840","\u5723\u8840","\u795e\u8840","\u5316\u7981","\u6697","\u5149","\u711a","\u711a\u5929","\u68b5\u97f3","\u6bd2","\u7965\u745e","\u4e0d\u7965","\u5929\u715e","\u65f6\u5149","\u4e03\u6740","\u5e7d\u51a5","\u8be1\u5320","\u8be1\u5f02","\u9020\u5316","\u8d2a\u5a6a","\u8d2a\u5929","\u751f\u6b7b","\u72f1\u706b","\u91cd\u6c34","\u5929\u6781","\u5929\u91d1","\u4e07\u68ee","\u539a\u571f","\u4ed9\u6781","\u6e05\u6d9f","\u8bdb\u4ed9","\u65ad\u5929","\u9b54\u9b42","\u5723\u9b54","\u5c01\u9b54","\u5c01\u4ed9","\u5c01\u5929","\u5c01\u7075","\u5e7b\u591c","\u6e05\u98ce","\u660e\u6708","\u8d64\u9704","\u5927\u590f","\u65f6\u4e4b","\u7edd\u4ee3","\u865a\u7a7a","\u592a\u4e59","\u7384\u5929","\u6258\u6708","\u4e09\u751f","\u7ea2\u5c18","\u4e7e\u5764","\u6e21\u4e16","\u795e\u9b54","\u5929\u7f61","\u9020\u5316","\u7476\u6c60","\u5929\u8c34","\u5723\u7075","\u4e0a\u5584","\u5bc2\u706d","\u4e5d\u5143","\u8352","\u9053","\u5251","\u6c38\u751f","\u9053\u6e90","\u4e5d\u5e7d","\u4e09\u6e05","\u539f\u521d","\u5927\u5723","\u6d6e\u751f","\u6df7\u4e71","\u65e7\u65e5"],this.t.addition_endList=["\u7687\u4f53","\u4e4b\u4f53","\u8840\u8109","\u4ed9\u4f53","\u5251\u4f53","\u9b54\u4f53","\u5996\u4f53","\u5c0a\u4f53","\u4ed9\u8109","\u9b42\u4f53","\u7687\u8109","\u53e4\u4f53"];var b=new c;b.id="specialBody_name6",b.onlyByTemplate=!0,b.templates=["part1","addition_end"],this.add(b),this.t.partsList=["\u8352\u53e4","\u65e0\u6781","\u6df7\u6c8c","\u6c38\u6052","\u516d\u9053","\u7981\u5fcc","\u865a\u5984","\u5927\u9053","\u9634\u9633","\u592a\u9633","\u592a\u9634","\u9547\u72f1","\u86ee\u8352","\u8352\u829c","\u51cc\u9704","\u65e0\u59cb","\u5929\u9b54","\u9ed1\u6697","\u5149\u660e","\u9752\u83b2","\u541e\u5929","\u8352\u53e4","\u9633\u9633","\u592a\u865a","\u4e0d\u6b7b","\u541e\u566c","\u661f\u7a7a","\u6d2a\u8352","\u6bc1\u706d","\u521b\u4e16","\u5ba1\u5224","\u5929\u9053","\u8f6e\u56de","\u7981\u5fcc","\u592a\u4e00","\u539f\u59cb","\u7d2b\u8587","\u82cd\u5929","\u4e0a\u82cd","\u4ed9\u9053","\u771f\u6b66","\u81f3\u5c0a","\u7956\u9f99","\u4ed9\u51e4","\u82cd\u7a79","\u6c38\u6052","\u65f6\u7a7a","\u542f\u6e90","\u5f80\u751f","\u75f4\u611a","\u5c79\u6602","\u5e7d\u51a5","\u9762\u5305","\u661f\u68cb\u76d8","\u76df\u4e3b","\u4e34\u6e0a","\u4eba\u95f4"],this.t.addition_endList=["\u5723\u4f53","\u5e1d\u4f53","\u5e1d\u8109","\u795e\u4f53","\u4ed9\u4f53","\u7981\u8109","\u9053\u4f53","\u9b54\u4f53","\u795e\u8109","\u4ed9\u8109","\u5723\u8109","\u4e4b\u6e90","\u7981\u4f53"]},e.prototype.addAddtion_endList=function(t){this.t.addition_endList=t,c.familyNameTotal.addRange(t)},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=s.default.fromJson(i,new c);return o.id=t,this.add(o),o},e}(l.default);n.default=d,cc._RF.pop()},{}],CitiesElement:[function(t,e,i){"use strict";cc._RF.push(e,"18de2CePgVJt4VXBqZBendT","CitiesElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ToolBox"),c=a("ViewController"),d=a("Config"),u=a("TextureLoader"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.city=null,e.text_name=null,e.population=null,e.army=null,e.zones=null,e.age=null,e.raceIcon=null,e.banner=null,e}return r(e,t),e.prototype.initItem=function(t){var e,i,o,a;this.city=t,this.showBanner(),this.text_name.string=t.data.cityName,this.text_name.node.color=t.kingdom.kingdomColor.colorBorderOut,this.population.string=null!==(e=t.getPopulationTotal().toString())&&void 0!==e?e:"",this.army.string=null!==(i=t.getArmy().toString())&&void 0!==i?i:"",this.zones.string=null!==(o=t.zones.length.toString())&&void 0!==o?o:"",this.age.string=null!==(a=t.data.age.toString())&&void 0!==a?a:"",this.raceIcon.spriteFrame=u.TextureLoader.inst.getSpriteFrame(u.ATLAS_TYPE.UIATLAS,"icons/"+t.race.icon)},e.prototype.showBanner=function(){var t,e="banners/"+this.city.race.bannerId+"/background/banner_part_background"+l.Toolbox.randomInt(0,8),i="banners/"+this.city.race.bannerId+"/icon/banner_part_object"+l.Toolbox.randomInt(0,8),o=this.banner.getComponent(cc.Sprite);o.node.color=null===(t=this.city.kingdom.kingdomColor)||void 0===t?void 0:t.colorBorderOut,o.spriteFrame=u.TextureLoader.inst.getSpriteFrame(u.ATLAS_TYPE.WORLDATLAS,e);var a=this.banner.getChildByName("icon").getComponent(cc.Sprite);a.node.color=this.city.kingdom.kingdomColor.colorBorderBannerIcon,a.spriteFrame=u.TextureLoader.inst.getSpriteFrame(u.ATLAS_TYPE.WORLDATLAS,i)},e.prototype.click=function(){d.default.selectedCity=this.city,d.default.selectedCity&&c.default.open(c.view_type.CityWindow)},s([f(cc.Label)],e.prototype,"text_name",void 0),s([f(cc.Label)],e.prototype,"population",void 0),s([f(cc.Label)],e.prototype,"army",void 0),s([f(cc.Label)],e.prototype,"zones",void 0),s([f(cc.Label)],e.prototype,"age",void 0),s([f(cc.Sprite)],e.prototype,"raceIcon",void 0),s([f(cc.Node)],e.prototype,"banner",void 0),s([p],e)}(cc.Component);n.default=_,cc._RF.pop()},{}],CitiesListWindow:[function(t,e,i){"use strict";cc._RF.push(e,"0aeadHVXkJCyKsvUj6xz9WB","CitiesListWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GamePopBase"),d=a("Config"),u=a("MapBox"),h=a("CitiesElement"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabElement=null,e.content=null,e}return r(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.showList()},e.prototype.showList=function(){var t,e;if(d.default.gameLoaded){u.default.inst.citiesList.sort(function(t,e){return t.getPopulationTotal()-e.getPopulationTotal()});try{for(var i=l(u.default.inst.citiesList),o=i.next();!o.done;o=i.next()){var a=o.value;this.showElement(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}},e.prototype.showElement=function(t){var e=cc.instantiate(this.prefabElement);e.parent=this.content,e.getComponent(h.default).initItem(t)},s([_(cc.Prefab)],e.prototype,"prefabElement",void 0),s([_(cc.Node)],e.prototype,"content",void 0),s([f],e)}(c.GamePopBase);n.default=m,cc._RF.pop()},{}],CityBehBorderGrowth:[function(t,e,i){"use strict";cc._RF.push(e,"1433aQh6mBPdLxaqWA6zit6","CityBehBorderGrowth");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("BehaviourActionCity"),c=a("ToolBox"),d=function(t){function e(){var e=t.call(this)||this;return e.nextWave=[],e.wave=[],e.checked_regions=new Set,e._bestDist=0,e._bestZone=null,e._dist=0,e._cityTile=null,e.id="CityBehBorderGrowth",e}return r(e,t),e.prototype.execute=function(t){return 0==t.getPopulationTotal()?s.BehResult.Stop:t.zones.length>=t.status.maximumZones?s.BehResult.Stop:(this.newGrowth(t),s.BehResult.Continue)},e.prototype.newGrowth=function(t){if(this._cityTile=t.getTile(),this._cityTile)if(this._cityTile.zone.city==t){for(this.wave=[],this.nextWave=[],this.checked_regions.clear(),this._dist=0,this._bestDist=0,this._bestZone=null,this.wave.push(this._cityTile.region);this.wave.length>0&&(this.startWave(),this.nextWave.length>0&&(this.wave.addRange(this.nextWave),this.nextWave=[]),!this._bestZone););this.checked_regions.clear(),this._bestZone&&t.addZone(this._bestZone)}else t.addZone(this._cityTile.zone)},e.prototype.startWave=function(){for(var t=null;this.wave.length>0;){t=this.wave.pop(),this.checked_regions.add(t);for(var e=0;e<t.neighbours.length;e++){var i=t.neighbours[e];this.checked_regions.has(i)||(this.checked_regions.add(i),this.checkForBestRegion(i,this.nextWave,!0))}}},e.prototype.checkForBestRegion=function(t,e,i){void 0===i&&(i=!1),0==t.type&&(t.zone.city==this._cityTile.zone.city&&e.push(t),i&&!t.zone.city&&(this._dist=c.Toolbox.distVec3(this._cityTile.posV3,t.zone.centerTile.posV3),(!this._bestZone||this._dist<this._bestDist)&&(this._bestDist=this._dist,this._bestZone=t.zone)))},e}(l.default);n.default=d,cc._RF.pop()},{}],CityBehBorderSteal:[function(t,e,i){"use strict";cc._RF.push(e,"59847LSKwJDdoAdGTiGfwbu","CityBehBorderSteal");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("BehaviourActionCity"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehBorderSteal",e}return r(e,t),e.prototype.execute=function(t){if(!d.default.inst.worldLaws.world_law_border_stealing.boolVal)return l.BehResult.Stop;if(0==t.getPopulationTotal())return l.BehResult.Stop;if(t.zones.length>=t.status.maximumZones)return l.BehResult.Stop;if(0==t.buildings.length)return l.BehResult.Stop;for(var e=0;e<3&&!this.tryStealZone(t);e++);return l.BehResult.Continue},e.prototype.tryStealZone=function(t){var i,o,a,n,r,l;e._zones=[];var c=null===(l=null===(r=null===(n=null===(a=null==t?void 0:t.buildings)||void 0===a?void 0:a.getRandom())||void 0===n?void 0:n.currentTile)||void 0===r?void 0:r.zone)||void 0===l?void 0:l.neighbours;if(!c||0==c.length)return!1;try{for(var d=s(c),u=d.next();!u.done;u=d.next()){var h=u.value;if(h.city&&h.city!=t&&h.buildings.size<=0&&h.city.kingdom.isEnemy(t.kingdom))return this.stealZone(h,t),!0}}catch(p){i={error:p}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}return!1},e.prototype.stealZone=function(t,e){t.city&&t.city.removeZone(t),e.addZone(t)},e._zones=[],e}(c.default);n.default=u,cc._RF.pop()},{}],CityBehBuildDocks:[function(t,e,i){"use strict";cc._RF.push(e,"cd69aL71A9CSpNlvOG2fyTL","CityBehBuildDocks");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("BehaviourActionCity"),c=a("MapBox"),d=a("CityBehBuild"),u=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehBuildDocks",e}return r(e,t),e.prototype.execute=function(t){var e=d.default.getDockTile(t);return e?(c.default.inst.flashEffects.flashPixel(e,10),d.default.tryToBuild(t,"docks_"+t.race.id),s.BehResult.Continue):s.BehResult.Continue},e}(l.default);n.default=u,cc._RF.pop()},{}],CityBehBuild:[function(t,e,i){"use strict";cc._RF.push(e,"4785aJXdchP1JxlyfuMNLWF","CityBehBuild");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MapAction"),c=a("AssetManager"),d=a("BaseBuilding"),u=a("BehaviourActionBase"),h=a("BehaviourActionCity"),p=a("CityBuildOrder"),f=a("OceanHelper"),_=a("ToolBox"),m=a("Config"),g=a("GameAudio"),y=a("TileTypeBase"),v=a("MapBox"),b=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehBuild",e}return r(e,t),e.prototype.execute=function(t){return t.isGettingCaptured()?u.BehResult.Continue:(e.buildTick(t),u.BehResult.Continue)},e.buildTick=function(t){var i,o,a,n,r,l=t.getCulture();if(t.buildings.length>2&&(null==l?void 0:l.haveTech("building_roads"))){var d=t.buildings.getRandom();d&&e.makeRoadsBuildings(t,d)}if(!(t.tasks.fire>0)){if(!t.underConstructionBuilding)try{for(var u=s(t.buildings.list),h=u.next();!h.done;h=u.next()){var f=h.value;if(null===(r=f.data)||void 0===r?void 0:r.underConstruction){t.underConstructionBuilding=f;break}}}catch(B){i={error:B}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}if(!t.underConstructionBuilding){t._debug_nextPlannedBuilding=null;var _="";try{for(var g=s(p.default.list),y=g.next();!y.done;y=g.next()){var v=y.value,b=v.buildingID;if(v.addRace&&(b=b+"_"+t.race.id),!v.usedByRacesCheck||v.usedByRaces.includes(t.race.id)){var w=c.default.buildings.get(b);if(t._debug_nextPlannedBuilding=w.type,!w.tech||(null==l?void 0:l.haveTech(w.tech))){var T=t.getLimitOfBuildings(v);if(!(v.checkFullVillage&&0!=t.status.homesFree||0!=v.limitID&&t.countBuildingsID(b)>=v.limitID||0!=T&&t.countBuildingsType(w.type)>=T||t.status.population<v.requiredPop||t.buildings.length<v.requiredBuildings))if(t.haveEnoughResourcesFor(w.cost)){if(!w.docks||e.getDockTile(t)){_=b;break}}else if(v.waitForResources)return}}}}catch(S){a={error:S}}finally{try{y&&!y.done&&(n=g.return)&&n.call(g)}finally{if(a)throw a.error}}if(_){var k=e.tryToBuild(t,_);k&&(m.default.fastCities&&(k&&k.updateBuild(1e3),t.underConstructionBuilding=null),(null==l?void 0:l.haveTech("building_roads"))&&k&&e.makeRoadsBuildings(t,k))}}}},e.tryToBuild=function(t,i){var o,a,n=c.default.buildings.get(i);if(!t.haveEnoughResourcesFor(n.cost))return null;var r=null;if(e._zones_with_buildings=[],e._zones_no_buildings=[],n.buildingPlacement==p.CityBuildingPlacement.Borders)r=e.tryToBuildInZones(e.getZonesForTower(t),n,t);else if(n.docks)r=e.getDockTile(t);else{try{for(var l=s(t.zones),d=l.next();!d.done;d=l.next()){var u=d.value;if(0!=u.buildings.size){for(var h=0;h<u.neighboursAll.length;h++){var f=u.neighboursAll[h];e._zones_with_buildings.includes(f)||e._zones_with_buildings.push(f)}e._zones_with_buildings.push(u)}else e._zones_no_buildings.push(u)}}catch(b){o={error:b}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}e._zones_with_buildings.shuffle(),(r=e.tryToBuildInZones(e._zones_with_buildings,n,t))||(e._zones_no_buildings.shuffle(),r=e.tryToBuildInZones(e._zones_no_buildings,n,t))}if(!r)return null;var _=v.default.inst.addBuilding(n.id,r);return t.addBuilding(_),t.underConstructionBuilding=_,_.data.underConstruction=!0,_.setSpriteUnderConstruction(),t.spendResourcesFor(n.cost),g.default.playConstructing(_.node.position),_},e.tryToBuildInZones=function(t,i,o){var a,n,r,l,c=null;try{for(var u=s(t),h=u.next();!h.done;h=u.next()){var p=h.value;if(p.tiles.shuffle(),o.race.buildingPlacements==d.BuildingPlacements.Random||i.docks)try{for(var f=(r=void 0,s(p.tiles)),m=f.next();!m.done;m=f.next()){var g=m.value;if(e.isGoodTileForBuilding(g,i,o))return c=g}}catch(b){r={error:b}}finally{try{m&&!m.done&&(l=f.return)&&l.call(f)}finally{if(r)throw r.error}}else if(o.race.buildingPlacements==d.BuildingPlacements.Center&&e.isGoodTileForBuilding(p.centerTile,i,o))return c=p.centerTile,_.Toolbox.randomChance(.8)?c.neighboursAll.getRandom():c}}catch(y){a={error:y}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return c},e.isGoodTileForBuilding=function(t,e,i){return!!t.canBuildOn(e)&&v.default.inst.canBuildFrom(t,e,i)},e.debugRoards=function(t,i){e.makeRoadsBuildings(t,i)},e.makeRoadsBuildings=function(t,e){var i,o;if(!(t.roadTilesToBuild.length>0)&&(null===(i=null==e?void 0:e.stats)||void 0===i?void 0:i.buildRoadTo)){var a=e.currentTile;if(null===(o=a.type)||void 0===o||!o.liquid){var n=[];if(t.buildings.list.forEach(function(t){var i,o,a;t!=e&&(null===(i=null==t?void 0:t.stats)||void 0===i?void 0:i.buildRoadTo)&&!(null===(o=t.currentTile)||void 0===o?void 0:o.type.liquid)&&(null===(a=t.currentTile)||void 0===a?void 0:a.isSameIsland(e.currentTile))&&n.push(t.currentTile)}),0!=n.length){var r=!1;m.default.fastCities&&(r=!0);var s=_.Toolbox.getClosestTile(n,a);s&&(n.remove(s),l.default.makeRoadBetween(s,a,t,r)),(s=_.Toolbox.getClosestTile(n,a))&&(n.remove(s),l.default.makeRoadBetween(s,a,t,r))}}}},e.getZonesForTower=function(t){for(var e=[],i=0;i<t.zones.length;i++)for(var o=t.zones[i],a=0;a<o.neighboursAll.length;a++)o.neighboursAll[a].city==t||e.includes(o)||e.push(o);return e.length<=0?null:e},e.getDockTile=function(t){var e,i,o,a,n,r,l=c.default.buildings.get("docks_"+t.race.id),d=null;if(f.default.clearOceanPools(),f.default.saveOceanPoolsWithDocks(t),!t.getTile())return null;try{for(var u=s(t.zones),h=u.next();!h.done;h=u.next()){var p=h.value,_=p.centerTile.chunk;if(!(0==p.tilesWithLiquid||_.regions.length<=1)){var m=!1;try{for(var g=(o=void 0,s(_.regions)),b=g.next();!b.done;b=g.next()){var w=b.value;if(w.type==y.TileLayerType.Ocean){if(!f.default.goodForNewDock(w.tiles[0]))continue;m=!0}}}catch(S){o={error:S}}finally{try{b&&!b.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(m&&m){p.tiles.shuffle();try{for(var T=(n=void 0,s(p.tiles)),k=T.next();!k.done;k=T.next()){var B=k.value;if(B.type.ocean&&v.default.inst.canBuildFrom(B,l,t)){d=B;break}}}catch(C){n={error:C}}finally{try{k&&!k.done&&(r=T.return)&&r.call(T)}finally{if(n)throw n.error}}if(d)return d}}}}catch(x){e={error:x}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}return d},e._zones_with_buildings=[],e._zones_no_buildings=[],e}(h.default);n.default=b,cc._RF.pop()},{}],CityBehCheckArmy:[function(t,e,i){"use strict";cc._RF.push(e,"34bd6nj+vpHkbwXL1nAI1tt","CityBehCheckArmy");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("BehaviourActionCity"),c=a("MapBox"),d=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehCheckArmy",e}return r(e,t),e.prototype.execute=function(t){var e,i=t.getCulture();return i&&i.haveTech("weapon_production")?0==t.getArmy()?s.BehResult.Continue:((null===(e=t.army)||void 0===e?void 0:e.isAlive())||(t.army=null),t.army?s.BehResult.Continue:(t.army=c.default.inst.unitGroupManager.createNewGroup(t),s.BehResult.Continue)):s.BehResult.Continue},e}(l.default);n.default=d,cc._RF.pop()},{}],CityBehCheckAttackZone:[function(t,e,i){"use strict";cc._RF.push(e,"a9d46jDjgNHM6LsDVBJLTho","CityBehCheckAttackZone");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehCheckAttackZone",e}return r(e,t),e.prototype.execute=function(t){var e,i;if((null===(i=null===(e=t.attackZone)||void 0===e?void 0:e.city)||void 0===i?void 0:i.alive)&&t.attackZone.city.kingdom.isEnemy(t.kingdom)||(t.attackZone=null),t.attackZone)return s.BehResult.Continue;if(t.kingdom.target_kingdom)if(t.kingdom.checkTarget(),t.kingdom.target_city){if(t.kingdom.target_city.buildings.length>0){var o=t.kingdom.target_city.buildings.getRandom();t.attackZone=o.currentTile.zone}}else t.kingdom.clearTarget();else t.attackZone=null;return s.BehResult.Continue},e}(a("BehaviourActionCity").default);n.default=l,cc._RF.pop()},{}],CityBehCheckCitizenTasks:[function(t,e,i){"use strict";cc._RF.push(e,"c1cadbHTlZDlKryyS5++roH","CityBehCheckCitizenTasks");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("ActorAsset"),d=a("TopTileLibrary"),u=a("BaseBuilding"),h=a("BehaviourActionBase"),p=a("BehaviourActionCity"),f=a("MapBox"),_=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehCheckCitizenTasks",e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a=t.tasks,n=t.jobs,r=t.status,p=t.getCulture();n.clearTasks(),a.trees=0,a.stone=0,a.ore=0,a.mine=0,a.gold=0,a.bushes=0,a.ruins=0,a.farmFields=0,a.canBeFarms=0,a.roads=0,a.wheats=0,a.fire=0,a.metal=t.data.storage.get("ore");for(var _=0;_<t.neighbourZones.length;_++){var m=t.neighbourZones[_];a.fire+=m.tilesOnFire}for(_=0;_<t.zones.length;_++){var g=t.zones[_];a.fire+=g.tilesOnFire,a.trees+=g.trees.size,a.stone+=g.stone.size,a.ore+=g.ore.size,a.gold+=g.gold.size,a.ruins+=g.ruins.size,a.canBeFarms+=g.countCanBeFarms(),g.food.forEach(function(t){t.haveResources&&a.bushes++});var y=g.getTilesOfType(d.default.field);if(y)try{for(var v=(e=void 0,s(y)),b=v.next();!b.done;b=v.next()){var w=b.value;w.building?(null===(o=w.building.stats)||void 0===o?void 0:o.buildingType)!=u.BuildingType.Wheat||w.building.canBeUpgraded()||a.wheats++:a.farmFields++}}catch(F){e={error:F}}finally{try{b&&!b.done&&(i=v.return)&&i.call(v)}finally{if(e)throw e.error}}}t.haveBuildingType("mine")&&(a.mine=r.population/20,n.jobs.set("miner",a.mine)),a.fire>0&&n.addJob("fireman",a.fire);var T=0;if(a.stone>0&&t.data.storage.get("stone")<999&&(T+=a.stone),a.gold>0&&t.data.storage.get("gold")<999&&(T+=a.gold),a.ore>0&&t.data.storage.get("ore")<999&&(T+=a.ore),T>r.population/10&&(T=r.population/10),T>0&&n.addJob("miner_deposit",T),a.metal>0&&n.addJob("metalworker",r.population/20,t.data.storage.get("ore")),r.population>60?n.addJob("blacksmith",3):r.population>30?n.addJob("blacksmith",2):r.population>15&&n.addJob("blacksmith",1),t.settleTarget)if(f.default.inst.worldLaws.world_law_kingdom_expansion.boolVal&&r.population>30&&f.default.inst.cityPlaceFinder.zones.length>0||r.population>30&&r.homesFree<5){var k=r.population/20+1;k>7&&(k=7),n.jobs.set("settler",k)}else n.jobs.set("settler",0);if(r.population>20){var B=r.population/20+1;B>3&&(B=3),n.jobs.set("hunter",B)}if(a.bushes>0&&n.jobs.set("gatherer",l.default.clamp(r.population/10+1,1,3)),t.roadTilesToBuild.length>0&&(a.roads=1,n.jobs.set("road_builder",1)),a.ruins>0&&n.jobs.set("cleaner",1),a.trees>0&&t.data.storage.get("wood")<100){var S=l.default.clamp(a.trees,1,3);n.jobs.set("woodcutter",l.default.clamp(r.population/10+1,1,S))}t.getBuildingToBuild()&&n.jobs.set("builder",l.default.clamp(r.population/10+1,1,3));var C=r.population/5+1;a.farmFields<C&&C<128&&n.jobs.set("farmer_plower",1);var x=C/2+1;(a.wheats>0||a.farmFields>0)&&n.jobs.set("farmer",x),n.occupied.clear();for(var A=t.units.getSimpleList(),P=0;P<A.length;P++){var O=A[P];if(O.ai.job&&O.ai.job.cityJob){n.occupied.has(O.ai.job.id)||n.occupied.set(O.ai.job.id,0);var R=n.occupied.get(O.ai.job.id)+1;n.occupied.set(O.ai.job.id,R)}}return r.populationAdults>15&&(r.populationAdults<50?r.warriorSlots=l.default.intCast(.4*r.populationAdults+1):r.warriorSlots=l.default.intCast(.85*r.populationAdults+1),r.warriorSlots>t.getArmyMaxLeader()&&(r.warriorSlots=t.getArmyMaxLeader()),p&&(r.warriorSlots+=l.default.intCast(p.stats.bonus_max_army.value)),n.jobs.set("attacker",r.warriorSlots)),r.warriorCurrent=t.countProfession(c.UnitProfession.Warrior),h.BehResult.Continue},e}(p.default);n.default=_,cc._RF.pop()},{}],CityBehCheckCulture:[function(t,e,i){"use strict";cc._RF.push(e,"70519bek71Do6M9Gl9p50+z","CityBehCheckCulture");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("BehaviourActionCity"),c=a("Culture"),d=a("MapBox"),u=function(t){function e(){var e=t.call(this)||this;return e._counters_dict=new Map,e._counters_list=[],e.id="CityBehCheckCulture",e}return r(e,t),e.prototype.execute=function(t){return this.recalcMainCulture(t),this.tryToCreateNewCultureFromBonfire(t),this.spreadMainCultureFromBonfire(t),s.BehResult.Continue},e.prototype.recalcMainCulture=function(t){this._counters_dict.clear(),this._counters_list=[];for(var e=0;e<t.zones.length;e++){var i=t.zones[e];i.culture&&((o=this._counters_dict.get(i.culture))||(o=new c.CultureMainCounter(i.culture),this._counters_dict.set(i.culture,o),this._counters_list.push(o)),o.amount++)}for(e=0;e<t.units.length;e++){var o,a=t.units.list[e].getCulture();a&&((o=this._counters_dict.get(a))||(o=new c.CultureMainCounter(a),this._counters_dict.set(a,o),this._counters_list.push(o)),o.amount++)}if(this._counters_list.length>0){this._counters_list.sort(function(t,e){return t.amount-e.amount});var n=this._counters_list[0].culture;t.setCulture(n)}},e.prototype.tryToCreateNewCultureFromBonfire=function(t){if(!t.getCulture()){var e=t.getBuildingType("bonfire");e&&!e.currentTile.zone.culture&&this.setNewCultureForCity(t)}},e.prototype.spreadMainCultureFromBonfire=function(t){var e=t.getCulture(),i=t.getBuildingType("bonfire");if(i&&e){var o=i.currentTile.zone;o.culture||e.addZone(o)}},e.prototype.setNewCultureForCity=function(t){if(t.data.culture)return null;var e=d.default.inst.cultures.newCulture(t.race,t);return t.setCulture(e),e},e}(l.default);n.default=u,cc._RF.pop()},{}],CityBehCheckPopPoints:[function(t,e,i){"use strict";cc._RF.push(e,"64e47SGTsBC6o8xKr0qwuDP","CityBehCheckPopPoints");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("BehaviourActionCity"),d=a("City"),u=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehCheckPopPoints",e}return r(e,t),e.prototype.execute=function(t){var i,o,a,n,r,c;if(0==t.data.popPoints.length)return l.BehResult.Continue;e._temp_actors=[],e._temp_buildings=[];var u=t.getPopulationUnits(),h=0,p=0;if(t.jobs.jobs.forEach(function(e,i){h=e,t.jobs.occupied.has(i)&&t.jobs.occupied.get(i),p+=h}),p<=u)return l.BehResult.Continue;var f=p-u;if(f<0)return l.BehResult.Continue;e._temp_actors=[];var _=t.buildings.getSimpleList();_.shuffle();try{for(var m=s(_),g=m.next();!g.done;g=m.next()){var y=g.value;if(!(null===(a=y.data)||void 0===a?void 0:a.underConstruction)&&(null===(n=y.data)||void 0===n?void 0:n.alive)&&!(null===(r=y.stats)||void 0===r?void 0:r.isRuin)&&0!=(null===(c=y.stats)||void 0===c?void 0:c.housing)&&(e._temp_buildings.push(y),e._temp_buildings.length>f))break}}catch(T){i={error:T}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}if(0==e._temp_buildings.length)return l.BehResult.Continue;f>10&&(f=10);for(var v=0;v<f;v++){var b=d.default.getActorDataPopPoint(t);if(!b)break;var w=e._temp_buildings.getRandom();t.spawnPopPoint(b,w.currentTile)}return l.BehResult.Continue},e._temp_actors=[],e._temp_buildings=[],e}(c.default);n.default=u,cc._RF.pop()},{}],CityBehCheckSettleTarget:[function(t,e,i){"use strict";cc._RF.push(e,"fc520BSAVNHtaaGDD+FJCwj","CityBehCheckSettleTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("BehaviourActionCity"),d=a("ToolBox"),u=a("MapBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehCheckSettleTarget",e}return r(e,t),e.prototype.execute=function(t){var e,i,o;if(!(null==t?void 0:t.alive))return l.BehResult.Stop;if(t.status.population<30)return t.settleTarget=null,l.BehResult.Continue;if(t.settlerTargetTimer>0)return l.BehResult.Continue;t.settleTarget=null;var a=t.getTile();if(!a)return l.BehResult.Continue;var n=null,r=0,c=0;if(!n){t.kingdom.cities.shuffle();try{for(var h=s(t.kingdom.cities),p=h.next();!p.done;p=h.next()){var f=p.value;if(f!=t&&f.status.population<30){n=null===(o=f.getTile())||void 0===o?void 0:o.zone;break}}}catch(_){e={error:_}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(e)throw e.error}}}return!n&&u.default.inst.cityPlaceFinder.zones.length>0&&(u.default.inst.cityPlaceFinder.zones.forEach(function(t){t.centerTile.isSameIsland(a)&&(c=d.Toolbox.distTile(t.centerTile,a),(!n||c<r)&&(r=c,n=t))}),n||u.default.inst.cityPlaceFinder.zones.forEach(function(t){c=d.Toolbox.distTile(t.centerTile,a),(!n||c<r)&&(r=c,n=t)})),n?(t.settlerTargetTimer=d.Toolbox.randomFloat(100,400),t.settleTarget=n,l.BehResult.Continue):l.BehResult.Continue},e}(c.default);n.default=h,cc._RF.pop()},{}],CityBehFindLeader:[function(t,e,i){"use strict";cc._RF.push(e,"34c91c0MmZGIoJH2Cr+zed0","CityBehFindLeader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorAsset"),l=a("ActorTool"),c=a("BehaviourActionBase"),d=a("BehaviourActionCity"),u=a("City"),h=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehFindLeader",e}return r(e,t),e.prototype.execute=function(t){if(t.units.length<10)return c.BehResult.Continue;if(t.leader)return c.BehResult.Continue;if(t.captureTicks>0)return c.BehResult.Continue;for(var e=null,i=0,o=0,a=1,n=0;n<t.units.list.length;n++){var r=t.units.list[n];a=1,r.data.profession==s.UnitProfession.Unit&&(r.data.favorite&&(a+=2),i=l.default.attributeDice(r,a),(!e||i>o)&&(e=r,o=i))}return e&&u.default.makeLeader(e,t),c.BehResult.Continue},e}(d.default);n.default=h,cc._RF.pop()},{}],CityBehGiveInventoryItem:[function(t,e,i){"use strict";cc._RF.push(e,"c520ax7l9JDVJNBEqTgU0Or","CityBehGiveInventoryItem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ActorAsset"),c=a("ActorEquipment"),d=a("BehaviourActionBase"),u=a("BehaviourActionCity"),h=a("City"),p=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehGiveInventoryItem",e}return r(e,t),e.prototype.execute=function(t){var e,i,o=c.default.getList(t.data.storage.itemStorage);if(0==o.length)return d.BehResult.Stop;try{for(var a=s(o),n=a.next();!n.done;n=a.next()){var r=n.value;t.kingdom.king&&h.default.giveItem(t.kingdom.king,r,t)||t.leader&&h.default.giveItem(t.leader,r,t)||!(t.countProfession(l.UnitProfession.Warrior)>0)||h.default.giveItem(t.professionsDict.get(l.UnitProfession.Warrior).getRandom(),r,t)}}catch(u){e={error:u}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return d.BehResult.Continue},e}(u.default);n.default=p,cc._RF.pop()},{}],CityBehProduceBoat:[function(t,e,i){"use strict";cc._RF.push(e,"a6fc2jmoK1EPKoyo3rOqbkh","CityBehProduceBoat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Boat"),l=a("BehaviourActionBase"),c=a("BehaviourActionCity"),d=a("Docks"),u=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehProduceBoat",e}return r(e,t),e.prototype.execute=function(t){if(t.boatBuildTimer>0)return l.BehResult.Stop;if(!t.haveBuildingType("docks"))return l.BehResult.Stop;var e=t.getBuildingType("docks",!0,!0);if(!e)return l.BehResult.Stop;var i=e.getComponent(d.default).buildBoatFromHere(t);return i?(i.setKingdom(t.kingdom),i.getComponent(s.default).updateTexture(),i.setCity(t),t.boatBuildTimer=10,l.BehResult.Continue):l.BehResult.Stop},e}(c.default);n.default=u,cc._RF.pop()},{}],CityBehProduceResources:[function(t,e,i){"use strict";cc._RF.push(e,"0dd26fGepBEdLQ67qAB3b4V","CityBehProduceResources");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("AssetManager"),d=a("BehaviourActionBase"),u=function(t){function e(){var e=t.call(this)||this;return e.workers=0,e.id="CityBehProduceResources",e}return r(e,t),e.prototype.execute=function(t){var e=this;return t.race.production.shuffle(),t.race.production.forEach(function(i){e.workers=l.default.intCast(t.status.population/10+1),e.tryToProduce(i,t)}),d.BehResult.Continue},e.prototype.tryToProduce=function(t,e){for(var i,o,a=c.default.resources.get(t),n=0;n<this.workers;n++){if(e.data.storage.get(t)==a.maximum)return!1;var r=a.ingredients;try{for(var l=(i=void 0,s(r)),d=l.next();!d.done;d=l.next()){var u=d.value;if(e.data.storage.get(u)<a.ingredientsAmount)return!1}}catch(h){i={error:h}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}(r=a.ingredients).forEach(function(t){e.data.storage.change(t,-a.ingredientsAmount)}),e.data.storage.change(t)}return!0},e}(a("BehaviourActionCity").default);n.default=u,cc._RF.pop()},{}],CityBehProduceUnit:[function(t,e,i){"use strict";cc._RF.push(e,"b9a8fUkK1NB2q3OAtF6DyW2","CityBehProduceUnit");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Constants"),l=a("ActorBase"),c=a("ActorStatus"),d=a("ActorTool"),u=a("AssetManager"),h=a("BehaviourActionBase"),p=a("BehaviourActionCity"),f=a("ChineseNameGenerator"),_=a("FamilysManager"),m=a("ToolBox"),g=a("MapBox"),y=function(t){function e(){var e=t.call(this)||this;return e.unitProduced=!1,e.id="CityBehProduceUnit",e}return r(e,t),e.prototype.execute=function(t){if(!t.getFoodItem())return h.BehResult.Stop;if(0==t.status.homesFree)return h.BehResult.Stop;this.unitProduced=!1;for(var e=t.status.population/7+1,i=m.Toolbox.randomInt(1,e),o=0;o<i&&0!=t.status.homesFree;o++)this.tryToProduceUnit(t);return this.unitProduced?h.BehResult.Continue:h.BehResult.Stop},e.prototype.tryToProduceUnit=function(t){if(t.getFoodItem()&&0!=t.status.homesFree){var e=t.getBuildingType("house");e&&this.produceNewCitizen(e,t)&&(this.unitProduced=!0)}},e.prototype.produceNewCitizen=function(t,i){var o=i.units.getSimpleList(),a=e.getRandomParent(o);if(!a)return!1;if(a.haveTrait("infected")&&m.Toolbox.randomBool())return!1;var n=e.getRandomParent(o,a);a.data.children++;var r=i.getFoodItem();i.eatFoodItem(r.id),i.status.homesFree--,i.data.born++,i.kingdom&&i.kingdom.data.born++;var h=a.stats,p=new c.ActorData;p.cityID=i.data.cityID,p.status=new c.default,p.status.statsID=h.id,l.default.generateCivUnit(a.stats,p.status,a.race),p.status.generateTraits(h,a.race),p.status.inheritTraits(a.data.traits),p.status.hunger=h.maxHunger/2,n&&(p.status.inheritTraits(n.data.traits),n.data.children++),p.status.skin=d.default.getBabyColor(a,n),p.status.skin_set=a.data.skin_set;var g=e.getBabyCulture(a,n);return g&&(p.status.culture=g.id,p.status.level=g.getBornLevel()),s.default.LANGUAGE==s.LANGUAGE_TYPE.ZH&&(p.status.familyID=d.default.getFamily(a).id,m.Toolbox.randomChance(.05)&&(h.unit?p.status.familyID=u.default.chineseName.get(h.nameTemplate).addition_startList.getRandom():p.status.familyID=u.default.chineseName.get(h.nameTemplate).addition_endList.getRandom()),_.default.familys.get(p.status.familyID).num++,p.status.familyName=a.data.familyName,h.unit?(m.Toolbox.randomChance(.02)&&(p.status.familyName=u.default.chineseName.get(h.nameTemplate).addition_startList.getRandom()),p.status.firstName=f.default.getCreatureName(h.nameTemplate,p.status.familyName,!0)):(m.Toolbox.randomChance(.02)&&(p.status.familyName=u.default.chineseName.get(h.nameTemplate).addition_endList.getRandom()),p.status.firstName=f.default.getCreatureName(h.nameTemplate,p.status.familyName,!1))),i.data.popPoints.push(p),!0},e.getBabyCulture=function(t,e){var i,o,a=t.data.culture,n=a;e&&(n=e.data.culture),a||(a=null===(i=t.city)||void 0===i?void 0:i.data.culture),!n&&e&&(n=null===(o=e.city)||void 0===o?void 0:o.data.culture);var r=t.currentTile.zone.culture;return r&&r.race==t.race.id&&m.Toolbox.randomChance(r.stats.culture_spread_convert_chance.value)&&(a=r.id),m.Toolbox.randomBool()?g.default.inst.cultures.get(a):g.default.inst.cultures.get(n)},e.getRandomParent=function(t,i){void 0===i&&(i=null),e.parent_index>=t.length&&(e.parent_index=0);for(var o=e.parent_index;o<t.length;o++){var a=t[o];if(a.data.alive&&a!=i&&!a.haveTrait("plague")&&a.data.age>18)return e.parent_index=o,a}return null},e.parent_index=0,e}(p.default);n.default=y,cc._RF.pop()},{}],CityBehRandomWait:[function(t,e,i){"use strict";cc._RF.push(e,"b7aa43dVWNOAoeL4uVNPMzp","CityBehRandomWait");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("BehaviourActionCity"),c=a("ToolBox"),d=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=1);var o=t.call(this)||this;return o.min=0,o.max=0,o.min=e,o.max=i,o.id="CityBehRandomWait",o}return r(e,t),e.prototype.execute=function(t){return t.timer_action=c.Toolbox.randomFloat(this.min,this.max),s.BehResult.Continue},e}(l.default);n.default=d,cc._RF.pop()},{}],CityBehSupplyKingdomCities:[function(t,e,i){"use strict";cc._RF.push(e,"4a891JKvGNIBYZsPYykAoOD","CityBehSupplyKingdomCities");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=function(t){function e(){var e=t.call(this)||this;return e._resources=[],e.id="CityBehSupplyKingdomCities",e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a,n=this,r=t.getCulture();if(!r)return l.BehResult.Stop;if(1==t.kingdom.cities.length)return l.BehResult.Stop;if(!r.haveTech("trading"))return l.BehResult.Stop;if(t.data.timer_supply>0)return l.BehResult.Stop;if(this._resources=[],t.data.storage.resources.forEach(function(e,i){var o=t.data.storage.resources.get(i);o.amount>o.asset.supplyBoundGive&&n._resources.push(o)}),0==this._resources.length)return l.BehResult.Stop;t.kingdom.cities.shuffle();try{for(var c=s(t.kingdom.cities),d=c.next();!d.done;d=c.next()){var u=d.value;if(u!=t)try{for(var h=(o=void 0,s(this._resources)),p=h.next();!p.done;p=h.next()){var f=p.value;if(u.data.storage.get(f.id)<f.asset.supplyBoundTake)return this.shareResource(t,u,f),this.updateSupplyTimer(t),l.BehResult.Continue}}catch(_){o={error:_}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}}}catch(m){e={error:m}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}return l.BehResult.Continue},e.prototype.updateSupplyTimer=function(t){var e=30;t.leader&&(e*=t.leader.curStats.mod_supply_timer);var i=t.getCulture();i&&(e-=e*i.stats.mod_trading_bonus.value),e<10&&(e=10),t.data.timer_supply=e},e.prototype.shareResource=function(t,e,i){t.data.storage.change(i.id,-i.asset.supplyGive),e.data.storage.change(i.id,i.asset.supplyGive)},e}(a("BehaviourActionCity").default);n.default=c,cc._RF.pop()},{}],CityBehUpgradeRandomBuilding:[function(t,e,i){"use strict";cc._RF.push(e,"8ac80Xg3htC76TvT+ivWAEr","CityBehUpgradeRandomBuilding");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AssetManager"),c=a("BehaviourActionBase"),d=a("BehaviourActionCity"),u=a("ToolBox"),h=function(t){function e(){var e=t.call(this)||this;return e.id="CityBehUpgradeRandomBuilding",e}return r(e,t),e.prototype.execute=function(t){return u.Toolbox.randomBool()&&this.upgradeRandomBuilding(t),c.BehResult.Continue},e.prototype.upgradeRandomBuilding=function(t){var e,i;if(0!=t.buildings.length){var o=t.buildings.getSimpleList();o.shuffle();var a=null;try{for(var n=s(o),r=n.next();!r.done;r=n.next()){var c=r.value;if(c.canBeUpgraded()){a=c;break}}}catch(h){e={error:h}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}if(a){var d=a.stats.upgradeTo,u=l.default.buildings.get(d);t.haveEnoughResourcesFor(u.cost)&&(t.spendResourcesFor(u.cost),a.upgradeBulding())}}},e}(d.default);n.default=h,cc._RF.pop()},{}],CityBuildOrder:[function(t,e,i){"use strict";cc._RF.push(e,"7d668iuQ6BFAoCuP0UutQy2","CityBuildOrder");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.CityBuildingPlacement=o.CityBuildOrderElement=void 0;var a=function(){this.buildingID="",this.limitType=0,this.limitID=0,this.priority=0,this.addRace=!1,this.requiredPop=0,this.requiredBuildings=0,this.waitForResources=!0,this.usedByRacesCheck=!1,this.usedByRaces="human,orc,elf,dwarf",this.checkFullVillage=!1};o.CityBuildOrderElement=a,function(t){t[t.Everywhere=0]="Everywhere",t[t.Borders=1]="Borders"}(o.CityBuildingPlacement||(o.CityBuildingPlacement={}));var n=function(){function t(){}return t.init=function(){t.list=[];var e=new a;e.buildingID="bonfire",e.priority=100,e.limitType=1,t.add(e);var i=new a;i.buildingID="windmill",i.priority=100,i.limitType=1,i.requiredBuildings=5,i.requiredPop=20,i.addRace=!0,t.add(i);var o=new a;o.buildingID="docks",o.priority=100,o.addRace=!0,o.limitType=5,o.requiredBuildings=2,o.waitForResources=!1,t.add(o);var n=new a;n.buildingID="well",n.requiredBuildings=10,n.requiredPop=20,n.waitForResources=!1,n.limitType=1,t.add(n);var r=new a;r.buildingID="tent",r.addRace=!0,r.limitID=5,r.checkFullVillage=!0,t.add(r);var s=new a;s.buildingID="hall",s.priority=90,s.limitType=1,s.addRace=!0,s.requiredBuildings=10,s.requiredPop=20,s.waitForResources=!0,t.add(s);var l=new a;l.buildingID="mine",l.limitType=1,l.requiredBuildings=10,l.requiredPop=20,l.waitForResources=!1,t.add(l);var c=new a;c.buildingID="barracks",c.addRace=!0,c.limitType=1,c.requiredBuildings=10,c.requiredPop=30,c.waitForResources=!1,t.add(c);var d=new a;d.buildingID="watch_tower",d.addRace=!0,d.limitType=1,d.requiredBuildings=10,d.requiredPop=30,d.waitForResources=!1,t.add(d);var u=new a;u.buildingID="temple",u.addRace=!0,u.limitType=1,u.requiredBuildings=40,u.requiredPop=150,u.waitForResources=!0,t.add(u);var h=new a;h.buildingID="statue",h.limitType=1,h.requiredBuildings=20,h.requiredPop=170,h.waitForResources=!1,h.usedByRacesCheck=!0,h.usedByRaces="human,dwarf",t.add(h)},t.addTent=function(e){var i=new a;i.buildingID="tent",i.addRace=!0,i.limitType=e,t.add(i)},t.add=function(e){t.list.push(e)},t.list=[],t}();o.default=n,cc._RF.pop()},{}],CityCheckAbandonZones:[function(t,e,i){"use strict";cc._RF.push(e,"96046wnhjdP/o2o8nec6zCz","CityCheckAbandonZones");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("TileTypeBase"),s=o("MapBox"),l=function(){function t(){}return t.checkAbandonZones=function(e){t._checkingCity=e,t.clearAll(),t.prepareCityZones(e),t.resetCityFinderForIslands(),t.startCheckingFromBuildings(e),t._split_areas.sort(t.sorter),t.abandonLeftoverZones(e),t.abandonSmallAreas(e)},t.startCheckingFromBuildings=function(e){var i=[];for(e.buildings.checkAddRemove(),i.addRange(e.buildings.getSimpleList());i.length>0;){var o=i.pop();t.prepareWaveFromTile(o.currentTile)}},t.prepareWaveFromTile=function(e){if(t._zones_hashset_to_check.has(e.zone))for(e.region.island.calc_temp_city_here=!0,t.wave=[],t.nextWave=[],t._cur_area=[],t._split_areas.push(t._cur_area),t.addRegionsToCheckFromZone(e.zone,t.wave);t.wave.length>0;)t.starRegiontWave(),t.nextWave.length>0&&(t.wave.addRange(t.nextWave),t.nextWave=[])},t.abandonLeftoverZones=function(e){var i,o;if(0!=t._zones_hashset_to_check.size)try{for(var a=n(t._zones_hashset_to_check),r=a.next();!r.done;r=a.next()){var s=r.value;e.removeZone(s,!0)}}catch(l){i={error:l}}finally{try{r&&!r.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},t.abandonSmallAreas=function(e){if(!(t._split_areas.length<2)){t._split_areas.shift();for(var i=0;i<t._split_areas.length;i++)for(var o=t._split_areas[i],a=0;a<o.length;a++){var n=o[a];e.removeZone(n,!0)}}},t.starRegiontWave=function(){for(var e=null;t.wave.length>0;){e=t.wave[t.wave.length-1].zone,t.wave.pop(),t._zones_hashset_to_check.delete(e),t._cur_area.push(e),e.zoneChecked=!0;for(var i=0;i<e.neighbours.length;i++){var o=e.neighbours[i];o.zoneChecked||o.city!=t._checkingCity||(o.zoneChecked=!0,t.addRegionsToCheckFromZone(o,t.nextWave))}}},t.addRegionsToCheckFromZone=function(t,e){for(var i=0;i<t.chunk.regions.length;i++){var o=t.chunk.regions[i];o.type==r.TileLayerType.Ground&&o.island.calc_temp_city_here&&e.push(o)}},t.resetCityFinderForIslands=function(){for(var t=0;t<s.default.inst.islandsCalculator.islands_ground.length;t++)s.default.inst.islandsCalculator.islands_ground[t].calc_temp_city_here=!1},t.prepareCityZones=function(e){for(var i=0;i<e.zones.length;i++){var o=e.zones[i];o.zoneChecked=!1,t._zones_hashset_to_check.add(o)}},t.clearAll=function(){t._zones_hashset_to_check.clear(),t._split_areas=[]},t.sorter=function(t,e){return e.length-t.length},t.nextWave=[],t.wave=[],t._split_areas=[],t._zones_hashset_to_check=new Set,t._checkingCity=null,t._cur_area=[],t}();a.default=l,cc._RF.pop()},{}],CityInfoElement:[function(t,e,i){"use strict";cc._RF.push(e,"45a29K0/khLeqLuq4jHUUQM","CityInfoElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ViewController"),c=a("Config"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cityName=null,e.population=null,e.diplomacy=null,e.buttonLeader=null,e.capitalIcon=null,e.city=null,e}var i;return r(e,t),i=e,e.prototype.initItem=function(t){this.city=t,this.city.isCapitalCity()&&(this.node.color=i.capitalColor),this.buttonLeader.active=null!=t.leader,this.cityName.string=t.data.cityName,this.population.string=""+t.getPopulationTotal(),this.capitalIcon.active=this.city.kingdom.capital==this.city;var e=this.city.getRelationRating();this.diplomacy.string=""+e,this.diplomacy.node.color=e>0?cc.Color.GREEN:cc.Color.RED},e.prototype.clickLeader=function(){c.default.selectedCity=this.city,c.default.selectedUnit=this.city.leader,c.default.selectedUnit&&l.default.open(l.view_type.CreatureInfo)},e.prototype.clickCity=function(){c.default.selectedCity=this.city,l.default.open(l.view_type.CityWindow)},e.capitalColor=new cc.Color(178.5,178.5,178.5),s([h(cc.Label)],e.prototype,"cityName",void 0),s([h(cc.Label)],e.prototype,"population",void 0),s([h(cc.Label)],e.prototype,"diplomacy",void 0),s([h(cc.Node)],e.prototype,"buttonLeader",void 0),s([h(cc.Node)],e.prototype,"capitalIcon",void 0),i=s([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],CityJobLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"8e554MpKD5NL5QzTq4tWpsX","CityJobLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorJob"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new s.JobCityAsset;e.id="city",this.add(e),this.t.addTask("build"),this.t.addTask("wait1"),this.t.addTask("check_army"),this.t.addTask("wait1"),this.t.addTask("do_checks"),this.t.addTask("wait1"),this.t.addTask("border_growth"),this.t.addTask("wait1"),this.t.addTask("border_steal"),this.t.addTask("wait1"),this.t.addTask("produce_unit"),this.t.addTask("wait1"),this.t.addTask("give_inventory_item"),this.t.addTask("wait1"),this.t.addTask("produce_boat"),this.t.addTask("wait1"),this.t.addTask("upgrade_random_building"),this.t.addTask("wait1"),this.t.addTask("supply_kingdom_cities"),this.t.addTask("wait1"),this.t.addTask("produce_resources"),this.t.addTask("wait1"),this.t.addTask("check_pop_points"),this.t.addTask("wait1"),this.t.addTask("check_culture")},e}(a("AssetLibrary").default);n.default=l,cc._RF.pop()},{}],CityJobs:[function(t,e,i){"use strict";cc._RF.push(e,"66736LGkG9OCJAJyD9+BLkb","CityJobs");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MathUtils"),r=function(){function t(){this.jobs=new Map,this.occupied=new Map}return t.prototype.clearTasks=function(){this.total=0,this.jobs.clear()},t.prototype.addJob=function(t,e,i){void 0===i&&(i=0),this.jobs.has(t)||this.jobs.set(t,0),0!=i?this.jobs.set(t,n.default.clamp(e,1,i)):this.jobs.set(t,e)},t.prototype.continueJob=function(t){return!!this.jobs.has(t)},t.prototype.countOccupied=function(t){return this.occupied.has(t)?this.occupied.get(t):0},t.prototype.haveJob=function(t){return!(!this.jobs.has(t)||0==this.jobs.get(t)||this.occupied.has(t)&&this.occupied.get(t)>=this.jobs.get(t))},t.prototype.takeJob=function(t){if(this.occupied.has(t)){var e=this.occupied.get(t);this.occupied.set(t,e++)}else this.occupied.set(t,1)},t.prototype.freeJob=function(t){if(this.occupied.has(t)){var e=this.occupied.get(t);this.occupied.set(t,e--),this.occupied.get(t)<0&&this.occupied.set(t,0)}else this.occupied.set(t,0)},t}();a.default=r,cc._RF.pop()},{}],CityPlaceFinder:[function(t,e,i){"use strict";cc._RF.push(e,"08c73t+YO1D0ZWko9U5CDRR","CityPlaceFinder");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("TileTypeBase"),s=o("MapBox"),l=function(){function t(){this.dirty=!1,this.zones=[],this.nextWave=[],this.wave=[],this.checkedZones=new Set,this.timer=2,this._curWave=2,this.tilesForCity=2}return t.prototype.logicUpdate=function(t){this.timer>=0&&(this.timer-=t,this.dirty&&this.calculate())},t.prototype.calculate=function(){this.dirty=!1,this.zones=[];for(var t=0;t<s.default.inst.zoneCalculator.zones.length;t++){var e=s.default.inst.zoneCalculator.zones[t];e.goodForNewCity=!1,e.zoneChecked=!1,!e.city&&e.tilesWithGround>=64&&e.centerTile.region.island.getTileCount()>=500&&e.countCanBeFarms()>=5&&(e.goodForNewCity=!0)}for(t=0;t<s.default.inst.citiesList.length;t++){var i=s.default.inst.citiesList[t];this.checkCity(i)}for(t=0;t<s.default.inst.zoneCalculator.zones.length;t++){var o=s.default.inst.zoneCalculator.zones[t];o.goodForNewCity&&this.zones.push(o)}this.zones.shuffle()},t.prototype.checkCity=function(t){for(var e,i,o,a=0;a<s.default.inst.islandsCalculator.islands_ground.length;a++)s.default.inst.islandsCalculator.islands_ground[a].calc_temp_city_here=!1;var r=t.getTile();r&&(r.region.island.calc_temp_city_here=!0);for(var l=t.buildings.getSimpleList(),c=0;c<l.length;c++){var d=l[c];(null===(o=d.data)||void 0===o?void 0:o.alive)&&d.currentTile&&(d.currentTile.region.island.calc_temp_city_here=!0)}this._curWave=0,this.wave=[],this.nextWave=[];for(var u=0;u<t.zones.length;u++){var h=t.zones[u];this.addRegionsToCheckFromZone(h,this.wave)}for(;this.wave.length>0&&this._curWave<5;)this._curWave++,this.startNextWave(),this.nextWave.length>0&&(this.wave.addRange(this.nextWave),this.nextWave=[]);try{for(var p=n(this.checkedZones),f=p.next();!f.done;f=p.next())f.value.zoneChecked=!1}catch(_){e={error:_}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(e)throw e.error}}this.checkedZones.clear()},t.prototype.addRegionsToCheckFromZone=function(t,e){for(var i=t.chunk,o=0;o<i.regions.length;o++){var a=i.regions[o];a.type==r.TileLayerType.Ground&&a.island.calc_temp_city_here&&e.push(a)}},t.prototype.startNextWave=function(){for(var t=null;this.wave.length>0;){(t=this.wave.pop().zone).zoneChecked=!0,t.goodForNewCity=!1,this.checkedZones.add(t);for(var e=0;e<t.neighbours.length;e++){var i=t.neighbours[e];!i.zoneChecked&&!i.city&&i.tilesWithGround>=10&&(i.zoneChecked=!0,this.checkedZones.add(i),this.addRegionsToCheckFromZone(i,this.nextWave))}}},t.prototype.cleanGoodList=function(){for(var t=0;t<this.zones.length;t++)this.zones[t].goodForNewCity=!1;this.zones=[]},t.prototype.setDirty=function(){this.dirty=!0,this.timer<=0&&(this.timer=1)},t}();a.default=l,cc._RF.pop()},{}],CityStorage:[function(t,e,i){"use strict";cc._RF.push(e,"cc5c25sRlJE0YbIwbAaInQW","CityStorage");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(a,"__esModule",{value:!0}),a.CityStorageSlot=void 0;var s=o("Tools"),l=o("AchievData"),c=o("ActorEquipment"),d=o("AssetManager"),u=o("ResourceLibrary"),h=function(){function t(){this.id="",this.amount=0,this.asset=null,Object.defineProperty(this,"asset",{enumerable:!1})}return t.prototype.create=function(){this.asset=d.default.resources.get(this.id)},t}();a.CityStorageSlot=h;var p=function(){function t(){this.itemStorage=new c.default,this.resources=new Map,this.resourcesFood=new Map,this.listFood=[],this.savedResources=[],this.savedItems=[]}return t.prototype.toJSON=function(){return{savedResources:this.savedResources,savedItems:this.savedItems}},t.prototype.loadFromSave=function(){if(this.savedItems&&(this.itemStorage=new c.default,this.itemStorage.load(this.savedItems)),this.savedResources)for(var t=0;t<this.savedResources.length;t++){var e=this.savedResources[t];"food"==(e=s.default.fromJson(e,new h)).id&&(e.id="wheat"),d.default.resources.get(e.id)&&e.amount>=0&&(e.create(),this.putToDict(e))}},t.prototype.getRandomFood=function(){if(0==this.listFood.length)return null;this.listFood.sort(function(t,e){return t.amount-e.amount});for(var t=0;t<this.listFood.length;t++){var e=this.listFood[t];if(e.amount>0)return e.asset}return null},t.prototype.save=function(){var t,e;this.savedResources=[];try{for(var i=n(this.resources),o=i.next();!o.done;o=i.next()){var a=r(o.value,2),s=(a[0],a[1]);0!=s.amount&&this.savedResources.push(s)}}catch(d){t={error:d}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.savedItems=this.itemStorage.getDataForSave()},t.prototype.getMaterialForItem=function(t,e,i,o){void 0===o&&(o=!0);var a=i.getCulture();if(!a)return null;for(var n=e.list.length-1;n>=0;n--){var r=e.list[n];if(t.materials.includes(r.id)&&(!o||!r.tech_needed||a.haveTech(r.tech_needed))&&r.cost_gold<=this.get("gold")&&("none"==r.cost_resource_id_1||r.cost_resource_1<=this.get(r.cost_resource_id_1))&&this.get(r.cost_resource_id_1)>=15&&("none"==r.cost_resource_id_2||r.cost_resource_2<=this.get(r.cost_resource_id_2)))return r}return null},t.prototype.get=function(t){return this.resources.has(t)?this.resources.get(t).amount:0},t.prototype.addNew=function(t,e){var i=new h;i.id=t,i.amount=e,i.create(),this.putToDict(i)},t.prototype.putToDict=function(t){this.resources.has(t.id)||(this.resources.set(t.id,t),t.asset.type==u.ResType.Food&&(this.resourcesFood.set(t.id,t),this.listFood.push(t)))},t.prototype.set=function(t,e){this.resources.has(t)?this.resources.get(t).amount=e:this.addNew(t,e)},t.prototype.change=function(t,e){if(void 0===e&&(e=1),this.resources.has(t)){var i=this.resources.get(t);i.amount+=e,i.amount>i.asset.maximum&&(i.amount=i.asset.maximum),"wood"==t&&l.default.update(3,i.amount,!0),"gold"!=t&&"metals"!=t||l.default.update(24,i.amount,!0)}else this.addNew(t,e)},t}();a.default=p,cc._RF.pop()},{}],CityTaskList:[function(t,e,i){"use strict";cc._RF.push(e,"2a445kU+sBJ35zVgd6OEnl/","CityTaskList");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.CityTasksData=void 0,o.CityTasksData=function(){this.trees=0,this.stone=0,this.ore=0,this.metal=0,this.gold=0,this.mine=0,this.bushes=0,this.farmFields=0,this.canBeFarms=0,this.wheats=0,this.ruins=0,this.roads=0,this.fire=0};var a=function(){function t(){}return t.init=function(){t.jobsUnit=[],t.jobsWarrior=[],t.initTaskList()},t.prepare=function(e,i){t.city=e,t.taskUnit=i},t.initTaskList=function(){t.jobsUnit.push("builder"),t.jobsUnit.push("gatherer"),t.jobsUnit.push("farmer_plower"),t.jobsUnit.push("farmer"),t.jobsUnit.push("hunter"),t.jobsUnit.push("woodcutter"),t.jobsUnit.push("miner"),t.jobsUnit.push("miner_deposit"),t.jobsUnit.push("blacksmith"),t.jobsUnit.push("road_builder"),t.jobsUnit.push("cleaner"),t.jobsUnit.push("settler"),t.jobsWarrior.push("attacker")},t.checkJob=function(e){return!!t.city.jobs.haveJob(e)&&(t.city.jobs.takeJob(e),t.taskUnit.ai.setJob(e),!0)},t.jobsUnit=[],t.jobsWarrior=[],t.taskUnit=null,t.city=null,t}();o.default=a,cc._RF.pop()},{}],CityWindow:[function(t,e,i){"use strict";cc._RF.push(e,"7a0f40aNIFEkbMqS04eXV/g","CityWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GamePopBase"),d=a("AssetManager"),u=a("MoveCamera"),h=a("StatsHelper"),p=a("ViewController"),f=a("Config"),_=a("TextureLoader"),m=a("ToolTip"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentResources=null,e.txtName=null,e.army=null,e.population=null,e.territory=null,e.buildings=null,e.icon=null,e.buttonKingdom=null,e.buttonLeader=null,e.valueNode=null,e.temp_res=[],e.tempNode=null,e}return r(e,t),e.prototype.onLoad=function(){this.tempNode=cc.instantiate(this.parentResources.children[0])},e.prototype.start=function(){if(f.default.selectedCity){var t=f.default.selectedCity;this.icon.spriteFrame=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"icons/"+t.race.icon),this.txtName.string=t.data.cityName,this.population.string=t.getPopulationTotal()+"/"+t.status.homesTotal,this.territory.string=t.zones.length+"/"+t.status.maximumZones,this.army.string=t.getArmy()+"/"+t.getArmyMaxCity(),this.buildings.string=t.buildings.length<=0?"0":""+t.buildings.length,null==t.kingdom?this.buttonKingdom.active=!1:this.buttonKingdom.active=!0,null==t.leader?this.buttonLeader.active=!1:this.buttonLeader.active=!0,this.clearPrevButtons(),this.loadResources(),this.showValues()}},e.prototype.loadResources=function(){var t=this;this.temp_res=[],this.temp_res.push(d.default.resources.get("gold")),d.default.resources.list.forEach(function(e){"gold"!=e.id&&t.tryToAdd(e)});var e=0,i=this.temp_res.length;this.temp_res.forEach(function(o){t.loadResource(o,e,i),e++})},e.prototype.tryToAdd=function(t){f.default.selectedCity.data.storage.get(t.id)>0&&this.temp_res.push(t)},e.prototype.loadResource=function(t){var e=cc.instantiate(this.tempNode);e.y=10,e.attr({data:t}),e.parent=this.parentResources,e.getComponent(cc.Sprite).spriteFrame=t.getSprite(),e.addComponent(cc.Button),e.on("click",this.clickResource,this),e.getChildByName("label").getComponent(cc.Label).string=""+f.default.selectedCity.data.storage.get(t.id)},e.prototype.showValues=function(){var t,e;try{for(var i=l(this.valueNode.children),o=i.next();!o.done;o=i.next()){var a=o.value,n=h.default.getStatistic(a.name);a.getComponent(cc.RichText).string=n}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.clearPrevButtons=function(){this.parentResources.destroyAllChildren()},e.prototype.onDisable=function(){f.default.selectedCity&&(f.default.selectedCity=null),t.prototype.onDisable.call(this)},e.prototype.clickAttribute=function(t,e){var i=t.getCurrentTarget();m.default.info_tip=i.name,m.default.inst.show(i,"tip",i.name,e)},e.prototype.clickResource=function(t){var e=t.node.data;m.default.info_resource=e,m.default.inst.show(t.node,"resource")},e.prototype.clickKingdom=function(t){f.default.selectedKingdom=f.default.selectedCity.kingdom,p.default.open(p.view_type.KingdomWindow,null,t)},e.prototype.clickLeader=function(t){f.default.selectedUnit=f.default.selectedCity.leader,p.default.open(p.view_type.CreatureInfo,null,t)},e.prototype.clickLocate=function(){this.close(),u.MoveCamera.inst.focusOn(f.default.selectedCity.cityCenter)},s([v(cc.Node)],e.prototype,"parentResources",void 0),s([v(cc.Label)],e.prototype,"txtName",void 0),s([v(cc.Label)],e.prototype,"army",void 0),s([v(cc.Label)],e.prototype,"population",void 0),s([v(cc.Label)],e.prototype,"territory",void 0),s([v(cc.Label)],e.prototype,"buildings",void 0),s([v(cc.Sprite)],e.prototype,"icon",void 0),s([v(cc.Node)],e.prototype,"buttonKingdom",void 0),s([v(cc.Node)],e.prototype,"buttonLeader",void 0),s([v(cc.Node)],e.prototype,"valueNode",void 0),s([y],e)}(c.GamePopBase);n.default=b,cc._RF.pop()},{}],City:[function(t,e,i){"use strict";cc._RF.push(e,"17275YKkqNDpYVh8Vluv8Ow","City");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(n,"__esModule",{value:!0}),n.CityStatus=n.CityIcon=n.CityData=void 0;var d=a("MathUtils"),u=a("Tools"),h=a("AchievData"),p=a("GameCommon"),f=a("ActorAsset"),_=a("ActorBase"),m=a("ActorEquipment"),g=a("ActorEquipmentSlot"),y=a("ActorStatus"),v=a("Baby"),b=a("AiSystem"),w=a("AssetManager"),T=a("ItemLibrary"),k=a("BaseBuilding"),B=a("BaseMapObject"),S=a("ItemGenerator"),C=a("NameGenerator"),x=a("Globals"),A=a("ItemTools"),P=a("ToolBox"),O=a("Culture"),R=a("MapBox"),F=a("WorldLog"),L=a("ModModule"),D=a("CityCheckAbandonZones"),M=a("CityJobs"),I=a("CityStorage"),j=a("CityTaskList"),E=function(){this.cityName="NEW_CITY",this.storage=new I.default,this.cityID="",this.kingdomID="",this.leaderID="",this.zones=[],this.culture="",this.race="null",this.age=0,this.deaths=0,this.born=0,this.timer_supply=0,this.timer_trade=0,this.timer_revolt=0,this.popPoints=[]};n.CityData=E;var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.tip_id="?",e}return r(e,t),e}(cc.Component);n.CityIcon=N;var z=function(){this.populationAdults=0,this.population=0,this.homesTotal=0,this.homesFree=0,this.homesOccupied=0,this.warriorSlots=0,this.warriorCurrent=0,this.hungry=0,this.maximumZones=0};n.CityStatus=z;var G=cc._decorator,U=G.ccclass,W=(G.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.professionsDict=new Map,e.units=new _.ActorContainer,e.buildings=new k.BuildingContainer,e.buildings_dict_type=new Map,e.buildings_dict_id=new Map,e.tasks=new j.CityTasksData,e.jobs=new M.default,e.status=new z,e.data=new E,e.mapText=null,e.cityStatusDirty=!1,e.abandonedZonesDirty=!1,e.abandonedZones_timer=0,e.hashcode=0,e.race=null,e.kingdom=null,e.leader=null,e.army=null,e.zones=[],e.neighbourZones=[],e.alive=!0,e.underConstructionBuilding=null,e.cityTickTimer=0,e.cityTickInterval=6,e.settlerTargetTimer=15,e.boatBuildTimer=10,e.roadTilesToBuild=[],e.tilesToRemove=[],e.cityEnemy=null,e.lastPopulationCheck=0,e.samePopulationTicks=0,e.settleTarget=null,e.attackZone=null,e._cityTile=null,e.timer_action=0,e._debug_nextPlannedBuilding="",e.capturingBy=null,e.captureTicks=0,e.lastTicks=0,e.captureTimer=0,e.blacksmith=null,e.cityCenter=cc.Vec3.ZERO,e.lastCityCenter=cc.Vec3.ZERO,e.ai=null,e.unitsDirty=!1,e.timer_warrior=0,e.currentTaskID_unit=0,e.currentTaskID_warrior=0,e._opinion_king=0,e._opinion_leader=0,e._opinion_population=0,e._opinion_zones=0,e._opinion_distance=0,e._opinion_capital=0,e._opinion_loyalty_traits=0,e._opinion_loyalty_mood=0,e._opinion_new_city=0,e._opinion_new_kingdom=0,e._opinion_cities=0,e._opinion_superior_enemies=0,e._opinion_close_to_capital=0,e._opinion_world_law=0,e._opinion_culture=0,e._opinion_total=0,e.gold_in_tax=0,e.gold_out_army=0,e.gold_out_buildigs=0,e.gold_out_homeless=0,e.gold_change=0,e.capturingUnits=new Map,e.city_hash_id=0,e.bonfire=null,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.city_hash_id=i.LAST_CITY_HASH_ID++,this.createAI(),this.cityStatusDirty=!0},e.prototype.createAI=function(){this.ai=new b.AiSystemCity(this),this.ai.nextJobDelegate=this.getNextJob,this.ai.jobs_library=w.default.job_city,this.ai.task_library=w.default.tasks_city},e.prototype.correctBuildingDicts=function(){var t,e;try{for(var i=l(this.buildings_dict_type),o=i.next();!o.done;o=i.next()){var a=c(o.value,2),n=(a[0],a[1]);n.checkAddRemove();for(var r=n.getSimpleList(),s=0;s<r.length;s++){var d=r[s];d.data.state!=k.BuildingState.CivKingdom&&n.remove(d)}n.checkAddRemove()}}catch(p){t={error:p}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.getTile=function(){return this._cityTile},e.prototype.recalculateCityTile=function(){this._cityTile=null,this.correctBuildingDicts();var t=this.getBuildingType("bonfire");if(t)this._cityTile=t.currentTile;else{var e=this.buildings.getSimpleList();e.shuffle();for(var i=0;i<e.length;i++){var o=e[i];o.stats.docks||o.currentTile.type.ocean||(t?o.stats.priority>t.stats.priority&&(t=o):t=o)}if(t&&(this._cityTile=t.currentTile),0!=this.zones.length)for(var a=0;a<this.zones.length;a++){var n=this.zones[a];if(!n.centerTile.type.ocean){this._cityTile=n.centerTile;break}}}},e.prototype.countInHouses=function(){for(var t=0,e=this.units.getSimpleList(),i=0;i<e.length;i++)e[i].insideBuilding&&t++;return t},e.prototype.setKingdom=function(t){this.kingdom=t,this.kingdom?(this.data.kingdomID=t.data.id,this.kingdom.addCity(this)):this.data.kingdomID=null;for(var e=this.units.getSimpleList(),i=0;i<e.length;i++){var o=e[i];o.setKingdom(this.kingdom),o.data.profession==f.UnitProfession.King&&o.setProfession(f.UnitProfession.Unit)}},e.prototype.getStorageNear=function(t){for(var e,i,o=null,a=0,n=0,r=this.buildings.getSimpleList(),s=0;s<r.length;s++){var l=r[s];(null===(e=l.stats)||void 0===e?void 0:e.storage)&&!(null===(i=l.data)||void 0===i?void 0:i.underConstruction)&&(a=P.Toolbox.distVec2(l.currentTile.pos,t.pos),(!o||a<n)&&(n=a,o=l))}return o||null},e.prototype.getRoadTileToBuild=function(){this.tilesToRemove=[];for(var t=0;t<this.roadTilesToBuild.length;t++){var e=this.roadTilesToBuild[t];(e.type.road||e.type.liquid)&&this.tilesToRemove.push(e)}for(var i=0;i<this.tilesToRemove.length;i++){var o=this.tilesToRemove[i];this.roadTilesToBuild.remove(o)}return this.roadTilesToBuild.length>0?this.roadTilesToBuild[0]:null},e.prototype.addPopPoint=function(t){this.data.popPoints.push(t),this.cityStatusDirty=!0},e.prototype.getNextJob=function(){return"city"},e.prototype.checkSettleTarget=function(){this.settleTarget&&(this.settleTarget.city==this?this.settleTarget=null:this.settleTarget.city&&(this.settleTarget.city.kingdom!=this.kingdom?this.settleTarget=null:this.settleTarget.city.getPopulationTotal()>=30&&(this.settleTarget=null)))},e.prototype.createNewCity=function(){this.data.cityID=R.default.inst.mapStats.getNextId("city")},e.prototype.generateName=function(){this.data.cityName=C.default.getName(this.race.name_template_city),this.node.name=this.data.cityName,this.hashcode=this.getHashCode()},e.prototype.setRace=function(t){this.race=t,this.data.race=t.id},e.prototype.loadLeader=function(){this.data.leaderID&&i.makeLeader(R.default.inst.getActorByID(this.data.leaderID),this)},e.prototype.newCityEvent=function(){this.recalculateCityTile(),this.generateName()},e.prototype.loadCity=function(t){this.data=t,this.data.storage.loadFromSave(),this.race=w.default.raceLibrary.dict.get(this.data.race),this.node.name=this.data.cityName,this.hashcode=this.getHashCode(),this.updateCityStatus()},e.prototype.addNewUnit=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),t.setCity(this),this.units.add(t),this.cityStatusDirty=!0,this.unitsDirty=!0,e&&t.setKingdom(this.kingdom)},e.prototype.setAbandonedZonesDirty=function(){this.abandonedZonesDirty=!0,this.abandonedZones_timer=2},e.prototype.updateCityStatus=function(){this.cityStatusDirty=!1,this.setAbandonedZonesDirty(!0),this.recalculateCityTile(),this.recalculateNeighbourZones(),this.status.maximumZones=this.race.civ_baseZones,this.status.maximumZones+=3*this.buildings.length,this.leader&&(this.status.maximumZones+=this.leader.curStats.zones),this.status.population=this.getPopulationTotal(),this.status.populationAdults=this.getPopulationTotal()-this.countProfession(f.UnitProfession.Baby),this.status.hungry=0,this.status.homesTotal=0,this.status.homesFree=0,this.status.homesOccupied=0,this.blacksmith=null;for(var t=this.getCulture(),e=this.units.getSimpleList(),i=0;i<e.length;i++){var o=e[i];o.data.hunger<=10&&this.status.hungry++,o.isCurrentJob("blacksmith")&&(this.blacksmith=o)}for(var a=this.buildings.getSimpleList(),n=0;n<a.length;n++){var r=a[n];!r.data.underConstruction&&r.stats.housing>0&&(this.status.homesTotal+=r.stats.housing,t&&(this.status.homesTotal+=d.default.intCast(t.stats.housing.value)))}this.status.population>this.status.homesTotal?this.status.homesOccupied=this.status.homesTotal:this.status.homesOccupied=this.status.population,this.status.homesFree=this.status.homesTotal-this.status.homesOccupied},e.prototype.recalculateNeighbourZones=function(){this.neighbourZones=[];for(var t=0;t<this.zones.length;t++)for(var e=this.zones[t],i=0;i<e.neighboursAll.length;i++){var o=e.neighboursAll[i];o.city||this.neighbourZones.includes(o)||this.neighbourZones.push(o)}},e.prototype.removeCitizen=function(t,e,o){var a,n,r,s;void 0===e&&(e=!1),void 0===o&&(o=f.AttackType.Other),null===(a=this.units)||void 0===a||a.remove(t),this.cityStatusDirty=!0,this.unitsDirty=!0,this.data&&(e&&(this.data.deaths++,this.kingdom&&this.kingdom.data.deaths++),this.leader==t&&this.removeLeader(),(null===(n=this.kingdom)||void 0===n?void 0:n.king)==t&&(this.kingdom.removeKing(),e?o!=f.AttackType.Age&&o!=f.AttackType.Plague&&o!=f.AttackType.Hunger&&(null===(r=null==t?void 0:t.attackedBy)||void 0===r?void 0:r.a)?(F.default.logKingMurder(this.kingdom,t,null===(s=null==t?void 0:t.attackedBy)||void 0===s?void 0:s.a),t.attackedBy.a.addTrait("kingslayer")):F.default.logKingDead(this.kingdom,t):F.default.logKingLeft(this.kingdom,t)),o==f.AttackType.Age&&i.giveItemsToCity(this,t))},e.giveItemsToCity=function(t,e){for(var i=m.default.getList(e.equipment),o=0;o<i.length;o++){var a=i[o],n=t.data.storage.itemStorage.getSlot(a.type);if(n.isEmpty())n.setItem(a.data);else{A.default.calcItemValues(n.data);var r=A.default.s_value;A.default.calcItemValues(a.data),A.default.s_value>r&&n.setItem(a.data)}}},e.prototype.removeLeader=function(){this.leader=null,this.data.leaderID=null},e.prototype.getCulture=function(){return this.data.culture?R.default.inst.cultures.get(this.data.culture):null},e.prototype.setCulture=function(t){this.data.culture=t instanceof O.default?t.id:t},e.prototype.logicUpdate=function(e){var i;t.prototype.logicUpdate.call(this,e),this.abandonedZonesDirty&&(this.abandonedZones_timer>0?this.abandonedZones_timer-=e:(D.default.checkAbandonZones(this),this.abandonedZonesDirty=!1)),this.buildings.checkAddRemove(),this.units.checkAddRemove(),this.data.timer_supply>0&&(this.data.timer_supply-=e),this.data.timer_trade>0&&(this.data.timer_trade-=e),this.data.timer_revolt>0&&(this.data.timer_revolt-=e),this.timer_warrior>0&&(this.timer_warrior-=e),this.data.age>=1&&(0==this.zones.length||0==this.getPopulationTotal())&&(this==(null===(i=L.default.inst.kingdom)||void 0===i?void 0:i.capital)?L.default.inst.unmanned()&&(L.default.inst.placeUnit(L.default.inst.race,!0,2),R.default.inst.kingdoms.diplomacyManager.startPeace(this.kingdom,this.capturingBy,!0)):R.default.inst.destroyCity(this)),this.leader&&!this.leader.curStats&&this.removeLeader(),this.cityStatusDirty&&this.updateCityStatus(),p.default.isPaused||(this.settlerTargetTimer>0&&(this.settlerTargetTimer-=e),this.boatBuildTimer>0&&(this.boatBuildTimer-=e),this.unitsDirty&&this.updateCitizens(),this.cityTickTimer>0?this.cityTickTimer-=e:(this.cityTickTimer=this.cityTickInterval,this.updateTasks()),this.ai&&(this.timer_action>0?this.timer_action-=e:this.ai.logicUpdate(e)),this.updateCapture(e))},e.prototype.updateCapture=function(t){var e,i,o=this;if(this.captureTicks==this.lastTicks?(this.lastTicks>100&&(this.lastTicks=100),this.lastTicks<0&&(this.lastTicks=0)):this.captureTicks>this.lastTicks?(this.lastTicks++,this.lastTicks>100&&(this.lastTicks=100)):(this.lastTicks--,this.lastTicks<0&&(this.lastTicks=0)),this.captureTimer>0)this.captureTimer-=t;else{this.captureTimer=.1;var a=null;if(this.capturingUnits.forEach(function(t,e){a?o.capturingUnits.get(e)>o.capturingUnits.get(a)&&(a=e):a=e}),!a)return this.captureTicks-=.5,void(this.captureTicks<=0&&this.clearCapture());var n=!1;if(this.capturingUnits.has(this.kingdom)&&this.capturingUnits.get(this.kingdom)>0&&(n=!0),this.kingdom==a&&this.capturingBy)this.captureTicks-=1,this.captureTicks<=0&&this.clearCapture();else{if(!a.isEnemy(this.kingdom)||n)return;this.capturingBy&&this.capturingBy!=a?a.isEnemy(this.capturingBy)?(this.captureTicks-=.5,this.captureTicks<=0&&this.clearCapture()):(this.captureTicks+=1,this.captureTicks>=100&&(this==(null===(i=L.default.inst.kingdom)||void 0===i?void 0:i.capital)?(this.clearCapture(),R.default.inst.kingdoms.diplomacyManager.startPeace(this.kingdom,this.capturingBy,!0)):this.checkConquestBy(this.capturingBy))):(this.captureTicks+=1,this.capturingBy=a,this.captureTicks>=100&&(this==(null===(e=L.default.inst.kingdom)||void 0===e?void 0:e.capital)?(this.clearCapture(),R.default.inst.kingdoms.diplomacyManager.startPeace(this.kingdom,this.capturingBy,!0)):this.checkConquestBy(this.capturingBy)))}}},e.prototype.isGettingCaptured=function(){return 0!=this.capturingUnits.size&&(1!=this.capturingUnits.size||!this.capturingUnits.has(this.kingdom))},e.prototype.isGettingCapturedBy=function(t){return!!(this.capturingUnits.has(t)&&this.capturingUnits.get(t)>0)},e.prototype.clearCapture=function(){this.captureTicks=0,this.capturingBy=null},e.prototype.updateCitizens=function(){var t,e,i;if(this.unitsDirty=!1,0==this.professionsDict.size)for(var o in f.UnitProfession)this.professionsDict.set(parseInt(o),[]);try{for(var a=l(this.professionsDict),n=a.next();!n.done;n=a.next()){var r=c(n.value,2);o=r[0],r[1],this.professionsDict.set(o,[])}}catch(_){t={error:_}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var s=this.units.getSimpleList(),d=0;d<s.length;d++){var u=s[d];u.stats.baby||(u&&(null===(i=u.data)||void 0===i?void 0:i.alive)?this.professionsDict.get(u.data.profession).push(u):this.units.remove(u))}s.length>10&&this.kingdom==L.default.inst.kingdom&&L.default.inst.restoreStatus()},e.prototype.updateTasks=function(){},e.prototype.needMoreAttackers=function(t){return this.jobs.countOccupied("attacker")<this.jobs.countOccupied("defender")&&(this.jobs.freeJob("defender"),this.jobs.takeJob("attacker"),t.ai.setJob("attacker"),!0)},e.prototype.countProfession=function(t){return this.professionsDict.has(t)?this.professionsDict.get(t).length:0},e.prototype.destroyCity=function(){this.alive=!1,this.buildings.checkAddRemove(),this.units.checkAddRemove(),this.kingdom&&this.kingdom.removeCity(this);for(var t=0;t<this.units.list.length;t++)this.units.list[t].removeFromCity();for(t=0;t<this.zones.length;t++)this.zones[t].setCity(null);for(t=0;t<this.buildings.list.length;t++)this.abandonBuilding(this.buildings.list[t]);this.buildings_dict_id.clear(),this.buildings_dict_type.clear(),this.zones=[],this.units.clear()},e.prototype.abandonBuilding=function(t){t.setCity(null),this.buildings.remove(t),cc.isValid(t.node)&&(t.data.underConstruction||!t.stats.canBeAbandoned?t.startDestroyBuilding():t.makeAbandoned())},e.prototype.removeBuilding=function(t){this.cityStatusDirty=!0,this.buildings.remove(t),this.setBuildingDictType(t,!1),(null==t?void 0:t.stats)&&t.stats.housing>0&&this.data.popPoints.length>0&&(this.killRandomPopPoints(),this.spawnRandomPopPoints(t.stats.housing,t.currentTile)),this.underConstructionBuilding==t&&(this.underConstructionBuilding=null),0==this.buildings.length&&R.default.inst.destroyCity(this)},e.getActorDataPopPoint=function(t){if(0==t.data.popPoints.length)return null;var e=t.data.popPoints.getRandom();return t.data.popPoints.remove(e),e},e.prototype.spawnPopPoint=function(t,e){if(null==t?void 0:t.status){t.status.actorID=R.default.inst.mapStats.getNextId("unit"),t.status.age<=8&&(t.status.statsID=t.status.statsID.replace("unit_","baby_"),t.status.profession=f.UnitProfession.Baby);for(var i=w.default.unitStats.get(t.status.statsID),o=0;o<i.traits.length;o++){var a=i.traits[o];t.status.traits.includes(a)||t.status.traits.push(a)}var n=R.default.inst.spawnAndLoadUnit(t.status.statsID,t,e);n&&(n.setStatsDirty(),n.stats.baby&&(n.getComponent(v.default).timerGrow=n.stats.timeToGrow,"human"==n.race.id&&h.default.update(10)))}},e.prototype.spawnRandomPopPoints=function(t,e){for(var o=0;o<t;o++){var a=i.getActorDataPopPoint(this);if(!a)break;this.spawnPopPoint(a,e)}},e.prototype.killHalfPopPoints=function(){this.killRandomPopPoints(this.data.popPoints.length/2+1)},e.prototype.killRandomPopPoints=function(t){if(void 0===t&&(t=1),0!=this.data.popPoints.length){var e=t;1==e&&(this.data.popPoints.length>1e3?e+=this.data.popPoints.length/100:this.data.popPoints.length>100&&(e+=this.data.popPoints.length/10)),this.data.popPoints.shuffle();for(var i=0;i<e&&0!=this.data.popPoints.length;i++)this.data.popPoints.splice(this.data.popPoints.length-1,1)}},e.prototype.spendResourcesFor=function(t){this.data.storage.change("wood",-t.wood),this.data.storage.change("gold",-t.gold),this.data.storage.change("stone",-t.stone),this.data.storage.change("metals",-t.metals)},e.prototype.haveEnoughResourcesFor=function(t){return!(x.default.BUILDINGS_USE_RESOURCES&&(this.data.storage.get("wood")<t.wood||this.data.storage.get("metals")<t.metals||this.data.storage.get("stone")<t.stone||this.data.storage.get("gold")<t.gold))},e.prototype.getHallLevel=function(){var t=this.buildings_dict_type.get("hall");return t?t[0].stats.upgradeLevel:0},e.prototype.getBuildingToBuild=function(){var t,e,i,o;return(null===(e=null===(t=this.underConstructionBuilding)||void 0===t?void 0:t.data)||void 0===e?void 0:e.underConstruction)&&(null===(o=null===(i=this.underConstructionBuilding)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive)||(this.underConstructionBuilding=null),this.underConstructionBuilding},e.prototype.setBuildingDictType=function(t,e){var i=this.getBuildingContainer(t.stats.type);i||(i=new k.BuildingContainer,this.buildings_dict_type.set(t.stats.type,i)),e?i.add(t):i.remove(t),this.setBuildingDictID(t,e)},e.prototype.setBuildingDictID=function(t,e){this.buildings_dict_id.has(t.stats.id)||this.buildings_dict_id.set(t.stats.id,new k.BuildingContainer),e?this.buildings_dict_id.get(t.stats.id).add(t):this.buildings_dict_id.get(t.stats.id).remove(t)},e.prototype.addBuilding=function(t){return t.setCity(this),this.buildings.add(t),this.setBuildingDictType(t,!0),this.cityStatusDirty=!0,h.default.update(4,this.buildings.length,!0),t},e.prototype.countBuildingsType=function(t){var e=this.getBuildingContainer(t);return e?(e.checkAddRemove(),e.length):0},e.prototype.countBuildingsID=function(t){var e=this.getBuildingContainer(t);return e?(e.checkAddRemove(),e.length):0},e.prototype.haveBuildingType=function(t,e){void 0===e&&(e=!0);var i=this.getBuildingContainer(t);if(!i)return!1;if(i.checkAddRemove(),0==i.length)return!1;var o=i.getSimpleList()[0];return!e||!o.data.underConstruction},e.prototype.getBuildingContainer=function(t){return this.buildings_dict_type.get(t)},e.prototype.getBuildingType=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var o=this.getBuildingContainer(t);if(!o)return null;if(o.checkAddRemove(),0==o.length)return null;var a=i?o.getRandom():o.getSimpleList()[0];return e&&a.data.underConstruction?null:a},e.prototype.addRoads=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.type.road||!i.type.liquid||this.roadTilesToBuild.includes(i)||this.roadTilesToBuild.push(i)}},e.prototype.tryToMakeWarrior=function(t){if(this.status.warriorSlots<=this.status.warriorCurrent)return!1;if(!this.blacksmith)return!1;if(this.data.storage.itemStorage.weapon.data||this.tryProduceItem(this.blacksmith,T.ItemProductionOrder.Weapon),!this.data.storage.itemStorage.weapon.data&&t.equipment.weapon.isEmpty())return!1;if(t.setProfession(f.UnitProfession.Warrior),t.equipment.weapon.isEmpty()&&i.giveItem(t,this.data.storage.itemStorage.weapon,this),this.status.warriorCurrent++,h.default.update(28,this.status.warriorCurrent,!0),this.timer_warrior=30,this.leader){var e=this.leader.curStats.warfare/2;this.timer_warrior-=e,this.timer_warrior<1&&(this.timer_warrior=1)}return this.haveBuildingType("barracks")&&(this.timer_warrior/=2),!0},e.prototype.findNewJob=function(t){if(0==this.captureTicks)if(t.isProfession(f.UnitProfession.Warrior))this.status.warriorSlots<this.status.warriorCurrent&&(t.setProfession(f.UnitProfession.Unit),this.status.warriorCurrent--);else if(this.timer_warrior<=0&&t.isProfession(f.UnitProfession.Unit)&&this.data.storage.get("gold")>10&&this.tryToMakeWarrior(t))return;if(j.default.prepare(this,t),!(j.default.checkJob("fireman")||j.default.checkJob("builder")||!this.getFoodItem()&&j.default.checkJob("gatherer")))for(var e=t.isProfession(f.UnitProfession.Warrior)?j.default.jobsWarrior:j.default.jobsUnit,i=0;i<e.length;i++){var o="";if(t.isProfession(f.UnitProfession.Warrior)?(this.currentTaskID_warrior++,this.currentTaskID_warrior>e.length-1&&(this.currentTaskID_warrior=0),o=e[this.currentTaskID_warrior]):(this.currentTaskID_unit++,this.currentTaskID_unit>e.length-1&&(this.currentTaskID_unit=0),o=e[this.currentTaskID_unit]),("settler"!=o||t!=this.leader&&t!=this.kingdom.king)&&j.default.checkJob(o))break}},e.prototype.tryProduceItem=function(t,e){void 0===e&&(e=T.ItemProductionOrder.Both);var i=t.getCulture();if(i){var o=1;switch(e){case T.ItemProductionOrder.RandomArmor:if(i.haveTech("armor_production")){var a=m.default.getList(this.data.storage.itemStorage,!0);if(0!=a.length){var n=a.getRandom();o+=d.default.intCast(i.stats.item_production_tries_weapons.value),this.produceItem(t,t.data.firstName,n,o)}}break;case T.ItemProductionOrder.Weapon:i.haveTech("weapon_production")&&!this.data.storage.itemStorage.weapon.data&&(o+=d.default.intCast(i.stats.item_production_tries_armor.value),this.produceItem(t,t.data.firstName,this.data.storage.itemStorage.weapon,o));break;case T.ItemProductionOrder.Both:this.tryProduceItem(t,T.ItemProductionOrder.RandomArmor),this.tryProduceItem(t,T.ItemProductionOrder.Weapon)}}},e.prototype.produceItem=function(t,e,i,o){void 0===o&&(o=1);var a=t.getCulture();if(a){var n=null;switch(i.type){case g.EquipmentType.Weapon:n=w.default.items_material_weapon;break;case g.EquipmentType.Helmet:case g.EquipmentType.Armor:case g.EquipmentType.Boots:n=w.default.items_material_armor;break;case g.EquipmentType.Ring:case g.EquipmentType.Amulet:n=w.default.items_material_accessory}var r=w.default.items.getEquipmentID(i.type);"weapon"==r&&(r=this.race.preferred_weapons.getRandom());var s=w.default.items.get(r);if(!s.tech_needed||a.haveTech(s.tech_needed)){var l=this.data.storage.getMaterialForItem(s,n,this);l&&(S.default.generateItem(s,l.id,i,R.default.inst.mapStats.year,this.kingdom.data.name,e,o),this.data.storage.change("gold",-l.cost_gold),"none"!=l.cost_resource_id_1&&this.data.storage.change(l.cost_resource_id_1,-l.cost_resource_1),"none"!=l.cost_resource_id_2&&this.data.storage.change(l.cost_resource_id_2,-l.cost_resource_2))}}},e.prototype.getFoodItem=function(t){return void 0===t&&(t=""),t&&this.data.storage.get(t)>0?w.default.resources.get(t):this.data.storage.getRandomFood()},e.prototype.eatFoodItem=function(t){t&&this.data.storage.change(t,-1)},e.prototype.removeZone=function(t,e){var i;void 0===e&&(e=!1),this!=(null===(i=L.default.inst.kingdom)||void 0===i?void 0:i.capital)&&(this.zones.remove(t)&&(t.setCity(null),R.default.inst.cityPlaceFinder.setDirty()),this.updateCityCenter(),e&&this.abandonBuildingsInZone(t),this.cityStatusDirty=!0)},e.prototype.abandonBuildingsInZone=function(t){if(0!=t.buildings.size){i._buildingsToAbandon=[];for(var e=0;e<t.buildings.length;e++){var o=t.buildings[e];o.city==this&&i._buildingsToAbandon.push(o)}for(e=0;e<i._buildingsToAbandon.length;e++){var a=i._buildingsToAbandon[e];this.abandonBuilding(a)}this.buildings.checkAddRemove()}},e.prototype.addZone=function(t){var e,i;if(!this.zones.includes(t)){t.city&&t.city.removeZone(t),this.zones.push(t),h.default.update(22,this.zones.length,!0),t.setCity(this),this.updateCityCenter(),R.default.inst.cityPlaceFinder.zones.length>0&&R.default.inst.cityPlaceFinder.setDirty(),this.cityStatusDirty=!0,P.Toolbox.temp_list_buildings_2=[],P.Toolbox.temp_list_buildings_2.addRange(Array.from(t.abandoned));for(var o=0;o<P.Toolbox.temp_list_buildings_2.length;o++){var a=P.Toolbox.temp_list_buildings_2[o];!a.stats.cityBuilding||a.stats.race&&a.stats.race!=this.kingdom.race.id||a.data.state!=k.BuildingState.CivAbandoned||(this.addBuilding(a),a.retake())}var n=0;try{for(var r=l(this.kingdom.cities),s=r.next();!s.done;s=r.next())n+=s.value.zones.length}catch(p){e={error:p}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}var c=Math.floor(n/R.default.inst.zoneCalculator.length*100);h.default.update(62,c,!0),1==R.default.inst.kingdoms.length&&c>=60&&h.default.update(39,c,!0)}},e.prototype.getRelationRating=function(){if(this._opinion_king=0,this._opinion_leader=0,this._opinion_population=0,this._opinion_zones=0,this._opinion_distance=0,this._opinion_capital=0,this._opinion_loyalty_traits=0,this._opinion_loyalty_mood=0,this._opinion_cities=0,this._opinion_superior_enemies=0,this._opinion_close_to_capital=0,this._opinion_world_law=0,this._opinion_culture=0,!R.default.inst.worldLaws.world_law_rebellions.boolVal)return this._opinion_world_law=100,this._opinion_total=100,this._opinion_total;if(this.isCapitalCity())return this._opinion_total=100,this._opinion_capital=100,this._opinion_total;if(this.kingdom.capital&&(i.nearbyBorders(this.kingdom.capital,this)&&(this._opinion_close_to_capital=15),this.kingdom.capital.getCulture()==this.getCulture()?this._opinion_culture=10:this._opinion_culture=-10),this.data.age<=25?this._opinion_new_city=25-this.data.age:this._opinion_new_city=0,this.kingdom.data.age<=30?this._opinion_new_kingdom=30-this.kingdom.data.age:this._opinion_new_kingdom=0,this.kingdom.civs_enemies.size>0){var t=0;this.kingdom.civs_enemies.forEach(function(e,i){t+=i.power}),this._opinion_superior_enemies=(t-this.kingdom.power)/2,this._opinion_superior_enemies<0?this._opinion_superior_enemies=0:this._opinion_superior_enemies>50&&(this._opinion_superior_enemies=50)}this.kingdom.king&&(this._opinion_king=this.kingdom.king.curStats.diplomacy);var e=this.kingdom.getMaxCities();if(this.kingdom.cities.length>e&&(this._opinion_cities=25*(e-this.kingdom.cities.length)),this.leader&&(this._opinion_leader=-this.leader.curStats.diplomacy,this._opinion_loyalty_traits=this.leader.curStats.loyalty_traits),this.leader&&this.kingdom.king){var o=w.default.traits.checkTraitsMod(this.leader,this.kingdom.king);this._opinion_loyalty_traits+=o}if(this.kingdom.capital){var a=Math.abs(this.status.population-this.kingdom.capital.status.population)/3;a>30&&(a=30),this.status.population>this.kingdom.capital.status.population?this._opinion_population=-a:this._opinion_population=a;var n=Math.abs(this.zones.length-this.kingdom.capital.zones.length)/20;if(n>5&&(n=5),this.zones.length>this.kingdom.capital.zones.length?this._opinion_zones=-n:this._opinion_zones=n,this.cityCenter.x!=x.default.POINT_IN_VOID.x&&this.kingdom.capital.cityCenter.x!=x.default.POINT_IN_VOID.x){var r=d.default.intCast(P.Toolbox.distVec3(this.cityCenter,this.kingdom.capital.cityCenter)/10);this._opinion_distance=-r}}else this._opinion_capital=-20;return this.leader&&(this._opinion_loyalty_mood=this.leader.curStats.loyalty_mood),this._opinion_total=this._opinion_king+this._opinion_leader+this._opinion_population+this._opinion_zones+this._opinion_distance+this._opinion_capital+this._opinion_loyalty_traits+this._opinion_loyalty_mood+this._opinion_new_kingdom+this._opinion_cities+this._opinion_superior_enemies+this._opinion_close_to_capital+this._opinion_culture+this._opinion_new_city,this._opinion_total},e.prototype.isCapitalCity=function(){return!!this.kingdom&&this==this.kingdom.capital},e.prototype.updateAge=function(){this.data.age++,this.gold_in_tax=this.getPopulationTotal()/2,this.gold_out_homeless=this.getPopulationTotal()-this.status.homesTotal,this.gold_out_homeless<0&&(this.gold_out_homeless=0),this.gold_out_army=this.countProfession(f.UnitProfession.Warrior)/2,this.gold_out_buildigs=this.buildings.length/2,this.gold_change=this.gold_in_tax-this.gold_out_army-this.gold_out_buildigs-this.gold_out_homeless;var t=this.gold_change;t<0&&(t=0),this.data.storage.change("gold",t),this.updatePopPoints()},e.prototype.updatePopPoints=function(){if(0!=this.data.popPoints.length)for(var t=0;t<this.data.popPoints.length;){var e=this.data.popPoints[t];(null==e?void 0:e.status)&&!e.status.updateAge&&(e.status=u.default.fromJson(e.status,new y.default)),e.status.updateAge(this.race)?t++:this.data.popPoints.splice(t,1)}},e.prototype.updateCityCenter=function(){if(0!=this.zones.length){for(var t=0,e=0,i=0,o=0,a=null,n=0;n<this.zones.length;n++){var r=this.zones[n];t+=r.centerTile.posV3.x,e+=r.centerTile.posV3.y}for(this.cityCenter.x=t/this.zones.length,this.cityCenter.y=e/this.zones.length,n=0;n<this.zones.length;n++){var s=this.zones[n];i=P.Toolbox.dist(s.centerTile.x,s.centerTile.y,this.cityCenter.x,this.cityCenter.y),(!a||i<o)&&(a=s,o=i)}this.cityCenter.x=a.centerTile.posV3.x,this.cityCenter.y=a.centerTile.posV3.y+2,this.lastCityCenter=this.cityCenter}else this.cityCenter=x.default.POINT_IN_VOID},e.prototype.removeFromCurrentKingdom=function(){this.kingdom.removeCity(this);for(var t=this.units.getSimpleList(),e=0;e<t.length;e++){var i=t[e];this.kingdom.removeUnit(i)}},e.prototype.switchedKingdom=function(){for(var t=this.buildings.getSimpleList(),e=0;e<t.length;e++){var i=t[e];i.data.state!=k.BuildingState.Removed&&i.setKingdom(this.kingdom)}R.default.inst.zoneCalculator.setDrawnZonesDirty()},e.prototype.useInspire=function(){var t=this.kingdom;this.makeOwnKingdom(),R.default.inst.kingdoms.diplomacyManager.startWar(this.kingdom,t,!0)},e.prototype.clearCurrentCaptureAmounts=function(){this.capturingUnits.clear()},e.prototype.updateConquest=function(t){t.kingdom.isCiv()&&t.kingdom.race==this.kingdom.race&&(t.kingdom==this.kingdom||t.kingdom.isEnemy(this.kingdom))&&this.addCapturePoints(t,1)},e.prototype.addCapturePoints=function(t,e){if(this.capturingUnits.has(t.kingdom)){var i=this.capturingUnits.get(t.kingdom);i+=e,this.capturingUnits.set(t.kingdom,i)}else this.capturingUnits.set(t.kingdom,e)},e.prototype.checkConquestBy=function(t){this.clearCapture(),this.joinAnotherKingdom(t),h.default.update(29)},e.prototype.getMaximumZones=function(){return this.status.maximumZones},e.prototype.shrinkZones=function(t){if(void 0===t&&(t=!0),!(t&&P.Toolbox.randomChance(.2)||0==this.zones.length)){for(var e=null,i=0,o=0,a=0;a<this.zones.length;a++){var n=this.zones[a];if(!(n.buildings.size>0)&&(i=P.Toolbox.distVec2(n.centerTile.pos,cc.v2(this.cityCenter)),!e||i>o)){for(var r=!0,s=0;s<n.neighbours.length;s++)if(n.neighbours[s].city!=this){r=!1;break}r||(e=n,o=i)}}e&&(this.removeZone(e),this.cityStatusDirty=!0)}},e.prototype.makeOwnKingdom=function(){this.removeFromCurrentKingdom();var t=R.default.inst.kingdoms.makeNewCivKingdom(this);return this.switchedKingdom(),t},e.prototype.getPopulationTotal=function(){return this.units.length+this.data.popPoints.length},e.prototype.getPopulationPopPoints=function(){return this.data.popPoints.length},e.prototype.getPopulationUnits=function(){return this.units.length},e.prototype.joinAnotherKingdom=function(t){var e=this.kingdom;this.removeFromCurrentKingdom(),this.setKingdom(t),this.switchedKingdom(),t.data.timer_event=0,this.data.timer_revolt=150,t.capturedFrom(e)},e.prototype.forceSettleTarget=function(t){this.settlerTargetTimer=500,this.settleTarget=null,t!=this&&t.getTile()&&(this.settleTarget=t.getTile().zone)},e.prototype.getArmy=function(){return this.countProfession(f.UnitProfession.Warrior)},e.prototype.getArmyMaxLeader=function(){var t=this.race.civ_baseArmy;return this.leader&&(t+=this.leader.curStats.army),t=d.default.clamp(t,10,65),d.default.intCast(t+this.getPopulationTotal()*t/100)},e.prototype.getArmyMaxCity=function(){return this.status.warriorSlots},e.makeLeader=function(t,e){t&&e.kingdom.king!=t&&(e.leader=t,e.leader.setProfession(f.UnitProfession.Leader),e.data.leaderID=t.data.actorID)},e.nearbyBorders=function(t,e){var i,o,a=null,n=null;t.zones.length>e.zones.length?(a=e,n=t):(a=t,n=e);for(var r=0;r<a.zones.length;r++){var s=a.zones[r];try{for(var c=(i=void 0,l(s.neighboursAll)),d=c.next();!d.done;d=c.next())if(d.value.city==n)return!0}catch(p){i={error:p}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}return!1},e.giveItem=function(t,e){if(!t.equipment)return!1;var i=t.equipment.getSlot(e.type);if(i.data){var o=A.default.calcItemValues(i.data);if(A.default.calcItemValues(e.data)>o){var a=i.data;i.setItem(e.data),e.setItem(a),t.setStatsDirty()}return!1}return i.setItem(e.data),e.emptySlot(),t.setStatsDirty(),!0},e.prototype.getLimitOfBuildings=function(t){var e=t.limitType,i=this.getCulture();return i&&"watch_tower"==t.buildingID&&(e+=d.default.intCast(i.stats.bonus_watch_towers.value),this.leader&&(e+=this.leader.curStats.bonus_towers)),e},e.prototype.getHashCode=function(){return this.city_hash_id},e.prototype.equals=function(t){return this.city_hash_id==t.city_hash_id},e.unitProfessions=[],e._buildingsToAbandon=[],e.LAST_CITY_HASH_ID=0,i=s([U],e)}(B.default));n.default=W,cc._RF.pop()},{}],CloudController:[function(t,e,i){"use strict";cc._RF.push(e,"3ffb1lyOYhGpqgOvuvTARbc","CloudController");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.CloudController=void 0;var c=a("AchievData"),d=a("ToolBox"),u=a("Cloud"),h=a("BaseEffectController"),p=cc._decorator,f=p.ccclass,_=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){t.prototype.create.call(this),this.timer_interval=15},e.prototype.getNext=function(){var t,e,i=this.getObject();i.created||i.create();var o=0;try{for(var a=l(this.list),n=a.next();!n.done;n=a.next())n.value.getComponent(u.default).type!=u.CloudType.normal&&o++}catch(d){t={error:d}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return c.default.update(41,o,!0),i},e.prototype.spawnCloud=function(t,e){this.getNext().init(t,e)},e.prototype.spawn=function(){this.getNext().init()},e.prototype.checkTile=function(t,e){var i,o;try{for(var a=l(this.list),n=a.next();!n.done;n=a.next()){var r=n.value;if(!(d.Toolbox.dist(r.x,r.y,t.pos.x,t.pos.y)>e)){r.getComponent(u.default).startToDie();break}}}catch(h){i={error:h}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},s([f],e)}(h.default));n.CloudController=_,cc._RF.pop()},{}],Cloud:[function(t,e,i){"use strict";cc._RF.push(e,"f226dylhHNKBovoy7uJ+4ie","Cloud");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.CloudType=void 0;var l,c=a("MathUtils"),d=a("GameCommon"),u=a("BaseEffect"),h=a("MoveCamera"),p=a("ToolBox"),f=a("Config"),_=a("MapBox"),m=a("WorldTimer"),g=cc._decorator,y=g.ccclass,v=g.property;(function(t){t[t.normal=0]="normal",t[t.rain=1]="rain",t[t.lava=2]="lava",t[t.acid=3]="acid",t[t.snow=4]="snow"})(l=n.CloudType||(n.CloudType={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colorNormal=cc.color(255,255,255),e.colorRain=cc.color(160,160,160),e.colorLava=cc.color(238,105,0),e.colorAcid=cc.color(60,231,65),e.colorSnow=cc.color(60,231,65),e.cloudSprites=[],e.sprShadow=null,e.offset=cc.v2(0,-20),e.shadowColor=cc.color(38,37,65),e.maxAlpha=76.5,e.speedMax=6,e.speed=1,e._type=l.normal,e.timerFallingPixels=null,e.dropID="",e.fadeMultiplier=51,e}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),e.prototype.init=function(e,i){void 0===e&&(e=null),void 0===i&&(i="normal"),this.timerFallingPixels||(this.timerFallingPixels=new m.default(.05,this.cloudAction.bind(this))),e||(e=cc.v3(p.Toolbox.randomRange(-50,30),p.Toolbox.randomRange(0,240))),t.prototype.prepare.call(this,e,.2),this.node.scaleX*=p.Toolbox.randomBool()?1:-1,this.speed=p.Toolbox.randomFloat(1,this.speedMax),this.loadTexture(this.cloudSprites.getRandom()),this.setType(i),this.setAlpha(0)},e.prototype.loadTexture=function(t){this.sprRenderer||(this.sprRenderer=this.node.getChildByName("cloud").getComponent(cc.Sprite)),this.sprRenderer.spriteFrame=t,this.sprShadow.spriteFrame=t},e.prototype.cloudAction=function(){if(!(this.type==l.normal||this.alpha<.1)){var t=.08*this.sprRenderer.spriteFrame.getOriginalSize().width,e=.04*this.sprRenderer.spriteFrame.getOriginalSize().height,i=c.default.intCast(this.node.x),o=c.default.intCast(this.node.y);i+=c.default.intCast(p.Toolbox.randomFloat(0-t,t)),o+=c.default.intCast(p.Toolbox.randomFloat(0-e+this.offset.y,e+this.offset.y));var a=_.default.inst.getTile(i,o);a&&(_.default.inst.dropManager.spawn(a,this.dropID,10),this.type==l.rain&&p.Toolbox.randomChance(.01)&&(i+=c.default.intCast(p.Toolbox.randomFloat(.5*t,t)),o+=c.default.intCast(p.Toolbox.randomFloat(0-e+this.offset.y,e+this.offset.y)),(a=_.default.inst.getTile(i,o))&&_.default.spawnLightning(a,.15)))}},e.prototype.setType=function(t){"cloudRain"==t?(this._type=l.rain,this.sprRenderer.node.color=this.colorRain,this.maxAlpha=204,this.dropID="rain"):"cloudAcid"==t?(this._type=l.acid,this.sprRenderer.node.color=this.colorAcid,this.maxAlpha=204,this.dropID="acid"):"cloudLava"==t?(this._type=l.lava,this.sprRenderer.node.color=this.colorLava,this.maxAlpha=204,this.dropID="lava"):"cloudSnow"==t?(this._type=l.snow,this.sprRenderer.node.color=this.colorSnow,this.maxAlpha=204,this.dropID="snow"):(this._type=l.normal,this.sprRenderer.node.color=this.colorNormal,this.maxAlpha=127.5,this.dropID=null)},e.prototype.logicUpdate=function(t){f.default.timeScale>10?this.fadeMultiplier=12.75:this.fadeMultiplier=51,d.default.isPaused||(this.node.x+=this.speed*t,this.timerFallingPixels.logicUpdate(t)),this.node.x>_.default.width&&this.startToDie();var e=this.maxAlpha;switch(e*=h.MoveCamera.inst.magnification,this.state){case 1:this.alpha<e?(this.alpha+=t*this.fadeMultiplier,this.alpha>=e&&(this.alpha=e)):this.alpha>e?(this.alpha-=t*this.fadeMultiplier,this.alpha<=e&&(this.alpha=e)):this.alpha=e,this.setAlpha(this.alpha);break;case 2:this.alpha>0?this.alpha-=t*this.fadeMultiplier:(this.alpha=0,this.controller.killObject(this)),this.setAlpha(this.alpha)}},s([v(cc.Color)],e.prototype,"colorNormal",void 0),s([v(cc.Color)],e.prototype,"colorRain",void 0),s([v(cc.Color)],e.prototype,"colorLava",void 0),s([v(cc.Color)],e.prototype,"colorAcid",void 0),s([v(cc.Color)],e.prototype,"colorSnow",void 0),s([v([cc.SpriteFrame])],e.prototype,"cloudSprites",void 0),s([v(cc.Sprite)],e.prototype,"sprShadow",void 0),s([v(cc.Vec2)],e.prototype,"offset",void 0),s([v(cc.Color)],e.prototype,"shadowColor",void 0),s([y],e)}(u.default);n.default=b,cc._RF.pop()},{}],CondGroupLeader:[function(t,e,i){"use strict";cc._RF.push(e,"2d522Nyi9VMTJdrhI2BtWkk","CondGroupLeader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!!t.kingdom.isCiv()&&(null===(e=t.unitGroup)||void 0===e?void 0:e.groupLeader)==t},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],CondHaveAttackTarget:[function(t,e,i){"use strict";cc._RF.push(e,"649d5OonhBKApCuuSo53LmD","CondHaveAttackTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!!t.kingdom.isCiv()&&(null===(e=t.unitGroup)||void 0===e?void 0:e.groupLeader)==t&&!!t.city&&!!t.city.attackZone},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],CondHaveUnitGroup:[function(t,e,i){"use strict";cc._RF.push(e,"46b3cZ67NFKla/MlTx/JNnh","CondHaveUnitGroup");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!(null===(e=t.unitGroup)||void 0===e||!e.isAlive())||(t.unitGroup=null,!1)},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],CondNoAttackTarget:[function(t,e,i){"use strict";cc._RF.push(e,"9d7c4rXYT9Gx7A9YPARqsg0","CondNoAttackTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!!t.kingdom.isCiv()&&(null===(e=t.unitGroup)||void 0===e?void 0:e.groupLeader)==t&&!!t.city&&!t.city.attackZone},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],CondNoUnitGroup:[function(t,e,i){"use strict";cc._RF.push(e,"94de3eSk3xJppzuPNWsokhW","CondNoUnitGroup");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!(null!==(e=t.unitGroup)&&void 0!==e&&e.isAlive()||(t.unitGroup=null,0))},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],CondNotGroupLeader:[function(t,e,i){"use strict";cc._RF.push(e,"5b794Z6srVMWqwUCFvfzeX/","CondNotGroupLeader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.check=function(t){var e;return!!t.kingdom.isCiv()&&(null===(e=t.unitGroup)||void 0===e?void 0:e.groupLeader)!=t},e}(a("BaseCondition").BehaviourActorCondition);n.default=s,cc._RF.pop()},{}],Config:[function(t,e,i){"use strict";cc._RF.push(e,"130d8S7Ni9NrJzwjgJEDArE","Config");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.PerformanceConfig=void 0;var n=o("MoveCamera"),r=function(){function t(){}return t.gv="worldbox",t.controllableUnit=null,t.newRender=!0,t.WORLD_SAVE_VERSION=9,t.customMapSize="standard",t.customZoneX=0,t.customZoneY=0,t.customPerlinScale=5,t.customRandomShapes=10,t.customWaterLevel=0,t.ZONE_AMOUNT_X=4,t.ZONE_AMOUNT_Y=4,t.customMapSizeDefault="standard",t.maxMapSize="iceberg",t.ZONE_AMOUNT_X_DEFAULT=3,t.ZONE_AMOUNT_Y_DEFAULT=4,t.timeScale=1,t.defaultTimeScale=3,t.fastCities=!1,t.actorFastMode=1,t.LOAD_TIME_CREATE=0,t.LOAD_TIME_GENERATE=0,t.EVERYTHING_MAGIC_COLOR=!1,t.EVERYTHING_FIREWORKS=!1,t.jobs_updater_parallel=!1,t.gameLoaded=!1,t.greyGooDamaged=!1,t.fireDamage=0,t.currentSlot=0,t.currentBrush="circ_2",t.currentBrushData=null,t.selectedCity=null,t.selectedKingdom=null,t.selectedUnit=null,t.selectedCulture=null,t.selectedProp="",t.propUseCount=0,t.showkingsAndLeadersInfo=!1,t.showmarks_boatsInfo=!1,t.showHistoryLog=!1,t.maxFreeSaveSlotId=1,t.spectatorMode=function(){return null!=n.MoveCamera.focusUnit},t.controllingUnit=function(){return null!=t.controllableUnit},t.maxSlotCount=6,t.quickSaveSlotId=0,t.mode_sandBox=!0,t.mode_count=!0,t.useFog=!1,t.firstClick=!0,t}();a.default=r;var s=function(){function t(){}return t.intervalOfAutoSave=900,t.intervalOfSortActors=.3,t.maxBuildings=500,t.maxCreatures=150,t}();a.PerformanceConfig=s,cc._RF.pop()},{}],ConwayLife:[function(t,e,i){"use strict";cc._RF.push(e,"b571dfyLE9FF5M5ev1TgzMG","ConwayLife");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.ConwayType=void 0;var c,d=a("GameCommon"),u=a("MapAction"),h=a("ToolBox"),p=a("Config"),f=a("MapLayer"),_=a("TileDictionary");(function(t){t[t.Eater=0]="Eater",t[t.Creator=1]="Creator",t[t.None=2]="None"})(c=n.ConwayType||(n.ConwayType={}));var m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.makeFlash=!0,e.newList=new _.TileDictionary,e.nextTickTimer=0,e.nextTickInterval=.05,e.decreaseTick=0,e.toRemove=[],e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.colorCreator=h.Toolbox.makeColor("#3BCC55"),this.tileDictionary=new _.TileDictionary,t.prototype.create.call(this)},e.prototype.updateDirty=function(t){if(this.updateVisual(),!d.default.isPaused)if(this.nextTickTimer>0)this.nextTickTimer-=t;else{this.nextTickTimer=this.nextTickInterval;for(var e=0;e<p.default.timeScale;e++)this.updateTick()}},e.prototype.updateVisual=function(){var t=this;0!=this.pixels_to_update.length()&&(this.pixels_to_update.dict.forEach(function(e,o){t.tileDictionary.contains(o)?o.data.conwayType==c.Eater?t.updateSinglePixel(o.data.tile_id,i.colorEater):o.data.conwayType==c.Creator?t.updateSinglePixel(o.data.tile_id,i.colorCreator):t.updateSinglePixel(o.data.tile_id,h.Toolbox.clear):(o.data.conwayType=c.None,t.updateSinglePixel(o.data.tile_id,h.Toolbox.clear))}),this.pixels_to_update.clear(),this.updatePixels())},e.prototype.remove=function(t){this.tileDictionary.remove(t),this.pixels_to_update.add(t),t.data.conwayType=c.None},e.prototype.add=function(t,e){t.data.conwayType="conway"==e?c.Eater:c.Creator,this.tileDictionary.add(t),this.pixels_to_update.add(t)},e.prototype.updateTick=function(){var t=this;if(this.decreaseTick--<=0&&(this.decreaseTick=5),!(this.tileDictionary.length()<=0&&this.newList.length()<=0)){this.newList.clear(),this.tileDictionary.dict.forEach(function(e,i){t.checkCell(i),i.neighboursAll.forEach(function(e){t.checkCell(e)})});var e=this.tileDictionary;this.tileDictionary=this.newList,this.newList=e,this.updateVisual()}},e.prototype.makeAlive=function(t){5==this.decreaseTick&&(t.data.conwayType==c.Eater?u.default.decreaseTile(t,"destroy_no_flash"):u.default.increaseTile(t,"destroy_no_flash")),this.newList.add(t),this.makeFlash&&this.makeFlashh(t,25)},e.prototype.makeFlashh=function(t){t.data.conwayType,c.None},e.prototype.clear=function(){t.prototype.clear.call(this),this.newList.clear(),this.tileDictionary.clear()},e.prototype.checkCell=function(t){var e,i,o=this;if(!this.pixels_to_update.contains(t)){var a=0,n=0,r=0;if(this.pixels_to_update.add(t),t.data.conwayType==c.Eater&&n++,t.data.conwayType==c.Creator&&r++,this.tileDictionary.contains(t)){try{for(var s=l(t.neighboursAll),d=s.next();!d.done;d=s.next()){var u=d.value;if(this.tileDictionary.contains(u)&&(a++,u.data.conwayType==c.Creator?r++:u.data.conwayType==c.Eater&&n++),a>=4)return this.makeFlash&&this.makeFlashh(t,15),void(t.data.conwayType=c.None)}}catch(f){e={error:f}}finally{try{d&&!d.done&&(i=s.return)&&i.call(s)}finally{if(e)throw e.error}}2==a||3==a?(t.data.conwayType!=c.None||0==n&&0==r||(t.data.conwayType=n>=r?c.Eater:c.Creator),this.makeAlive(t)):t.data.conwayType=c.None}else t.neighboursAll.forEach(function(t){o.tileDictionary.contains(t)&&a++,t.data.conwayType==c.Eater&&n++,t.data.conwayType==c.Creator&&r++}),3==a&&(t.data.conwayType!=c.None||0==n&&0==r||(t.data.conwayType=n>=r?c.Eater:c.Creator),this.makeAlive(t))}},e.prototype.checkKillRange=function(t,e){var i=this;0!=this.tileDictionary.dict.size&&(this.toRemove=[],this.tileDictionary.dict.forEach(function(o,a){h.Toolbox.distVec2(a.pos,t)<=e&&(a.data.conwayType=c.None,i.toRemove.push(a))}),this.toRemove.forEach(function(t){i.remove(t)}))},e.colorEater=cc.color(255,51,255),e.colorCreator=cc.Color.TRANSPARENT,s([y],e.prototype,"makeFlash",void 0),i=s([g],e)}(f.default);n.default=v,cc._RF.pop()},{}],CreatureInfo:[function(t,e,i){"use strict";cc._RF.push(e,"8bdf3CKYYxKoJ9U9FcL8i/s","CreatureInfo");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("MathUtils"),d=a("GamePopBase"),u=a("LocalizedTextManager"),h=a("Boat"),p=a("UnitAvatarLoader"),f=a("AssetManager"),_=a("MoveCamera"),m=a("ToolBox"),g=a("ViewController"),y=a("Config"),v=a("TextureLoader"),b=a("ToolTip"),w=a("WorldTip"),T=cc._decorator,k=T.ccclass,B=T.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtName=null,e.favoriteFoodBg=null,e.favoriteFoodSpr=null,e.moodBG=null,e.traitsParent=null,e.equipmentParent=null,e.health=null,e.hunger=null,e.damage=null,e.armor=null,e.speed=null,e.crit=null,e.attackSpeed=null,e.diplomacy=null,e.warfare=null,e.stewardship=null,e.avatarLoader=null,e.iconFavorite=null,e.buttonKingdom=null,e.buttonCity=null,e.text_description=null,e.text_values=null,e.temp_equipment=[],e}return r(e,t),e.prototype.start=function(){this.showUser(),cc.tween(this.favoriteFoodBg).by(1.3,{angle:90}).repeatForever().start()},e.prototype.close=function(){w.default.inst.hide(),t.prototype.close.call(this)},e.prototype.showUser=function(){var t,e,i,o,a,n,r,s,l,d,p,_,m;if((null===(e=null===(t=y.default.selectedUnit)||void 0===t?void 0:t.data)||void 0===e?void 0:e.alive)&&(null===(i=y.default.selectedUnit)||void 0===i?void 0:i.stats)){var g=y.default.selectedUnit;if(this.txtName.string=g.data.firstName,this.health.progress=g.data.health/g.curStats.health,this.health.node.getChildByName("label").getComponent(cc.Label).string=g.data.health+"/"+g.curStats.health,g.stats.needFood||g.stats.unit){this.hunger.node.parent.active=!0;var v=c.default.intCast(g.data.hunger/g.stats.maxHunger*100);this.hunger.progress=v/100,this.hunger.node.getChildByName("label").getComponent(cc.Label).string=v+"%"}else this.hunger.node.parent.active=!1;if(this.damage.active=!0,this.armor.active=!0,this.speed.active=!0,this.attackSpeed.active=!0,this.crit.active=!0,this.diplomacy.active=!0,this.warfare.active=!0,this.stewardship.active=!0,g.stats.unit||(this.diplomacy.active=!1,this.warfare.active=!1,this.stewardship.active=!1),g.stats.inspect_stats||(this.damage.active=!1,this.armor.active=!1,this.speed.active=!1,this.diplomacy.active=!1,this.attackSpeed.active=!1,this.crit.active=!1),this.damage.getChildByName("richText").getComponent(cc.RichText).string=""+g.curStats.damage,this.armor.getChildByName("richText").getComponent(cc.RichText).string=Math.floor(100*g.curStats.armor)/100+"%",this.speed.getChildByName("richText").getComponent(cc.RichText).string=""+g.curStats.speed,this.crit.getChildByName("richText").getComponent(cc.RichText).string=Math.floor(100*g.curStats.crit)/100+"%",this.attackSpeed.getChildByName("richText").getComponent(cc.RichText).string=""+g.curStats.attackSpeed,this.showAttribute(this.diplomacy.getChildByName("richText").getComponent(cc.RichText),g.curStats.diplomacy),this.showAttribute(this.stewardship.getChildByName("richText").getComponent(cc.RichText),g.curStats.stewardship),this.showAttribute(this.warfare.getChildByName("richText").getComponent(cc.RichText),g.curStats.warfare),this.avatarLoader.load(g),this.iconFavorite.parent.active=!g.stats.hideFavoriteIcon,this.text_description.string="",this.text_values.string="",this.showStat("creature_statistics_age",""+y.default.selectedUnit.data.age),g.stats.inspect_kills&&this.showStat("creature_statistics_kills",""+y.default.selectedUnit.data.kills),g.stats.inspect_experience&&this.showStat("creature_statistics_character_experience",y.default.selectedUnit.data.experience+"/"+y.default.selectedUnit.getExpToLevelup()),g.stats.inspect_experience&&this.showStat("creature_statistics_character_level",""+y.default.selectedUnit.data.level),g.stats.inspect_children&&this.showStat("creature_statistics_children",""+y.default.selectedUnit.data.children),this.moodBG.active=!1,this.favoriteFoodBg.active=!1,this.favoriteFoodSpr.node.active=!1,g.stats.unit&&!g.stats.baby){var b="??";y.default.selectedUnit.data.favoriteFood&&(b=u.LocalizedTextManager.getText(y.default.selectedUnit.data.favoriteFood),this.favoriteFoodBg.active=!0,this.favoriteFoodSpr.node.active=!0,this.favoriteFoodSpr.spriteFrame=f.default.resources.get(y.default.selectedUnit.data.favoriteFood).getSprite()),this.showStat("creature_statistics_favorite_food",b)}if(g.stats.unit){this.moodBG.active=!0,this.showStat("creature_statistics_mood",u.LocalizedTextManager.getText("mood_"+g.data.mood));var w=f.default.moods.get(g.data.mood);this.moodBG.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=w.getSprite(),g.s_personality&&this.showStat("creature_statistics_personality",u.LocalizedTextManager.getText("personality_"+g.s_personality.id))}if(this.text_description.string+="\n",this.text_values.string+="\n",g.stats.inspect_home&&this.showStat("creature_statistics_homeVillage",(null===(a=null===(o=y.default.selectedUnit.city)||void 0===o?void 0:o.data)||void 0===a?void 0:a.cityName)||"??",null===(r=null===(n=y.default.selectedUnit.kingdom)||void 0===n?void 0:n.kingdomColor)||void 0===r?void 0:r.colorBorderOut),(null===(s=y.default.selectedUnit.kingdom)||void 0===s?void 0:s.isCiv())&&this.showStat("kingdom",(null===(d=null===(l=y.default.selectedUnit.kingdom)||void 0===l?void 0:l.data)||void 0===d?void 0:d.name)||"??",null===(_=null===(p=y.default.selectedUnit.kingdom)||void 0===p?void 0:p.kingdomColor)||void 0===_?void 0:_.colorBorderOut),y.default.selectedUnit.stats.isBoat){var T=y.default.selectedUnit.getComponent(h.default);this.showStat("passengers",""+T.unitsInside.size),T.isState(h.BoatState.TransportDoLoading)&&this.showStat("status",u.LocalizedTextManager.getText("status_waiting_for_passengers"))}g.city?this.buttonCity.active=!0:this.buttonCity.active=!1,(null===(m=g.kingdom)||void 0===m?void 0:m.isCiv())?this.buttonKingdom.active=!0:this.buttonKingdom.active=!1,this.updateFavoriteIconFor(g),this.clearPrevButtons(),this.loadTraits(),this.loadEquipment()}},e.prototype.showAttribute=function(t,e){var i=""+e;e<4?i=m.Toolbox.coloredText(i,m.Toolbox.color_negative):e>=20&&(i=m.Toolbox.coloredText(i,m.Toolbox.color_positive)),t.string=i},e.prototype.showStat=function(t,e,i){void 0===i&&(i=null);var o=this.text_description;o.string=o.string+u.LocalizedTextManager.getText(t)+"\n";var a=this.text_values;a.string=i?a.string+m.Toolbox.coloredString(e,i.toHEX())+"\n":a.string+e+"\n"},e.prototype.clearPrevButtons=function(){this.traitsParent.destroyAllChildren(),this.equipmentParent.destroyAllChildren()},e.prototype.loadTraits=function(){var t,e,i=y.default.selectedUnit,o=0,a=i.data.traits.length;if(i.data.traits)try{for(var n=l(i.data.traits),r=n.next();!r.done;r=n.next()){var s=r.value;this.loadTraitButton(s,o,a),o++}}catch(u){t={error:u}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.loadEquipment=function(){var t,e,i=y.default.selectedUnit;if(this.temp_equipment=[],this.equipmentParent.parent.active=!1,i.equipment){this.equipmentParent.parent.active=!0,i.equipment.weapon.data&&this.temp_equipment.push(i.equipment.weapon),i.equipment.helmet.data&&this.temp_equipment.push(i.equipment.helmet),i.equipment.armor.data&&this.temp_equipment.push(i.equipment.armor),i.equipment.boots.data&&this.temp_equipment.push(i.equipment.boots),i.equipment.ring.data&&this.temp_equipment.push(i.equipment.ring),i.equipment.amulet.data&&this.temp_equipment.push(i.equipment.amulet);var o=0,a=this.temp_equipment.length;if(this.temp_equipment.length>0)try{for(var n=l(this.temp_equipment),r=n.next();!r.done;r=n.next()){var s=r.value;this.loadEquipmentButton(s,o,a),o++}}catch(u){t={error:u}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},e.prototype.loadEquipmentButton=function(t){var e=new cc.Node;e.scale=1.6,e.parent=this.equipmentParent,e.attr({data:t});var i="icons/items/icon_"+t.data.id;"base"!=t.data.material&&(i=i+"_"+t.data.material),e.addComponent(cc.Sprite).spriteFrame=v.TextureLoader.inst.getSpriteFrame(v.ATLAS_TYPE.UIATLAS,i),e.addComponent(cc.Button),e.on("click",this.clickEquipment,this)},e.prototype.loadTraitButton=function(t){var e=f.default.traits.get(t);if(e){var i=new cc.Node;i.scale=1.6,i.parent=this.traitsParent,i.attr({data:e}),i.addComponent(cc.Sprite).spriteFrame=v.TextureLoader.inst.getSpriteFrame(v.ATLAS_TYPE.UIATLAS,"icons/"+e.icon),i.addComponent(cc.Button),i.on("click",this.clickTrait,this)}},e.prototype.updateFavoriteIconFor=function(t){this.iconFavorite.opacity=t.data.favorite?255:127},e.prototype.pressFavorite=function(){if(y.default.selectedUnit){var t=y.default.selectedUnit;t.data.favorite=!t.data.favorite,this.updateFavoriteIconFor(t),t.data.favorite&&w.default.inst.show("tip_favorite_icon",!0,"top")}},e.prototype.onDisable=function(){y.default.selectedUnit&&(y.default.selectedUnit=null),t.prototype.onDisable.call(this)},e.prototype.clickAvatar=function(){var t=null;if(y.default.selectedUnit?t=y.default.selectedUnit.race:y.default.selectedCity?t=y.default.selectedCity.race:y.default.selectedKingdom&&(t=y.default.selectedKingdom.race),t){var e=m.Toolbox.randomInt(1,3),i="click_"+t.id+"_"+e;u.LocalizedTextManager.contains(i)&&w.default.inst.show(i,!0,"cursor")}},e.prototype.clickKingdom=function(t){y.default.selectedKingdom=y.default.selectedUnit.kingdom,g.default.open(g.view_type.KingdomWindow,null,t)},e.prototype.clickVillage=function(t){y.default.selectedCity=y.default.selectedUnit.city,g.default.open(g.view_type.CityWindow,null,t)},e.prototype.clickFollow=function(){this.close(),_.MoveCamera.inst.focusOnAndFollow(y.default.selectedUnit)},e.prototype.clickEquipment=function(t){var e=t.node.data;b.default.info_equipment_slot=e,b.default.inst.show(t.node,"equipment")},e.prototype.clickTrait=function(t){var e=t.node.data,i="trait_"+e.id,o="trait_"+e.id+"_info";u.LocalizedTextManager.contains(o)||(o=""),b.default.inst.show(t.node,"normal",i,o)},e.prototype.clickAttribute=function(t,e){var i=t.getCurrentTarget();b.default.info_tip=i.name,b.default.inst.show(i,"tip",i.name,e)},s([B(cc.Label)],e.prototype,"txtName",void 0),s([B(cc.Node)],e.prototype,"favoriteFoodBg",void 0),s([B(cc.Sprite)],e.prototype,"favoriteFoodSpr",void 0),s([B(cc.Node)],e.prototype,"moodBG",void 0),s([B(cc.Node)],e.prototype,"traitsParent",void 0),s([B(cc.Node)],e.prototype,"equipmentParent",void 0),s([B(cc.ProgressBar)],e.prototype,"health",void 0),s([B(cc.ProgressBar)],e.prototype,"hunger",void 0),s([B(cc.Node)],e.prototype,"damage",void 0),s([B(cc.Node)],e.prototype,"armor",void 0),s([B(cc.Node)],e.prototype,"speed",void 0),s([B(cc.Node)],e.prototype,"crit",void 0),s([B(cc.Node)],e.prototype,"attackSpeed",void 0),s([B(cc.Node)],e.prototype,"diplomacy",void 0),s([B(cc.Node)],e.prototype,"warfare",void 0),s([B(cc.Node)],e.prototype,"stewardship",void 0),s([B(p.default)],e.prototype,"avatarLoader",void 0),s([B(cc.Node)],e.prototype,"iconFavorite",void 0),s([B(cc.Node)],e.prototype,"buttonKingdom",void 0),s([B(cc.Node)],e.prototype,"buttonCity",void 0),s([B(cc.RichText)],e.prototype,"text_description",void 0),s([B(cc.RichText)],e.prototype,"text_values",void 0),s([k],e)}(d.GamePopBase);n.default=S,cc._RF.pop()},{}],CultureElement:[function(t,e,i){"use strict";cc._RF.push(e,"c08a5Pz/r5DgLKPGxQvwZC6","CultureElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AssetManager"),c=a("ToolBox"),d=a("ViewController"),u=a("Config"),h=a("TextureLoader"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtName=null,e.culture=null,e.textFollowers=null,e.textZones=null,e.textCities=null,e.textLevel=null,e.cultureElement=null,e.cultureDecor=null,e.iconRace=null,e}return r(e,t),e.prototype.initItem=function(t){var e,i,o,a;this.culture=t;var n=l.default.raceLibrary.get(t.race);this.iconRace.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.UIATLAS,"icons/"+n.icon),this.txtName.string=t.name,this.txtName.node.color=t.color32_text,this.cultureElement.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.WORLDATLAS,this.culture.icon_element),this.cultureDecor.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.WORLDATLAS,this.culture.icon_decor),this.cultureElement.node.color=c.Toolbox.makeColor(this.culture.color),this.cultureDecor.node.color=c.Toolbox.makeColor(this.culture.color),this.textFollowers.string=null!==(e=t.followers.toString())&&void 0!==e?e:"",this.textLevel.string=null!==(i=t.getCurrentLevel().toString())&&void 0!==i?i:"",this.textCities.string=null!==(o=t.cities.toString())&&void 0!==o?o:"",this.textZones.string=null!==(a=t.zones.size.toString())&&void 0!==a?a:""},e.prototype.clickCulture=function(){u.default.selectedCulture=this.culture,u.default.selectedCulture&&d.default.open(d.view_type.CultureWindow)},s([_(cc.Label)],e.prototype,"txtName",void 0),s([_(cc.Label)],e.prototype,"textFollowers",void 0),s([_(cc.Label)],e.prototype,"textZones",void 0),s([_(cc.Label)],e.prototype,"textCities",void 0),s([_(cc.Label)],e.prototype,"textLevel",void 0),s([_(cc.Sprite)],e.prototype,"cultureElement",void 0),s([_(cc.Sprite)],e.prototype,"cultureDecor",void 0),s([_(cc.Sprite)],e.prototype,"iconRace",void 0),s([f],e)}(cc.Component);n.default=m,cc._RF.pop()},{}],CultureManager:[function(t,e,i){"use strict";cc._RF.push(e,"007d4B/EIxG7pu/2IHsgTOG","CultureManager");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.CultureManager=void 0;var n=o("Log"),r=o("AssetManager"),s=o("MapBox"),l=o("Culture"),c=function(){function t(){this.list=[],this.dict=new Map,this._timer_recalc_values=0,this._to_remove=[]}return t.prototype.testCulture=function(){var t=new l.default,e=r.default.raceLibrary.get("elf");t.create(e,null);for(var i=0;i<100;i++)t.researchNewTechTest();for(var o="",a=0;a<t.list_tech_ids.length;a++)o=o+t.list_tech_ids[a]+",";n.default.d(o)},t.prototype.updateProgress=function(){for(var t=0;t<this.list.length;t++)this.list[t].updateProgress()},t.prototype.logicUpdate=function(t){for(var e=0;e<this.list.length;e++)this.list[e].logicUpdate(t);this.updateRecalcValues(t)},t.prototype.updateRecalcValues=function(t){this._timer_recalc_values>0?this._timer_recalc_values-=t:this.recalcCultureValues()},t.prototype.removeDeadCultures=function(){this._to_remove=[];for(var t=0;t<this.list.length;t++){var e=this.list[t];0==e.followers&&0==e.cities&&0==e.kingdoms&&this._to_remove.push(e)}for(t=0;t<this._to_remove.length;t++){var i=this._to_remove[t];i.clearZones(),this.list.remove(i),this.dict.delete(i.id)}},t.prototype.recalcCultureValues=function(){this._timer_recalc_values=3;for(var t=0;t<this.list.length;t++)this.list[t].reset();for(t=0;t<s.default.inst.kingdoms.list.length;t++){var e=s.default.inst.kingdoms.list[t];e.data.cultureID&&this.countKingdom(e);for(var i=0;i<e.cities.length;i++){var o=e.cities[i];this.countCity(o);for(var a=0;a<o.data.popPoints.length;a++){var n=o.data.popPoints[a];this.countUnit(n.status.culture)}}}for(t=0;t<s.default.inst.units.list.length;t++){var r=s.default.inst.units.list[t];this.countUnit(r.data.culture)}for(t=0;t<this.list.length;t++)this.list[t].calculateKnowledgeGain();this.removeDeadCultures()},t.prototype.countKingdom=function(t){var e=this.get(t.data.cultureID);e&&e.kingdoms++},t.prototype.countCity=function(t){var e=this.get(t.data.culture);e&&(e.cities++,e._list_cities.push(t))},t.prototype.countUnit=function(t){var e=this.get(t);e&&e.followers++},t.prototype.get=function(t){return t?this.dict.get(t):null},t.prototype.getCultureName=function(t){return t?this.get(t).name:""},t.prototype.save=function(){for(var t=0;t<this.list.length;t++)this.list[t].prepareForSave();return this.list},t.prototype.newCulture=function(t,e){var i=new l.default;return i.create(t,e),this.add(i),i},t.prototype.loadCulture=function(t){t.load(),this.add(t)},t.prototype.clear=function(){this.dict.clear(),this.list=[]},t.prototype.add=function(t){this.list.push(t),this.dict.set(t.id,t)},t.prototype.isColorUsed=function(t){for(var e=0;e<this.list.length;e++)if(this.list[e].color==t)return!0;return!1},t}();a.CultureManager=c,cc._RF.pop()},{}],CultureTechLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"914a2n1+axJB5HaLrrA1fQH","CultureTechLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Culture"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addCulture(),this.addLegendary(),this.addEpic(),this.addCiv(),this.addWar(),this.addBuildings(),this.addProduction(),this.addTrading(),this.addTechBoats(),this.addTechItems(),this.addTechMaterials()},e.prototype.logTechNames=function(){for(var t="",e=0;e<this.list.length;e++)t+=this.list[e].id,t+="\n";cc.log(t)},e.prototype.addCulture=function(){var t=new s.CultureTechAsset;t.id="culture_convert_chance_1",t.icon="tech/icon_tech_culture_convert_chance_1",this.add(t),this.t.stats.culture_spread_convert_chance.add(.05);var e=new s.CultureTechAsset;e.id="culture_convert_chance_2",e.icon="tech/icon_tech_culture_convert_chance_2",this.add(e),this.addRequirement("culture_convert_chance_1"),this.t.stats.culture_spread_convert_chance.add(.05),this.t.required_level=10;var i=new s.CultureTechAsset;i.id="culture_convert_chance_3",i.icon="tech/icon_tech_culture_convert_chance_3",this.add(i),this.addRequirement("culture_convert_chance_2"),this.t.stats.culture_spread_convert_chance.add(.05),this.t.required_level=20;var o=new s.CultureTechAsset;o.id="culture_spread_speed_1",o.icon="tech/icon_tech_culture_spread_speed_1",this.add(o),this.t.stats.culture_spread_speed.add(-.5);var a=new s.CultureTechAsset;a.id="culture_spread_speed_2",a.icon="tech/icon_tech_culture_spread_speed_2",this.add(a),this.addRequirement("culture_spread_speed_1"),this.t.stats.culture_spread_speed.add(-.5),this.t.required_level=10;var n=new s.CultureTechAsset;n.id="culture_spread_speed_3",n.icon="tech/icon_tech_culture_spread_speed_3",this.add(n),this.addRequirement("culture_spread_speed_2"),this.t.stats.culture_spread_speed.add(-.5),this.t.required_level=20},e.prototype.addLegendary=function(){var t=new s.CultureTechAsset;t.id="nature_lovers",t.icon="tech/icon_tech_nature_lovers",t.type=s.TechType.Rare,t.required_level=20,t.enabled=!1,this.add(t)},e.prototype.addEpic=function(){var t=new s.CultureTechAsset;t.id="ancestors_knowledge",t.icon="tech/icon_tech_ancestors_knowledge",t.type=s.TechType.Rare,t.required_level=20,this.add(t),this.t.stats.bonus_born_level.value=1;var e=new s.CultureTechAsset;e.id="way_of_live",e.icon="tech/icon_tech_way_of_life",e.type=s.TechType.Rare,e.required_level=20,this.add(e);var i=new s.CultureTechAsset;i.id="heroes",i.icon="tech/icon_tech_heroes",i.type=s.TechType.Rare,i.required_level=20,this.add(i),this.t.stats.bonus_max_unit_level.add(2);var o=new s.CultureTechAsset;o.id="steal_resources",o.icon="tech/icon_tech_steal_resources",o.type=s.TechType.Rare,o.required_level=20,o.enabled=!1,this.add(o);var a=new s.CultureTechAsset;a.id="steal_kids",a.icon="tech/icon_tech_steal_kids",a.type=s.TechType.Rare,a.required_level=20,a.enabled=!1,this.add(a);var n=new s.CultureTechAsset;n.id="gems_water",n.icon="tech/icon_tech_gems_water",n.type=s.TechType.Rare,n.required_level=20,n.enabled=!1,this.add(n)},e.prototype.addCiv=function(){var t=new s.CultureTechAsset;t.id="housing_1",t.icon="tech/icon_tech_housing_1",t.required_level=5,this.add(t),this.addRequirement("house_tier_2"),this.t.stats.housing.add(1);var e=new s.CultureTechAsset;e.id="housing_2",e.icon="tech/icon_tech_housing_2",e.required_level=10,this.add(e),this.addRequirement("house_tier_4"),this.addRequirement("housing_1"),this.t.stats.housing.add(1);var i=new s.CultureTechAsset;i.id="housing_3",i.icon="tech/icon_tech_housing_3",i.required_level=15,this.add(i),this.addRequirement("house_tier_5"),this.addRequirement("housing_2"),this.t.stats.housing.add(1);var o=new s.CultureTechAsset;o.id="governance_1",o.icon="tech/icon_tech_governance_1",o.required_level=10,this.add(o),this.t.stats.bonus_max_cities.add(1);var a=new s.CultureTechAsset;a.id="governance_2",a.icon="tech/icon_tech_governance_2",this.add(a),this.addRequirement("governance_1"),this.t.stats.bonus_max_cities.add(1);var n=new s.CultureTechAsset;n.id="governance_3",n.icon="tech/icon_tech_governance_3",n.type=s.TechType.Rare,n.required_level=20,this.add(n),this.addRequirement("governance_2"),this.t.stats.bonus_max_cities.add(1);var r=new s.CultureTechAsset;r.id="knowledge_gain_1",r.icon="tech/icon_tech_knowledge_gain1",r.required_level=5,this.add(r),this.t.stats.knowledge_gain.add(.5);var l=new s.CultureTechAsset;l.id="knowledge_gain_2",l.icon="tech/icon_tech_knowledge_gain2",l.required_level=10,this.add(l),this.addRequirement("knowledge_gain_1"),this.t.stats.knowledge_gain.add(.5);var c=new s.CultureTechAsset;c.id="knowledge_gain_3",c.icon="tech/icon_tech_knowledge_gain3",c.required_level=15,this.add(c),this.addRequirement("knowledge_gain_2"),this.t.stats.knowledge_gain.add(.5);var d=new s.CultureTechAsset;d.id="army_training_1",d.icon="tech/icon_tech_army_training_1",d.required_level=5,this.add(d),this.addRequirement("building_barracks"),this.t.stats.bonus_max_army.add(5);var u=new s.CultureTechAsset;u.id="army_training_2",u.icon="tech/icon_tech_army_training_2",u.required_level=5,this.add(u),this.addRequirement("army_training_1"),this.t.stats.bonus_max_army.add(5);var h=new s.CultureTechAsset;h.id="army_training_3",h.icon="tech/icon_tech_army_training_3",h.required_level=5,this.add(h),this.addRequirement("army_training_2"),this.t.stats.bonus_max_army.add(5)},e.prototype.addWar=function(){var t=new s.CultureTechAsset;t.id="military_strategy",t.icon="tech/icon_tech_military_strategy",t.required_level=20,t.type=s.TechType.Rare,this.add(t),this.addRequirement("weapon_production"),this.addRequirement("armor_production"),this.t.stats.bonus_damage.add(.05);var e=new s.CultureTechAsset;e.id="defense_strategy",e.icon="tech/icon_tech_defense_strategy",e.required_level=20,e.type=s.TechType.Rare,this.add(e),this.addRequirement("armor_production"),this.t.stats.bonus_armor.add(.05)},e.prototype.addBuildings=function(){var t=new s.CultureTechAsset;t.id="house_tier_0",t.icon="tech/icon_tech_house_tier_0",t.priority=!0,this.add(t);var e=new s.CultureTechAsset;e.id="house_tier_1",e.icon="tech/icon_tech_house_tier_1",e.required_level=5,e.priority=!0,this.add(e),this.addRequirement("house_tier_0");var i=new s.CultureTechAsset;i.id="house_tier_2",i.icon="tech/icon_tech_house_tier_2",i.required_level=8,i.priority=!0,this.add(i),this.addRequirement("house_tier_1");var o=new s.CultureTechAsset;o.id="house_tier_3",o.icon="tech/icon_tech_house_tier_3",o.required_level=12,this.add(o),this.addRequirement("house_tier_2");var a=new s.CultureTechAsset;a.id="house_tier_4",a.icon="tech/icon_tech_house_tier_4",a.required_level=15,this.add(a),this.addRequirement("house_tier_3");var n=new s.CultureTechAsset;n.id="house_tier_5",n.icon="tech/icon_tech_house_tier_5",n.required_level=20,this.add(n),this.addRequirement("house_tier_4");var r=new s.CultureTechAsset;r.id="building_docks",r.icon="tech/icon_tech_building_docks",r.priority=!0,this.add(r),this.addRequirement("house_tier_2");var l=new s.CultureTechAsset;l.id="building_roads",l.icon="tech/icon_tech_building_roads",l.required_level=5,this.add(l);var c=new s.CultureTechAsset;c.id="building_well",c.icon="tech/icon_tech_well",c.required_level=12,this.add(c),this.addRequirement("house_tier_2");var d=new s.CultureTechAsset;d.id="building_watch_tower",d.icon="tech/icon_tech_building_watch_tower",d.required_level=5,this.add(d),this.addRequirement("house_tier_3"),this.addRequirement("weapon_bow");var u=new s.CultureTechAsset;u.id="building_watch_tower_bonus",u.icon="tech/icon_tech_watch_tower_bonus",u.required_level=20,u.type=s.TechType.Rare,this.add(u),this.t.stats.bonus_watch_towers.value=1,this.addRequirement("building_watch_tower");var h=new s.CultureTechAsset;h.id="building_statues",h.icon="tech/icon_tech_building_statues",h.required_level=5,this.add(h),this.addRequirement("house_tier_3");var p=new s.CultureTechAsset;p.id="building_mine",p.icon="tech/icon_tech_building_mine",p.required_level=5,this.add(p),this.addRequirement("house_tier_1");var f=new s.CultureTechAsset;f.id="building_barracks",f.icon="tech/icon_tech_barracks",f.required_level=5,this.add(f),this.addRequirement("house_tier_2");var _=new s.CultureTechAsset;_.id="building_windmill",_.icon="tech/icon_tech_windmill",_.required_level=5,this.add(_),this.addRequirement("house_tier_2");var m=new s.CultureTechAsset;m.id="building_temple",m.icon="tech/icon_tech_temple",m.required_level=10,this.add(m),this.addRequirement("house_tier_3")},e.prototype.addProduction=function(){var t=new s.CultureTechAsset;t.id="mining_efficiency",t.icon="tech/icon_tech_mining_efficiency",t.required_level=3,this.add(t),this.t.stats.bonus_res_chance_ores.add(.2),this.t.stats.bonus_res_ore_amount.add(1);var e=new s.CultureTechAsset;e.id="sharp_axes",e.icon="tech/icon_tech_sharp_axes",e.required_level=2,this.add(e),this.t.stats.bonus_res_chance_wood.add(.2),this.t.stats.bonus_res_wood_amount.add(1);var i=new s.CultureTechAsset;i.id="weaponsmith",i.icon="tech/icon_tech_weaponsmith",i.required_level=20,i.type=s.TechType.Rare,this.add(i),this.addRequirement("weapon_production"),this.t.stats.item_production_tries_weapons.add(2);var o=new s.CultureTechAsset;o.id="armorsmith",o.icon="tech/icon_tech_armorsmith",o.required_level=20,o.type=s.TechType.Rare,this.add(o),this.addRequirement("armor_production"),this.t.stats.item_production_tries_armor.add(2)},e.prototype.addTrading=function(){var t=new s.CultureTechAsset;t.id="trading",t.icon="tech/icon_tech_trading",t.required_level=7,this.add(t);var e=new s.CultureTechAsset;e.id="trading_efficiency",e.icon="tech/icon_tech_trading-_efficiency",e.required_level=8,this.add(e),this.addRequirement("trading"),this.t.stats.mod_trading_bonus.add(.15)},e.prototype.addTechBoats=function(){var t=new s.CultureTechAsset;t.id="boats_fishing",t.icon="tech/icon_tech_boats_fishing",t.required_level=2,this.add(t),this.addRequirement("building_docks");var e=new s.CultureTechAsset;e.id="boats_trading",e.icon="tech/icon_tech_boats_trading",e.required_level=4,this.add(e),this.addRequirement("building_docks");var i=new s.CultureTechAsset;i.id="boats_transport",i.icon="tech/icon_tech_boats_transport",i.required_level=8,i.priority=!0,this.add(i),this.addRequirement("building_docks")},e.prototype.addTechItems=function(){var t=new s.CultureTechAsset;t.id="weapon_sword",t.icon="tech/icon_tech_weapon_sword",t.required_level=3,t.priority=!0,this.add(t),this.addRequirement("weapon_production");var e=new s.CultureTechAsset;e.id="weapon_axe",e.icon="tech/icon_tech_weapon_axe",e.required_level=3,this.add(e),this.addRequirement("weapon_production");var i=new s.CultureTechAsset;i.id="weapon_hammer",i.icon="tech/icon_tech_weapon_hammer",i.required_level=3,this.add(i),this.addRequirement("weapon_production");var o=new s.CultureTechAsset;o.id="weapon_spear",o.icon="tech/icon_tech_weapon_spear",o.required_level=3,this.add(o),this.addRequirement("weapon_production");var a=new s.CultureTechAsset;a.id="armor_production",a.icon="tech/icon_tech_armor_production",a.required_level=3,this.add(a),this.addRequirement("weapon_production");var n=new s.CultureTechAsset;n.id="weapon_production",n.icon="tech/icon_tech_weapon_production",n.required_level=3,n.priority=!0,this.add(n);var r=new s.CultureTechAsset;r.id="weapon_bow",r.icon="tech/icon_tech_weapon_bow",r.required_level=3,this.add(r),this.addRequirement("weapon_production")},e.prototype.addTechMaterials=function(){var t=new s.CultureTechAsset;t.id="material_copper",t.icon="tech/icon_tech_material_copper",t.required_level=4,this.add(t);var e=new s.CultureTechAsset;e.id="material_bronze",e.icon="tech/icon_tech_material_bronze",e.required_level=6,this.add(e),this.addRequirement("material_copper");var i=new s.CultureTechAsset;i.id="material_silver",i.icon="tech/icon_tech_material_silver",i.required_level=10,this.add(i),this.addRequirement("material_bronze");var o=new s.CultureTechAsset;o.id="material_iron",o.icon="tech/icon_tech_material_iron",o.required_level=20,this.add(o),this.addRequirement("material_silver");var a=new s.CultureTechAsset;a.id="material_steel",a.icon="tech/icon_tech_material_steel",a.required_level=30,this.add(a),this.addRequirement("material_iron");var n=new s.CultureTechAsset;n.id="material_mythril",n.icon="tech/icon_tech_material_mythril",n.required_level=40,this.add(n),this.addRequirement("material_steel");var r=new s.CultureTechAsset;r.id="material_adamantine",r.icon="tech/icon_tech_material_adamantine",r.required_level=50,this.add(r),this.addRequirement("material_mythril")},e.prototype.addRequirement=function(t){this.t.requirements||(this.t.requirements=[]),this.t.requirements.push(t)},e}(a("AssetLibrary").default);n.default=l,cc._RF.pop()},{}],CultureWindow:[function(t,e,i){"use strict";cc._RF.push(e,"473ef1/wJFFMrlw7Fmd+t1c","CultureWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GamePopBase"),c=a("LocalizedTextManager"),d=a("AssetManager"),u=a("ToolBox"),h=a("Config"),p=a("Culture"),f=a("MapBox"),_=a("TextureLoader"),m=a("ToolTip"),g=a("TechElement"),y=cc._decorator,v=y.ccclass,b=y.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text_name=null,e.text_description=null,e.text_values=null,e.text_rare_knowledges=null,e.population=null,e.cities=null,e.kingdoms=null,e.knowledge_gain=null,e.level=null,e.zones=null,e.tech_common=null,e.tech_rare=null,e.tech_prefab=null,e.researchBar=null,e.currentTech=null,e.cultureElement=null,e.cultureDecor=null,e}return r(e,t),e.prototype.start=function(){var t,e,i,o,a,n;if(h.default.selectedCulture){f.default.inst.cultures.recalcCultureValues(),this.cultureElement.spriteFrame=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.WORLDATLAS,h.default.selectedCulture.icon_element),this.cultureDecor.spriteFrame=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.WORLDATLAS,h.default.selectedCulture.icon_decor),this.cultureElement.node.color=u.Toolbox.makeColor(h.default.selectedCulture.color),this.cultureDecor.node.color=u.Toolbox.makeColor(h.default.selectedCulture.color),this.text_name.string=h.default.selectedCulture.name,this.text_description.string="",this.text_values.string="",this.population.string=null!==(t=h.default.selectedCulture.followers.toString())&&void 0!==t?t:"",this.cities.string=null!==(e=h.default.selectedCulture.cities.toString())&&void 0!==e?e:"",this.kingdoms.string=null!==(i=h.default.selectedCulture.kingdoms.toString())&&void 0!==i?i:"",this.knowledge_gain.string=null!==(o=h.default.selectedCulture.knowledge_gain.toString())&&void 0!==o?o:"",this.level.string=null!==(a=h.default.selectedCulture.getCurrentLevel().toString())&&void 0!==a?a:"",this.zones.string=null!==(n=h.default.selectedCulture.zones.size.toString())&&void 0!==n?n:"";var r=f.default.inst.mapStats.year-h.default.selectedCulture.year+1;h.default.selectedCulture.village_origin&&this.showStat("culture_founded_in",h.default.selectedCulture.village_origin),this.showStat("age",r.toString());var s=h.default.selectedCulture.research_progress;h.default.selectedCulture.checkResearchingTech();var l=0;if(h.default.selectedCulture.researching_tech){l=h.default.selectedCulture.getKnowledgeCostForResearch();var c=d.default.culture_tech.get(h.default.selectedCulture.researching_tech);this.currentTech.node.active=!0,this.currentTech.load(c)}else s=0,l=0,this.currentTech.node.active=!1;this.researchBar.node.getChildByName("label").getComponent(cc.Label).string=Math.floor(10*s)/10+"/"+l,this.researchBar.progress=s/l,this.clearPrevTechElements(),this.loadTechButtons();var p=d.default.raceLibrary.get(h.default.selectedCulture.race);this.text_rare_knowledges.string=h.default.selectedCulture.countCurrentRareTech()+"/"+p.culture_rate_tech_limit}},e.prototype.loadTechButtons=function(){var t=h.default.selectedCulture,e=[],i=[];t.list_tech_ids.sort(function(t,e){return t.localeCompare(e)});for(var o=0;o<t.list_tech_ids.length;o++){var a=d.default.culture_tech.get(t.list_tech_ids[o]);if(a)switch(a.type){case p.TechType.Common:e.push(a);break;case p.TechType.Rare:i.push(a)}}this.loadButtons(e,this.tech_common),this.loadButtons(i,this.tech_rare)},e.prototype.loadButtons=function(t,e){for(var i=0;i<t.length;i++)this.loadTechButton(t[i],e)},e.prototype.loadTechButton=function(t,e){var i=cc.instantiate(this.tech_prefab);i.parent=e,i.getComponent(g.default).load(t)},e.prototype.clearPrevTechElements=function(){this.tech_common.destroyAllChildren(),this.tech_rare.destroyAllChildren()},e.prototype.showStat=function(t,e){this.text_description.string+=c.LocalizedTextManager.getText(t)+"\n",this.text_values.string+=e+"\n"},e.prototype.clickAttribute=function(t){var e=t.getCurrentTarget(),i="tip_"+e.name,o="tip_"+e.name+"_description";m.default.inst.show(e,"normal",i,o)},e.prototype.onDestroy=function(){h.default.selectedCulture&&(h.default.selectedCulture=null)},s([b(cc.Label)],e.prototype,"text_name",void 0),s([b(cc.Label)],e.prototype,"text_description",void 0),s([b(cc.Label)],e.prototype,"text_values",void 0),s([b(cc.Label)],e.prototype,"text_rare_knowledges",void 0),s([b(cc.Label)],e.prototype,"population",void 0),s([b(cc.Label)],e.prototype,"cities",void 0),s([b(cc.Label)],e.prototype,"kingdoms",void 0),s([b(cc.Label)],e.prototype,"knowledge_gain",void 0),s([b(cc.Label)],e.prototype,"level",void 0),s([b(cc.Label)],e.prototype,"zones",void 0),s([b(cc.Node)],e.prototype,"tech_common",void 0),s([b(cc.Node)],e.prototype,"tech_rare",void 0),s([b(cc.Prefab)],e.prototype,"tech_prefab",void 0),s([b(cc.ProgressBar)],e.prototype,"researchBar",void 0),s([b(g.default)],e.prototype,"currentTech",void 0),s([b(cc.Sprite)],e.prototype,"cultureElement",void 0),s([b(cc.Sprite)],e.prototype,"cultureDecor",void 0),s([v],e)}(l.GamePopBase);n.default=w,cc._RF.pop()},{}],CulturesListWindow:[function(t,e,i){"use strict";cc._RF.push(e,"c27baFhbs9MA5iewCfOVAGw","CulturesListWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GamePopBase"),d=a("Config"),u=a("MapBox"),h=a("CultureElement"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabElement=null,e.content=null,e}return r(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.showList()},e.prototype.showList=function(){var t,e;if(d.default.gameLoaded){u.default.inst.cultures.list.sort(function(t,e){return t.followers-e.followers});try{for(var i=l(u.default.inst.cultures.list),o=i.next();!o.done;o=i.next()){var a=o.value;this.showElement(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}},e.prototype.showElement=function(t){var e=cc.instantiate(this.prefabElement);e.parent=this.content,e.getComponent(h.default).initItem(t)},s([_(cc.Prefab)],e.prototype,"prefabElement",void 0),s([_(cc.Node)],e.prototype,"content",void 0),s([f],e)}(c.GamePopBase);n.default=m,cc._RF.pop()},{}],Culture:[function(t,e,i){"use strict";cc._RF.push(e,"4d9487GAKRO3JtyXFO2lkoj","Culture");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.CultureMainCounter=n.CultureTechAsset=n.TechType=void 0;var l,c=a("MathUtils"),d=a("ObjectUtils"),u=a("UserData"),h=a("GameCommon"),p=a("AssetLibrary"),f=a("AssetManager"),_=a("NameGenerator"),m=a("Globals"),g=a("ToolBox"),y=a("Config"),v=a("GuideController"),b=a("KingdomStats"),w=a("MapBox"),T=a("ModModule");(function(t){t[t.Common=0]="Common",t[t.Rare=1]="Rare"})(l=n.TechType||(n.TechType={}));var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stats=new b.default,e.icon="",e.knowledge_cost=1,e.required_level=0,e.type=l.Common,e.requirements=[],e.enabled=!0,e.priority=!1,e}return r(e,t),e}(p.Asset);n.CultureTechAsset=k,n.CultureMainCounter=function(t){this.culture=null,this.amount=0,this.culture=t};var B=function(){function t(){this.hash=0,this.id="",this.name="",this.color32=cc.Color.TRANSPARENT,this.color32_border=cc.Color.TRANSPARENT,this.color32_text=cc.Color.TRANSPARENT,this.color32_unit=cc.Color.TRANSPARENT,this.color="",this.icon_element="",this.icon_decor="",this.year=0,this.village_origin="",this.race="",this.skin_citizen_male="",this.skin_citizen_female="",this.skin_warrior="",this.list_zone_ids=[],this.list_tech_ids=[],this.researching_tech="",this.research_progress=0,this._list_tech=[],this._list_cities=[],this.stats=new b.default,this.dirty=!1,this.followers=0,this.cities=0,this.kingdoms=0,this.knowledge_gain=0,this.zones=new Set,this._zones_dirty=!1,this.timer_spread=0,this._maximum_level_reached=!1,this.titleCenter=m.default.POINT_IN_VOID,Object.defineProperty(this,"color32",{enumerable:!1}),Object.defineProperty(this,"_list_tech",{enumerable:!1}),Object.defineProperty(this,"_list_cities",{enumerable:!1}),Object.defineProperty(this,"stats",{enumerable:!1}),Object.defineProperty(this,"zones",{enumerable:!1})}return t.prototype.create=function(t,e){this.race=t.id,this.list_tech_ids=[],this.id=w.default.inst.mapStats.getNextId("culture"),this.name=_.default.getName(t.name_template_culture),this.village_origin=e?e.data.cityName:"??",this.year=w.default.inst.mapStats.year,this.prepare()},t.prototype.prepare=function(){this.createSkins(),this.setDirty(),this.color32.equals(cc.Color.TRANSPARENT)&&this.createGameColors(),this.hash=d.default.getHashCode(this.id)},t.prototype.addZone=function(t){t.culture&&t.culture!=this&&t.culture.removeZone(t),this.zones.add(t),t.setCulture(this),this._zones_dirty=!0},t.prototype.removeZone=function(t){this.zones.delete(t),t.removeCulture(),this._zones_dirty=!0},t.prototype.createSkins=function(){if(this.race||(this.race="human"),!this.skin_citizen_female){var t=f.default.raceLibrary.get(this.race),e=g.Toolbox.randomInt(0,t.skin_citizen_female.length);if(this.skin_citizen_female=t.skin_citizen_female[e],this.skin_citizen_male=t.skin_citizen_male[e],this.skin_warrior=t.skin_warrior[e],!this.icon_element){this.icon_element=t.culture_elements.getRandom(),this.icon_decor=t.culture_decors.getRandom(),t.culture_colors.shuffle(),this.color="";for(var i=0;i<t.culture_colors.length;i++)if(!w.default.inst.cultures.isColorUsed(t.culture_colors[i])){this.color=t.culture_colors[i];break}this.color||(this.color=t.culture_colors.getRandom())}}},t.prototype.reset=function(){this.kingdoms=0,this.cities=0,this.followers=0,this.knowledge_gain=0,this._list_cities=[]},t.prototype.calculateKnowledgeGain=function(){var t,e=f.default.raceLibrary.get(this.race);this.knowledge_gain=e.culture_knowledge_gain_base;for(var i=0;i<this._list_cities.length;i++){var o=this._list_cities[i].leader;if((null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.culture)==this.id){var a=(o.curStats.intelligence+1)*e.culture_knowledge_gain_per_intelligence;this.knowledge_gain+=a*e.culture_knowledge_gain_rate}}this.knowledge_gain+=this.stats.knowledge_gain.value},t.prototype.prepareForSave=function(){var t,e;this.list_zone_ids=[];try{for(var i=s(this.zones),o=i.next();!o.done;o=i.next()){var a=o.value;this.list_zone_ids.push(a.id)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.load=function(){if(this.prepare(),this.list_zone_ids)for(var t=0;t<this.list_zone_ids.length;t++){var e=this.list_zone_ids[t];this.addZone(w.default.inst.zoneCalculator.getZoneByID(e))}},t.prototype.setDirty=function(){this.dirty=!0},t.prototype.getCurrentLevel=function(){return this.list_tech_ids.length},t.prototype.updateProgress=function(){var t;if(!this.researching_tech)return this.researching_tech=this.findNextTechToResearch(),void(this.research_progress=0);this.research_progress+=this.knowledge_gain,!y.default.mode_sandBox&&!u.default.member.cultureGuided&&this.research_progress>70&&(v.default.inst.do(v.GUIDE_TYPE.culture),u.default.member.cultureGuided=!0,u.default.save()),this.research_progress>=this.getKnowledgeCostForResearch()&&(this.addFinishedTech(this.researching_tech),this==(null===(t=T.default.inst.kingdom)||void 0===t?void 0:t.getCulture())&&T.default.inst.showTechEffect(this.researching_tech),this.research_progress=0,this.researching_tech=this.findNextTechToResearch())},t.prototype.getKnowledgeCostForResearch=function(){if(this.checkResearchingTech(),!this.researching_tech)return 0;var t=0,e=f.default.culture_tech.get(this.researching_tech);return t=100*e.knowledge_cost+25*this.getCurrentLevel(),e.type==l.Rare&&(t*=2),t},t.prototype.addFinishedTech=function(t){this.list_tech_ids.push(t),this.setDirty()},t.prototype.updateSpread=function(t){if(this.timer_spread>0)this.timer_spread-=t;else if(this.timer_spread=this.stats.culture_spread_speed.value,0!=this.followers&&0!=this.zones.size){var e=g.Toolbox.getRandom(this.zones);this.spreadAround(e)}},t.prototype.spreadAround=function(t){var e,i,o=this.getBestZoneToSpreadFrom(t),a=t.culture;if(o)if(o.culture){for(var n=0,r=0;r<o.neighbours.length;r++)o.neighbours[r].culture==a&&n++;var s=0,l=[];g.Toolbox.fillListWithUnitsFromChunk(o.centerTile.chunk,l);for(var c=0;c<l.length;c++)(null===(i=null===(e=l[c])||void 0===e?void 0:e.data)||void 0===i?void 0:i.culture)==this.id&&(s+=.05);var d=this.stats.culture_spread_convert_chance.value*n+s;o.culture.followers>this.followers&&(d*=(this.followers+1)/(o.culture.followers+1)),g.Toolbox.randomChance(d)&&this.spreadOn(o)}else this.spreadOn(o)},t.prototype.getBestZoneToSpreadFrom=function(e){t._list_zones_to_spread=[],t._list_zones_to_spread.addRange(e.neighbours);for(var i=null,o=null,a=e.culture,n=0;n<t._list_zones_to_spread.length;n++){t._list_zones_to_spread.shuffle();var r=t._list_zones_to_spread[n];if(r.city&&r.culture!=this&&r.city.race.id==a.race&&r.city.kingdom!=T.default.inst.kingdom&&(o||(o=r),!i&&64==r.tilesWithGround)){i=r;break}}return i||o},t.prototype.spreadOn=function(t){this.addZone(t)},t.prototype.updateDirty=function(){if(this.dirty){this.dirty=!1,this._list_tech=[],this.stats.clear();var t=f.default.raceLibrary.get(this.race);this.stats.addStats(t.stats);for(var e=0;e<this.list_tech_ids.length;e++){var i=this.list_tech_ids[e],o=f.default.culture_tech.get(i);o&&(this._list_tech.push(o),this.stats.addStats(o.stats))}this.calculateKnowledgeGain()}},t.prototype.logicUpdate=function(t){this._zones_dirty&&(this._zones_dirty=!1,this.updateTitleCenter()),h.default.isPaused||this.updateSpread(t),this.updateDirty(t)},t.prototype.findNextTechToResearch=function(){if(this._maximum_level_reached)return"";var t=[],e=[],i=[];i.addRange(f.default.culture_tech.list),i.shuffle();for(var o=this.getCurrentLevel(),a=this.countCurrentRareTech(),n=f.default.raceLibrary.get(this.race),r=0;r<i.length;r++){var s=i[r];!(s.enabled&&s.required_level<=o&&!this.haveTech(s.id)&&this.haveRequiredTechFor(s))||s.type==l.Rare&&a==n.culture_rate_tech_limit||!n.culture_forbidden_tech.empty()&&n.culture_forbidden_tech.includes(s.id)||(s.priority&&t.push(s),e.push(s))}return t.length>0?t.getRandom().id:e.length>0?e.getRandom().id:(this._maximum_level_reached=!0,"")},t.prototype.countCurrentRareTech=function(){for(var t=0,e=0;e<this.list_tech_ids.length;e++){var i=this.list_tech_ids[e],o=f.default.culture_tech.get(i);o&&o.type==l.Rare&&t++}return t},t.prototype.haveTech=function(t){return this.list_tech_ids.includes(t)},t.prototype.checkResearchingTech=function(){this.researching_tech&&!f.default.culture_tech.get(this.researching_tech)&&(this.researching_tech="")},t.prototype.haveRequiredTechFor=function(t){if(!t.requirements||t.requirements.empty())return!0;for(var e=0;e<t.requirements.length;e++){var i=t.requirements[e];if(!this.list_tech_ids.includes(i))return!1}return!0},t.prototype.updateTitleCenter=function(){var t,e,i,o;if(0!=this.zones.size){var a=0,n=0,r=0,l=0,c=null;try{for(var d=s(this.zones),u=d.next();!u.done;u=d.next()){var h=u.value;a+=h.centerTile.posV3.x,n+=h.centerTile.posV3.y}}catch(b){t={error:b}}finally{try{u&&!u.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}this.titleCenter.x=a/this.zones.size,this.titleCenter.y=n/this.zones.size;try{for(var p=s(this.zones),f=p.next();!f.done;f=p.next()){var _=f.value;r=g.Toolbox.dist(_.centerTile.x,_.centerTile.y,this.titleCenter.x,this.titleCenter.y),(!c||r<l)&&(c=_,l=r)}}catch(w){i={error:w}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}this.titleCenter.x=c.centerTile.posV3.x,this.titleCenter.y=c.centerTile.posV3.y+2}else this.titleCenter=m.default.POINT_IN_VOID},t.prototype.createGameColors=function(){this.color32=g.Toolbox.makeColor(this.color),this.color32.a=140,this.color32_border=g.Toolbox.makeDarkerColor(this.color32,.7),this.color32_border.a=230,this.color32_text=cc.color(this.color32.r,this.color32.g,this.color32.b,this.color32.a),this.color32_text=this.convertToLight(this.color32_text),this.color32_text.a=255,this.color32_unit=cc.Color.lerp(this.color32_unit,this.color32,cc.Color.WHITE,.3),this.color32_unit.a=255},t.prototype.convertToLight=function(t){if((t.r+t.b+t.g)/3<.333333343){var e=1.66666663;return cc.color(t.r*e,t.b*e,t.g*e)}return t},t.prototype.clearZones=function(){var t,e;try{for(var i=s(this.zones),o=i.next();!o.done;o=i.next())o.value.removeCulture()}catch(r){t={error:r}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.zones.clear(),this._list_tech=[],this._list_cities=[],this.list_tech_ids=[]},t.prototype.getBornLevel=function(){return 1+c.default.intCast(this.stats.bonus_born_level.value)},t.prototype.getMaxAgeBonus=function(){return c.default.intCast(this.stats.bonus_age.value)},t.prototype.getMaxLevelBonus=function(){return c.default.intCast(this.stats.bonus_max_unit_level.value)},t.prototype.researchNewTechTest=function(){var t=this.findNextTechToResearch();t&&this.addFinishedTech(t)},t._list_zones=[],t._list_zones_to_spread=[],t}();n.default=B,cc._RF.pop()},{}],CumulativeReward:[function(t,e,i){"use strict";cc._RF.push(e,"5e0ceqekbxAFLSqqi4HNktT","CumulativeReward");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("UserData"),c=a("ViewController"),d=a("AwardView"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.num=null,e.closeNode=null,e.openNode=null,e}return r(e,t),e.prototype.onLoad=function(){this.showProgress(),cc.director.on("updateVideoCount",this.updateCount,this)},e.prototype.onDestroy=function(){cc.director.off("updateVideoCount")},e.prototype.updateCount=function(){l.default.member.videoCount++,l.default.member.videoCount>5&&(l.default.member.videoCount=5),l.default.save(),this.showProgress()},e.prototype.showProgress=function(){this.progressBar.progress=l.default.member.videoCount/5,this.num.string=l.default.member.videoCount+" / 5",this.closeNode.active=l.default.member.videoCount<5,this.openNode.active=5==l.default.member.videoCount},e.prototype.click=function(t){var e=this;c.default.open(c.view_type.AwardView,null,t,!0,function(t){t.getComponent(d.default).init(d.Reward_type.cumulative,1),l.default.member.videoCount=0,l.default.save(),e.showProgress()})},s([p(cc.ProgressBar)],e.prototype,"progressBar",void 0),s([p(cc.Label)],e.prototype,"num",void 0),s([p(cc.Node)],e.prototype,"closeNode",void 0),s([p(cc.Node)],e.prototype,"openNode",void 0),s([h],e)}(cc.Component);n.default=f,cc._RF.pop()},{}],DebugConfig:[function(t,e,i){"use strict";cc._RF.push(e,"7bc1cdwtDhAQ6EAtVlNQQ42","DebugConfig");var o=i;Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.Prop_infinite=!1,t.UnCkeck_Address=!1,t.UnitPathfinding=!0,t.UseGlobalPathLock=!0,t.CheckGoodForBoat=!1,t.SystemSplitAstar=!0,t.UseCacheForRegionPath=!0,t.LastPath=!1,t}();o.default=a,cc._RF.pop()},{}],DiplomacyManager:[function(t,e,i){"use strict";cc._RF.push(e,"92f9btRiHpO94pSHFsap7Gy","DiplomacyManager");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(a,"__esModule",{value:!0});var s=o("MapBox"),l=o("WorldLog"),c=o("DiplomacyRelation"),d=function(){function t(t){this.kingdoms=null,this.relations_dict=new Map,this.relations_civs=new Map,this._tempKingdoms=[],this.temp_arr=[],this.diplomacyTick=0,this.kingdoms=t}return t.prototype.save=function(){var t,e,i=[];try{for(var o=n(this.relations_civs),a=o.next();!a.done;a=o.next()){var s=r(a.value,2),l=(s[0],s[1]);l.kingdom1=this.kingdoms.getKingdomByID(l.data.kingdom1_id),l.kingdom2=this.kingdoms.getKingdomByID(l.data.kingdom2_id),l.kingdom1&&l.kingdom2&&i.push(l.data)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return i},t.prototype.load=function(t){for(var e=0;e<t.length;e++){var i=t[e],o=c.default.initWithData(i);o.kingdom1=this.kingdoms.getKingdomByID(i.kingdom1_id),o.kingdom2=this.kingdoms.getKingdomByID(i.kingdom2_id),o.kingdom1&&o.kingdom2&&this.addToDicts(o)}},t.prototype.addToDicts=function(t){this.relations_dict.has(t.data.id)||this.relations_dict.set(t.data.id,t),t.kingdom1.isCiv()&&t.kingdom2.isCiv()&&!this.relations_civs.has(t.data.id)&&this.relations_civs.set(t.data.id,t)},t.prototype.logicUpdate=function(t){this.diplomacyTick>0?this.diplomacyTick-=t:(this.diplomacyTick=2,this.newDiplomacyTick())},t.prototype.updateAge=function(){var t,e;try{for(var i=n(this.relations_civs),o=i.next();!o.done;o=i.next()){var a=r(o.value,2);a[0],a[1].data.stateChanged++}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.newDiplomacyTick=function(){this.findSupremeKingdom()},t.prototype.findSupremeKingdom=function(){if(t.kingdom_supreme=null,0!=this.kingdoms.list_civs.length){for(var e=0;e<this.kingdoms.list_civs.length;e++){var i=this.kingdoms.list_civs[e];i.power=2*i.countArmy()+5*i.cities.length}this.kingdoms.list_civs.sort(function(t,e){return t.power-e.power}),t.kingdom_supreme=this.kingdoms.list_civs[0],this.kingdoms.list_civs.length>1?t.kingdom_second=this.kingdoms.list_civs[1]:t.kingdom_second=null}},t.prototype.startWar=function(t,e,i){if(void 0===i&&(i=!1),t&&e){i||l.default.logNewWar(t,e),this.kingdoms.setDiplomacyState(t,e,c.DiplomacyState.War);var o=this.getRelation(t,e);o.data.warSince=s.default.inst.mapStats.year,o.data.stateChanged=0}},t.prototype.startPeace=function(t,e,i){if(void 0===i&&(i=!1),t&&e){i||(l.default.logNewPeace(t,e),s.default.inst.spawnPeaceFireworks(t),s.default.inst.spawnPeaceFireworks(e)),this.kingdoms.setDiplomacyState(t,e,c.DiplomacyState.Ally);var o=this.getRelation(t,e);o.data.peaceSince=s.default.inst.mapStats.year,o.data.stateChanged=0}},t.prototype.eventSpite=function(t){var e,i;if(0!=t.civs_allies.size){this._tempKingdoms=[];try{for(var o=n(t.civs_allies),a=o.next();!a.done;a=o.next()){var s=r(a.value,2),l=s[0];s[1],this._tempKingdoms.push(l)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}this.startWar(t,this._tempKingdoms.getRandom()),this.kingdoms.length}},t.prototype.eventFriendship=function(t){var e,i;if(0!=t.civs_enemies.size){this._tempKingdoms=[];try{for(var o=n(t.civs_enemies),a=o.next();!a.done;a=o.next()){var s=r(a.value,2),l=s[0];s[1],this._tempKingdoms.push(l)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}this.startPeace(t,this._tempKingdoms.getRandom())}},t.prototype.getOpinion=function(t,e){return this.getRelation(t,e).getOpinion(t,e)},t.prototype.getRelation=function(t,e){var i=this;this.temp_arr[0]=t,this.temp_arr[1]=e,this.temp_arr.sort(function(t,e){return i.stringCompare(t.data.id,e.data.id)});var o=this.temp_arr[0].data.id+"_"+this.temp_arr[1].data.id;if(this.relations_dict.has(o)){var a=this.relations_dict.get(o);if(a.kingdom1==t&&a.kingdom2==e)return a;this.relations_dict.has(o)&&this.relations_dict.delete(o),this.relations_civs.has(o)&&this.relations_civs.delete(o)}var n=new c.default;return n.data.id=o,n.data.kingdom1_id=this.temp_arr[0].data.id,n.data.kingdom2_id=this.temp_arr[1].data.id,n.kingdom1=t,n.kingdom2=e,this.addToDicts(n),n},t.prototype.stringCompare=function(t,e){return parseInt(t.substring(2))-parseInt(e.substring(2))},t.prototype.makeAllFriendlyTo=function(t){for(var e=0;e<this.kingdoms.list_civs.length;e++){var i=this.kingdoms.list_civs[e];i!=t&&t.isEnemy(i)&&this.startPeace(t,i,!0)}},t.prototype.allPeace=function(){for(var t=0;t<this.kingdoms.list_civs.length;t++){var e=this.kingdoms.list_civs[t];this.makeAllFriendlyTo(e)}},t.prototype.clear=function(){this.relations_dict.clear(),this.relations_civs.clear()},t.prototype.removeRelations=function(t){var e,i;try{for(var o=n(this.relations_dict),a=o.next();!a.done;a=o.next()){var s=r(a.value,2),l=(s[0],s[1]);l.kingdom1!=t&&l.kingdom2!=t||(this.relations_dict.delete(l.data.id),this.relations_civs.delete(l.data.id))}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t.kingdom_supreme=null,t.kingdom_second=null,t}();a.default=d,cc._RF.pop()},{}],DiplomacyRelation:[function(t,e,i){"use strict";cc._RF.push(e,"9c8a8EVVFBJ9rWizFqPzoCA","DiplomacyRelation");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.DiplomacyData=a.DiplomacyState=void 0;var n,r=o("KingdomOpinion");(function(t){t[t.War=0]="War",t[t.Ally=1]="Ally",t[t.Clear=2]="Clear"})(n=a.DiplomacyState||(a.DiplomacyState={}));var s=function(){this.id="",this.kingdom1_id="",this.kingdom2_id="",this.stateChanged=0,this.peaceSince=0,this.warSince=0,this.state=n.Ally};a.DiplomacyData=s;var l=function(){function t(){this.data=new s,this.kingdom1=null,this.kingdom2=null,this.opinion_k1=null,this.opinion_k2=null}return t.initWithData=function(e){var i=new t;return i.data=e,i},t.prototype.getOpinion=function(t,e){return this.opinion_k1.target==e?this.opinion_k1:this.opinion_k2},t.prototype.recalculate=function(){this.opinion_k1||(this.opinion_k1=new r.default(this.kingdom1,this.kingdom2),this.opinion_k2=new r.default(this.kingdom2,this.kingdom1)),this.opinion_k1.calculate(this.kingdom1,this.kingdom2,this),this.opinion_k2.calculate(this.kingdom2,this.kingdom1,this)},t}();a.default=l,cc._RF.pop()},{}],DisasterLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"a0c48UcjX5HsaXSnoUNlArP","DisasterLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.DisasterAsset=n.DisasterType=void 0;var s,l=a("ToolBox"),c=a("GameAudio"),d=a("MapBox"),u=a("Earthquake"),h=a("WorldLog"),p=a("AssetLibrary"),f=a("AssetManager");(function(t){t[t.Nature=0]="Nature",t[t.Other=1]="Other"})(s=n.DisasterType||(n.DisasterType={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.action=null,e.rate=1,e.chance=1,e.world_log="",e.world_log_icon="",e.min_world_population=0,e.premium_only=!1,e.type=s.Other,e}return r(e,t),e}(p.Asset);n.DisasterAsset=_;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._random_pool=[],e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new _;e.id="rain_cloud",e.rate=40,e.chance=.5,e.world_log="",e.type=s.Nature,this.add(e),this.t.action=this.spawnRainCloud;var i=new _;i.id="tornado",i.rate=5,i.chance=.5,i.world_log="worldlog_disaster_tornado",i.world_log_icon="iconTornado",i.min_world_population=100,i.type=s.Nature,this.add(i),this.t.action=this.spawnTornado;var o=new _;o.id="small_meteorite",o.rate=5,o.chance=.5,o.world_log="worldlog_disaster_meteorite",o.world_log_icon="iconMeteorite",o.min_world_population=400,o.premium_only=!0,o.type=s.Nature,this.add(o),this.t.action=this.spawnMeteorite;var a=new _;a.id="small_earthquake",a.rate=3,a.chance=.4,a.world_log="worldlog_disaster_earthquake",a.world_log_icon="iconEarthquake",a.min_world_population=400,a.type=s.Nature,this.add(a),this.t.action=this.spawnSmallEarthquake;var n=new _;n.id="hellspawn",n.rate=2,n.chance=.9,n.world_log="worldlog_disaster_hellspawn",n.world_log_icon="iconDemon",n.min_world_population=300,n.premium_only=!0,this.add(n),this.t.action=this.spawnHellSpawn;var r=new _;r.id="underground_necromancer",r.rate=2,r.chance=.9,r.world_log="worldlog_disaster_underground_necromancer",r.world_log_icon="iconNecromancer",r.min_world_population=200,r.premium_only=!0,this.add(r),this.t.action=this.spawnNecromancer;var l=new _;l.id="mad_thoughts",l.rate=2,l.chance=.7,l.world_log="worldlog_disaster_mad_thoughts",l.world_log_icon="iconMadness",l.min_world_population=150,this.add(l),this.t.action=this.spawnMadThought;var c=new _;c.id="greg_abominations",c.rate=1,c.chance=.5,c.world_log="worldlog_disaster_greg_abominations",c.world_log_icon="iconGreg",c.min_world_population=2e3,this.add(c),this.t.action=this.spawnGreg},e.prototype.getRandomAssetFromPool=function(){if(null==this._random_pool||0==this._random_pool.length){this._random_pool=[];for(var t=0;t<this.list.length;t++)for(var e=this.list[t],i=0;i<e.rate;i++)this._random_pool.push(e)}var o=this._random_pool.getRandom();if(o.type==s.Nature){if(!d.default.inst.worldLaws.world_law_disasters_nature.boolVal)return null}else if(o.type==s.Other&&!d.default.inst.worldLaws.world_law_disasters_other.boolVal)return null;return o.min_world_population<=d.default.inst.getCivWorldPopulation()?o:null},e.prototype.spawnMadThought=function(t){var e=d.default.inst.citiesList.getRandom();if(e&&!(e.getPopulationUnits()<50)&&e.getTile()){var i=[],o=e.units.getSimpleList();o.shuffle();for(var a=0;a<o.length;a++)l.Toolbox.randomChance(.2)&&i.push(o[a]);for(a=0;a<i.length;a++)i[a].addTrait("madness");h.default.logDisaster(t,e.getTile(),null,e)}},e.prototype.spawnGreg=function(t){if(!(f.default.raceLibrary.get("greg").units.length>=1)){var e=d.default.inst.citiesList.getRandom(),i=e.getBuildingType("mine");if(i){var o=i.currentTile,a=d.default.inst.createNewUnit("greg",o,"");h.default.logDisaster(t,o,a.data.firstName,e,a);for(var n=l.Toolbox.randomInt(5,25),r=0;r<n;r++)d.default.inst.createNewUnit("greg",o.region.tiles.getRandom(),"")}}},e.prototype.spawnNecromancer=function(t){if(!(f.default.raceLibrary.get("necromancer").units.length>=1)){var e=d.default.inst.citiesList.getRandom(),i=e.getBuildingType("mine");if(i){var o=i.currentTile,a=d.default.inst.createNewUnit("necromancer",o,"");h.default.logDisaster(t,o,a.data.firstName,e,a);for(var n=l.Toolbox.randomInt(5,25),r=0;r<n;r++)d.default.inst.createNewUnit("skeleton",o.region.tiles.getRandom(),"")}}},e.prototype.spawnEvilMage=function(t){if(f.default.raceLibrary.get("evilMage").units.length<1){var e=d.default.inst.islandsCalculator.getRandomIslandGround();if(e){var i=e.getRandomTile(),o=d.default.inst.createNewUnit("evilMage",i,"");h.default.logDisaster(t,i,o.data.firstName,null,o)}}},e.prototype.spawnSmallEarthquake=function(t){var e=d.default.inst.tilesList.getRandom();d.default.inst.earthquakeManager.startQuake(e,u.EarthquakeType.SmallDisaster),h.default.logDisaster(t,e)},e.prototype.spawnHellSpawn=function(t){if(!(f.default.raceLibrary.get("demon").units.length>20)){var e=d.default.inst.islandsCalculator.getRandomIslandGround();if(e){var i=e.getRandomTile(),o=f.default.powers.get("demons");o.showSpawnEffect&&d.default.inst.stackEffects.startSpawnEffect(i,o.showSpawnEffect),d.default.inst.createNewUnit(o.actorStatsId,i,"",o.actorSpawnHeight);for(var a=l.Toolbox.randomInt(2,5),n=0;n<a;n++){var r=i.neighbours.getRandom();d.default.inst.createNewUnit(o.actorStatsId,r,"",o.actorSpawnHeight)}h.default.logDisaster(t,i)}}},e.prototype.spawnRainCloud=function(){var t=f.default.powers.get("cloudRain"),e=d.default.inst.tilesList.getRandom();d.default.inst.cloudController.spawnCloud(e.posV3,t.id)},e.prototype.spawnTornado=function(t){var e=f.default.powers.get("tornado");e.spawnSound&&c.default.play(e.spawnSound);var i=d.default.inst.tilesList.getRandom();d.default.inst.createNewUnit(e.actorStatsId,i,"",e.actorSpawnHeight),h.default.logDisaster(t,i)},e.prototype.spawnMeteorite=function(t){var e=d.default.inst.tilesList.getRandom();d.default.inst.spawnMeteorite(e),h.default.logDisaster(t,e)},e}(p.default);n.default=m,cc._RF.pop()},{}],Docks:[function(t,e,i){"use strict";cc._RF.push(e,"bf97ce+NYxOy4cZrY63/KoE","Docks");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetManager"),l=a("BaseBuilding"),c=a("MapBox"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.limit=1,e.boats_trading=[],e.boats_transport=[],e.boats_fishing=[],e.tiles_ocean=[],e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.getIsland=function(){var t;return this.building.city?null===(t=this.building.city.getTile())||void 0===t?void 0:t.region.island:null},e.prototype.getOceanTileInSameOcean=function(t){for(var e=0;e<this.tiles_ocean.length;e++){var i=this.tiles_ocean[e];if(i.isSameIsland(t))return i}return null},e.prototype.checkOceanTiles=function(){return this.recalculateOceanTiles(),0!=this.tiles_ocean.length},e.prototype.recalculateOceanTiles=function(){this.tiles_ocean=[];var t=c.default.inst.getTile(this.building.currentTile.x-4,this.building.currentTile.y);t&&t.isGoodForBoat()&&this.tiles_ocean.push(t),(t=c.default.inst.getTile(this.building.currentTile.x+5,this.building.currentTile.y))&&t.isGoodForBoat()&&this.tiles_ocean.push(t),(t=c.default.inst.getTile(this.building.currentTile.x,this.building.currentTile.y-4))&&t.isGoodForBoat()&&this.tiles_ocean.push(t),(t=c.default.inst.getTile(this.building.currentTile.x,this.building.currentTile.y+7))&&t.isGoodForBoat()&&this.tiles_ocean.push(t),this.tiles_ocean.shuffle(),0==this.tiles_ocean.length&&this.building.startRemove()},e.prototype.isDockGood=function(){return!1},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e)},e.prototype.haveFreeSlot=function(t){var e=this.getList(t);return!(this.limit<=e.length)},e.prototype.isMoreLimit=function(t){return this.getList(t).length>this.limit},e.prototype.buildBoatFromHere=function(t){var i=t.getCulture();if(!i)return null;var o=s.default.unitStats.get(e.boat_types.getRandom());if(o.tech&&!i.haveTech(o.tech))return null;if(this.getList(o),!this.haveFreeSlot(o))return null;if(!t.haveEnoughResourcesFor(o.cost))return null;if(0==this.tiles_ocean.length)return this.recalculateOceanTiles(),null;if(this.tiles_ocean.getRandom().region.island.getTileCount()<2500)return null;var a=c.default.inst.createNewUnit(o.id,this.tiles_ocean.getRandom());return a?(this.addBoatToDock(a),t.spendResourcesFor(o.cost),a):null},e.prototype.getList=function(t){switch(t.id){case"boat_transport":return this.boats_transport;case"boat_fishing":return this.boats_fishing;case"boat_trading":return this.boats_trading;default:return[]}},e.prototype.setKingdom=function(t){this.setKingdomToBoats(t,this.boats_transport),this.setKingdomToBoats(t,this.boats_fishing),this.setKingdomToBoats(t,this.boats_trading)},e.prototype.setKingdomToBoats=function(t,e){for(var i=0;i<e.length;i++)e[i].setKingdom(t)},e.prototype.addBoatToDock=function(t){t.setHomeBuilding(this.building),this.getList(t.stats).push(t),t.setCity(t.homeBuilding.city),t.callbacks_on_death.push(this.callbackUnitDied.bind(this))},e.prototype.removeBoatFromDock=function(t){var e;null===(e=this.getList(t.stats))||void 0===e||e.remove(t)},e.prototype.callbackUnitDied=function(t){this.removeBoatFromDock(t)},e.boat_types=["boat_fishing","boat_trading","boat_transport"],e}(l.BaseBuildingComponent);n.default=d,cc._RF.pop()},{}],DragonAsset:[function(t,e,i){"use strict";cc._RF.push(e,"dae999kgz1H9o+mZt0m8J1t","DragonAsset");var o,a,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.DragonAssetContainer=n.DragonState=void 0,function(t){t[t.Fly=0]="Fly",t[t.LandAttack=1]="LandAttack",t[t.Death=2]="Death",t[t.SleepStart=3]="SleepStart",t[t.SleepLoop=4]="SleepLoop",t[t.SleepUp=5]="SleepUp",t[t.Landing=6]="Landing",t[t.Slide=7]="Slide",t[t.Up=8]="Up",t[t.Idle=9]="Idle"}(a=n.DragonState||(n.DragonState={}));var l=cc._decorator,c=l.ccclass,d=l.property,u=function(){function t(){this.name="",this.id=a.Fly,this.frames=[],this.states=[],this.speed=.1}return s([d({type:cc.Enum(a)})],t.prototype,"id",void 0),s([d({type:[cc.SpriteFrame]})],t.prototype,"frames",void 0),s([d({type:[cc.Enum(a)]})],t.prototype,"states",void 0),s([d()],t.prototype,"speed",void 0),s([c("DragonAssetContainer")],t)}();n.DragonAssetContainer=u;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dict=null,e.list=[],e}return r(e,t),e.prototype.getAsset=function(t){var e=this;return null==this.dict&&(this.dict=new Map,this.list.forEach(function(t){e.dict.set(t.id,t)})),this.dict.get(t)},s([d({type:[u]})],e.prototype,"list",void 0),s([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],Dragon:[function(t,e,i){"use strict";cc._RF.push(e,"b7f00uUrddLG44Sh6n/J8HH","Dragon");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("Log"),d=a("SpriteAnimation"),u=a("DropsLibrary"),h=a("BaseActorComponent"),p=a("ToolBox"),f=a("UnusedLibrary"),_=a("GameAudio"),m=a("MapBox"),g=a("DragonAsset"),y=cc._decorator,v=y.ccclass,b=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ignoredKingdoms=[],e.dragonAsset=null,e.state=g.DragonState.Idle,e.animationDoneOnce=!1,e.actionTime=0,e.landAttacks=0,e.attacksForCity=0,e.cityToAttack=null,e.actorToAttack=null,e._justGotHit=!1,e._canSleep=!1,e.sleepy=0,e._died=!1,e.spriteAnimation=null,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.spriteAnimation=this.getComponent(d.SpriteAnimation),this.actor.haveTrait("zombie")?(this.ignoredKingdoms=["undead"],this.dragonAsset=f.default.inst.zombieDragonAsset):(this.ignoredKingdoms=["dragons"],this.dragonAsset=f.default.inst.dragonAsset),this.actor.callbacks_get_hit.push(this.getHit.bind(this)),this.setState(g.DragonState.Fly)},e.prototype.setFlying=function(t){this.actor.flying=t,this.actor.hitboxZ=t?8:2},e.prototype.setState=function(t){var e,i,o,a,n,r,s,l,c,d,u,h=this;this.state=t;var f=this.dragonAsset.getAsset(t);this.animationDoneOnce=!1,this.setFlying(!1);var y=null;switch(this.actor.haveTrait("zombie")||this.sleepy++,this.state){case g.DragonState.Fly:if(this.setFlying(!0),(null===(i=null===(e=this.actorToAttack)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive)||(this.actorToAttack=null),this.actor.haveTrait("zombie")&&!this.actorToAttack&&!this.cityToAttack&&m.default.inst.kingdoms.getKingdomByID("goldenBrain").buildings.length>0){var v=0,b=0;if(m.default.inst.kingdoms.getKingdomByID("goldenBrain").buildings.list.forEach(function(t){v=p.Toolbox.distTile(t.currentTile,h.actor.currentTile),(!y||v<b)&&(y=t.currentTile,b=v)}),y&&y==this.actor.currentTile)return void this.setState(g.DragonState.Landing)}if((null===(a=null===(o=this.actorToAttack)||void 0===o?void 0:o.data)||void 0===a?void 0:a.alive)&&this.actorToAttack.currentTile&&!this.shouldFly()&&this.actor.currentTile==this.actorToAttack.currentTile)return void this.setState(g.DragonState.Landing);if(this.attacksForCity>0&&(null===(n=this.cityToAttack)||void 0===n?void 0:n.buildings)&&(0==this.cityToAttack.buildings.length?this.cityToAttack=null:(y=null===(u=null===(d=null===(c=null===(l=null===(s=null===(r=this.cityToAttack)||void 0===r?void 0:r.buildings)||void 0===s?void 0:s.getRandom())||void 0===l?void 0:l.currentTile)||void 0===c?void 0:c.zone)||void 0===d?void 0:d.tiles)||void 0===u?void 0:u.getRandom(),this.attacksForCity--)),!y){var w=50;for(y=m.default.inst.islandsCalculator.getRandomGround();p.Toolbox.dist(this.actor.currentTile.pos.x,this.actor.currentTile.pos.y,y.pos.x,y.pos.y)>100&&(y=m.default.inst.islandsCalculator.getRandomGround(),!(--w<=0)););}this.actor.moveTo(y);break;case g.DragonState.LandAttack:_.default.playDragonAttack(this.node.position);break;case g.DragonState.Death:this.spriteAnimation.looped=!1;break;case g.DragonState.SleepStart:this.sleepy=0,this.actor.setFlip(!1);break;case g.DragonState.SleepLoop:this.sleepy=0,this.actor.setFlip(!1),this.actionTime=p.Toolbox.randomFloat(10,80);break;case g.DragonState.SleepUp:this.sleepy=0,this.actor.setFlip(!1);break;case g.DragonState.Landing:if(this.shouldFly())return void this.setState(g.DragonState.Up);break;case g.DragonState.Slide:_.default.playDragonSwoop(this.node.position),this.setFlying(!0);break;case g.DragonState.Up:this.landAttacks=0,this.actionTime=0,this.setFlying(!0);break;case g.DragonState.Idle:this.actionTime=p.Toolbox.randomFloat(1,3)}this.spriteAnimation.setFrames(f.frames),this.spriteAnimation.timeBetweenFrames=f.speed,this.spriteAnimation.resetAnim()},e.prototype.shouldFly=function(){var t,e,i;return(null===(e=null===(t=this.actor.currentTile)||void 0===t?void 0:t.type)||void 0===e||!e.ground)&&!0===(null===(i=this.actor.data)||void 0===i?void 0:i.alive)},e.prototype.attackTile=function(t){if(t){if(this.actor.haveTrait("zombie"))return u.default.action_acid(t),void(p.Toolbox.randomBool()&&m.default.inst.dropManager.spawnBurstPixel(t,"acid",p.Toolbox.randomFloat(.05,.5),p.Toolbox.randomFloat(.05,.75)));t.setFire(!0),t.building&&t.building.getHit(10),p.Toolbox.randomBool()&&m.default.inst.dropManager.spawnBurstPixel(t,"fire",p.Toolbox.randomFloat(.05,.5),p.Toolbox.randomFloat(.05,.75))}},e.prototype.hasTargetsForSlide=function(){var t,e;if(m.default.inst.worldLaws.world_law_peaceful_monsters.boolVal)return!1;var i=this.attackRange(this.actor.flip);try{for(var o=l(i),a=o.next();!a.done;a=o.next()){var n=a.value;if(this.hasTarget(n))return!0}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return!1},e.prototype.attackRange=function(t){void 0===t&&(t=!1);var e,i=[];e=t?-25:20;for(var o=0;o<4;o++)for(var a=0;a<35;a++){var n=m.default.inst.getTile(this.actor.currentTile.x+a-15+e,this.actor.currentTile.y-o+2);n&&i.push(n)}return i},e.prototype.hasTarget=function(t){var e,i,o,a,n,r,s,c;if(m.default.inst.worldLaws.world_law_peaceful_monsters.boolVal)return!1;if((null===(r=null===(n=t.building)||void 0===n?void 0:n.data)||void 0===r?void 0:r.alive)&&!t.building.isRuin())return!0;if(t.units.length>0)try{for(var d=l(t.units),u=d.next();!u.done;u=d.next()){var h=u.value;if((null===(s=h.data)||void 0===s?void 0:s.alive)&&!(h.node.z>0)&&this.ignoredKingdoms){var p=!1,f=this.ignoredKingdoms;try{for(var _=(o=void 0,l(f)),g=_.next();!g.done;g=_.next()){var y=g.value;if((null===(c=h.kingdom)||void 0===c?void 0:c.data.id)==y){p=!0;break}}}catch(v){o={error:v}}finally{try{g&&!g.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}if(p)continue}}}catch(b){e={error:b}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(e)throw e.error}}return!1},e.prototype.logicUpdate=function(t){var e,i,o=this;if(this.spriteAnimation.currentFrameIndex>0&&(this.animationDoneOnce=!0),(null===(i=null===(e=this.actor)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive)||(this.actionTime=-1),this.state==g.DragonState.Slide&&7==this.spriteAnimation.currentFrameIndex)this.attackRange(this.actor.flip).forEach(function(t){p.Toolbox.randomBool()||(m.default.inst.applyForce(t,2,o.actor.curStats.knockback,!0,!1,o.actor.curStats.damage,o.ignoredKingdoms,o.actor),o.attackTile(t))});else if(this.state==g.DragonState.LandAttack&&5==this.spriteAnimation.currentFrameIndex){this.landAttacks++;for(var a=0;a<12;a++)for(var n=0;n<20;n++)if(!p.Toolbox.randomBool()){var r=m.default.inst.getTile(this.actor.currentTile.pos.x+n-10,this.actor.currentTile.pos.y-a+1);!r||p.Toolbox.dist(this.actor.currentTile.pos.x,this.actor.currentTile.pos.y,r.pos.x,r.pos.y)>9||this.attackTile(r)}m.default.inst.applyForce(this.actor.currentTile,10,this.actor.curStats.knockback,!0,!1,this.actor.curStats.damage,this.ignoredKingdoms,this.actor)}else if(this.state==g.DragonState.Death&&this.spriteAnimation.currentFrameIndex==this.spriteAnimation.frames.length-1)return this.actor.updateDeadBlackAnimation(),void(this._died||(this._died=!0,this.actor.haveTrait("fire_blood")&&this.fireBloodExplosion()));this.actor.is_moving||(this.shouldFly()&&(this.actionTime=0),this.actionTime>0?this.actionTime-=t:this.nextAction())},e.prototype.fireBloodExplosion=function(){for(var t=0;t<25;t++)p.Toolbox.randomBool()&&m.default.inst.dropManager.spawnBurstPixel(this.actor.currentTile,"fire",p.Toolbox.randomFloat(.05,.5),p.Toolbox.randomFloat(.05,1)),this.actor.currentTile.neighboursAll.forEach(function(t){p.Toolbox.randomBool()&&m.default.inst.dropManager.spawnBurstPixel(t,"fire",p.Toolbox.randomFloat(.05,.5),p.Toolbox.randomFloat(.05,1))})},e.prototype.nextAction=function(){var t,e,o,a,n=m.default.inst.worldLaws.world_law_peaceful_monsters.boolVal;if(0==this.spriteAnimation.currentFrameIndex&&this.animationDoneOnce)if(null===(e=null===(t=this.actor)||void 0===t?void 0:t.data)||void 0===e?void 0:e.alive){if(this._justGotHit&&!n){if(this.state==g.DragonState.Idle||this.state==g.DragonState.SleepUp||this.state==g.DragonState.LandAttack)return this.landAttacks>2||this.shouldFly()?void this.setState(g.DragonState.Up):(this._justGotHit=!1,void this.setState(g.DragonState.LandAttack));if(this.state==g.DragonState.Fly||this.state==g.DragonState.Up)return this.setState(g.DragonState.Slide),void(this._justGotHit=!1)}if(this.state==g.DragonState.Landing){if(!n&&(null===(a=null===(o=this.actorToAttack)||void 0===o?void 0:o.data)||void 0===a?void 0:a.alive)&&this.actor.currentTile&&this.actor.currentTile==this.actorToAttack.currentTile&&!this.shouldFly())return void this.setState(g.DragonState.LandAttack);if(!n&&this.attacksForCity>0&&this.cityToAttack&&p.Toolbox.randomChance(.2)){if(this.shouldFly()&&this.hasTargetsForSlide()&&p.Toolbox.randomBool())return this.setState(g.DragonState.Slide),void this.attacksForCity--;if(!this.shouldFly())return this.setState(g.DragonState.LandAttack),void this.attacksForCity--}if(this.shouldFly())return void this.setState(g.DragonState.Fly)}if(this._canSleep=!0,this.actorToAttack||this.cityToAttack?this._canSleep=!1:this.actor.currentTile.units.length>1&&(this._canSleep=!1),i.possibleActions=[],this.state==g.DragonState.SleepStart&&i.possibleActions.push(g.DragonState.SleepLoop),this.state==g.DragonState.SleepLoop&&(i.possibleActions.push(g.DragonState.SleepLoop),i.possibleActions.push(g.DragonState.SleepUp)),this.state==g.DragonState.SleepUp&&(this._canSleep&&i.possibleActions.push(g.DragonState.SleepStart),i.possibleActions.push(g.DragonState.Up),i.possibleActions.push(g.DragonState.Idle)),this.state!=g.DragonState.Up&&this.state!=g.DragonState.Fly&&this.state!=g.DragonState.Slide||(this.shouldFly()||(i.possibleActions.push(g.DragonState.Fly),this.state!=g.DragonState.Up&&i.possibleActions.push(g.DragonState.Landing)),i.possibleActions.push(g.DragonState.Fly),i.possibleActions.push(g.DragonState.Fly),i.possibleActions.push(g.DragonState.Fly),i.possibleActions.push(g.DragonState.Fly),i.possibleActions.push(g.DragonState.Fly),this.state==g.DragonState.Slide||n||i.possibleActions.push(g.DragonState.Slide)),this.state!=g.DragonState.Landing&&this.state!=g.DragonState.Idle&&this.state!=g.DragonState.LandAttack||(i.possibleActions.push(g.DragonState.Up),n||i.possibleActions.push(g.DragonState.LandAttack),this._canSleep&&this.sleepy>10&&(i.possibleActions.push(g.DragonState.SleepStart),i.possibleActions.push(g.DragonState.SleepStart),i.possibleActions.push(g.DragonState.SleepStart)),i.possibleActions.push(g.DragonState.Idle),i.possibleActions.push(g.DragonState.Idle),i.possibleActions.push(g.DragonState.Idle)),i.possibleActions.length>0){var r=i.possibleActions.getRandom();this.setState(r)}else c.default.d("no possible actions for current state : "+this.state);i.possibleActions=[]}else this.actor.flying?this.setState(g.DragonState.Landing):this.state!=g.DragonState.Death&&this.setState(g.DragonState.Death)},e.prototype.clickToWakeup=function(){this.state!=g.DragonState.SleepLoop&&this.state!=g.DragonState.SleepStart||(this.actionTime=0)},e.prototype.getHit=function(){var t,e,i;!m.default.inst.worldLaws.world_law_peaceful_monsters.boolVal&&(null===(t=this.actor)||void 0===t?void 0:t.attackedBy)&&(this.actor.attackedBy.isActor()&&!(null===(i=null===(e=this.actorToAttack)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive)&&(this.actorToAttack=this.actor.attackedBy.a),this.cityToAttack=this.actor.attackedBy.city,this.attacksForCity=p.Toolbox.randomInt(4,12)),this._justGotHit=!0,this.actionTime=0},e.possibleActions=[],i=s([v],e)}(h.default));n.default=b,cc._RF.pop()},{}],DropManager:[function(t,e,i){"use strict";cc._RF.push(e,"5fc60cTyaZE5pZ5Hi4Vbr9P","DropManager");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("AssetManager"),d=a("BaseMapObject"),u=a("ToolBox"),h=a("MapBox"),p=a("Drop"),f=cc._decorator,_=f.ccclass,m=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.drops=[],e.timeout_timer=0,e.activeIndex=0,e.original_drop=null,e.tDrop=null,e.pool=new cc.NodePool,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.spawn=function(t,e,i,o){void 0===i&&(i=-1),void 0===o&&(o=-1);var a=c.default.drops.get(e),n=this.getObject();if(n.launch(t,a,i),-1==o&&(o=a.default_scale),n.node.scale=o,a.random_flip){var r=u.Toolbox.randomBool()?1:-1;n.node.scaleX*=r}return n},e.prototype.spawnBurstPixel=function(t,e,i,o,a,n){void 0===a&&(a=0),void 0===n&&(n=-1);var r=this.spawn(t,e,a,n);r.burst=!0,r.zPosition.z=a,r.updatePosition();var s=u.Toolbox.randomFloat(-Math.PI,Math.PI),l=i*Math.cos(s),c=i*Math.sin(s),d=u.Toolbox.randomFloat(o,2*o);r.addForce(l,c,d),r.updatePosition()},e.prototype.spawnPixel=function(t,e,i){void 0===i&&(i=!1)},e.prototype.clear=function(){for(var t=this.drops.length-1;this.drops.length>0;){var e=this.drops[t];this.killObject(e),t--}this.drops=[]},e.prototype.killObject=function(t){t.active=!1,this.drops.remove(t),this.pool.put(t.node)},e.prototype.landPixel=function(t){var e=t.currentTile;this.killObject(t),e&&h.default.inst.flashEffects.flashPixel(e,14)},e.prototype.getObject=function(){var t=this.pool.get();return t||(t=cc.instantiate(this.original_drop)),t.parent=this.node,t.scale=1,this.tDrop=t.getComponent(p.default),this.tDrop.controller=this,this.drops.push(this.tDrop),this.tDrop.drop_index=this.drops.length,this.tDrop.burst=!1,this.tDrop.createGround=!0,this.tDrop.forcedTileType=null,this.tDrop.active=!0,this.tDrop},e.prototype.logicUpdate=function(e){var i,o;t.prototype.logicUpdate.call(this,e),this.timeout_timer>0&&(this.timeout_timer-=cc.director.getDeltaTime());try{for(var a=l(this.drops),n=a.next();!n.done;n=a.next()){var r=n.value;r.created&&r.active&&r.logicUpdate(e)}}catch(d){i={error:d}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},s([m(cc.Prefab)],e.prototype,"original_drop",void 0),s([_],e)}(d.default);n.default=g,cc._RF.pop()},{}],DropsLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"c4aee9yBEpCnpBJFwL8oRmJ","DropsLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.DropAsset=void 0;var l=a("MathUtils"),c=a("Tools"),d=a("MapAction"),u=a("WorldAction"),h=a("ActionLibrary"),p=a("BaseBuilding"),f=a("Wheat"),_=a("ToolBox"),m=a("ExplosionChecker"),g=a("GameAudio"),y=a("MapLayer"),v=a("TileTypeBase"),b=a("MapBox"),w=a("AssetLibrary"),T=a("AssetManager"),k=a("TerraformLibrary"),B=a("TopTileLibrary"),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.random_frame=!1,e.random_flip=!1,e.animated=!1,e.animation_speed=.1,e.animation_speed_random=.1,e.sound_drop="",e.sound_launch="",e.action_launch=u.default.create(),e.action_landed=u.default.create(),e.powerOnLanding="",e.constructionTemplate="",e.constructionTemplateSound="",e.bounce=!1,e.fallingSpeed=3.2,e.fallingSpeedRandom=.5,e.fallingHeight=cc.v3(15,20),e.fallingRandomXMove=!1,e.particleInterval=0,e.texture="drops/drop_pixel",e.default_scale=1,e.spriteList=[],e}return r(e,t),e}(w.Asset);n.DropAsset=S;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var i=new S;i.id="tnt",i.sound_drop="fallingSand",i.animated=!0,i.texture="drops/drop_tnt",i.animation_speed=.03,i.default_scale=.2,i.action_landed.add(e.action_tnt),this.add(i);var o=new S;o.id="tnt_timed",o.texture="drops/drop_tnttimed",o.default_scale=.2,o.sound_drop="fallingSand",o.action_landed.add(e.action_tnt_timed),this.add(o);var a=new S;a.id="water_bomb",a.texture="drops/drop_waterbomb",a.default_scale=.2,a.action_landed.add(e.action_water_bomb),this.add(a);var n=new S;n.id="landmine",n.texture="drops/drop_landmine",n.default_scale=.2,n.sound_drop="fallingSand",n.action_landed.add(e.action_landmine),this.add(n);var r=new S;r.id="fireworks",r.texture="drops/drop_fireworks",r.random_frame=!0,r.default_scale=.1,r.sound_drop="fallingSand",r.action_landed.add(e.action_fireworks),this.add(r);var s=new S;s.id="inspiration",s.texture="drops/drop_fire",s.default_scale=.2,s.action_landed.add(e.action_inspiration),this.add(s);var l=new S;l.id="friendship",l.texture="drops/drop_friendship",l.random_frame=!0,l.default_scale=.1,l.action_landed.add(e.action_friendship),this.add(l);var c=new S;c.id="spite",c.texture="drops/drop_spite",c.random_frame=!0,c.default_scale=.1,c.action_landed.add(e.action_spite),this.add(c);var d=new S;d.id="madness",d.texture="drops/drop_madness",d.random_frame=!0,d.default_scale=.1,d.action_landed.add(e.action_madness),this.add(d);var u=new S;u.id="blessing",u.texture="drops/drop_blessing",u.animated=!0,u.animation_speed=.03,u.default_scale=.1,u.action_landed.add(e.action_blessing),this.add(u),this.t.action_landed.add(h.default.action_shrinkTornadoes);var p=new S;p.id="shield",p.texture="drops/drop_shield",p.random_frame=!0,p.default_scale=.1,p.action_landed.add(e.action_shield),this.add(p);var f=new S;f.id="coffee",f.texture="drops/drop_coffee",f.random_frame=!0,f.default_scale=.1,f.action_landed.add(e.action_coffee),this.add(f);var _=new S;_.id="powerup",_.texture="drops/drop_mushroom_powerup",_.random_frame=!0,_.default_scale=.1,_.action_landed.add(e.action_powerup),this.add(_);var m=new S;m.id="curse",m.texture="drops/drop_curse",m.random_frame=!0,m.default_scale=.1,m.action_landed.add(e.action_curse),this.add(m),this.t.action_landed.add(h.default.action_growTornadoes);var g=new S;g.id="zombieInfection",g.texture="drops/drop_zombieinfection",g.random_frame=!0,g.default_scale=.1,g.action_landed.add(e.action_zombieInfection),this.add(g);var y=new S;y.id="mushSpores",y.texture="drops/drop_mushSpores",y.random_frame=!0,y.default_scale=.1,y.action_landed.add(e.action_mushSpore),this.add(y);var v=new S;v.id="plague",v.texture="drops/drop_plague",v.random_frame=!0,v.default_scale=.1,v.action_landed.add(e.action_plague),this.add(v);var b=new S;b.id="livingPlants",b.texture="drops/drop_blessing",b.animated=!0,b.default_scale=.1,b.action_landed.add(e.action_livingPlants),this.add(b);var w=new S;w.id="livingHouse",w.texture="drops/drop_blessing",w.animated=!0,w.default_scale=.1,w.action_landed.add(e.action_livingHouse),this.add(w);var T=new S;T.id="bomb",T.sound_launch="bomb fall",T.sound_drop="explosion small",T.texture="drops/drop_bomb",T.default_scale=.2,T.fallingHeight=cc.v3(60,70),T.action_landed.add(e.action_bomb),T.random_flip=!0,this.add(T),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var k=new S;k.id="grenade",k.texture="drops/drop_grenade",k.animated=!0,k.default_scale=.2,k.animation_speed=.03,k.sound_drop="explosion small",k.fallingHeight=cc.v3(60,70),k.action_landed.add(e.action_grenade),k.random_flip=!0,this.add(k),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var B=new S;B.id="napalmBomb",B.texture="drops/drop_napalmbomb",B.default_scale=.2,B.sound_drop="explosion small",B.fallingHeight=cc.v3(60,70),B.action_landed.add(e.action_napalmBomb),B.random_flip=!0,this.add(B),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var C=new S;C.id="atomicBomb",C.texture="drops/drop_atomicbomb",C.default_scale=.2,C.sound_launch="bomb fall",C.sound_drop="explosion medium",C.fallingHeight=cc.v3(60,70),C.action_landed.add(e.action_atomicBomb),C.random_flip=!0,this.add(C),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var x=new S;x.id="antimatterBomb",x.texture="drops/drop_antimatterbomb",x.default_scale=.2,x.fallingHeight=cc.v3(60,70),x.action_landed.add(e.action_antimatterBomb),this.add(x),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var A=new S;A.id="czarBomba",A.texture="drops/drop_czarbomba",A.default_scale=.2,A.sound_launch="bomb fall",A.sound_drop="explosion big",A.fallingHeight=cc.v3(60,70),A.action_landed.add(e.action_czarBomba),this.add(A),this.t.action_launch.add(h.default.increaseDroppedBombsCounter);var P=new S;P.id="rain",P.texture="drops/drop_rain",P.random_frame=!0,P.default_scale=.2,P.fallingHeight=cc.v3(30,45),P.action_landed.add(e.action_rain),this.add(P);var O=new S;O.id="bouncy_sand",O.default_scale=.2,O.random_frame=!0,this.add(O);var R=new S;R.id="bouncy_soil",R.default_scale=.2,R.random_frame=!0,this.add(R);var F=new S;F.id="bloodRain",F.texture="drops/drop_blood",F.random_frame=!0,F.default_scale=.1,F.fallingHeight=cc.v3(30,45),F.action_landed.add(e.action_bloodRain),this.add(F);var L=new S;L.id="cure",L.texture="drops/drop_cure",L.random_frame=!0,L.default_scale=.1,L.fallingHeight=cc.v3(30,45),L.action_landed.add(e.action_cure),this.add(L);var D=new S;D.id="fire",D.texture="drops/drop_fire",D.animated=!0,D.animation_speed=.03,D.default_scale=.2,D.sound_launch="fallingFire",D.fallingHeight=cc.v3(30,45),D.fallingRandomXMove=!0,D.particleInterval=.3,D.action_landed.add(e.action_fire),D.animation_speed_random=.08,D.random_frame=!0,D.random_flip=!0,this.add(D);var M=new S;M.id="snow",M.texture="drops/drop_snow",M.random_frame=!0,M.default_scale=.2,M.sound_drop="snow",M.fallingSpeed=.3,M.fallingHeight=cc.v3(30,45),M.fallingRandomXMove=!0,M.particleInterval=.15,M.action_landed.add(e.action_snow),this.add(M);var I=new S;I.id="acid",I.texture="drops/drop_acid",I.random_frame=!0,I.default_scale=.2,I.sound_drop="acid",I.fallingHeight=cc.v3(30,45),I.action_landed.add(e.action_acid),this.add(I);var j=new S;j.id="lava",j.texture="drops/drop_lava",j.animated=!0,j.animation_speed=.03,j.default_scale=.2,j.sound_drop="lava",j.fallingHeight=cc.v3(30,45),j.action_landed.add(e.action_lava),this.add(j);var E=new S;E.id="santa_bomb",E.texture="drops/drop_santabomb",E.random_frame=!0,E.default_scale=.2,E.sound_launch="bomb fall",E.sound_drop="explosion small",E.action_landed.add(e.action_santa_bomb),this.add(E);var N=new S;N.id="_spawn_building",N.texture="drops/drop_stone",N.random_frame=!0,N.default_scale=.2,N.fallingHeight=cc.v3(10,15),N.fallingSpeed=5,this.add(N),this.t.action_landed.add(e.action_spawn_building),this.clone("seedsGrass","_spawn_building"),this.t.texture="drops/drop_seed_grass",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_grass),this.clone("seedsEnchanted","_spawn_building"),this.t.texture="drops/drop_seed_enchanted",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_enchanted),this.clone("seedsSavanna","_spawn_building"),this.t.texture="drops/drop_seed_savanna",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_savanna),this.clone("seedsCorrupted","_spawn_building"),this.t.texture="drops/drop_seed_corrupted",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_corrupted),this.clone("seedsMushroom","_spawn_building"),this.t.texture="drops/drop_seed_mushroom",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_mushroom),this.clone("seedsJungle","_spawn_building"),this.t.texture="drops/drop_seed_jungle",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_jungle),this.clone("seedsSwamp","_spawn_building"),this.t.texture="drops/drop_seed_swamp",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_swamp),this.clone("seedsInfernal","_spawn_building"),this.t.texture="drops/drop_seed_infernal",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_infernal),this.clone("seedsSnowfield","_spawn_building"),this.t.texture="drops/drop_snow",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_snowfield),this.clone("seedsWasteland","_spawn_building"),this.t.texture="drops/drop_acid",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_seeds_wasteland),this.clone("fruitBush","_spawn_building"),this.t.texture="drops/drop_seed",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_fruitBush),this.clone("fertilizerPlants","_spawn_building"),this.t.texture="drops/drop_fertilizer",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_fertilizerPlants),this.t.action_landed.add(e.flash),this.clone("fertilizerTrees","_spawn_building"),this.t.texture="drops/drop_fertilizer",this.t.fallingSpeed=3,this.t.action_landed.add(e.action_fertilizerTrees),this.t.action_landed.add(e.flash),this.clone("stone","_spawn_building"),this.t.texture="drops/drop_stone",this.t.default_scale=.2,this.t.constructionTemplate="stone,stone_m,stone_s",this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="stone",this.clone("ore_deposit","_spawn_building"),this.t.texture="drops/drop_metal",this.t.default_scale=.2,this.t.constructionTemplate="ore_deposit,ore_deposit_m,ore_deposit_s",this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="ore_deposit",this.clone("gold","_spawn_building"),this.t.texture="drops/drop_gold",this.t.default_scale=.2,this.t.constructionTemplate="gold,gold_m,gold_s",this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="gold",this.clone("tumor","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="spawnTumor",this.clone("biomass","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="spawnBiomass",this.clone("cybercore","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="spawnCybercore",this.clone("superPumpkin","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="spawnSuperPumpkin",this.clone("geyser","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="geyser",this.clone("geyserAcid","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="geyserAcid",this.clone("volcano","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.t.constructionTemplateSound="spawnVolcano",this.clone("goldenBrain","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.clone("corruptedBrain","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.clone("iceTower","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.clone("beehive","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building),this.clone("flameTower","_spawn_building"),this.t.constructionTemplate=this.t.id,this.t.action_landed.add(e.action_spawn_building)},e.useDropSeedOn=function(t,i,o){e.useSeedOn(t,i,o);for(var a=0;a<t.neighbours.length;a++)e.useSeedOn(t.neighbours[a],i,o)},e.useSeedOn=function(t,e,i){t.type.canGrowBiomeGrass&&(t.main_type.rankType==v.TileRank.Low?d.default.growGreens(t,e):t.main_type.rankType==v.TileRank.High&&d.default.growGreens(t,i))},e.action_seeds_grass=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.grass_low,B.default.grass_high)},e.action_seeds_enchanted=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.enchanted_low,B.default.enchanted_high)},e.action_seeds_corrupted=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.corruption_low,B.default.corruption_high)},e.action_seeds_savanna=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.savanna_low,B.default.savanna_high)},e.action_seeds_swamp=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.swamp_low,B.default.swamp_high)},e.action_seeds_jungle=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.jungle_low,B.default.jungle_high)},e.action_seeds_infernal=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.infernal_low,B.default.infernal_high)},e.action_seeds_mushroom=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.mushroom_low,B.default.mushroom_high)},e.action_seeds_snowfield=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.snow_low,B.default.snow_high)},e.action_seeds_wasteland=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useDropSeedOn(t,B.default.wasteland_low,B.default.wasteland_high)},e.action_rain=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.useRainOn(t);for(var o=0;o<t.neighbours.length;o++){var a=t.neighbours[o];e.useRainOn(a)}for(o=0;o<t.zone.tiles.length;o++){var n=t.zone.tiles[o];n.data.fire&&n.stopFire()}},e.useRainOn=function(t){var e,i;t.stopFire();for(var o=0;o<t.units.length;o++){var a=t.units[o];(null===(e=a.data)||void 0===e?void 0:e.alive)&&(a.removeStatusEffect("burning"),a.stats.damagedByRain&&a.getHit(13))}t.building&&(t.building.stopFire(),(null===(i=t.building.stats)||void 0===i?void 0:i.buildingType)==p.BuildingType.Wheat&&t.building.getComponent(f.default).growWheat(),t.building.stats.damagedByRain&&t.building.getHit(13)),t.removeBurn(),t.type.canBeFilledWithOcean&&d.default.setOcean(t),t.type.lava&&b.default.inst.lavaLayer.putOut(t),t.type.explodableByOcean&&b.default.inst.explosionLayer.explodeBomb(t)},e.action_acid=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),d.default.checkAcidTerraform(t),_.Toolbox.randomChance(.2)&&b.default.inst.particlesSmoke.spawn(t.pos.x,t.pos.y),t.building&&t.building.stats.affectedByAcid&&t.building.data.alive&&t.building.getHit(20),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];_.Toolbox.randomChance(.6)||o.haveTrait("acid_proof")||o.haveTrait("acid_blood")||o.getHit(20)}b.default.inst.conwayLayer.checkKillRange(t.pos,2)},e.action_fire=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),h.default.action_fire(null,t)},e.action_fireworks=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),d.default.terraformTop(t,B.default.fireworks,k.default.remove)},e.action_tnt=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.type.lava||t.data.fire?(d.default.terraformTop(t,B.default.tnt,k.default.remove),b.default.inst.explosionLayer.explodeBomb(t)):d.default.terraformTop(t,B.default.tnt,k.default.remove)},e.action_tnt_timed=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.type.lava||t.data.fire?(d.default.terraformTop(t,B.default.tnt_timed,k.default.remove),b.default.inst.explosionLayer.explodeBomb(t)):d.default.terraformTop(t,B.default.tnt_timed,k.default.remove)},e.action_czarBomba=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.stackEffects.spawnNukeFlash(t,"czarBomba"),b.default.inst.startShake()},e.action_atomicBomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.startShake(),b.default.inst.stackEffects.spawnNukeFlash(t,"atomicBomb")},e.action_antimatterBomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.startShake(),b.default.inst.stackEffects.spawnAntimatterEffect(t)},e.action_napalmBomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.startShake(),b.default.inst.stackEffects.spawnNapalmFlash(t,"napalmBomb"),b.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(t,.15,.3)},e.action_grenade=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),d.default.damageWorld(t,5,T.default.terraform.get("grenade")),b.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(t,.1,.15)},e.action_bomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(t,.45,.6),m.default.inst.checkNearby(t,10)||d.default.damageWorld(t,10,T.default.terraform.get("bomb"))},e.action_santa_bomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),d.default.damageWorld(t,10,T.default.terraform.get("santa_bomb")),b.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(t,.45,.6)},e.action_water_bomb=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.type.liquid||t.type.lava||t.data.fire?(d.default.terraformTop(t,B.default.water_bomb,k.default.remove),b.default.inst.explosionLayer.explodeBomb(t)):d.default.terraformTop(t,B.default.water_bomb,k.default.remove)},e.action_lava=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.lavaLayer.addLava(t)},e.action_snow=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.type.frozen||(d.default.freezeTile(t),d.default.freezeTile(t));for(var i=0;i<10;i++){var o=t.chunk.tiles.getRandom();if(!o.type.frozen){if(_.Toolbox.distTile(t,o)<11)break;d.default.freezeTile(o),d.default.freezeTile(o)}}},e.action_cure=function(t,e){var i;void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,4,y.MapObjectType.Actor);for(var o=0;o<b.default.inst.temp_map_objects.length;o++){var a=b.default.inst.temp_map_objects[o];(null===(i=a.base_data)||void 0===i?void 0:i.alive)&&(a.removeTrait("plague"),a.removeTrait("cursed"),a.removeTrait("tumorInfection"),a.removeTrait("mushSpores"),a.removeTrait("infected"),a.startShake(),a.startColorEffect("white"))}},e.action_bloodRain=function(t,e){var i;void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var o=0;o<b.default.inst.temp_map_objects.length;o++){var a=b.default.inst.temp_map_objects[o];(null===(i=a.base_data)||void 0===i?void 0:i.alive)&&(a.removeStatusEffect("burning"),a.restoreHealth(l.default.intCast(.2*a.curStats.health)),a.startShake(),a.startColorEffect("white"))}},e.action_plague=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addTrait("plague"),o.haveTrait("plague")&&(o.startShake(),o.startColorEffect("white"))}},e.action_zombieInfection=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.stats.canTurnIntoZombie&&!o.haveTrait("zombie")&&(o.addTrait("infected"),o.startShake(),o.startColorEffect("white"))}},e.action_mushSpore=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.stats.canTurnIntoMush&&!o.haveTrait("mushSpores")&&(o.addTrait("mushSpores"),o.startShake(),o.startColorEffect("white"))}},e.action_curse=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addTrait("cursed")&&(o.setStatsDirty(),o.removeTrait("blessed"),o.startShake(),o.startColorEffect("white"))}},e.action_shield=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addStatusEffect("shield"),o.isActor()&&o.a.startColorEffect("white")}},e.action_powerup=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addStatusEffect("powerup"),o.a.startColorEffect("white")}},e.action_coffee=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addStatusEffect("caffeinated"),o.isActor()&&o.a.startColorEffect("white")}},e.action_blessing=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++){var o=b.default.inst.temp_map_objects[i];o.addTrait("blessed")&&(o.statsDirty=!0,o.event_full_heal=!0),o.removeTrait("cursed"),o.startShake(),o.startColorEffect("white")}},e.action_madness=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.getObjectsInChunks(t,3,y.MapObjectType.Actor);for(var i=0;i<b.default.inst.temp_map_objects.length;i++)b.default.inst.temp_map_objects[i].addTrait("madness")},e.action_inspiration=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.zone.city&&1!=t.zone.city.kingdom.cities.length&&t.zone.city.kingdom.capital!=t.zone.city&&t.zone.city.useInspire()},e.action_spite=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.zone.city&&b.default.inst.kingdoms.diplomacyManager.eventSpite(t.zone.city.kingdom)},e.action_friendship=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.zone.city&&b.default.inst.kingdoms.diplomacyManager.eventFriendship(t.zone.city.kingdom)},e.action_spawn_building=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=T.default.drops.get(e),o=i.constructionTemplate.split(",");b.default.inst.addBuilding(o[0],t,null,!0)?i.constructionTemplateSound&&g.default.play(i.constructionTemplateSound):b.default.inst.stackEffects.get("fx_bad_place").spawnAt(t,.25)},e.flash=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.flashEffects.flashPixel(t,20)},e.action_fertilizerPlants=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.tryGrowVegetationRandom(t,p.VegetationType.Plants,!1,!1)},e.action_fertilizerTrees=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.tryGrowVegetationRandom(t,p.VegetationType.Trees,!1,!1)},e.action_fruitBush=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),b.default.inst.tryGrowVegetation(t,!0,"fruit_bush")},e.action_landmine=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t.type.lava?b.default.inst.explosionLayer.explodeBomb(t):d.default.terraformTop(t,B.default.landmine,k.default.remove)},e.action_livingHouse=function(t,i){var o,a,n,r;void 0===t&&(t=null),void 0===i&&(i=null),e._tempList=Array.from(t.zone.buildings).concat(Array.from(t.zone.ruins)).concat(Array.from(t.zone.abandoned));try{for(var l=s(e._tempList),c=l.next();!c.done;c=l.next()){var d=c.value;if(!d.isRuin()&&!(null===(n=d.data)||void 0===n?void 0:n.underConstruction)&&(null===(r=d.stats)||void 0===r?void 0:r.canBeLivingHouse)){var u=b.default.inst.createNewUnit("livingHouse",d.currentTile);u.data.special_graphics=d.stats.id+"#"+d.animData_index,u.spriteRenderer.spriteFrame=d.spriteRenderer.spriteFrame,d.destroyBuilding(),u.startColorEffect("white")}}}catch(f){o={error:f}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}},e.action_livingPlants=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),e.checkListForLivingPlants(t.zone.food,t),e.checkListForLivingPlants(t.zone.trees,t),e.checkListForLivingPlants(t.zone.wheat,t)},e.checkListForLivingPlants=function(t){e._tempList=Array.from(t),e._tempList.forEach(function(t){var e,i,o;if((null===(e=t.data)||void 0===e?void 0:e.alive)&&(null===(i=t.stats)||void 0===i?void 0:i.canBeLivingPlant)&&!t.chopped&&!t.isRuin()&&!(null===(o=t.data)||void 0===o?void 0:o.underConstruction)){var a=b.default.inst.createNewUnit("livingPlants",t.currentTile);a.spriteRenderer.spriteFrame=t.spriteRenderer.spriteFrame,t.destroyBuilding(),a.startColorEffect("white")}})},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e)));return this.t=c.default.fromJson(i,new S),this.t.id=t,this.t.action_landed=new u.default,this.t.action_launch=new u.default,this.add(this.t)},e._tempList=[],e}(w.default);n.default=C,cc._RF.pop()},{}],Drop:[function(t,e,i){"use strict";cc._RF.push(e,"8d5c8XExDVDBoRRd4Kl889t","Drop");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("SpriteAnimation"),d=a("BaseMapObject"),u=a("ToolBox"),h=a("GameAudio"),p=a("MapBox"),f=a("TextureLoader"),_=cc._decorator,m=_.ccclass,g=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.drop_index=0,e.active=!1,e.controller=null,e.rnd=null,e.animation=null,e.forceVector=cc.Vec3.ZERO,e.initHeight=0,e.forcedTileType=null,e.asset=null,e.soundOn=!1,e.createGround=!1,e.bounce=!1,e.burst=!1,e.falling_speed=0,e.prevPos=cc.Vec3.ZERO,e}return r(e,t),e.prototype.onLoad=function(){this.rnd=this.getComponent(cc.Sprite),this.animation=this.getComponent(c.SpriteAnimation)},e.prototype.launch=function(t,e,i){var o;void 0===i&&(i=-1),this.created||this.create(),this.soundOn&&e.sound_launch&&h.default.play(e.sound_launch),this.soundOn=!1,this.asset=e,(null===(o=this.asset)||void 0===o?void 0:o.action_launch)&&this.asset.action_launch.do(null,null),this.falling_speed=this.asset.fallingSpeed+u.Toolbox.randomFloat(0,this.asset.fallingSpeedRandom),null!=this.asset.spriteList&&0!=this.asset.spriteList.length||(this.asset.spriteList=Array.from(f.TextureLoader.inst.getSpriteFrames(f.ATLAS_TYPE.WORLDATLAS,this.asset.texture).values())),this.animation.setFrames(this.asset.spriteList),this.asset.animated?(this.animation.isOn=!0,this.animation.timeBetweenFrames=this.asset.animation_speed+u.Toolbox.randomFloat(0,this.asset.animation_speed_random)):this.animation.isOn=!1,this.asset.random_frame&&this.animation.setRandomFrame(),this.animation.forceUpdateFrame(),this.forceVector.set(cc.v3(0,0,0)),this.currentTile=t,this.zPosition.z=-1!=i?i:u.Toolbox.randomInt(e.fallingHeight.x,e.fallingHeight.y),this.currentPosition=cc.v3(t.posV3.x,t.posV3.y,0),this.updatePosition()},e.prototype.updateFall=function(t){var e=50*t;e=this.node.scaleX<1?e*(this.falling_speed/(2*this.node.scaleX)):e*this.falling_speed,this.zPosition.z<0&&(e=0),this.zPosition.z-=e*this.node.scaleX,e>0&&this.asset.fallingRandomXMove&&Math.random()>.5&&(Math.random()>.5?this.currentPosition.x-=1*this.node.scaleX:this.currentPosition.x+=1*this.node.scaleX),this.updatePosition(),(this.zPosition.z<=0||this.zPosition.z<=0&&this.forceVector.z<=0)&&(this.zPosition.z=0,0==this.forceVector.z?this.currentTile=p.default.inst.getTile(l.default.intCast(this.currentPosition.x),l.default.intCast(this.currentPosition.y)):this.currentTile=p.default.inst.getTile(l.default.intCast(this.node.position.x),l.default.intCast(this.node.position.y)),this.currentTile&&!this.currentTile.type.liquid&&this.bounce&&Math.abs(this.forceVector.z)>.1?(this.forceVector.z=.5*(0-this.forceVector.z),this.forceVector.x*=.7,this.forceVector.y*=.7,this.initHeight*=.7,this.forceVector.z=this.initHeight):this.land())},e.prototype.land=function(){var t,e;(null===(t=this.asset)||void 0===t?void 0:t.action_landed)&&this.currentTile&&this.asset.action_landed.do(this.currentTile,this.asset.id),(null===(e=this.asset)||void 0===e?void 0:e.sound_drop)&&!this.burst&&h.default.play(this.asset.sound_drop),this.controller.landPixel(this)},e.prototype.updateForce=function(t){if(0!=this.forceVector.x||0!=this.forceVector.y||0!=this.forceVector.z){var e=40*t,i=this.forceVector.z*e;0!=this.forceVector.x&&(this.currentPosition.x+=this.forceVector.x*e),0!=this.forceVector.y&&(this.currentPosition.y+=this.forceVector.y*e),this.zPosition.z+=i,this.forceVector.z-=5*t}},e.prototype.logicUpdate=function(){var e=cc.director.getDeltaTime();t.prototype.logicUpdate.call(this,e),this.animation.logicUpdate(e),e*=.3,this.updateForce(e),this.updateFall(e),this.updatePosition()},e.prototype.updatePosition=function(){this.node.position=cc.v3(this.currentPosition.x,this.currentPosition.y+this.zPosition.z,0)},e.prototype.addForce=function(t,e,i){this.forceVector.x=.6*t,this.forceVector.y=.6*e,this.forceVector.z=2*i,this.initHeight=this.forceVector.z},e.prototype.findCurrentTile=function(){var t=Math.floor(this.node.x),e=Math.floor(this.node.y);t>=p.default.width&&(t=p.default.width-1),e>=p.default.height&&(e=p.default.height-1),t<0&&(t=0),e<0&&(e=0),this.currentTile=p.default.inst.getTile(t,e)},s([m],e)}(d.default));n.default=g,cc._RF.pop()},{}],Earthquake:[function(t,e,i){"use strict";cc._RF.push(e,"50982XtJTJFMp3e/pHq4+9R","Earthquake");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.EarthquakeType=void 0;var l,c=a("MapAction"),d=a("AssetManager"),u=a("ToolBox"),h=a("GameAudio"),p=a("MapBox");(function(t){t[t.RandomPower=0]="RandomPower",t[t.BigIncrease=1]="BigIncrease",t[t.BigDecrease=2]="BigDecrease",t[t.SmallDisaster=3]="SmallDisaster"})(l=n.EarthquakeType||(n.EarthquakeType={}));var f=cc._decorator,_=f.ccclass,m=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentPrint=null,e.printTick=0,e.printTileOrigin=null,e.timer=0,e.interval=.05,e.quakeActive=!1,e.type=l.BigDecrease,e.currentPrintIndex=0,e}return r(e,t),e.prototype.startQuake=function(t,e){void 0===e&&(e=l.RandomPower),this.quakeActive||(h.default.playEarthquake(),this.type=e,this.quakeActive=!0,this.currentPrintIndex++,this.currentPrintIndex>=p.default.inst.printLibrary.listQuakes.length&&(p.default.inst.printLibrary.listQuakes.shuffle(),this.currentPrintIndex=0),this.currentPrint=p.default.inst.printLibrary.listQuakes[this.currentPrintIndex],this.currentPrint.steps.shuffle(),this.printTileOrigin=t,this.printTick=0,e==l.RandomPower&&(u.Toolbox.randomChance(.5)?this.type=l.BigDecrease:this.type=l.BigIncrease))},e.prototype.update=function(){if(this.quakeActive)if(this.timer>0)this.timer-=p.default.inst.elapsed;else{this.timer=this.interval;for(var t=0;t<300;t++){if(this.printTick>=this.currentPrint.steps.length){this.endQuake();break}var e=this.currentPrint.steps[this.printTick];this.printTick++;var i=p.default.inst.getTile(this.printTileOrigin.pos.x+e.x,this.printTileOrigin.pos.y+e.y);if(i&&(this.tileAction(i),this.printTick>=this.currentPrint.steps.length)){this.endQuake();break}}p.default.inst.startShake()}},e.prototype.tileAction=function(t){switch(this.type){case l.BigDecrease:t.type.decreaseTo&&c.default.decreaseTile(t,"earthquake");break;case l.BigIncrease:t.type.increaseTo&&c.default.decreaseTile(t,"earthquake");break;case l.SmallDisaster:c.default.terraformMain(t,t.main_type,d.default.terraform.get("earthquakeDisaster"))}},e.prototype.endQuake=function(){this.quakeActive=!1},s([_],e)}(cc.Component));n.default=m,cc._RF.pop()},{}],EffectDivineLight:[function(t,e,i){"use strict";cc._RF.push(e,"9e6a9z6n5FGdZM1a35/4CWd","EffectDivineLight");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.DivineLightState=void 0;var l,c=a("SpriteAnimation"),d=a("BaseAnimatedObject"),u=a("MapBox");(function(t){t[t.SpawnFirstStage=0]="SpawnFirstStage",t[t.SpawnSecondStage=1]="SpawnSecondStage",t[t.Idle=2]="Idle",t[t.Hide=3]="Hide"})(l=n.DivineLightState||(n.DivineLightState={}));var h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.raySpawn=null,e.rayIdle=null,e.baseSpawn=null,e.baseIdle=null,e.isOn=!1,e.state=l.Idle,e}return r(e,t),e.prototype.onLoad=function(){this.setState(l.SpawnFirstStage)},e.prototype.setState=function(t){switch(this.state=t,this.state){case l.SpawnFirstStage:this.raySpawn.node.active=!0,this.rayIdle.node.active=!1,this.baseSpawn.node.active=!1,this.baseIdle.node.active=!1;break;case l.SpawnSecondStage:this.raySpawn.node.active=!1,this.rayIdle.node.active=!0,this.baseSpawn.node.active=!0,this.baseIdle.node.active=!1;break;case l.Idle:this.raySpawn.node.active=!1,this.rayIdle.node.active=!0,this.baseSpawn.node.active=!1,this.baseIdle.node.active=!0;break;case l.Hide:this.raySpawn.node.active=!0,this.rayIdle.node.active=!1,this.baseSpawn.node.active=!0,this.baseIdle.node.active=!1}},e.prototype.stopEffet=function(){},e.prototype.useEffect=function(){},e.prototype.update=function(){this.isOn?(this.raySpawn.playType=c.AnimPlayType.Forward,this.baseSpawn.playType=c.AnimPlayType.Forward,this.raySpawn.isLastFrame()?(this.raySpawn.node.active=!1,this.rayIdle.node.active=!0):(this.raySpawn.node.active=!0,this.rayIdle.node.active=!1),this.baseSpawn.isLastFrame()?(this.baseSpawn.node.active=!1,this.baseIdle.node.active=!0):(this.baseSpawn.node.active=!0,this.baseIdle.node.active=!1)):(this.raySpawn.playType=c.AnimPlayType.Backward,this.baseSpawn.playType=c.AnimPlayType.Backward,this.rayIdle.node.active=!1,this.baseIdle.node.active=!1,this.raySpawn.isFirstFrame()?this.raySpawn.node.active=!1:this.raySpawn.node.active=!0,this.baseSpawn.isFirstFrame()?this.baseSpawn.node.active=!1:this.baseSpawn.node.active=!0),this.baseSpawn.node.active&&this.baseSpawn.logicUpdate(u.default.inst.elapsed),this.baseIdle.node.active&&this.baseIdle.logicUpdate(u.default.inst.elapsed),this.raySpawn.node.active&&this.raySpawn.logicUpdate(u.default.inst.elapsed),this.rayIdle.node.active&&this.rayIdle.logicUpdate(u.default.inst.elapsed),this.isOn=!1},e.prototype.playOn=function(t){this.node.position=t.posV3,this.isOn=!0},s([f({type:c.SpriteAnimation})],e.prototype,"raySpawn",void 0),s([f({type:c.SpriteAnimation})],e.prototype,"rayIdle",void 0),s([f({type:c.SpriteAnimation})],e.prototype,"baseSpawn",void 0),s([f({type:c.SpriteAnimation})],e.prototype,"baseIdle",void 0),s([f],e.prototype,"isOn",void 0),s([p],e)}(d.default);n.default=_,cc._RF.pop()},{}],EffectInfinityCoin:[function(t,e,i){"use strict";cc._RF.push(e,"bb82aScsvxN/oo4RqG+o3gG","EffectInfinityCoin");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t},d=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var u=a("LocalizedTextManager"),h=a("ActorAsset"),p=a("BaseEffect"),f=a("MapBox"),_=a("WorldTip"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.used=!1,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.prepare=function(e,i){void 0===i&&(i=1),t.prototype.prepare.call(this,e,i),this.used=!1,f.default.inst.startShake(.1,.02,3)},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),this.spriteAnimation.currentFrameIndex>=32&&!this.used){f.default.inst.startShake(.2,.01,3,!1),this.used=!0;var i=this.node.position;i.y+=2;var o=f.default.inst.stackEffects.get("boulderImpact").spawnAt(i,this.node.scaleX);o&&(o.autoYZ=!1,(i=this.node.position).z=this.node.z-10,o.node.position=i),f.default.inst.stackEffects.get("explosionWave").spawnNew().startFlash(i,5),this.doAction()}},e.prototype.doAction=function(){for(var t,e,o=0,a=0,n=0;n<f.default.inst.units.list.length;n++){var r=f.default.inst.units.list[n];!r.data.alive||r.data.favorite||r.stats.ignoredByInfinityCoin||o++}a=o%2!=0?o/2+1:o/2,f.default.inst.citiesList.forEach(function(t){t.killHalfPopPoints()}),i.temp_list=c(f.default.inst.units.list),i.temp_list.shuffle();var s=0;try{for(var l=d(i.temp_list),p=l.next();!p.done;p=l.next()){var m=p.value;if(0==a)break;m.data&&m.data.alive&&!m.data.favorite&&!m.stats.ignoredByInfinityCoin&&(s++,a--,m.getHit(1e3*m.data.health+1,!0,h.AttackType.Other,null,!1))}}catch(g){t={error:g}}finally{try{p&&!p.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}_.default.inst.show(u.LocalizedTextManager.getText("Infinity Coin Used")+" "+s,!1,"top")},e.temp_list=[],i=s([g],e)}(p.default));n.default=y,cc._RF.pop()},{}],Egg:[function(t,e,i){"use strict";cc._RF.push(e,"9a8e4ekryxC+6D04CtPF4Qc","Egg");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameCommon"),c=a("BaseActorComponent"),d=a("MapBox"),u=a("ActorAsset"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timerEgg=0,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.timerEgg=100},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),!l.default.isPaused&&(this.timerEgg-=e,this.timerEgg<=0)){var i=d.default.inst.createNewUnit(this.actor.stats.growIntoID,this.actor.currentTile,null,2);i.data.firstName=this.actor.data.firstName,i.data.favorite=this.actor.data.favorite,i.justBorn(),i.data.hunger=i.stats.maxHunger/2,d.default.inst.gameStats.creaturesBorn++,i.data.skin_set=this.actor.data.skin_set,this.actor.killHimself(!0,u.AttackType.None,!1)}},s([p],e)}(c.default));n.default=f,cc._RF.pop()},{}],ExplosionChecker:[function(t,e,i){"use strict";cc._RF.push(e,"a881ckp7ThFx6SXM54bcddh","ExplosionChecker");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(a,"__esModule",{value:!0}),a.ExplosionMemoryData=void 0;var s=o("MathUtils"),l=o("ToolBox"),c=function(){this.x=0,this.y=0,this.range=0,this.timer=0};a.ExplosionMemoryData=c;var d=function(){function t(){this.data=new Map,this._to_remove=[]}return t.prototype.checkNearby=function(t,e){var i=1e7*e+1e3*t.x+t.y;return!(!this.data.has(i)&&!this.isNearbyOthers(t,e/3)&&(this.add(i,t,e),this.updateNearbyTimers(t,e),1))},t.prototype.updateNearbyTimers=function(t,e){var i,o,a=1,c=e;a+=this.data.size/10,c+=this.data.size/5,a=s.default.clamp(a,1,5),c=s.default.clamp(c,e,5*e);try{for(var d=n(this.data),u=d.next();!u.done;u=d.next()){var h=r(u.value,2),p=(h[0],h[1]);l.Toolbox.dist(t.x,t.y,p.x,p.y)<c&&(p.timer=a)}}catch(f){i={error:f}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},t.prototype.isNearbyOthers=function(t,e){var i,o;try{for(var a=n(this.data),s=a.next();!s.done;s=a.next()){var c=r(s.value,2),d=(c[0],c[1]);if(l.Toolbox.dist(t.x,t.y,d.x,d.y)<e)return!0}}catch(u){i={error:u}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}return!1},t.prototype.add=function(t,e,i){var o=new c;o.range=i,o.x=e.x,o.y=e.y;var a=1;a+=this.data.size/10,a=o.timer=s.default.clamp(a,1,5),this.data.set(t,o)},t.prototype.logicUpdate=function(t){var e,i;try{for(var o=n(this.data),a=o.next();!a.done;a=o.next()){var s=r(a.value,2),l=s[0],c=s[1];c.timer-=t,c.timer<=0&&this._to_remove.push(l)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}if(this._to_remove.length>0){for(var d=0;d<this._to_remove.length;d++)this.data.delete(this._to_remove[d]);this._to_remove=[]}},t.prototype.clear=function(){this.data.clear()},t.TIMER=1,t.inst=new t,t}();a.default=d,cc._RF.pop()},{}],ExplosionFlash:[function(t,e,i){"use strict";cc._RF.push(e,"f9d3c0HrqxC1Zq2JYLZIt9t","ExplosionFlash");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseEffect"),c=a("MapBox"),d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=0,e}return r(e,t),e.prototype.startFlash=function(t,e,i){void 0===i&&(i=1);var o=t instanceof cc.Vec3?t:t.posV3;this.speed=i,this.node.position=o,this.setScale(.1),this.setAlpha(255)},e.prototype.logicUpdate=function(){this.setAlpha(this.alpha-c.default.inst.elapsed*this.speed*127.5),this.setScale(this.scale+=c.default.inst.elapsed*this.speed*.1),this.alpha<=0&&this.kill()},s([u],e)}(l.default));n.default=h,cc._RF.pop()},{}],ExplosionsEffects:[function(t,e,i){"use strict";cc._RF.push(e,"1b9c5NqiNZO8pPQPYwMHKen","ExplosionsEffects");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("MathUtils"),d=a("GameCommon"),u=a("MapAction"),h=a("AssetManager"),p=a("TopTileLibrary"),f=a("ToolBox"),_=a("GameAudio"),m=a("MapLayer"),g=a("TileDictionary"),y=a("MapBox"),v=cc._decorator,b=v.ccclass,w=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.explosionDict=new Map,e.explosionDictCurrent=new Map,e.explosionQueue=[],e.explosionQueueCurrent=[],e.timerExplosionQueue=0,e.interval=.01,e.nextWave=[],e.bombDict=new g.TileDictionary,e.delayedBombs=[],e.timedBombs=[],e.tilesToRemove=[],e}return r(e,t),e.prototype.create=function(){this.colorValues=cc.Color.WHITE,this.colors_amount=60,t.prototype.create.call(this)},e.prototype.clear=function(){this.explosionQueue=[],this.explosionQueueCurrent=[],this.explosionDict.clear(),this.explosionDictCurrent.clear(),this.tileDictionary.clear(),this.timedBombs=[],t.prototype.clear.call(this)},e.prototype.activateDelayedBomb=function(t){this.delayedBombs.includes(t)||(this.delayedBombs.push(t),t.delayedBombType=t.type.id,t.delayedTimerBomb=.09)},e.prototype.addTimedTnt=function(t){this.timedBombs.includes(t)||(t.delayedTimerBomb=5,this.timedBombs.push(t))},e.prototype.explodeBomb=function(t,e){if(void 0===e&&(e=!1),!this.bombDict.contains(t))if(!t.type.explodableDelayed||e){for(y.default.inst.startShake(),this.nextWave=[],this.nextWave.push(t);this.nextWave.length>0;){var i=this.nextWave[0];if(this.nextWave.splice(0,1),this.bombDict.add(i),i.type.explodable&&!i.type.explodableDelayed&&(i.explosionWave=i.type.explodeRange,i.explosionPower=i.type.explodeRange),!(i.explosionWave<=0))for(var o=0;o<i.neighbours.length;o++){var a=i.neighbours[o];a.explosionWave>0&&this.bombDict.contains(a)?a.explosionWave<i.explosionWave&&a.type.explodable:(this.bombDict.add(a),a.explosionWave=i.explosionWave-1,a.explosionPower=i.explosionPower,this.nextWave.push(a))}}u.default.pixelLimit=0,this.bombDict.dict.size<20?_.default.playExplosionSmall():_.default.playExplosionMedium(),this.bombDict.dict.forEach(function(e,i){u.default.explodeTile(i,10*(i.explosionPower-i.explosionWave),10*i.explosionPower,t,h.default.terraform.get("bomb"))})}else this.activateDelayedBomb(t)},e.prototype.prepareNewExplosion=function(t){this.explosionDict.has(t)||(this.explosionQueue.push(t),this.explosionDict.set(t,t.type))},e.prototype.updateExplosionQueue=function(){if(this.timerExplosionQueue>0)this.timerExplosionQueue-=y.default.inst.elapsed;else if(this.timerExplosionQueue=.1,0!=this.explosionQueue.length){for(var t=0;t<this.explosionQueue.length;t++){var e=this.explosionQueue[t];this.explosionQueueCurrent.push(e),this.explosionDictCurrent.set(e,this.explosionDict.get(e))}for(this.explosionQueue=[],this.explosionDict.clear(),t=0;t<this.explosionQueueCurrent.length;t++){var i=this.explosionQueueCurrent[t];u.default.damageWorld(i,this.explosionDictCurrent.get(i).explodeRange,h.default.terraform.get("bomb")),_.default.playExplosionMedium(i.posV3)}this.explosionQueueCurrent=[],this.explosionDictCurrent.clear()}},e.prototype.logicUpdate=function(t){var e,i,o,a;if(this.checkAutoDisable(),this.updateDirty(t),!(this.timedBombs.length<=0||d.default.isPaused)){var n=[];try{for(var r=l(this.timedBombs),s=r.next();!s.done;s=r.next())(f=s.value).delayedTimerBomb>0?f.delayedTimerBomb-=t:n.push(f)}catch(y){e={error:y}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}try{for(var c=l(n),p=c.next();!p.done;p=c.next()){var f=p.value;this.timedBombs.remove(f),f.type.explodableTimed&&(u.default.damageWorld(f,f.type.explodeRange,h.default.terraform.get("bomb")),_.default.playExplosionMedium(f.posV3))}}catch(v){o={error:v}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}}},e.prototype.updateDirty=function(){var t,e,i,o,a=this;if(this.delayedBombs.length>0){var n=[];try{for(var r=l(this.delayedBombs),s=r.next();!s.done;s=r.next())(m=s.value).delayedTimerBomb>0?m.delayedTimerBomb-=y.default.inst.elapsed:n.push(m)}catch(w){t={error:w}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}try{for(var c=l(n),d=c.next();!d.done;d=c.next()){var m;(m=d.value).delayedTimerBomb=-100,this.delayedBombs.remove(m);var g=m.delayedBombType?h.default.topTiles.get(m.delayedBombType):p.default.tnt_timed;u.default.damageWorld(m,g.explodeRange,h.default.terraform.get("bomb")),_.default.playExplosionMedium(m.posV3)}}catch(T){i={error:T}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}if(this.bombDict.length()>0&&(this.bombDict.dict.forEach(function(t,e){e.explosionWave=0,e.explosionPower=0}),this.bombDict.clear()),this.timer>0)this.timer-=y.default.inst.elapsed;else if(this.timer=this.interval,0!=this.tileDictionary.length()){if(this.tilesToRemove=[],this.tileDictionary.dict.forEach(function(t,e){e.explosionFxStage>0&&(Math.random()>.5?a.updateSinglePixel(e.data.tile_id,f.Toolbox.clear):a.updateSinglePixel(e.data.tile_id,a.colors[e.explosionFxStage-1]),e.explosionFxStage--,e.explosionFxStage<=0&&(e.explosionFxStage=0,a.tilesToRemove.push(e)))}),this.tilesToRemove.length>0)for(var v=0;v<this.tilesToRemove.length;v++){var b=this.tilesToRemove[v];this.tileDictionary.remove(b)}this.updatePixels()}},e.prototype.setDirty=function(t,e,i){var o=c.default.intCast(60*(1-e/i));0!=o&&o>=t.explosionFxStage&&(this.tileDictionary.add(t),t.explosionFxStage=o)},s([w],e.prototype,"interval",void 0),s([b],e)}(m.default);n.default=T,cc._RF.pop()},{}],FamilysManager:[function(t,e,i){"use strict";cc._RF.push(e,"f1249EAYSBHe639vxM5IbvA","FamilysManager");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.Family=void 0;var r=o("ChineseNameLibrary"),s=function(){function t(t){void 0===t&&(t="\u7532"),this.id="",this.maxLevel=0,this.honorary="",this.id=t,this.maxLevel=0,this.num=0,this.honorary=""}return t.prototype.levelUp=function(t){this.honorary=t,this.maxLevel++},t}();a.Family=s;var l=function(){function t(){}return t.init=function(){var e,i;t.familys.clear();try{for(var o=n(r.ChineseNameAsset.familyNameTotal),a=o.next();!a.done;a=o.next()){var l=a.value;t.familys.has(l)||t.familys.set(l,new s(l))}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t.familys=new Map,t}();a.default=l,cc._RF.pop()},{}],FavoriteElement:[function(t,e,i){"use strict";cc._RF.push(e,"55a9dV2euxDR7e9X4HWksAK","FavoriteElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("UnitAvatarLoader"),c=a("ViewController"),d=a("Config"),u=a("WorldLog"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actor=null,e.unitName=null,e.avatarLoader=null,e.text_health=null,e.text_damage=null,e.text_level=null,e.text_kills=null,e}return r(e,t),e.prototype.initItem=function(t){this.actor=t,this.unitName.string=t.data.firstName,this.avatarLoader.load(t),this.text_health.string=t.data.health+"/"+t.curStats.health,this.text_damage.string=""+t.curStats.damage,this.text_level.string=""+t.data.level,this.text_kills.string=""+t.data.kills},e.prototype.clickLocate=function(){u.default.locationFollow(this.actor)},e.prototype.clickInspect=function(){d.default.selectedUnit=this.actor,d.default.selectedUnit&&c.default.open(c.view_type.CreatureInfo)},s([f(cc.Label)],e.prototype,"unitName",void 0),s([f(l.default)],e.prototype,"avatarLoader",void 0),s([f(cc.Label)],e.prototype,"text_health",void 0),s([f(cc.Label)],e.prototype,"text_damage",void 0),s([f(cc.Label)],e.prototype,"text_level",void 0),s([f(cc.Label)],e.prototype,"text_kills",void 0),s([p],e)}(cc.Component);n.default=_,cc._RF.pop()},{}],FavoritesWindow:[function(t,e,i){"use strict";cc._RF.push(e,"36b8bnQ++xFO6jPTQ088KBc","FavoritesWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GamePopBase"),c=a("MapBox"),d=a("FavoriteElement"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.elementPrefab=null,e.content=null,e}return r(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.showList()},e.prototype.showList=function(){var t=this;c.default.inst.units.list.forEach(function(e){var i,o;(null===(i=e.data)||void 0===i?void 0:i.alive)&&(null===(o=e.data)||void 0===o?void 0:o.favorite)&&t.showElement(e)})},e.prototype.showElement=function(t){var e=cc.instantiate(this.elementPrefab);e.parent=this.content,e.getComponent(d.default).initItem(t)},s([p(cc.Prefab)],e.prototype,"elementPrefab",void 0),s([p(cc.Node)],e.prototype,"content",void 0),s([h],e)}(l.GamePopBase);n.default=f,cc._RF.pop()},{}],FireLayer:[function(t,e,i){"use strict";cc._RF.push(e,"414eemTr2BLJIULq3y1WQtg","FireLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("WorldBehaviourActionFire"),c=a("MapLayer"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fire_color=cc.Color.TRANSPARENT,e}return r(e,t),e.prototype.onLoad=function(){this.colorValues=this.fire_color,this.colors_amount=30,this.colors.reverse(),this.enabled=!0,t.prototype.create.call(this)},e.prototype.setTileDirty=function(t){this.pixels_to_update.contains(t)||this.pixels_to_update.add(t)},e.prototype.checkAutoDisable=function(){l.default.tiles.size>0?this.sprRnd.enabled||(this.sprRnd.enabled=!0):this.sprRnd.enabled&&(this.sprRnd.enabled=!1)},e.prototype.updateDirty=function(){var t=this;this.pixels_to_update.length()<=0||(this.pixels_to_update.dict.forEach(function(e,i){var o=i.data.fire_stage;i.data.fire||(o=t.colors.length-1),t.updateSinglePixel(i.data.tile_id,t.colors[o])}),this.pixels_to_update.clear(),this.updatePixels())},s([h(cc.Color)],e.prototype,"fire_color",void 0),s([u],e)}(c.default);n.default=p,cc._RF.pop()},{}],FogLayer:[function(t,e,i){"use strict";cc._RF.push(e,"8cb9dh0b4xBS7oLLm0gOPp6","FogLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.FogsData=void 0;var l=a("Tools"),c=a("MapBox"),d=a("MapLayer"),u=cc._decorator,h=u.ccclass,p=(u.property,function(){function t(){this.fogsData=[],this.unlock=[]}return t.prototype.clear=function(){this.fogsData=[],this.unlock=[]},t}());n.FogsData=p;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=new p,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){t.prototype.create.call(this),i.inst=this},e.prototype.loadFogs=function(t){this.data=l.default.fromJson(t,new p),this.createTextureNew();for(var e=0;e<c.default.width;e++)for(var i=0;i<c.default.height;i++)this.updateTilePixel(e,i,cc.color(0,0,0,255*this.data.fogsData[e][i]));this.updatePixels()},e.prototype.denseFog=function(){this.createTextureNew(),this.data.clear();for(var t=0;t<c.default.width;t++){this.data.fogsData[t]=[],this.data.unlock[t]=[];for(var e=0;e<c.default.height;e++)this.data.fogsData[t][e]=.45,this.data.unlock[t][e]=!1,this.updateTilePixel(t,e,cc.color(0,0,0,114.75))}this.updatePixels()},e.prototype.unLockTile=function(t){if(!this.data.unlock[t.x][t.y]){this.data.unlock[t.x][t.y]=!0;for(var e=t.x-8;e<=t.x+8;e++)for(var i=t.y-8;i<=t.y+8;i++)if(c.default.inst.getTile(e,i)){var o=.15*(Math.max(Math.abs(e-t.x),Math.abs(i-t.y))-5);o=o>=.15?o:0,this.data.fogsData[e][i]>o&&(this.data.fogsData[e][i]=o,this.updateTilePixel(e,i,cc.color(0,0,0,255*o)))}}},e.prototype.isLock=function(t){return this.data.fogsData[t.x][t.y]>=.45},e.inst=null,i=s([h],e)}(d.default);n.default=f,cc._RF.pop()},{}],GMView:[function(t,e,i){"use strict";cc._RF.push(e,"5b0be1TuQJGJoA01nUj5V0w","GMView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SaveUtils"),c=a("GamePopBase"),d=a("DebugConfig"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prop_infinite=null,e.unCkeck_Address=null,e.UnitPathfinding=null,e}return r(e,t),e.prototype.start=function(){this.prop_infinite.isChecked=d.default.Prop_infinite,this.unCkeck_Address.isChecked=d.default.UnCkeck_Address,this.UnitPathfinding.isChecked=d.default.UnitPathfinding},e.prototype.clearCache=function(){l.default.clear()},e.prototype.lateUpdate=function(){d.default.Prop_infinite=this.prop_infinite.isChecked,d.default.UnCkeck_Address=this.unCkeck_Address.isChecked,d.default.UnitPathfinding=this.UnitPathfinding.isChecked},s([p(cc.Toggle)],e.prototype,"prop_infinite",void 0),s([p(cc.Toggle)],e.prototype,"unCkeck_Address",void 0),s([p(cc.Toggle)],e.prototype,"UnitPathfinding",void 0),s([h],e)}(c.GamePopBase);n.default=f,cc._RF.pop()},{}],GameAudio:[function(t,e,i){"use strict";cc._RF.push(e,"e2c2fDuRt9A2bLBBe+q+Eud","GameAudio");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("AudioMgr"),r=o("MoveCamera"),s=o("ToolBox"),l=o("MapBox"),c="res/audio/",d=!0,u={},h={spawn_tree:"playSpawnTree",spawn_stone:"playSpawnStone",spawn_iron:"playSpawnIron",spawn_gold:"playSpawnGold",spawn_bush:"playSpawnBush",spawn_ore_deposit:"playSpawnOreDeposit",tornado:"playTornado","sheep spawn":"playSheepSpawn",spawnWolf:"playSpawnWolf",spawnBear:"playSpawnBear",spawnPiranha:"playSpawnPiranha",spawnWorm:"playSpawnWorm",spawnAnt:"playSpawnAnt",spawnSanta:"playSpawnSanta",spawnGodFinger:"playSpawnGodFinger",spawnUFO:"playSpawnUFO",spawnDragon:"playSpawnDragon",spawnHuman:"playSpawnHuman",spawnOrc:"playSpawnOrc",spawnElf:"playSpawnElf",spawnDwarf:"playSpawnDwarf",spawnColdOne:"playSpawnColdOne",spawnDemon:"playSpawnDemon",spawnBandit:"playSpawnBandit",spawnZombie:"playSpawnZombie",spawnVolcano:"playVolcano",spawnTumor:"playSpawnTumor",fallingSand:"playFallingSand",fallingFire:"playFallingFire",fallingWater:"playFallingWater","bomb fall":"playBombFall","explosion small":"playExplosionSmall","explosion medium":"playExplosionMedium","explosion big":"playExplosionBig",acid:"playAcid",lava:"playLava",snow:"playSnow",sheep:"playSheep",penguin:"playPenguin",turtle:"playTurtle",crab:"playCrab",wolf:"playWolf",gold:"playSpawnGold",geyser:"playGeyser",geyserAcid:"playGeyserAcid",ore_deposit:"playSpawnOreDeposit"},p=function(){function t(){}return t.allowPlayback=function(t){t=t.clone().subSelf(cc.v3(l.default.width/2,l.default.height/2));var e=r.MoveCamera.inst.camera.node.position;return s.Toolbox.distVec3(t,e)<=20&&cc.audioEngine.getEffectsVolume()>=.2},t.playBGM=function(){setTimeout(function(){d?n.default.playBgMusic(c+"Lighthearted Loop",!1).then(function(e){cc.audioEngine.setFinishCallback(e,function(){t.playBGM()})}):d=!0},4e4)},t.stopBGM=function(){d=!1,n.default.stopMusic()},t.playClick=function(){t.doPlay("res/audio/sfx_click",.001)},t.play=function(e){h[e]&&t[h[e]]&&t[h[e]]()},t.playVortex=function(){var e=c+["sfx_vortex","vortex8"].getRandom();t.doPlay(e,.1)},t.playForce=function(){t.doPlay("res/audio/sfx_force",.05)},t.playSpawn=function(){t.doPlay("res/audio/sfx_vortex",.1)},t.playSpawnTumor=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Tumor_Spawn0"+e;t.doPlay(i,.2)},t.playTemperatureU=function(){t.doPlay("res/audio/sfx_temperature_up",.15)},t.playTemperatureD=function(){t.doPlay("res/audio/sfx_temperature_down",.15)},t.playVolcano=function(){t.doPlay("res/audio/sfx_spawn_volcano",0)},t.playGeyser=function(){t.doPlay("res/audio/sfx_spawn_geyser",0)},t.playGeyserAcid=function(){t.doPlay("res/audio/geyserAcid",0)},t.playHeatray=function(){t.doPlay("res/audio/sfx_temperature_up",.1)},t.playConway=function(){t.doPlay("res/audio/sfx_conway",.1)},t.playGoo1=function(){t.doPlay("res/audio/sfx_goo",.15)},t.playLightning=function(){t.doPlay("res/audio/sfx_lightning",0)},t.playExplosionSmall=function(){t.doPlay("res/audio/sfx_explosion_small",.1)},t.playExplosionBig=function(){t.doPlay("res/audio/sfx_explosion_big",.1)},t.playExplosionMedium=function(e){void 0===e&&(e=cc.Vec3.ZERO),(t.allowPlayback(e)||e.equals(cc.Vec3.ZERO))&&t.doPlay("res/audio/sfx_explosion_medium",.1)},t.playExplosionHuge=function(){t.doPlay("res/audio/sfx_explosion_huge",.22)},t.playTornado=function(){var e=c+["sfx_tornado1","sfx_tornado2","sfx_tornado3"].getRandom();t.doPlay(e,.2)},t.playConstructing=function(e){var i=c+["sfx_constructing1","sfx_constructing2","sfx_constructing3","sfx_constructing4"].getRandom();t.allowPlayback(e)&&t.doPlay(i,6)},t.playPunch=function(e){var i=c+["sfx_punch_1","sfx_punch2"].getRandom();t.allowPlayback(e)&&t.doPlay(i,.1)},t.playWilhelmscream=function(){t.doPlay("res/audio/sfx_wilhelm_scream",.1)},t.playHammer1=function(e){t.allowPlayback(e)&&t.doPlay("res/audio/sfx_constructing3",1)},t.playDragonAttack=function(e){var i=c+["sfx_dragon_firebreath01","sfx_dragon_firebreath02"].getRandom();t.allowPlayback(e)&&t.doPlay(i,.1)},t.playDragonSwoop=function(e){var i=c+["sfx_dragon_swoop01","sfx_dragon_swoop02"].getRandom();t.allowPlayback(e)&&t.doPlay(i,.1)},t.playFallingFire=function(){t.doPlay("res/audio/sfx_fallingFire",.1)},t.playBombFall=function(){t.doPlay("res/audio/sfx_bomb_fall",.3)},t.playFallingSand=function(){t.doPlay("res/audio/sfx_falling_sand",.1)},t.playLava=function(){t.doPlay("res/audio/lava",.09)},t.playFallingWater=function(){t.doPlay("res/audio/sfx_fallingWater",.08)},t.playFireworks=function(){var e=s.Toolbox.randomInt(1,4),i=c+"fireworks0"+e;t.doPlay(i,.3)},t.playAcid=function(){t.doPlay("res/audio/sfx_fallingWater",.1)},t.playPrint1=function(e){t.allowPlayback(e)&&t.doPlay("res/audio/sfx_print",.1)},t.playAntimatterBomb=function(){t.doPlay("res/audio/sfx_antimatter_bomb",.22)},t.playEarthquake=function(){t.doPlay("res/audio/sfx_earthquake",0)},t.playMeteoriteFall=function(){t.doPlay("res/audio/sfx_meteorite_fall",.1)},t.playExplosionMeteorite=function(){t.doPlay("res/audio/sfx_explosion_meteorite",.05)},t.playBuildingDestroyed=function(e){var i=s.Toolbox.randomInt(1,4),o=c+"Building_Destroyed0"+i;t.allowPlayback(e)&&t.doPlay(o,.1)},t.playChopping=function(e){var i=s.Toolbox.randomInt(1,4),o=c+"chop0"+i;t.allowPlayback(e)&&t.doPlay(o,.1)},t.playMining=function(e){var i=s.Toolbox.randomInt(1,4),o=c+"mining0"+i;t.allowPlayback(e)&&t.doPlay(o,.1)},t.playBowlingBall=function(e){t.allowPlayback(e)&&t.doPlay("res/audio/bowling_ball01",.1)},t.playUfoAttack=function(e){t.allowPlayback(e)&&t.doPlay("res/audio/ufo_attack",.1)},t.playWolf=function(){t.doPlay("res/audio/sfx_wolf",20)},t.playSnow=function(){},t.playCow=function(){},t.playPenguin=function(){},t.playTurtle=function(){},t.playCrab=function(){},t.playSheep=function(){var e=c+["sfx_animal_sheep_baa","sfx_animals_sheep_bleat_001"].getRandom();t.doPlay(e,15)},t.playOrk=function(){t.doPlay("res/audio/ork",.1)},t.playOuch=function(){t.doPlay("res/audio/ouch",.1)},t.playOwww=function(){t.doPlay("res/audio/owww",.1)},t.playCloudRain=function(){t.doPlay("res/audio/cloud_rain",.1)},t.playCloudAcid=function(){t.doPlay("res/audio/cloud_acid",.1)},t.playCloudLava=function(){t.doPlay("res/audio/cloud_lava",.1)},t.playTreeFall=function(e){var i=s.Toolbox.randomInt(1,4),o=c+"Tree_Fall0"+i;t.allowPlayback(e)&&t.doPlay(o,.1)},t.playSpawnTree=function(){var e=s.Toolbox.randomInt(1,4),i=c+"seed0"+e;t.doPlay(i,.1)},t.playSpawnStone=function(){t.doPlay("res/audio/spawn_stone01",.1)},t.playSpawnIron=function(){t.doPlay("res/audio/spawn_iron01",.1)},t.playSpawnGold=function(){t.doPlay("res/audio/spawn_gold01",.1)},t.playSpawnBush=function(){t.doPlay("res/audio/spawn_bush01",.1)},t.playSpawnOreDeposit=function(){t.doPlay("res/audio/spawn_ore_deposit01",.1)},t.playSheepSpawn=function(){var e=c+["sfx_animal_sheep_baa","sfx_animals_sheep_bleat_001"].getRandom();t.doPlay(e,.7)},t.playSpawnWolf=function(){var e=s.Toolbox.randomInt(1,3),i=c+"Wolf_Spawn_Growl0"+e;t.doPlay(i,.2)},t.playSpawnBear=function(){var e=s.Toolbox.randomInt(1,3),i=c+"Bear_Spawn0"+e;t.doPlay(i,.2)},t.playSpawnPiranha=function(){t.doPlay("res/audio/Pirhana_Spawn01",.2)},t.playSpawnWorm=function(){var e=s.Toolbox.randomInt(1,3),i=c+"Worm_Spawn0"+e;t.doPlay(i,.2)},t.playSpawnAnt=function(){var e=s.Toolbox.randomInt(1,3),i=c+"Insect_Spawn0"+e;t.doPlay(i,.2)},t.playSpawnSanta=function(){t.doPlay("res/audio/Santa_Spawn_Rev01",.5)},t.playSpawnGodFinger=function(){t.doPlay("res/audio/God_Finger_Spawn01",.2)},t.playSpawnDragon=function(){var e=c+["sfx_dragon_spawn01","swf_dragon_spawn02","sfx_spawn_dragon03"].getRandom();t.doPlay(e,.2)},t.playSpawnUFO=function(){t.doPlay("res/audio/UFO_Spawn01",.1)},t.playSpawnHuman=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Human_Spawn_3rdRev0"+e;t.doPlay(i,.1)},t.playSpawnOrc=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Orc_Spawn0"+e;t.doPlay(i,.1)},t.playSpawnElf=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Elf_Spawn0"+e;t.doPlay(i,.1)},t.playSpawnDwarf=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Dwarf_Spawn0"+e;t.doPlay(i,.1)},t.playSpawnColdOne=function(){var e=s.Toolbox.randomInt(1,3),i=c+"ColdOnes_Spawn0"+e;t.doPlay(i,.2)},t.playSpawnDemon=function(){var e=s.Toolbox.randomInt(1,3),i=c+"Demon_Spawn0"+e;t.doPlay(i,.2)},t.playSpawnBandit=function(){var e=s.Toolbox.randomInt(1,5),i=c+"bandit0"+e;t.doPlay(i,.1)},t.playSpawnZombie=function(){var e=s.Toolbox.randomInt(1,6),i=c+"Zombie_Spawn0"+e;t.doPlay(i,.2)},t.doPlay=function(t,e){u[t]||(u[t]=!0,n.default.playEffect(t),setTimeout(function(){u[t]=!1},1e3*e))},t}();a.default=p,cc._RF.pop()},{}],GameUtils:[function(t,e,i){"use strict";cc._RF.push(e,"02fc6kPpKtIsLSMSNfyrqho","GameUtils");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("UiUtil"),r=o("GameCommon"),s=o("UiController"),l=function(){function t(){}return t.prototype.allowPopUi=function(){return!r.default.isPaused&&n.UiUtil.allowOpenModule()&&!s.default.inst.isDoRecord},t.inst=new t,t}();a.default=l.inst,cc._RF.pop()},{}],GeneratorTool:[function(t,e,i){"use strict";cc._RF.push(e,"41c4dPY8vBMirObe2f+jDG3","GeneratorTool");var o=t,a=i,n=function(t,e,i,o){return new(i||(i=Promise))(function(a,n){function r(t){try{l(o.next(t))}catch(e){n(e)}}function s(t){try{l(o.throw(t))}catch(e){n(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}l((o=o.apply(t,e||[])).next())})},r=function(t,e){var i,o,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(t){return function(e){return l([t,e])}}function l(n){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,o=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=e.call(t,r)}catch(s){n=[6,s],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(a,"__esModule",{value:!0}),a.GeneratorTool=a.GeneratorTarget=void 0;var s,l=o("Perlin"),c=o("MathUtils"),d=o("AssetManager"),u=o("DropsLibrary"),h=o("TopTileLibrary"),p=o("ToolBox"),f=o("TileTypeBase"),_=o("WorldTile"),m=o("MapBox"),g=o("TextureLoader"),y=o("TextureRotator"),v=o("TextureScale");(function(t){t[t.Height=0]="Height",t[t.Temperature=1]="Temperature"})(s=a.GeneratorTarget||(a.GeneratorTarget={}));var b=function(){function t(){}return t.init=function(){t.loadGenShapeTextures()},t.applyRandomShape=function(e,i,o){void 0===e&&(e=2),void 0===i&&(i=.7),void 0===o&&(o=!1);var a=null,n=0,r=0;t.randomTextures.length<t.maxRandomTextureCount?(a=p.Toolbox.getRandom(t.textures).clone(),t.randomTextures.push(a),n=c.default.intCast(a.width*p.Toolbox.randomRange(.3,2)),r=c.default.intCast(a.height*p.Toolbox.randomRange(.3,2)),a=y.TextureRotator.rotate(a,p.Toolbox.randomRange(0,360)),v.TextureScale.bilinear(a,n,r)):a=p.Toolbox.getRandom(t.randomTextures),n=a.width,r=a.height;var s=c.default.intCast(m.default.width/2-n/2-c.default.intCast(p.Toolbox.randomRange(-n*e,n*e))),l=c.default.intCast(m.default.height/2-r/2-c.default.intCast(p.Toolbox.randomRange(-r*e,r*e)));s<0&&(s=0),l<0&&(l=0),s+n>m.default.width&&(s=m.default.width-n),l+r>m.default.height&&(l=m.default.height-r);for(var d=i,u=0;u<a.width;u++)for(var h=0;h<a.height;h++){var f=m.default.inst.getTile(s+u,l+h);if(f){var _=a.getPixel(u,h).a,g=c.default.intCast(_*d);o&&(g=-g),f.height+=g}}},t.loadGenShapeTextures=function(){return n(this,void 0,void 0,function(){return r(this,function(){return t.textures.length>0?[2]:(t.textures=Array.from(g.TextureLoader.inst.getTextures(g.BIN_TYPE.gen_shapes).values()),[2])})})},t.applyWaterLevel=function(t,e,i){for(var o=0;o<t;o++)for(var a=0;a<e;a++)m.default.inst.getTile(o,a).height-=i},t.applyPerlinNoice=function(t,e,i,o,a,n,r,c){void 0===r&&(r=!1),void 0===c&&(c=s.Height);var d=255*a,u=1,h=1;t>e?u=t/e:h=e/t;for(var p=0;p<t;p++)for(var f=0;f<e;f++){var _=m.default.inst.getTile(p,f),g=i+p/t*n*u,y=o+f/e*n*h,v=Math.floor(l.default.noiseNormalized(g,y)*d);r&&(v=-v),c==s.Height&&(_.height+=v)}},t.updateTileTypes=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=0),void 0===i&&(i=0);for(var o=e+i,a=e;a<o;a++){var n=m.default.inst.tilesList[a],r=d.default.tiles.getTypeByWorldTile(n);n.setTileType(r)}},t.generateTileNeighbours=function(){for(var t=0;t<m.default.inst.tilesList.length;t++){var e=m.default.inst.tilesList[t],i=m.default.inst.getTile(e.x-1,e.y);e.addNeighbour(i,_.TileDirection.Left),i=m.default.inst.getTile(e.x+1,e.y),e.addNeighbour(i,_.TileDirection.Right),i=m.default.inst.getTile(e.x,e.y-1),e.addNeighbour(i,_.TileDirection.Down),i=m.default.inst.getTile(e.x,e.y+1),e.addNeighbour(i,_.TileDirection.Up),i=m.default.inst.getTile(e.x-1,e.y-1),e.addNeighbour(i,_.TileDirection.Null,!0),i=m.default.inst.getTile(e.x-1,e.y+1),e.addNeighbour(i,_.TileDirection.Null,!0),i=m.default.inst.getTile(e.x+1,e.y-1),e.addNeighbour(i,_.TileDirection.Null,!0),i=m.default.inst.getTile(e.x+1,e.y+1),e.addNeighbour(i,_.TileDirection.Null,!0)}},t.applyRingEffect=function(){for(var t=0;t<m.default.width;t++)for(var e=0;e<m.default.height;e++)for(var i=0;i<d.default.tiles.list.length;i++){var o=d.default.tiles.list[i];if(0!=o.additional_height.length){for(var a=!1,n=0;n<o.additional_height.length;n++){var r=m.default.inst.getTile(t,e);if(r.height==o.heightMin-o.additional_height[n]){r.height=o.heightMin,a=!0;break}}if(a)break}}},t.modifyIsland=function(t){var e=p.Toolbox.randomInt(0,3);if(0==e&&t.regions.length<20)for(var i=t.regions.getSimpleList(),o=0;o<i.length;o++)for(var a=i[o],n=0;n<a.tiles.length;n++){var r=a.tiles[n];r.type.layerType!=f.TileLayerType.Block&&(r.setTopTileType(null),r.setTileType("sand"))}else{if(1!=e)return;for(var s=t.regions.getSimpleList(),l=0;l<s.length;l++)for(var c=s[l],d=0;d<c.tiles.length;d++){var _=c.tiles[d];_.type.layerType==f.TileLayerType.Block&&_.main_type.canGrowBiomeGrass&&u.default.useSeedOn(_,h.default.grass_low,h.default.grass_high)}}},t.textures=[],t.randomTextures=[],t.maxRandomTextureCount=40,t}();a.GeneratorTool=b,cc._RF.pop()},{}],Globals:[function(t,e,i){"use strict";cc._RF.push(e,"89fe0G4+m5MR77vk08fBq88","Globals");var o=i;Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.CITY_TIMER_SUPPLY_DEFAULT=30,t.REGION_UPDATE_TIMEOUT=.5,t.CITY_POP_FOR_SETTLE_TARGET=30,t.CITY_MAXIMUM_ZONES_PER_BUILDING=3,t.AI_TEST_ACTIVE=!0,t.XMAS=!1,t.DEFAULT_SCALE_UNIT=.1,t.DEFAULT_SCALE_BUILDING=.25,t.DIAGNOSTIC=!1,t.DEBUG_CRAB=!1,t.TRAILER_MODE=!1,t.BUILDINGS_USE_RESOURCES=!0,t.TRAILER_MODE_USE_RESOURCES=!0,t.TRAILER_MODE_UPGRADE_BUILDINGS=!0,t.TIPS_AMOUNT=16,t.TORNADO_TIMER=35,t.CAST_HEIGHT=15,t.UNITS_IN_SPAWNER_PER_REGION=4,t.PATHFINDER_REGION_LIMIT=2,t.ATTRIBUTE_BAD=4,t.ATTRIBUTE_NORMAL=9,t.ATTRIBUTE_GOOD=20,t.maxBushesInZone=3,t.maxTreesInZone=3,t.MIN_ADS_INTERVAL_MINUTES=2,t.ADS_INTERVAL_MINUTES=5,t.specialAbstudio=!1,t.GREY_GOO_DAMAGE=50,t.DAMAGE_ACID=250,t.DAMAGE_HEAT=50,t.DAMAGE_BOULDER=1e3,t.CITIZEN_FOOD_COST=1,t.ZONES_BETWEEN_CITIES=5,t.CIV_ARMY_MAX=65,t.CIV_TIMEOUT_YEARS_FOR_DIPLOMACY=22,t.FOOD_FROM_FISH=1,t.FOOD_FROM_TILE=1,t.FOOD_FROM_FARM=2,t.ANIMAL_GOOD_FOR_HUNTING_AGE=3,t.BOAT_UNITS_LIMIT=100,t.TRANSPORT_WAIT_TRY_LIMIT=4,t.TIMER_HUNGER=8,t.HUNGRY=50,t.HUNGRY_UNIT=10,t.COLORS_ZONE_ALPHA=.78,t.ISLAND_TILES_FOR_DOCKS=2500,t.FOOD_BUSH_REGROW_TIME=90,t.REWARD_MINUTES=30,t.DISCORD_MEMBERS="200000",t.TIMEOUT_CONQUER=300,t.POINT_IN_VOID=cc.v3(-1e6,-1e6),t.NORMAL="0",t.RATE_US_ID=9,t.emptyVector=cc.v3(-1e5,-1e4),t}();o.default=a,cc._RF.pop()},{}],GlowParticles:[function(t,e,i){"use strict";cc._RF.push(e,"4d460B8tx1IlLmU2pn8xhOs","GlowParticles");var o,a=i,n=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(a,"__esModule",{value:!0}),a.GlowParticles=void 0;var s=cc._decorator,l=s.ccclass,c=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.particles=null,e}return n(e,t),e.prototype.start=function(){this.particles||(this.particles=this.getComponent(cc.ParticleSystem))},e.prototype.spawn=function(t,e,i){if(void 0===i&&(i=!1),this.enabled){if(i&&(this.cooldown=0),this.cooldown>0)return void this.cooldown--;this.cooldown=3;var o=cc.v2(t+.5,e+.5);this.particles._simulator.emitParticle(o)}},e.prototype.clear=function(){this.particles&&this.particles.stopSystem()},r([c({type:cc.ParticleSystem,tooltip:"\u5982\u679c\u4e0d\u586b\u5199\uff0c\u5c31\u4f7f\u7528\u5f53\u524d\u8282\u70b9\u7684ParticleSystem\u7ec4\u4ef6"})],e.prototype,"particles",void 0),r([l],e)}(cc.Component);a.GlowParticles=d,cc._RF.pop()},{}],GodActions:[function(t,e,i){"use strict";cc._RF.push(e,"f70e6rNLexBHqhjVTxQjLwY","GodActions");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.GodAction=void 0;var a=function(){this.name="god_action",this.value=-1,this.icon="",this.hold_action=!0};o.GodAction=a;var n=function(){function t(){}return t.init=function(){t.list=[],t.dict=new Map;var e=new a;e.name="height",t.add(e);var i=new a;i.name="temperature",t.add(i);var o=new a;o.name="rainfall",t.add(o);var n=new a;n.name="small",n.value=3,t.add(n);var r=new a;r.name="normal",r.value=5,t.add(r);var s=new a;s.name="big",s.value=10,t.add(s);var l=new a;l.name="huge",l.value=65,t.add(l);var c=new a;c.name="draw",t.add(c);var d=new a;d.name="lightning",d.hold_action=!1,t.add(d);var u=new a;u.name="city",u.hold_action=!1,t.add(u);var h=new a;h.name="meteorite",h.hold_action=!1,t.add(h);var p=new a;p.name="ant",p.hold_action=!1,t.add(p)},t.add=function(e){t.list.push(e),t.dict.set(e.name,e)},t.list=[],t.dict=new Map,t}();o.default=n,cc._RF.pop()},{}],GodFinger:[function(t,e,i){"use strict";cc._RF.push(e,"ebfcdhBd/lG1Y3uVsIu3j1b","GodFinger");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AchievData"),c=a("GameCommon"),d=a("SpriteAnimation"),u=a("AssetManager"),h=a("BaseActorComponent"),p=a("Brush"),f=a("ToolBox"),_=a("MapBox"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wait=0,e.speedMod=1,e.target=cc.Vec3.ZERO,e.startPos=cc.Vec3.ZERO,e.randomDirection=cc.Vec3.ZERO,e.rotateToward1=cc.Vec3.ZERO,e.rotateToward2=cc.Vec3.ZERO,e.rotateToward3=cc.Vec3.ZERO,e.angleDirection=cc.Vec3.ZERO,e.godPower=null,e.distanceToTarget=0,e.haveTarget=!1,e.draw=!1,e.angleHand=0,e.powers=["tileSand","tileHighSoil","tileSoil","tileHills","tileMountains"],e.fingerTip=null,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.godPower=u.default.powers.get(f.Toolbox.getRandom(this.powers)),this.fingerTip=this.node.getChildByName("Tip").getComponent(d.SpriteAnimation)},e.prototype.newMove=function(){this.haveTarget=!0,this.target=f.Toolbox.getRandom(_.default.inst.tilesList).posV3,this.rotateToward1=f.Toolbox.getRandom(_.default.inst.tilesList).posV3,this.rotateToward2=f.Toolbox.getRandom(_.default.inst.tilesList).posV3,this.rotateToward3=f.Toolbox.getRandom(_.default.inst.tilesList).posV3,this.randomDirection.x=f.Toolbox.randomFloat(-20,20),this.randomDirection.y=f.Toolbox.randomFloat(-20,20),this.startPos=this.actor.currentPosition,this.distanceToTarget=0,this.speedMod=f.Toolbox.randomFloat(.1,.4),this.draw=f.Toolbox.randomBool(),this.draw||(this.speedMod=f.Toolbox.randomFloat(.2,.6)),this.angleDirection.set(cc.Vec3.ZERO)},e.prototype.lightAction=function(){l.default.update(50)},e.prototype.logicUpdate=function(t){var e;if(this.fingerTip.logicUpdate(t),null===(e=this.actor.data)||void 0===e?void 0:e.alive){if(c.default.isPaused)return;if(this.draw?(this.fingerTip.node.active=!0,this.angleHand+=20*t,this.angleHand>30&&(this.angleHand=30)):(this.fingerTip.node.active=!1,this.angleHand-=20*t,this.angleHand<=0&&(this.angleHand=0)),this.actor.zPosition.y>0)return this.haveTarget=!1,this.distanceToTarget=0,void(this.draw=!1);if(this.node.eulerAngles=cc.v3(0,0,this.angleHand),this.wait>0)return void(this.wait-=t);this.haveTarget||this.newMove(),this.distanceToTarget+=t*this.speedMod,this.draw&&(this.rotateToward1=f.Toolbox.moveTowards(this.rotateToward1,this.rotateToward2,30*t),this.rotateToward2=f.Toolbox.moveTowards(this.rotateToward2,this.rotateToward3,30*t),this.rotateToward3=f.Toolbox.moveTowards(this.rotateToward3,this.rotateToward1,30*t),this.target=f.Toolbox.moveTowards(this.target,this.rotateToward1,30*t)),cc.Vec2.lerp(this.actor.currentPosition,this.startPos,this.target,this.distanceToTarget),this.actor._positionDirty=!0,this.actor._currentTileDirty=!0,!this.draw||!this.actor.currentTile||this.actor.currentPosition.x>_.default.width||this.actor.currentPosition.y>_.default.height||this.actor.currentPosition.x<0||this.actor.currentPosition.y<0||(_.default.inst.conwayLayer.checkKillRange(this.actor.currentTile.pos,2),_.default.inst.loopWithBrush(this.actor.currentTile,p.default.getBrushBySize(2),this.godPower.click_action,this.godPower.id),_.default.inst.loopWithBrush(this.actor.currentTile,p.default.getBrushBySize(2),i.fingerTile,"godFinger")),this.distanceToTarget>=.9&&(this.haveTarget=!1,this.distanceToTarget=0,this.draw=!1,f.Toolbox.randomChance(.4)&&(this.wait=f.Toolbox.randomFloat(0,4)))}else this.fingerTip.node.active=!1},e.fingerTile=function(t){for(var e=0;e<t.units.length;e++){var i=t.units[e];!i.stats.flag_finger&&i.stats.canBeKilledByStuff&&i.data.alive&&i.getHit(1e5)}return!0},i=s([g],e)}(h.default));n.default=y,cc._RF.pop()},{}],GodPower:[function(t,e,i){"use strict";cc._RF.push(e,"c9f1crdLKRLNatcIF2FT/jj","GodPower");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.PowerActionType=n.PowerRank=n.BrushSize=void 0;var s,l,c=a("WorldAction"),d=a("AssetLibrary");(function(t){t[t.Size0=0]="Size0",t[t.Size1=1]="Size1",t[t.Size2=2]="Size2",t[t.Size3=3]="Size3",t[t.Size4=4]="Size4"})(n.BrushSize||(n.BrushSize={})),function(t){t[t.Rank0_free=0]="Rank0_free",t[t.Rank1_common=1]="Rank1_common",t[t.Rank2_normal=2]="Rank2_normal",t[t.Rank3_good=3]="Rank3_good",t[t.Rank4_awesome=4]="Rank4_awesome"}(s=n.PowerRank||(n.PowerRank={})),function(t){t[t.Special=0]="Special",t[t.SpawnActor=1]="SpawnActor",t[t.Tile=2]="Tile",t[t.Drops=3]="Drops",t[t.Draw=4]="Draw",t[t.Printer=5]="Printer"}(l=n.PowerActionType||(n.PowerActionType={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DEFAULT NAME",e.requiresPremium=!1,e.rank=s.Rank0_free,e.spawnSound="",e.icon="",e.cached_sprite=null,e.showToolSizes=!1,e.unselectWhenWindow=!1,e.holdAction=!1,e.clickInterval=0,e.particleInterval=0,e.applyForce=!1,e.forceDamage=0,e.fallingPixel=!1,e.fallingChance=.95,e.tileType="",e.topTileType="",e.dropID="",e.amountPerClick=1,e.forceBrush="",e.drawLines=!1,e.type=l.Tile,e.highlight=!1,e.click_brush_action=c.default.create(),e.click_action=c.default.create(),e.click_power_brush_action=c.default.create(),e.click_power_action=c.default.create(),e.toggle_name="",e.actorStatsId="?",e.actorSpawnHeight=6,e.showSpawnEffect="",e.printersPrint="",e.ignoreFastSpawn=!1,e.tester_enabled=!0,e.map_modes_switch=!0,e.allow_unit_selection=!1,e.isRace=!1,e}return r(e,t),e.addPower=function(t){t&&e.godPowers.set(t.id,t)},e.get=function(t){return e.godPowers.get(t)},e.godPowers=new Map,e}(d.Asset);n.default=u,cc._RF.pop()},{}],GreyGooLayer:[function(t,e,i){"use strict";cc._RF.push(e,"b5b6915UqNMEZh6q6Q/EWaZ","GreyGooLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameCommon"),c=a("MapAction"),d=a("TerraformLibrary"),u=a("TileLibrary"),h=a("BaseObjectData"),p=a("ToolBox"),f=a("GameAudio"),_=a("TileDictionary"),m=cc._decorator,g=m.ccclass,y=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tilesToRemove=[],e.tilesToAdd=[],e.toRemove=[],e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.tileDictionary=new _.TileDictionary},e.prototype.checkKillRange=function(t,e){var i=this;this.toRemove=[],this.tileDictionary.dict.forEach(function(o,a){p.Toolbox.distVec2(a.pos,t)<=e&&i.toRemove.push(a)}),this.toRemove.forEach(function(t){i.remove(t)})},e.prototype.clear=function(){t.prototype.clear.call(this),this.tileDictionary.clear()},e.prototype.logicUpdate=function(e){var i=this;t.prototype.logicUpdate.call(this,e),0==this.tileDictionary.length()||l.default.isPaused||(this.timer>0?this.timer-=e:(this.timer=.04,this.tilesToRemove=[],this.tilesToAdd=[],this.tileDictionary.dict.forEach(function(t,e){e.type.greyGoo?(p.Toolbox.randomBool()&&e.health--,5==e.health&&i.checkAroundTiles(e),e.health<=0&&(e.building&&e.building.startDestroyBuilding(!0),p.Toolbox.randomBool()&&(i.terraform(e),i.tilesToRemove.push(e)))):i.tilesToRemove.push(e)}),this.tilesToRemove.forEach(function(t){i.remove(t)}),this.tilesToAdd.forEach(function(t){i.add(t)})))},e.prototype.checkAroundTiles=function(t){var e=this;t.neighbours.forEach(function(t){t.type.isType("pit_deep_ocean")||t.type.isType("deep_ocean")&&!t.building||t.type.greyGoo||(e.makeGoo(t),e.tilesToAdd.push(t))})},e.prototype.makeGoo=function(t){c.default.terraformMain(t,u.default.grey_goo)},e.prototype.terraform=function(t){c.default.terraformMain(t,u.default.pit_deep_ocean,d.default.grey_goo),f.default.playGoo1()},e.prototype.remove=function(t){this.tileDictionary.remove(t)},e.prototype.add=function(t){t.type.isType("pit_deep_ocean")||t.type.isType("deep_ocean")||this.tileDictionary.contains(t)||(this.tileDictionary.add(t),this.makeGoo(t))},s([g],e)}(h.BaseModule));n.default=y,cc._RF.pop()},{}],GuideController:[function(t,e,i){"use strict";cc._RF.push(e,"13961XvkPlCYqejNwK6iL7k","GuideController");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.GUIDE_TYPE=void 0;var n,r=o("Constants"),s=o("ShuFenReport"),l=o("FestivityData"),c=o("GameCommon"),d=o("GuideView"),u=o("LocalizedTextManager"),h=o("AssetManager"),p=o("BrushWindow"),f=o("MoveCamera"),_=o("SaveList"),m=o("SavePopup"),g=o("ModModule"),y=o("UiController"),v=o("AchievementView");(function(t){t.none="none",t.novice="novice",t.save="save",t.cityInfo="cityInfo",t.mystery="mystery",t.luckyWheel="luckyWheel",t.general="general",t.online="online",t.timeScale="timeScale",t.achiev="achiev",t.culture="culture"})(n=a.GUIDE_TYPE||(a.GUIDE_TYPE={}));var b=function(){function t(){this._step=-1,this._guiding=!1,this._type=n.none,this.doStep=!1}return Object.defineProperty(t.prototype,"step",{get:function(){return this._step},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isGuiding",{get:function(){return this._guiding},enumerable:!1,configurable:!0}),t.prototype.initView=function(t){var e=cc.instantiate(t);e.parent=r.default.GLOBAL_NODE;var i=l.default.getCurrentFestivals(),o=i&&2==i.id;e.getComponent(d.default).init(o)},t.prototype.begin=function(){this._guiding=!0,y.default.inst.closeSelectTip(),y.default.inst.showBanner(!1),y.default.inst.checkGuideViewHeight()},t.prototype.complete=function(t){var e=this;void 0===t&&(t=!1),d.default.inst.hide(function(){e.doStep=!1,e._guiding=!1,e._type=n.none,t&&y.default.inst.showBanner(!BYTEDANCE_GAME)})},t.prototype.do=function(t){var e;this.doStep||(this.doStep=!0,this._step++,this._type=t,null===(e=this[t+"Step"+this._step])||void 0===e||e.call(this))},t.prototype.isType=function(t){return t==this._type},t.prototype.in=function(t,e){return t==this._type&&e==this._step},t.prototype.noviceStep0=function(){var t=this;this.begin(),s.default.reportGuide("guide00",!0);var e=r.default.CHANNEL==r.CHANNEL_TYPE.\u666e\u901a?["\u6b22\u8fce\u6765\u5230\u672c\u6e38\u620f\uff0c\n\u8fd9\u4e2a\u4e16\u754c\u7684\u4e00\u5207\u90fd\u5c06\u7531\u4f60\u521b\u9020\uff01"]:["\u6b22\u8fce\u6765\u5230\u4e16\u754c\u7f16\u8f91\u5668\uff0c\n\u8fd9\u4e2a\u4e16\u754c\u7684\u4e00\u5207\u90fd\u5c06\u7531\u4f60\u521b\u9020\uff01"];d.default.inst.enabledTouch(!0),d.default.inst.showTips(e,0,null,function(){t.doStep=!1,s.default.reportGuide("guide00",!1),t.do(n.novice)})},t.prototype.noviceStep1=function(){var t=this;s.default.reportGuide("guide01",!0),d.default.inst.showTips(["\u53cc\u6307\u53ef\u4ee5\u7f29\u653e\u5730\u56fe\u5927\u5c0f\uff0c\n\u6211\u4eec\u5148\u653e\u5927\u5730\u56fe\u770b\u770b\u3002"],1,function(){t.doStep=!1,d.default.inst.showFingerZoom(!0),d.default.inst.enabledTouch(!1)})},t.prototype.noviceStep2=function(){var t=this;s.default.reportGuide("guide01",!1),s.default.reportGuide("guide02",!0),d.default.inst.showFingerZoom(!1),d.default.inst.showTips(["\u6ca1\u9519\u5c31\u662f\u8fd9\u6837\uff01"],2,null,function(){t.doStep=!1,t.do(n.novice),s.default.reportGuide("guide02",!1)})},t.prototype.noviceStep3=function(){s.default.reportGuide("guide03",!0),this.doStep=!1;var t=y.default.inst.toggleContainer.getChildByName("toggle2"),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u5c1d\u8bd5\u4e00\u4e0b\u521b\u9020\u751f\u7269\u5427\uff0c\n\u70b9\u51fb\u4e0b\u65b9\u7684"\u4eba\u5f62"\u5206\u7c7b\u3002'],3)},t.prototype.noviceStep4=function(){s.default.reportGuide("guide03",!1),s.default.reportGuide("guide04",!0);var t=h.default.powers.get(g.default.inst.race),e=["\u9009\u62e9"+u.LocalizedTextManager.getGodPowerName(t.name)+"\u3002"];this.doStep=!1;var i=cc.find("view/HLayout/GLayout0/btn_"+g.default.inst.race,y.default.inst.curPage),o=i.convertToWorldSpaceAR(cc.Vec3.ZERO);d.default.inst.showFinger(!0,o),d.default.inst.showFrame(!0,o,i.getContentSize()),d.default.inst.showTips(e,4)},t.prototype.noviceStep5=function(){var t=this;s.default.reportGuide("guide04",!1),s.default.reportGuide("guide05",!0);var e=h.default.powers.get(g.default.inst.race),i=["\u70b9\u51fb\u5730\u56fe\u653e\u7f6e"+u.LocalizedTextManager.getGodPowerName(e.name)+"\u3002"];d.default.inst.showFrame(!1),d.default.inst.showFinger(!0,cc.v3(cc.winSize.width/2,.6*cc.winSize.height),!0),d.default.inst.showTips(i,5,function(){d.default.inst.enabledTouch(!1),t.doStep=!1})},t.prototype.noviceStep6=function(){var t=this;s.default.reportGuide("guide05",!1),s.default.reportGuide("guide06",!0);var e=h.default.powers.get(g.default.inst.race),i=u.LocalizedTextManager.getGodPowerName(e.name),o=["\u606d\u559c\u6210\u529f\u521b\u9020\u4e00\u4e2a"+i+"\uff01\n\u6211\u4eec\u6765\u8bd5\u8bd5\u521b\u9020\u66f4\u591a\u7684"+i+"\u5427\uff01"];d.default.inst.showTips(o,6,function(){d.default.inst.enabledTouch(!1),t.doStep=!1})},t.prototype.noviceStep7=function(){var t=this;s.default.reportGuide("guide06",!1),s.default.reportGuide("guide07",!0),d.default.inst.showTips(["\u518d\u653e\u591a\u70b9\uff0c\u518d\u591a\u70b9\uff01"],7,function(){d.default.inst.enabledTouch(!1),t.doStep=!1})},t.prototype.noviceStep8=function(){var t=this;s.default.reportGuide("guide07",!1),s.default.reportGuide("guide08",!0),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u5e72\u7684\u6f02\u4eae\uff01\n\u770b\uff0c\u4eba\u4eec\u6b63\u5728\u4f10\u6728\u76d6\u623f\u5b50\uff01"],8,null,function(){t.doStep=!1,t.do(n.novice)})},t.prototype.noviceStep9=function(){var t=this;s.default.reportGuide("guide08",!1),s.default.reportGuide("guide09",!0),d.default.inst.showTips(["\u6211\u4eec\u518d\u6492\u4e9b\u79cd\u5b50\uff0c\n\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\uff01"],9,function(){t.doStep=!1,t.do(n.novice)})},t.prototype.noviceStep10=function(){s.default.reportGuide("guide09",!1),s.default.reportGuide("guide10",!0),this.doStep=!1;var t=y.default.inst.toggleContainer.getChildByName("toggle4"),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u70b9\u51fb"\u81ea\u7136"\u5206\u7c7b\u3002'],10)},t.prototype.noviceStep11=function(){s.default.reportGuide("guide10",!1),s.default.reportGuide("guide11",!0),this.doStep=!1;var t=cc.find("view/HLayout/GLayout2/btn_fertilizerTrees",y.default.inst.curPage),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u70b9\u51fb\u79cd\u5b50\u3002"],11)},t.prototype.noviceStep12=function(){s.default.reportGuide("guide11",!1),s.default.reportGuide("guide12",!0),this.doStep=!1;var t=y.default.inst.mainSizeButton,e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u90e8\u5206\u9053\u5177\u662f\u901a\u8fc7\u82b1\u6d12\u5927\u91cf\u653e\u7f6e\u7684\uff0c\n\u70b9\u51fb\u8fd9\u91cc\u53ef\u4ee5\u8c03\u6574\u82b1\u6d12\u5927\u5c0f\u3002"],12)},t.prototype.noviceStep13=function(){s.default.reportGuide("guide12",!1),s.default.reportGuide("guide13",!0),this.doStep=!1;var t=p.default.inst.guideNode,e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u9009\u62e9\u8fd9\u4e2a\u8f83\u5927\u7684\u82b1\u6d12\u3002"],13)},t.prototype.noviceStep14=function(){var t=this;s.default.reportGuide("guide13",!1),s.default.reportGuide("guide14",!0),this.doStep=!1,d.default.inst.showFrame(!1),d.default.inst.showFinger(!0,cc.v3(cc.winSize.width/2,.6*cc.winSize.height),!0,d.FINGER_ACTION.leftAndRight),d.default.inst.showTips(["\u5728\u5730\u56fe\u4e0a\u6ed1\u52a8\u653e\u7f6e\u79cd\u5b50\u3002"],14,function(){d.default.inst.enabledTouch(!1),t.doStep=!1})},t.prototype.noviceStep15=function(){var t=this;s.default.reportGuide("guide14",!1),s.default.reportGuide("guide15",!0),y.default.inst.closeSelectTip(),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u73b0\u5728\u79cd\u5b50\u5df2\u7ecf\u6210\u957f\u4e3a\u6811\u6728\u4e86\u3002","\u5c1d\u8bd5\u4f7f\u7528\u5404\u79cd\u9053\u5177\uff0c\u521b\u9020\u5c5e\u4e8e\u4f60\u7684\u4e16\u754c\u5427\uff01"],15,function(){t._step=-1,t.complete(!0),y.default.inst.showBoxGift(),y.default.inst.showBoxMonster(),s.default.reportGuide("guide15",!1)})},t.prototype.saveStep0=function(){var t=this;this.begin(),d.default.inst.showTips(['"\u4fe1\u606f"\u5206\u7c7b\u91cc\uff0c\u6709\u4fdd\u5b58\u529f\u80fd\u3002'],4,null,function(){t.doStep=!1,y.default.inst.toggleContainer.children[0].getComponent(cc.Toggle).isChecked&&t._step++,t.do(n.save)})},t.prototype.saveStep1=function(){this.doStep=!1;var t=y.default.inst.toggleContainer.children[0],e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u70b9\u51fb"\u4fe1\u606f"\u5206\u7c7b\u6309\u94ae\u3002'],4)},t.prototype.saveStep2=function(){this.doStep=!1;var t=cc.find("checkmark/scrollView/view/HLayout/GLayout0/btn1004",y.default.inst.toggleContainer.children[0]),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u70b9\u51fb\u5b58\u6863\u6309\u94ae\u3002"],4)},t.prototype.saveStep3=function(){this.doStep=!1;var t=_.default.inst.slotNodes[1],e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u9009\u62e9\u4e00\u4e2a\u5b58\u6863\u4f4d\u7f6e\u3002"],4)},t.prototype.saveStep4=function(){this.doStep=!1;var t=m.default.inst.buttonSave.node,e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u70b9\u51fb\u4fdd\u5b58\u3002"],4)},t.prototype.saveStep5=function(){var t=this;d.default.inst.showFrame(!1),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u8fd9\u6837\u4e0b\u6b21\u5c31\u80fd\u7ee7\u7eed\u73a9\u4e86\uff0c\n\u9000\u51fa\u524d\u5343\u4e07\u8981\u8bb0\u5f97\u4fdd\u5b58\u54e6\uff01"],4,null,function(){t._step=-1,t.complete()})},t.prototype.cityInfoStep0=function(){var t=this;this.begin(),c.default.setPause(!0),cc.tween(f.MoveCamera.inst.camera).to(1.5,{zoomRatio:f.MoveCamera.inst.minZoomRatio}).start(),f.MoveCamera.inst.locked=!0,d.default.inst.showTips(["\u6709\u4e00\u4e2a\u597d\u4e1c\u897f\u5fd8\u4e86\u544a\u8bc9\u4f60\u3002"],4,null,function(){f.MoveCamera.inst.locked=!1,t.doStep=!1,y.default.inst.toggleContainer.children[0].getComponent(cc.Toggle).isChecked&&t._step++,t.do(n.cityInfo)})},t.prototype.cityInfoStep1=function(){this.doStep=!1;var t=y.default.inst.toggleContainer.children[0],e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u70b9\u51fb"\u4fe1\u606f"\u5206\u7c7b\u6309\u94ae'],4)},t.prototype.cityInfoStep2=function(){this.doStep=!1;var t=cc.find("checkmark/scrollView/view/HLayout/GLayout1/btn1006",y.default.inst.toggleContainer.children[0]),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u70b9\u51fb\u6253\u5f00"\u6751\u5e84\u60c5\u62a5"\n\u5f00\u542f\u540e\u663e\u793a\u6751\u5e84\u540d\u79f0\u4e0e\u4eba\u53e3'],4)},t.prototype.cityInfoStep3=function(){this.doStep=!1;var t=cc.find("checkmark/scrollView/view/HLayout/GLayout1/btn1007",y.default.inst.toggleContainer.children[0]),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(['\u70b9\u51fb\u6253\u5f00"\u6751\u5e84\u8fb9\u754c"\n\u5f00\u542f\u540e\u53ef\u4ee5\u770b\u5230\u6751\u5e84\u6269\u5f20\u7684\u60c5\u51b5'],4)},t.prototype.cityInfoStep4=function(){var t=this;d.default.inst.showFrame(!1),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u8fd9\u6837\u5c31\u53ef\u4ee5\u66f4\u597d\u7684\u89c2\u5bdf\u6751\u5e84\u7684\u72b6\u6001\u4e86"],4,null,function(){t.doStep=!1,t.do(n.cityInfo)})},t.prototype.cityInfoStep5=function(){var t=this;d.default.inst.showTips(["\u518d\u6b21\u70b9\u51fb\u76f8\u5e94\u6309\u94ae\n\u5373\u53ef\u5173\u95ed\u6751\u5e84\u72b6\u6001\u7684\u663e\u793a"],4,null,function(){t._step=-1,c.default.setPause(!1),t.complete(!0)})},t.prototype.mysteryStep0=function(){this.begin(),this.doStep=!1;var t=y.default.inst.node.getChildByName("mysteryGift"),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,cc.v3(e.x,e.y-50)),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u6709\u4e00\u4e2a\u98de\u7740\u7684\u5b9d\u7bb1\uff1f\n\u770b\u770b\u91cc\u9762\u6709\u4ec0\u4e48\u4e1c\u897f"],4)},t.prototype.mysteryStep1=function(){this._step=-1,this.complete(!0)},t.prototype.generalStep0=function(){var t=this;this.begin(),this.doStep=!1,d.default.inst.showMaskOpacity(100),d.default.inst.showTips(["\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e\u521b\u9020\u548c\u6467\u6bc1\u7684\u6e38\u620f\n(\u70b9\u51fb\u4efb\u610f\u4f4d\u7f6e\u4ee5\u7ee7\u7eed)"],4,null,function(){t.do(n.general)})},t.prototype.generalStep1=function(){var t=this;this.doStep=!1,d.default.inst.showTips(["\u63a7\u5236\u65b9\u5f0f\uff1a\u7528\u4e00\u6839\u624b\u6307\u79fb\u52a8\u955c\u5934\uff0c\u4e24\u4e2a\u624b\u6307\u63a7\u5236\u955c\u5934\u7f29\u653e"],4,null,function(){t.do(n.general)})},t.prototype.generalStep2=function(){var t=this;this.doStep=!1,d.default.inst.showTips(["\u6240\u6709\u7684\u9053\u5177\u90fd\u5728\u5c4f\u5e55\u7684\u4e0b\u65b9\n\u8fd9\u91cc\u662f\u51e0\u4e2a\u91cd\u8981\u7684\u6309\u94ae\uff1a"],4,null,function(){t.do(n.general)})},t.prototype.generalStep3=function(){var t=this;d.default.inst.interceptHighlightFrameTouch(!0);var e=cc.find("checkmark/scrollView/view/HLayout/GLayout0/btn1004",y.default.inst.toggleContainer.children[0]),i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u5b58\u6863"\u6309\u94ae\n\u7528\u5b83\u6765\u5b58\u50a8\u548c\u52a0\u8f7d\u4f60\u7684\u4e16\u754c'],4,null,function(){t.doStep=!1,t.do(n.general)})},t.prototype.generalStep4=function(){var t=this;this.doStep=!1;var e=cc.find("checkmark/scrollView/view/HLayout/GLayout0/btn1003",y.default.inst.toggleContainer.children[0]),i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u81ea\u5b9a\u4e49\u4e16\u754c"\u6309\u94ae\n\u7528\u5b83\u6765\u521b\u9020\u4e0d\u540c\u5c3a\u5bf8\u7684\u4e16\u754c'],4,null,function(){t.do(n.general)})},t.prototype.generalStep5=function(){var t=this;this.doStep=!1,d.default.inst.showFrame(!1),d.default.inst.showTips(['\u5404\u79cd\u4e0d\u540c\u7684\u9053\u5177\n\u88ab\u6574\u7406\u5728\u4e86\u4e0d\u540c\u7684"\u5206\u7c7b"\u4e2d'],4,null,function(){t.do(n.general)})},t.prototype.generalStep6=function(){var t=this;this.doStep=!1;var e=y.default.inst.toggleContainer.children[1],i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u5730\u5f62"\u5206\u7c7b\n\u5305\u542b\u4e86\u5404\u79cd\u4fee\u6539\u4e16\u754c\u7684\u5de5\u5177'],4,null,function(){t.do(n.general)})},t.prototype.generalStep7=function(){var t=this;this.doStep=!1;var e=y.default.inst.toggleContainer.children[2],i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u4eba\u5f62"\u5206\u7c7b\n\u53ef\u4ee5\u7528\u5b83\u6765\u521b\u9020\u6751\u5e84'],4,null,function(){t.do(n.general)})},t.prototype.generalStep8=function(){var t=this;this.doStep=!1;var e=y.default.inst.toggleContainer.children[3],i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u751f\u7269\u548c\u602a\u517d"\u5206\u7c7b\n\u60f3\u8981\u9f99\u5417\uff1f\u8fd9\u91cc\u5c31\u6709'],4,null,function(){t.do(n.general)})},t.prototype.generalStep9=function(){var t=this;this.doStep=!1;var e=y.default.inst.toggleContainer.children[4],i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u81ea\u7136"\u5206\u7c7b\n\u8fd9\u91cc\u6709\u4e00\u4e9b\u5de5\u5177\u53ef\u4ee5\u5e2e\u52a9\u4f60\u7684\u6587\u660e'],4,null,function(){t.do(n.general)})},t.prototype.generalStep10=function(){var t=this;this.doStep=!1;var e=y.default.inst.toggleContainer.children[5],i=e.parent.convertToWorldSpaceAR(e.position);d.default.inst.showFrame(!0,i,e.getContentSize()),d.default.inst.showTips(['"\u6467\u6bc1\u6027\u7269\u54c1"\u5206\u7c7b\n\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\u70b8\u5f39\u548c\u6838\u6b66\u5668'],4,null,function(){t.do(n.general)})},t.prototype.generalStep11=function(){var t=this;this.doStep=!1,d.default.inst.showFrame(!1),d.default.inst.showTips(["\u8fd9\u91cc\u6709\u592a\u591a\u7684\u9053\u5177\u7b49\u5f85\u4f60\u6765\u4f53\u9a8c\n\u5c3d\u60c5\u53bb\u5c1d\u8bd5\u5427"],4,null,function(){t.do(n.general)})},t.prototype.generalStep12=function(){d.default.inst.interceptHighlightFrameTouch(!1),this._step=-1,this.complete()},t.prototype.onlineStep0=function(){this.begin(),this.doStep=!1;var t=cc.find("left/btnOnline",y.default.inst.node),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u6709\u5728\u7ebf\u5956\u52b1\u53ef\u4ee5\u9886\u53d6\u54e6~"],4)},t.prototype.onlineStep1=function(){this._step=-1,this.complete(!0)},t.prototype.timeScaleStep0=function(){var t=this;this.begin(),d.default.inst.showTips(["\u5982\u679c\u4f60\u89c9\u5f97\u4e16\u754c\u8fd0\u8f6c\u592a\u6162\u7684\u8bdd,\n\u53ef\u4ee5\u4f7f\u7528\u65f6\u95f4\u52a0\u901f\u529f\u80fd\u3002"],4,null,function(){t.doStep=!1,t.do(n.timeScale)})},t.prototype.timeScaleStep1=function(){this.doStep=!1;var t=cc.find("right/btn1002",y.default.inst.node),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u70b9\u51fb\u65f6\u95f4\u52a0\u901f\u6309\u94ae\u3002"],4)},t.prototype.timeScaleStep2=function(){var t=this;d.default.inst.showFrame(!1),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u73b0\u5728\u4e16\u754c\u5c31\u5728\u52a0\u901f\u8fd0\u8f6c\u4e86\uff0c\n\u4f46\u662f\u8fdb\u884c\u52a0\u901f\u9700\u8981\u6d88\u8017\u52a0\u901f\u65f6\u95f4\u3002"],4,null,function(){t._step=-1,t.complete(!0)})},t.prototype.achievStep0=function(){var t=this;this.begin(),y.default.inst.checkGuideViewHeight(),d.default.inst.showTips(["\u4f60\u5b8c\u6210\u4e86\u4e00\u9879\u6210\u5c31\uff0c\n\u53ef\u4ee5\u9886\u53d6\u5956\u52b1\u4e86\u3002"],4,null,function(){t.doStep=!1,t.do(n.achiev)})},t.prototype.achievStep1=function(){this.doStep=!1;var t=cc.find("right/btnAchiev",y.default.inst.node),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u70b9\u51fb\u8fd9\u4e2a\u5956\u676f\u56fe\u6807\u67e5\u770b\u6210\u5c31\u3002"],4)},t.prototype.achievStep2=function(){this.doStep=!1;var t=v.default.inst.scrollView.content.children[0].getChildByName("reward"),e=t.parent.convertToWorldSpaceAR(t.position);d.default.inst.showFinger(!0,e),d.default.inst.showFrame(!0,e,t.getContentSize()),d.default.inst.showTips(["\u6765\uff0c\u9886\u53d6\u4f60\u7684\u6210\u5c31\u5956\u52b1\u5427\uff01"],4)},t.prototype.achievStep3=function(){var t=this;d.default.inst.showFrame(!1),d.default.inst.showFinger(!1),d.default.inst.showTips(["\u79ef\u6781\u5b8c\u6210\u6210\u5c31\u5e76\u83b7\u53d6\u5956\u52b1\u5427\u3002"],4,function(){t._step=-1,t.complete()})},t.prototype.cultureStep0=function(){var t=this;this.begin(),y.default.inst.checkGuideViewHeight(),c.default.setPause(!0),this.doStep=!1,cc.tween(y.default.inst.researchBar.node).sequence(cc.fadeOut(1),cc.fadeIn(1)).repeat(5).start(),d.default.inst.showTips(["\u8fd9\u662f\u79d1\u6280\u7814\u53d1\u8fdb\u5ea6\n\u5f53\u5b83\u5145\u6ee1\u65f6\uff0c\u738b\u56fd\u4f1a\u83b7\u5f97\u65b0\u79d1\u6280","\u5728\u7b49\u4e00\u4f1a\u513f\uff0c\u4f60\u7684\u738b\u56fd\u5c31\u53ef\u4ee5\u5efa\u9020\u623f\u5c4b\u4e86"],4,function(){t._step=-1,c.default.setPause(!1),t.complete()})},t.inst=new t,t}();a.default=b,cc._RF.pop()},{}],HeatRayEffect:[function(t,e,i){"use strict";cc._RF.push(e,"b723fHuO9BOZKX+k3aEHLZV","HeatRayEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SpriteAnimation"),c=a("BaseAnimatedObject"),d=a("MapBox"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ray=null,e.heat=null,e.active=!1,e.ticksActive=0,e.touchedGround=!1,e.rayScaleY=0,e.rayWidth=1,e}return r(e,t),e.prototype.onLoad=function(){this.ray.node.setScale(cc.v3(1,0,1))},e.prototype.isReady=function(){return this.touchedGround},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.ray.logicUpdate(d.default.inst.elapsed),this.heat.logicUpdate(d.default.inst.elapsed),this.ticksActive>0?this.ticksActive--:this.active=!1;var i=this.ray.node.position;i.z=this.node.position.y,this.ray.node.position=i,(i=this.heat.node.position).z=this.node.position.y,this.heat.node.position=i,this.active?this.rayScaleY<2e3&&(this.rayScaleY+=7e3*e,this.rayScaleY>=2e3&&(this.rayScaleY=2e3,this.touchedGround=!0),this.ray.node.setScale(cc.v3(this.rayWidth,this.rayScaleY,1))):(this.touchedGround=!1,this.rayScaleY>0&&(this.rayScaleY-=4e3*e,this.rayScaleY<0&&(this.rayScaleY=0,this.node.active=!1),this.ray.node.setScale(cc.v3(this.rayWidth,this.rayScaleY,1)))),this.heat.node.active=this.touchedGround},e.prototype.play=function(t,e){this.rayWidth=e>=10?1:.4,this.node.position=cc.v3(t.x,t.y),this.active=!0,this.ticksActive=4,this.node.active=!0},s([p({type:l.SpriteAnimation})],e.prototype,"ray",void 0),s([p({type:l.SpriteAnimation})],e.prototype,"heat",void 0),s([h],e)}(c.default);n.default=f,cc._RF.pop()},{}],Heat:[function(t,e,i){"use strict";cc._RF.push(e,"dd176vX8rFK7Y9HVKrb514B","Heat");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("AchievData"),s=o("GameCommon"),l=o("MapAction"),c=o("MapBox"),d=o("PowerButtonSelector"),u=o("TileTypeBase"),h=function(){function t(){this.tickTimer=0,this.tilesToRemove=[],this.tiles=null}return t.prototype.clear=function(){var t,e;this.tiles||(this.tiles=new Set);try{for(var i=n(this.tiles),o=i.next();!o.done;o=i.next())o.value.heat=0}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.tiles.clear()},t.prototype.addTile=function(t,e){var i,o,a,n,s,h;if(void 0===e&&(e=1),0==t.heat&&this.tiles.add(t),t.heat+=e,t.heat>5&&((null===(o=null===(i=t.building)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive)&&t.building.getHit(0),t.type.layerType==u.TileLayerType.Ocean&&(l.default.removeLiquid(t),c.default.inst.particlesSmoke.spawn(t.posV3.x,t.posV3.y)),t.type.frozen&&l.default.unfreezeTile(t),t.setBurned(),c.default.inst.setTileDirty(t)),t.heat>10&&(t.type.burnable&&((t.type.isType("tnt")||t.type.isType("tnt_timed"))&&r.default.update(13),t.setFire()),(null===(n=null===(a=t.building)||void 0===a?void 0:a.data)||void 0===n?void 0:n.alive)&&t.building.getHit(0),t.building&&t.setFire()),t.heat>20){t.type.explodable&&0==t.explosionWave&&c.default.inst.explosionLayer.explodeBomb(t);for(var p=0;p<t.units.length;p++){var f=t.units[p];f.stats.very_high_flyer||f.getHit(50)}t.building&&t.setFire(),t.top_type&&l.default.decreaseTile(t)}t.heat>30&&(t.type.lava&&c.default.inst.lavaLayer.addLava(t),(t.type.isType("soil_low")||t.type.isType("soil_high"))&&t.setTileType("sand"),t.type.road&&t.setTileType("sand"));var _=null===(h=null===(s=d.PowerButtonSelector.inst.selectedButton)||void 0===s?void 0:s.godPower)||void 0===h?void 0:h.id;t.heat>100&&t.type.isType("sand")&&(c.default.inst.lavaLayer.addLava(t),this.checkAchiev(_)),t.heat>160&&(t.type.isType("mountains")&&(c.default.inst.lavaLayer.addLava(t),this.checkAchiev(_)),t.type.isType("hills")&&(c.default.inst.lavaLayer.addLava(t),this.checkAchiev(_)))},t.prototype.checkAchiev=function(t){"lightning"==t&&r.default.update(34),"heatray"==t&&r.default.update(35)},t.prototype.logicUpdate=function(t){var e,i;if(!s.default.isPaused&&0!=this.tiles.size)if(this.tickTimer>0)this.tickTimer-=t;else{this.tickTimer=1,this.tilesToRemove=[];try{for(var o=n(this.tiles),a=o.next();!a.done;a=o.next()){var r=a.value;r.heat--,r.heat<=0&&this.tilesToRemove.push(r)}}catch(h){e={error:h}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}for(var l=0;l<this.tilesToRemove.length;l++){var c=this.tilesToRemove[l];this.tiles.delete(c)}this.tilesToRemove=[]}},t}();a.default=h,cc._RF.pop()},{}],HistoryHudItem:[function(t,e,i){"use strict";cc._RF.push(e,"36d11ybReBB/Y43Tj0Iu+1g","HistoryHudItem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameCommon"),c=a("TextureLoader"),d=a("PowerButtonSelector"),u=a("WorldLogMessageExtensions"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.desc=null,e.message=null,e.remove_timer=8,e.callback=null,e}return r(e,t),e.prototype.hide=function(){this.node.stopAllActions(),cc.tween(this.node).sequence(cc.fadeOut(1),cc.callFunc(this.callback)).start()},e.prototype.updateItem=function(t,e,i){void 0===i&&(i=!1),this.message=t,this.callback=e,this.desc.string=u.default.getFormatedText(t,this.desc,!1,!0),t.icon?this.icon.spriteFrame=c.TextureLoader.inst.getSpriteFrame(c.ATLAS_TYPE.UIATLAS,"icons/"+t.icon):this.icon.node.active=!1,i||cc.tween(this.node).sequence(cc.delayTime(this.remove_timer),cc.callFunc(this.hide.bind(this))).start()},e.prototype.click=function(){l.default.isPaused||d.PowerButtonSelector.inst.isPowerSelected()||u.default.jumpToLocation(this.message)},s([f(cc.Sprite)],e.prototype,"icon",void 0),s([f(cc.RichText)],e.prototype,"desc",void 0),s([p],e)}(cc.Component);n.default=_,cc._RF.pop()},{}],HistoryHud:[function(t,e,i){"use strict";cc._RF.push(e,"928150ouRpCHrVb4HO831Ij","HistoryHud");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("PlayerConfig"),d=a("HistoryHudItem"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layout=null,e.container=null,e.itemPrefab=null,e.pool=new cc.NodePool,e.historyItems=[],e.MAX_HISTORY_ITEMS=10,e.ITEM_HEIGHT=33,e.count=0,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.clear=function(){var t=this;this.historyItems.length>0&&(this.historyItems.forEach(function(e){t.pool.put(e.node)}),this.historyItems=[])},e.prototype.getObject=function(){var t=this.pool.get();return t||(t=cc.instantiate(this.itemPrefab)),t},e.prototype.remove=function(t){this.historyItems.remove(t),this.pool.put(t.node),this.historyItems.length==this.layout.childrenCount&&(this.count=0)},e.prototype.removeInvade=function(t,e){var i,o;try{for(var a=l(this.layout.children),n=a.next();!n.done;n=a.next()){var r=n.value.getComponent(d.default);if(t==r.message.kingdom||e==r.message.kingdom){r.hide();break}}}catch(u){i={error:u}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},e.prototype.newHistory=function(t){var e=this;if(c.default.optionBoolEnabled("history_log")){var i="diplomacy_invade"==t.text,o=this.getObject();o.name="HistoryItem "+(this.historyItems.length+1),o.parent=i?this.layout:this.container,o.opacity=255,i||(this.count++,o.y=-this.ITEM_HEIGHT*(this.count-1));var a=o.getComponent(d.default);a.updateItem(t,function(){e.remove(a)},i),this.historyItems.push(a),this.historyItems.length>this.MAX_HISTORY_ITEMS&&this.historyItems.shift().hide()}},e.prototype.update=function(){if(c.default.optionBoolEnabled("history_log")||this.clear(),0==this.container.childrenCount)this.container.y!=-this.layout.height&&(this.container.y=-this.layout.height);else{var t=(this.count-this.container.childrenCount)*this.ITEM_HEIGHT-this.layout.height;this.container.y<t&&(this.container.y+=2,this.container.y>t&&(this.container.y=t))}},e.inst=null,s([p(cc.Node)],e.prototype,"layout",void 0),s([p(cc.Node)],e.prototype,"container",void 0),s([p(cc.Prefab)],e.prototype,"itemPrefab",void 0),i=s([h],e)}(cc.Component);n.default=f,cc._RF.pop()},{}],HoverModule:[function(t,e,i){"use strict";cc._RF.push(e,"83e6fRTcZRDz4FOWNwT4bUZ","HoverModule");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.HoverState=void 0;var s,l=a("GameCommon"),c=a("BaseActorComponent"),d=a("ToolBox");(function(t){t[t.Hover=0]="Hover",t[t.Up=1]="Up",t[t.Down=2]="Down"})(s=n.HoverState||(n.HoverState={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=0,e}return r(e,t),e.prototype.logicUpdate=function(e){var i;if(t.prototype.logicUpdate.call(this,e),null===(i=this.actor.data)||void 0===i?void 0:i.alive){if(this.timer>0)this.timer-=e;else if(this.timer=1+d.Toolbox.randomFloat(0,4),!l.default.isPaused)switch(this.hoverState){case s.Hover:d.Toolbox.randomBool()?this.hoverState=s.Down:this.hoverState=s.Up;break;case s.Up:this.hoverState=s.Hover,this.actor.moveJumpOffset.y<this.actor.stats.hovering_max&&this.actor.changeMoveJumpOffset(3*e);break;case s.Down:this.hoverState=s.Hover,this.actor.moveJumpOffset.y>this.actor.stats.hovering_min&&this.actor.changeMoveJumpOffset(3*(0-e))}}else this.actor.changeMoveJumpOffset(10*(0-e))},e}(c.default);n.default=u,cc._RF.pop()},{}],IceTower:[function(t,e,i){"use strict";cc._RF.push(e,"fb096gGjutBHbG/CWEA+frx","IceTower");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("MapAction"),l=a("BaseBuilding"),c=a("ToolBox"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.freezeInterval=.3,e.freezeTimer=0,e}return r(e,t),e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.freezeTimer>0?this.freezeTimer-=e:(this.freezeTimer=this.freezeInterval,this.freezeRandomTile())},e.prototype.freezeRandomTile=function(){var t,e=this.building.currentTile,i=null===(t=e.region)||void 0===t?void 0:t.island;if(i){var o=i.regions.getRandom().tiles.getRandom();this.freeze(e,o)}},e.prototype.freeze=function(t,e){c.Toolbox.distTile(t,e)>50||(s.default.freezeTile(e),s.default.freezeTile(e))},e.prototype.checkChunk=function(t,e){var i=e.tiles.getRandom();c.Toolbox.distTile(t,i)>10||(s.default.freezeTile(i),s.default.freezeTile(i))},e}(l.BaseBuildingComponent);n.default=d,cc._RF.pop()},{}],InfiniteProp:[function(t,e,i){"use strict";cc._RF.push(e,"57edbnoHnVDZLt+gnCAAdBt","InfiniteProp");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("DateUtils"),c=a("Constants"),d=a("AdsManager"),u=a("GameTdd"),h=a("UserData"),p=a("GamePopBase"),f=a("MsgCache"),_=a("LocalizedTextManager"),m=a("AssetManager"),g=a("ViewController"),y=a("Config"),v=a("TextureLoader"),b=a("AdView"),w=cc._decorator,T=w.ccclass,k=w.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prop=[],e.title=null,e.btnText=null,e.btns=[],e.videoNormal=null,e.bg_count=null,e.bg_time=null,e.bg_unlock=null,e.cumulative=null,e.data=null,e}return r(e,t),e.prototype.onLoad=function(){this.cumulative.active=QQ_GAME},e.prototype.start=function(){var t=l.default.formatDayTime();void 0===h.default.member.firstFreeProp[t]&&(h.default.member.firstFreeProp={},h.default.member.firstFreeProp[t]=!0,h.default.save()),this.videoNormal.active=!h.default.member.firstFreeProp[t],this.videoNormal.active||(this.btnText.x=0),this.init()},e.prototype.clickClose=function(t){this.close(t)},e.prototype.init=function(){var t=this;if(this.data=h.default.getPropConfigByID(y.default.selectedProp),this.data){var e=h.default.getPropByID(this.data.propID);this.bg_unlock.active=e.lock,this.bg_time.active=!this.bg_unlock.active&&!OPPO_GAME,this.bg_count.active=!this.bg_unlock.active,this.bg_count.height=this.bg_count.active?200:400,this.title.string=this.bg_unlock.active?"\u6c38\u4e45\u89e3\u9501":"\u9053\u5177\u8017\u5c3d";for(var i=0;i<this.prop.length;i++){var o=this.prop[i],a=o.getChildByName("rare");a.active=this.data.rare>=0;var n=v.TextureLoader.inst.getSpriteFrame(v.ATLAS_TYPE.UIATLAS,"reward/rare_"+this.data.rare);n&&(a.getComponent(cc.Sprite).spriteFrame=n);var r=o.getChildByName("icon"),s="propIcon/"+m.default.powers.dict.get(this.data.propID).icon,l=v.TextureLoader.inst.getSpriteFrame(v.ATLAS_TYPE.UIATLAS,s);l&&(r.getComponent(cc.Sprite).spriteFrame=l),o.getChildByName("name").getComponent(cc.Label).string=this.data.propName;var c=o.getChildByName("num");c&&(c.getComponent(cc.Label).string="+"+this.data.reward);var p=o.getChildByName("time");if(p){var f=this.getInfiniteTime();p.getComponent(cc.Label).string=f+"\u79d2\n \u65e0\u9650\u4f7f\u7528"}var w=o.getChildByName("desc");if(w){var T=m.default.powers.dict.get(y.default.selectedProp);w.getComponent(cc.Label).string=_.LocalizedTextManager.getGodPowerDesc(T.name)}}var k=u.default.getData("p8",u.v_type.Number)||1;OPPO_GAME&&this.scheduleOnce(function(){var e=d.default.getNativeAdData();e&&g.default.open(g.view_type.AdView,null,null,!1,function(i){i.getComponent(b.default).init([t.data],e,b.AD_TYPE.infinite)},function(){d.default.preloadNativeAd()})},k)}},e.prototype.click=function(t,e){var i=this,o=t.getCurrentTarget().getComponent(cc.Button);o.interactable=!1;var a=l.default.formatDayTime();"addPropNum"==e&&h.default.member.firstFreeProp[a]?(h.default.member.firstFreeProp[a]=!1,this.reward(e)):(c.default.REPORT_ID=e,d.default.showVideoAds(function(t){if(1==t)i.reward(e);else{o.interactable=!0;var a=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";f.default.pushToast(a)}}))},e.prototype.reward=function(t){var e=h.default.getPropByID(this.data.propID);if(e){if("addPropNum"==t)e.number+=this.data.reward;else if("addPropTime"==t){var i=this.getInfiniteTime();e.number++,e.infiniteTime+=i,f.default.pushToast("\u83b7\u5f97"+i+"\u79d2\u65e0\u9650\u4f7f\u7528<"+e.propName+">\u5956\u52b1")}else e.lock=!1,f.default.pushToast("\u6c38\u4e45\u89e3\u9501<"+e.propName+">\u6210\u529f");h.default.save()}this.close()},e.prototype.getInfiniteTime=function(){return WECHAT_GAME||BYTEDANCE_GAME?200:100},s([k([cc.Node])],e.prototype,"prop",void 0),s([k(cc.Label)],e.prototype,"title",void 0),s([k(cc.Node)],e.prototype,"btnText",void 0),s([k([cc.Button])],e.prototype,"btns",void 0),s([k(cc.Node)],e.prototype,"videoNormal",void 0),s([k(cc.Node)],e.prototype,"bg_count",void 0),s([k(cc.Node)],e.prototype,"bg_time",void 0),s([k(cc.Node)],e.prototype,"bg_unlock",void 0),s([k(cc.Node)],e.prototype,"cumulative",void 0),s([T],e)}(p.GamePopBase);n.default=B,cc._RF.pop()},{}],IslandsCalculator:[function(t,e,i){"use strict";cc._RF.push(e,"ef587fhTBlIsJBFZqpWD8pT","IslandsCalculator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapBox"),r=o("TileIsland"),s=o("TileTypeBase"),l=function(){function t(){this.islands=[],this.islands_ground=[],this._temp_regions=[],this._temp_regions_cur_wave=[],this._temp_regions_next_wave=[]}return t.prototype.clear=function(){t.island_id=0,this.islands=[],this._temp_regions=[],this._temp_regions_cur_wave=[],this._temp_regions_next_wave=[]},t.prototype.logicUpdate=function(){this.timer_updateActors>0?this.timer_updateActors-=cc.director.getDeltaTime():(this.recalcActors(),this.timer_updateActors=2)},t.prototype.getRandomGround=function(){var t=null;if(this.islands.length>0){var e=this.getRandomIslandGround();e&&e.regions.length>0&&(t=e.getRandomTile())}return t||(t=n.default.inst.tilesList.getRandom()),t},t.prototype.getRandomIslandGround=function(t){if(void 0===t&&(t=!0),0==this.islands_ground.length)return null;if(!t)return this.islands_ground.getRandom();this.islands_ground.shuffle();for(var e=0;e<this.islands_ground.length;e++)if(this.islands_ground[e].regions.length>=4)return this.islands_ground[e];return null},t.prototype.countLandIslands=function(){for(var t=0,e=0;e<this.islands.length;e++){var i=this.islands[e];i.type==s.TileLayerType.Ground&&i.regions.length>=4&&t++}return t},t.prototype.recalcActors=function(){for(var t,e,i,o=0;o<this.islands.length;o++)this.islands[o].actors=[];for(var a=n.default.inst.units.getSimpleList(),r=0;r<a.length;r++){var s=a[r];(null===(t=s.data)||void 0===t?void 0:t.alive)&&(null===(i=null===(e=s.currentTile)||void 0===e?void 0:e.region)||void 0===i?void 0:i.island)&&s.currentTile.region.island.actors.push(s)}},t.prototype.clearEmptyIslands=function(){for(var t=this.islands.length;t>0;)0==this.islands[--t].regions.length&&this.islands.splice(t,1)},t.prototype.findIslands=function(){this._temp_regions=[],this.islands_ground=[],this.clearEmptyIslands();for(var t=0;t<n.default.inst.mapChunkManager.list.length;t++)for(var e=n.default.inst.mapChunkManager.list[t],i=0;i<e.regions.length;i++){var o=e.regions[i];o.island||(o.isIslandChecked=!1,this._temp_regions.push(o))}for(var a=0;a<this._temp_regions.length;a++){var r=this._temp_regions[a];r.island||this.newIslandFrom(r)}for(var l=0;l<this.islands.length;l++){var c=this.islands[l];c.regions.getSimpleList().shuffle(),c.countTiles(),c.type==s.TileLayerType.Ground&&this.islands_ground.push(c)}},t.prototype.newIslandFrom=function(e){t.island_id++,this._temp_regions_cur_wave=[],this._temp_regions_next_wave=[];var i=new r.default(t.island_id);i.type=e.type,this.islands.push(i),this._temp_regions_next_wave.push(e),t._nextWave=[],t._nextWave.push(e),this.startFill(i)},t.prototype.startFill=function(e){for(var i=0;i<t._nextWave.length;){var o=t._nextWave[i];o.isIslandChecked||(o.island=e,e.addRegion(o)),o.isIslandChecked=!0,i++;for(var a=0;a<o.neighbours.length;a++){var n=o.neighbours[a];n.isIslandChecked||(n.isIslandChecked=!0,n.island=e,e.addRegion(n),t._nextWave.push(n))}}e.regions.checkAddRemove()},t.prototype.getStartTile=function(t){if(0==this.islands_ground.length)return null;this.islands_ground.shuffle();for(var e=null,i=0,o=0;o<this.islands_ground.length;o++)this.islands_ground[o].regions.length>i&&this.islands_ground[o].getTileForCity(t)&&(e=this.islands_ground[o],i=this.islands_ground[o].regions.length);return e.getTileForCity(t)},t.island_id=0,t._nextWave=[],t}();a.default=l,cc._RF.pop()},{}],ItemAccessoryMaterialLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"952826xCzdB3YK4caShZ1bR","ItemAccessoryMaterialLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetLibrary"),l=a("ItemLibrary"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new l.ItemAsset;e.id="bone",e.equipment_value=5,this.add(e),this.t.setCost(5,"bones",1,"gems",1),this.t.baseStats.crit=2;var i=new l.ItemAsset;i.id="copper",i.equipment_value=10,i.tech_needed="material_copper",this.add(i),this.t.setCost(5,"metals",1,"gems",1),this.t.baseStats.crit=3;var o=new l.ItemAsset;o.id="bronze",o.equipment_value=15,o.tech_needed="material_bronze",this.add(o),this.t.setCost(10,"metals",1,"gems",1),this.t.baseStats.crit=4;var a=new l.ItemAsset;a.id="silver",a.equipment_value=20,a.tech_needed="material_silver",this.add(a),this.t.setCost(15,"metals",2,"gems",1),this.t.baseStats.crit=5;var n=new l.ItemAsset;n.id="iron",n.equipment_value=30,n.tech_needed="material_iron",this.add(n),this.t.setCost(20,"metals",3,"gems",2),this.t.baseStats.crit=6;var r=new l.ItemAsset;r.id="steel",r.equipment_value=40,r.tech_needed="material_steel",this.add(r),this.t.setCost(20,"metals",3,"gems",3),this.t.baseStats.crit=7;var s=new l.ItemAsset;s.id="mythril",s.equipment_value=50,s.tech_needed="material_mythril",this.add(s),this.t.setCost(50,"metals",4,"gems",4),this.t.baseStats.crit=8;var c=new l.ItemAsset;c.id="adamantine",c.equipment_value=70,c.tech_needed="material_adamantine",this.add(c),this.t.setCost(100,"metals",5,"gems",5),this.t.baseStats.crit=10},e}(s.default);n.default=c,cc._RF.pop()},{}],ItemArmorMaterialLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"1ca99qLelxDp5ofKmVORWWm","ItemArmorMaterialLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetLibrary"),l=a("ItemLibrary"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new l.ItemAsset;e.id="leather",e.equipment_value=5,this.add(e),this.t.setCost(5,"leather",1),this.t.baseStats.armor=2,this.t.baseStats.dodge=5,this.t.baseStats.speed=1;var i=new l.ItemAsset;i.id="copper",i.equipment_value=10,i.tech_needed="material_copper",this.add(i),this.t.setCost(5,"metals",1),this.t.baseStats.armor=3;var o=new l.ItemAsset;o.id="bronze",o.equipment_value=15,o.tech_needed="material_bronze",this.add(o),this.t.setCost(5,"metals",1),this.t.baseStats.armor=4;var a=new l.ItemAsset;a.id="silver",a.equipment_value=20,a.tech_needed="material_silver",this.add(a),this.t.setCost(10,"metals",1),this.t.baseStats.armor=5;var n=new l.ItemAsset;n.id="iron",n.equipment_value=30,n.tech_needed="material_iron",this.add(n),this.t.setCost(15,"metals",2),this.t.baseStats.armor=6;var r=new l.ItemAsset;r.id="steel",r.equipment_value=40,r.tech_needed="material_steel",this.add(r),this.t.setCost(20,"metals",3),this.t.baseStats.armor=7;var s=new l.ItemAsset;s.id="mythril",s.equipment_value=50,s.tech_needed="material_mythril",this.add(s),this.t.setCost(50,"metals",4),this.t.baseStats.armor=8;var c=new l.ItemAsset;c.id="adamantine",c.equipment_value=70,c.tech_needed="material_adamantine",this.add(c),this.t.setCost(100,"metals",5),this.t.baseStats.armor=10},e}(s.default);n.default=c,cc._RF.pop()},{}],ItemGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"1b08eRIT0JChKDCKfoElpDm","ItemGenerator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("Log"),r=o("ActorEquipmentSlot"),s=o("AssetManager"),l=o("ItemTools"),c=function(){function t(){}return t.getPool=function(e){if(t.pools.has(e))return t.pools.get(e);var i=[];return t.pools.set(e,i),i},t.createPools=function(e,i){i.forEach(function(i){for(var o=i.pool.split(","),a=0;a<o.length;a++)for(var n=t.getPool(e+"_"+o[a]),r=0;r<i.rarity;r++)n.push(i.id)})},t.init=function(){t.createPools("prefix",s.default.items_prefix.list),t.createPools("suffix",s.default.items_suffix.list)},t.generateItemsIDS=function(){t.list_id_string="",s.default.items.weapons_id_range.forEach(function(e){t.generateIdsFor(e,"weapon","range")}),s.default.items_suffix.list.forEach(function(e){var i=e.id;"0"!=i&&(t.list_id_string=t.list_id_string+"\nitem_prefix_of_"+i)}),n.default.d(t.list_id_string)},t.generateIdsFor=function(e,i,o){for(var a=0;a<s.default.items_prefix.list.length;a++){var n=s.default.items_prefix.list[a];if(n.pool.includes(o)){var r=n.id;if("0"==r){t.list_id_string=t.list_id_string+"\nitem_"+e;continue}t.list_id_string=t.list_id_string+"\nitem_"+e+"_"+r}}},t.generateItem=function(e,i,o,a,n,c,d){void 0===i&&(i="base"),void 0===o&&(o=null),void 0===a&&(a=0),void 0===n&&(n=""),void 0===c&&(c=""),void 0===d&&(d=1);var u=new r.ItemData,h=e.pool,p="0",f="0";if(0==e.suffixes.length&&0==e.prefixes.length){for(var _=null;d>0&&(p=t.getPool("prefix_"+h).getRandom(),d--,(_=s.default.items_prefix.get(p)).quality!=l.ItemQuality.Legendary););_.quality>l.ItemQuality.Normal&&(f=t.getPool("suffix_"+h).getRandom())}else f=e.suffixes.length>0?e.suffixes.getRandom():"0",p=e.prefixes.length>0?e.suffixes.getRandom():"0";var m="";"0"!=p&&(m=m+p+" "),m=m+i+" ",m+=e.id,"0"!=f&&(m=m+" of "+f),u.id=e.id,u.material=i,u.prefix=p,u.suffix=f,u.year=a,u.by=c,u.from=n,u.type=o.type,o.setItem(u),t.tString=t.tString+"\n"+m},t.pools=new Map,t.tString="",t.list_id_string="",t}();a.default=c,cc._RF.pop()},{}],ItemLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"4a7a0WXmEBLIJbWxntPK3YA","ItemLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ItemAsset=n.WeaponType=n.ItemProductionOrder=void 0;var s,l=a("Tools"),c=a("WorldAction"),d=a("ActionLibrary"),u=a("ActorEquipmentSlot"),h=a("BaseStats"),p=a("ItemTools"),f=a("AssetLibrary");(function(t){t[t.RandomArmor=0]="RandomArmor",t[t.Weapon=1]="Weapon",t[t.Both=2]="Both"})(n.ItemProductionOrder||(n.ItemProductionOrder={})),function(t){t[t.Melee=0]="Melee",t[t.Range=1]="Range"}(s=n.WeaponType||(n.WeaponType={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefixes=[],e.suffixes=[],e.materials=[],e.cost_gold=0,e.cost_resource_1=0,e.cost_resource_id_1="none",e.cost_resource_2=0,e.cost_resource_id_2="none",e.baseStats=new h.default,e.rarity=1,e.equipment_value=0,e.pool="",e.slash="",e.projectile="",e.attackAction=c.default.create(),e.quality=p.ItemQuality.Normal,e.attackType=s.Melee,e.tech_needed="",e}return r(e,t),e.prototype.setCost=function(t,e,i,o,a){void 0===e&&(e="none"),void 0===i&&(i=0),void 0===o&&(o="none"),void 0===a&&(a=0),this.cost_gold=t,this.cost_resource_id_1=e,this.cost_resource_1=i,this.cost_resource_id_2=o,this.cost_resource_2=a},e}(f.Asset);n.ItemAsset=_;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weapons_id_melee=[],e.weapons_id_range=[],e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new _;e.id="_equipment",this.add(e),this.t.pool="equipment",this.t.materials.addRange(["leather","copper","bronze","silver","iron","steel","mythril","adamantine"]),this.clone("armor","_equipment"),this.clone("boots","_equipment"),this.clone("helmet","_equipment");var i=new _;i.id="_accessory",this.add(i),this.t.pool="equipment",this.t.materials.addRange(["bone","copper","bronze","silver","iron","steel","mythril","adamantine"]),this.clone("ring","_accessory"),this.clone("amulet","_accessory"),this.clone("_weapon","_equipment"),this.t.slash="base",this.clone("_melee","_weapon"),this.t.pool="melee",this.clone("base","_melee"),this.t.slash="base",this.clone("hands","_melee"),this.t.slash="punch",this.clone("jaws","_melee"),this.t.slash="jaws",this.clone("claws","_melee"),this.t.slash="claws",this.clone("stick","_melee"),this.t.slash="punch",this.t.suffixes=["0"],this.t.materials=["wood"],this.t.baseStats.damage=1,this.t.baseStats.attackSpeed=20,this.t.baseStats.armor=1,this.clone("_range","_weapon"),this.t.pool="range",this.t.attackType=s.Range,this.t.baseStats.projectiles=1,this.clone("snowball","_range"),this.t.slash="punch",this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.damageCritMod=.5,this.t.projectile="snowball",this.t.baseStats.projectiles=1,this.t.attackAction.clear(),this.t.attackAction.add(d.default.addFrozenEffectOnTarget20),this.clone("bow","_range"),this.t.tech_needed="weapon_bow",this.t.projectile="arrow",this.t.slash="bow",this.t.materials.addRange(["wood","copper","bronze","silver","iron","steel","mythril","adamantine"]),this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.damageCritMod=.5,this.clone("flame_sword","_weapon"),this.t.materials=["base"],this.t.suffixes=["0","power","doom","terror"],this.t.slash="base",this.t.baseStats.damage=30,this.t.baseStats.attackSpeed=120,this.t.baseStats.targets=2,this.t.baseStats.damageCritMod=.1,this.t.equipment_value=50,this.t.attackAction.clear(),this.t.attackAction.add(d.default.addBurningEffectOnTarget),this.clone("necromancer_staff","_range"),this.t.materials=["base"],this.t.suffixes=["0","power","doom","terror"],this.t.projectile="bone",this.t.slash="punch",this.t.baseStats.attackSpeed=20,this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.targets=1,this.t.baseStats.damageCritMod=.5,this.t.equipment_value=50,this.t.baseStats.damage=30,this.clone("alien_blaster","_range"),this.t.materials=["base"],this.t.suffixes=["0"],this.t.projectile="plasma_ball",this.t.slash="punch",this.t.baseStats.attackSpeed=20,this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.targets=1,this.t.baseStats.damageCritMod=.5,this.t.equipment_value=50,this.t.baseStats.damage=30,this.clone("evil_staff","_range"),this.t.materials=["base"],this.t.suffixes=["0","power","doom","terror"],this.t.projectile="red_orb",this.t.slash="punch",this.t.baseStats.attackSpeed=20,this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.targets=1,this.t.baseStats.damageCritMod=.5,this.t.equipment_value=50,this.t.baseStats.projectiles=20,this.t.baseStats.damage=10,this.clone("white_staff","_range"),this.t.materials=["base"],this.t.suffixes=["0","power","doom","terror"],this.t.projectile="freeze_orb",this.t.slash="punch",this.t.baseStats.attackSpeed=20,this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.targets=1,this.t.baseStats.damageCritMod=.5,this.t.baseStats.damage=35,this.t.equipment_value=50,this.t.attackAction.clear(),this.t.attackAction.add(d.default.addFrozenEffectOnTarget20),this.clone("plague_doctor_staff","_weapon"),this.t.materials=["base"],this.t.suffixes=["0","power","health","protection","justice"],this.t.slash="punch",this.t.baseStats.attackSpeed=20,this.t.baseStats.crit=10,this.t.baseStats.targets=3,this.t.baseStats.damageCritMod=.5,this.t.baseStats.damage=35,this.t.equipment_value=15,this.clone("druid_staff","_range"),this.t.materials=["base"],this.t.suffixes=["0","power","doom","terror"],this.t.projectile="green_orb",this.t.slash="punch",this.t.baseStats.attackSpeed=35,this.t.baseStats.range=22,this.t.baseStats.crit=10,this.t.baseStats.targets=1,this.t.baseStats.damageCritMod=.3,this.t.baseStats.damage=12,this.t.equipment_value=50,this.t.baseStats.projectiles=2,this.t.attackAction.clear(),this.t.attackAction.add(d.default.addSlowEffectOnTarget20),this.clone("sword","_melee"),this.t.tech_needed="weapon_sword",this.t.slash="sword",this.t.materials=["wood","stone","copper","bronze","silver","iron","steel","mythril","adamantine"],this.t.baseStats.damage=1,this.t.baseStats.attackSpeed=40,this.clone("axe","_melee"),this.t.tech_needed="weapon_axe",this.t.slash="axe",this.t.materials=["wood","stone","copper","bronze","silver","iron","steel","mythril","adamantine"],this.t.baseStats.attackSpeed=20,this.clone("hammer","_melee"),this.t.tech_needed="weapon_hammer",this.t.slash="hammer",this.t.materials=["wood","stone","copper","bronze","silver","iron","steel","mythril","adamantine"],this.t.baseStats.attackSpeed=-10,this.t.baseStats.targets=1,this.clone("spear","_melee"),this.t.tech_needed="weapon_spear",this.t.slash="spear",this.t.materials=["wood","stone","copper","bronze","silver","iron","steel","mythril","adamantine"],this.t.baseStats.range=1,this.t.baseStats.attackSpeed=15,this.weapons_id_melee=[],this.weapons_id_melee.push("sword"),this.weapons_id_melee.push("axe"),this.weapons_id_melee.push("spear"),this.weapons_id_melee.push("hammer"),this.weapons_id_range=[],this.weapons_id_range.push("bow"),this.clone("venomous_bite","_melee"),this.t.slash="jaws",this.t.attackType=s.Melee,this.t.attackAction.add(d.default.addPoisonedEffectOnTarget),this.clone("rocks","_range"),this.t.projectile="rock",this.t.slash="punch",this.t.baseStats.range=15,this.t.baseStats.crit=10,this.t.baseStats.projectiles=1,this.t.baseStats.damageCritMod=.5,this.clone("shotgun","_range"),this.t.materials=["base"],this.t.suffixes=["0"],this.t.projectile="shotgun_bullet",this.t.slash="punch",this.t.baseStats.projectiles=12,this.t.baseStats.attackSpeed=10,this.t.baseStats.range=22,this.t.baseStats.targets=1,this.t.baseStats.damage=4},e.prototype.getEquipmentID=function(t){switch(t){case u.EquipmentType.Weapon:return"weapon";case u.EquipmentType.Helmet:return"helmet";case u.EquipmentType.Armor:return"armor";case u.EquipmentType.Boots:return"boots";case u.EquipmentType.Ring:return"ring";case u.EquipmentType.Amulet:return"amulet";default:return null}},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e)));return this.t=l.default.fromJson(i,new _),this.t.attackAction=c.default.create(),this.t.id=t,this.add(this.t)},e}(f.default);n.default=m,cc._RF.pop()},{}],ItemPrefixLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"42370C0Gv5K0bgS6yy6FKcw","ItemPrefixLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ItemTools"),l=a("AssetLibrary"),c=a("ItemLibrary"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c.ItemAsset;e.id="0",e.rarity=60,e.pool="melee,range,equipment",this.add(e);var i=new c.ItemAsset;i.id="uncomfortable",i.rarity=30,i.equipment_value=-10,i.pool="equipment",i.quality=s.ItemQuality.Junk,this.add(i),this.t.baseStats.dodge=-10;var o=new c.ItemAsset;o.id="blunt",o.rarity=10,o.equipment_value=-20,o.pool="melee",o.quality=s.ItemQuality.Junk,this.add(o),this.t.baseStats.accuracy=-8,this.t.baseStats.dodge=-5;var a=new c.ItemAsset;a.id="crooked",a.rarity=10,a.equipment_value=-20,a.pool="melee",a.quality=s.ItemQuality.Junk,this.add(a),this.t.baseStats.accuracy=-10,this.t.baseStats.dodge=-10,this.t.baseStats.armor=-5;var n=new c.ItemAsset;n.id="bad",n.rarity=10,n.equipment_value=-10,n.pool="range,melee,equipment",n.quality=s.ItemQuality.Junk,this.add(n),this.t.baseStats.accuracy=-20,this.t.baseStats.dodge=-5,this.t.baseStats.attackSpeed=-10;var r=new c.ItemAsset;r.id="ugly",r.rarity=5,r.equipment_value=-30,r.pool="melee,equipment",r.quality=s.ItemQuality.Junk,this.add(r),this.t.baseStats.diplomacy=-5;var l=new c.ItemAsset;l.id="broken",l.rarity=5,l.equipment_value=-30,l.pool="melee,range,equipment",l.quality=s.ItemQuality.Junk,this.add(l),this.t.baseStats.damage=-3,this.t.baseStats.accuracy=-3,this.t.baseStats.attackSpeed=-20;var d=new c.ItemAsset;d.id="good",d.rarity=10,d.equipment_value=5,d.pool="melee,range,equipment",d.quality=s.ItemQuality.Rare,this.add(d),this.t.baseStats.accuracy=5,this.t.baseStats.speed=1;var u=new c.ItemAsset;u.id="fine",u.rarity=5,u.equipment_value=10,u.pool="melee,range,equipment",u.quality=s.ItemQuality.Rare,this.add(u),this.t.baseStats.accuracy=7,this.t.baseStats.speed=1,this.t.baseStats.damage=1;var h=new c.ItemAsset;h.id="elegant",h.rarity=10,h.equipment_value=10,h.pool="equipment",h.quality=s.ItemQuality.Rare,this.add(h),this.t.baseStats.dodge=5,this.t.baseStats.accuracy=10,this.t.baseStats.crit=5;var p=new c.ItemAsset;p.id="sharp",p.rarity=5,p.equipment_value=10,p.pool="melee",p.quality=s.ItemQuality.Rare,this.add(p),this.t.baseStats.damage=3,this.t.baseStats.crit=20;var f=new c.ItemAsset;f.id="huge",f.rarity=5,f.equipment_value=10,f.pool="melee",f.quality=s.ItemQuality.Rare,this.add(f),this.t.baseStats.speed=-2,this.t.baseStats.damage=5,this.t.baseStats.targets=3;var _=new c.ItemAsset;_.id="great",_.rarity=4,_.equipment_value=20,_.pool="melee,equipment,range",_.quality=s.ItemQuality.Epic,this.add(_),this.t.baseStats.damage=4;var m=new c.ItemAsset;m.id="perfect",m.rarity=3,m.equipment_value=20,m.pool="melee,equipment,range",m.quality=s.ItemQuality.Epic,this.add(m),this.t.baseStats.health=20,this.t.baseStats.damage=2;var g=new c.ItemAsset;g.id="battle",g.rarity=3,g.equipment_value=20,g.pool="melee",g.quality=s.ItemQuality.Legendary,this.add(g),this.t.baseStats.damage=5,this.t.baseStats.crit=20,this.t.baseStats.armor=3,this.t.baseStats.targets=1;var y=new c.ItemAsset;y.id="death",y.rarity=3,y.equipment_value=30,y.pool="melee,range",y.quality=s.ItemQuality.Legendary,this.add(y),this.t.baseStats.damage=20,this.t.baseStats.health=-60,this.t.baseStats.armor=-2,this.t.baseStats.targets=1;var v=new c.ItemAsset;v.id="monster",v.rarity=3,v.equipment_value=40,v.pool="melee,range",v.quality=s.ItemQuality.Legendary,this.add(v),this.t.baseStats.health=100,this.t.baseStats.damage=10,this.t.baseStats.crit=5,this.t.baseStats.targets=2;var b=new c.ItemAsset;b.id="wild",b.rarity=3,b.equipment_value=30,b.pool="melee,range",b.quality=s.ItemQuality.Legendary,this.add(b),this.t.baseStats.speed=5,this.t.baseStats.crit=30,this.t.baseStats.damage=6,this.t.baseStats.targets=1},e}(l.default);n.default=d,cc._RF.pop()},{}],ItemSuffixLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"86a67jdWj1DS4YVdpCG19M4","ItemSuffixLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ItemTools"),l=a("AssetLibrary"),c=a("ItemLibrary"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c.ItemAsset;e.id="0",e.rarity=40,e.pool="melee,equipment,range",this.add(e);var i=new c.ItemAsset;i.id="balance",i.rarity=2,i.equipment_value=5,i.pool="melee,range",i.quality=s.ItemQuality.Rare,this.add(i),this.t.baseStats.crit=30;var o=new c.ItemAsset;o.id="justice",o.rarity=1,o.equipment_value=10,o.pool="melee,equipment,range",o.quality=s.ItemQuality.Rare,this.add(o),this.t.baseStats.armor=5,this.t.baseStats.health=20;var a=new c.ItemAsset;a.id="truth",a.rarity=1,a.equipment_value=10,a.pool="melee,equipment,range",a.quality=s.ItemQuality.Rare,this.add(a),this.t.baseStats.diplomacy=1;var n=new c.ItemAsset;n.id="speed",n.rarity=3,n.equipment_value=10,n.pool="melee,equipment,range",n.quality=s.ItemQuality.Rare,this.add(n),this.t.baseStats.speed=6;var r=new c.ItemAsset;r.id="health",r.rarity=1,r.equipment_value=10,r.pool="melee,equipment,range",r.quality=s.ItemQuality.Epic,this.add(r),this.t.baseStats.health=100;var l=new c.ItemAsset;l.id="protection",l.rarity=1,l.equipment_value=15,l.pool="melee,equipment,range",l.quality=s.ItemQuality.Epic,this.add(l),this.t.baseStats.armor=6;var d=new c.ItemAsset;d.id="greatness",d.rarity=1,d.equipment_value=20,d.pool="melee,equipment,range",d.quality=s.ItemQuality.Epic,this.add(d),this.t.baseStats.dodge=10;var u=new c.ItemAsset;u.id="power",u.rarity=3,u.equipment_value=25,u.pool="melee,equipment,range",u.quality=s.ItemQuality.Epic,this.add(u),this.t.baseStats.damage=5;var h=new c.ItemAsset;h.id="hell",h.rarity=1,h.equipment_value=30,h.pool="melee,equipment",h.quality=s.ItemQuality.Legendary,this.add(h),this.t.baseStats.damage=10;var p=new c.ItemAsset;p.id="doom",p.rarity=1,p.equipment_value=31,p.pool="melee,equipment,range",p.quality=s.ItemQuality.Legendary,this.add(p),this.t.baseStats.damage=10,this.t.baseStats.accuracy=10,this.t.baseStats.crit=20;var f=new c.ItemAsset;f.id="terror",f.rarity=1,f.equipment_value=35,f.pool="melee,equipment,range",f.quality=s.ItemQuality.Legendary,this.add(f),this.t.baseStats.damage=10,this.t.baseStats.crit=30,this.t.baseStats.attackSpeed=10,this.t.baseStats.speed=10,this.t.baseStats.armor=5},e}(l.default);n.default=d,cc._RF.pop()},{}],ItemTools:[function(t,e,i){"use strict";cc._RF.push(e,"1a050wPjSpKbJT78ZbNawyo","ItemTools");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.ItemQuality=void 0;var n,r=o("ActorEquipmentSlot"),s=o("AssetManager"),l=o("BaseStats");(function(t){t[t.Junk=0]="Junk",t[t.Normal=1]="Normal",t[t.Rare=2]="Rare",t[t.Epic=3]="Epic",t[t.Legendary=4]="Legendary"})(n=a.ItemQuality||(a.ItemQuality={}));var c=function(){function t(){}return t.calcItemValues=function(e){return t.s_stats.clear(),t.s_value=0,t.s_quality=n.Normal,t.checkStat(t.getItemMaterialLibrary(e.type,e.material)),t.checkStat(s.default.items.get(e.id)),t.checkStat(s.default.items_prefix.get(e.prefix)),t.checkStat(s.default.items_suffix.get(e.suffix)),t.s_value},t.checkStat=function(e){0!=t.s_quality&&(e.quality==n.Junk?t.s_quality=n.Junk:e.quality>t.s_quality&&(t.s_quality=e.quality)),t.s_stats.addStats(e.baseStats),t.s_value+=e.equipment_value},t.getItemMaterialLibrary=function(t,e){var i=null;switch(t){case r.EquipmentType.Helmet:case r.EquipmentType.Armor:case r.EquipmentType.Boots:i=s.default.items_material_armor.get(e);break;case r.EquipmentType.Weapon:i=s.default.items_material_weapon.get(e);break;case r.EquipmentType.Ring:case r.EquipmentType.Amulet:i=s.default.items_material_accessory.get(e)}return i},t.getItemClass=function(t){var e="";switch(t){case r.EquipmentType.Helmet:case r.EquipmentType.Armor:case r.EquipmentType.Boots:e="item_class_armor";break;case r.EquipmentType.Weapon:e="item_class_weapon";break;case r.EquipmentType.Ring:case r.EquipmentType.Amulet:e="item_class_accessory"}return e},t.s_value=0,t.s_quality=n.Normal,t.s_stats=new l.default,t}();a.default=c,cc._RF.pop()},{}],ItemWeaponMaterialLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"07711XVKW5Pyp+gIshBDMG0","ItemWeaponMaterialLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetLibrary"),l=a("ItemLibrary"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new l.ItemAsset;e.id="base",this.add(e);var i=new l.ItemAsset;i.id="wood",i.equipment_value=1,this.add(i),this.t.setCost(1,"wood",1),this.t.baseStats.damage=1,this.t.baseStats.attackSpeed=1;var o=new l.ItemAsset;o.id="stone",o.equipment_value=10,this.add(o),this.t.setCost(1,"stone",1),this.t.baseStats.damage=3,this.t.baseStats.speed=-2,this.t.baseStats.attackSpeed=-10;var a=new l.ItemAsset;a.id="copper",a.equipment_value=10,a.tech_needed="material_copper",this.add(a),this.t.setCost(1,"metals",1),this.t.baseStats.damage=3,this.t.baseStats.attackSpeed=2;var n=new l.ItemAsset;n.id="bronze",n.equipment_value=15,n.tech_needed="material_bronze",this.add(n),this.t.setCost(5,"metals",1),this.t.baseStats.damage=4,this.t.baseStats.attackSpeed=5;var r=new l.ItemAsset;r.id="silver",r.equipment_value=20,r.tech_needed="material_silver",this.add(r),this.t.setCost(10,"metals",1),this.t.baseStats.damage=5,this.t.baseStats.damage=1,this.t.baseStats.attackSpeed=8;var s=new l.ItemAsset;s.id="iron",s.equipment_value=30,s.tech_needed="material_iron",this.add(s),this.t.setCost(15,"metals",2),this.t.baseStats.damage=6,this.t.baseStats.attackSpeed=10,this.t.baseStats.crit=5;var c=new l.ItemAsset;c.id="steel",c.equipment_value=40,c.tech_needed="material_steel",this.add(c),this.t.setCost(20,"metals",3),this.t.baseStats.damage=7,this.t.baseStats.speed=1,this.t.baseStats.attackSpeed=10,this.t.baseStats.crit=5;var d=new l.ItemAsset;d.id="mythril",d.equipment_value=50,d.tech_needed="material_mythril",this.add(d),this.t.setCost(50,"metals",4),this.t.baseStats.damage=8,this.t.baseStats.attackSpeed=10,this.t.baseStats.crit=5;var u=new l.ItemAsset;u.id="adamantine",u.equipment_value=70,u.tech_needed="material_adamantine",this.add(u),this.t.setCost(100,"metals",5),this.t.baseStats.damage=10,this.t.baseStats.speed=1,this.t.baseStats.attackSpeed=15,this.t.baseStats.crit=15},e}(s.default);n.default=c,cc._RF.pop()},{}],JobManager:[function(t,e,i){"use strict";cc._RF.push(e,"0dacaUyQbtILInORVSFMVDY","JobManager");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.JobManagerBuildings=n.JobManagerActors=void 0;var s=a("Config"),l=a("BatchActors"),c=a("BatchBuildings"),d=function(){function t(){this.batches_all=[],this.batches_free=[],this.temp_list_keeper=[],this.batches_all_dirty=!1}return t.prototype.logicUpdate=function(t){this.updateBaseJobsPre(t),this.updateBaseJobsParallel(t),this.updateBaseJobsPost(t)},t.prototype.checkCleanup=function(){if(this.batches_all_dirty){this.batches_all_dirty=!1,this.temp_list_keeper=[];for(var t=0;t<this.batches_all.length;t++){var e=this.batches_all[t];e.main.length>0?this.temp_list_keeper.push(e):e.clear()}this.batches_all=[],this.batches_all.addRange(this.temp_list_keeper)}},t.prototype.updateBaseJobsPre=function(t){for(var e=0;e<this.batches_all.length;e++){var i=this.batches_all[e];0!=i.main.length&&i.updateJobsPre(t)}},t.prototype.updateBaseJobsPost=function(t){for(var e=0;e<this.batches_all.length;e++){var i=this.batches_all[e];0!=i.main.length&&i.updateJobsPost(t)}},t.prototype.clearParallelResults=function(){for(var t=0;t<this.batches_all.length;t++){var e=this.batches_all[t];0!=e.main.length&&e.clearParallelResults&&!e.clearParallelResults.isEmpty&&e.clearParallelResults.do()}},t.prototype.applyParallelResults=function(){for(var t=0;t<this.batches_all.length;t++){var e=this.batches_all[t];e.applyParallelResults&&!e.applyParallelResults.isEmpty&&e.applyParallelResults.do()}},t.prototype.updateBaseJobsParallel=function(t){if(this.clearParallelResults(),s.default.jobs_updater_parallel);else for(var e=0;e<this.batches_all.length;e++)this.batches_all[e].updateJobsParallel(t);this.applyParallelResults()},t.prototype.removeObject=function(){},t.prototype.newBatch=function(){return null},t.prototype.addNewObject=function(e){var i=this.getBatch();i.add(e),i.main.checkAddRemove(),i.main.length>=t.MAX_ELEMENTS&&(i.free_slots=!1,this.batches_free.pop())},t.prototype.getBatch=function(){if(0==this.batches_free.length){var t=this.newBatch();this.makeFree(t)}return this.batches_free[this.batches_free.length-1]},t.prototype.checkFree=function(e){e.main.checkAddRemove(),e.main.length<t.MAX_ELEMENTS&&this.makeFree(e)},t.prototype.makeFree=function(t){t.free_slots||(t.free_slots=!0,this.batches_free.push(t))},t.prototype.clear=function(){this.batches_free=[];for(var t=0;t<this.batches_all.length;t++){var e=this.batches_all[t];e.clear(),this.makeFree(e)}},t.MAX_ELEMENTS=256,t}();n.default=d;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.newBatch=function(){var t=new l.default;return t.createJobs(),this.batches_all.push(t),t},e}(d);n.JobManagerActors=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.newBatch=function(){var t=new c.default;return t.createJobs(),this.batches_all.push(t),t},e.prototype.removeObject=function(t){t.batch.remove(t),this.batches_all_dirty=!0},e}(d);n.JobManagerBuildings=h,cc._RF.pop()},{}],KingdomBehCheckCapital:[function(t,e,i){"use strict";cc._RF.push(e,"10994Qpas9A5buRhtnozDq7","KingdomBehCheckCapital");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomBehCheckCapital",e}return r(e,t),e.prototype.execute=function(t){var e;if(0==t.cities.length)return s.BehResult.Continue;if(null===(e=t.capital)||void 0===e?void 0:e.alive)return s.BehResult.Continue;t.cities.shuffle();var i=null;return t.cities.forEach(function(t){(!i||t.buildings.length>i.buildings.length)&&(i=t)}),t.capital=i,t.data.capitalID=t.capital.data.cityID,t.location=t.capital.cityCenter,s.BehResult.Continue},e}(s.BehaviourActionKingdom);n.default=l,cc._RF.pop()},{}],KingdomBehCheckCulture:[function(t,e,i){"use strict";cc._RF.push(e,"0867esABcROXZ4XMlk3vU5l","KingdomBehCheckCulture");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomBehCheckCulture",e}return r(e,t),e.prototype.execute=function(t){return this.recalcMainCulture(t),s.BehResult.Continue},e.prototype.recalcMainCulture=function(t){if(t.capital){var e=t.capital.getCulture();e&&(t.data.cultureID=e.id)}else t.data.cultureID=""},e}(s.BehaviourActionKingdom);n.default=l,cc._RF.pop()},{}],KingdomBehCheckKing:[function(t,e,i){"use strict";cc._RF.push(e,"b760bAnosFBzbg8FWSgcbg9","KingdomBehCheckKing");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Log"),c=a("ActorTool"),d=a("BehaviourActionBase"),u=a("City"),h=a("ToolBox"),p=a("MapBox"),f=a("WorldLog"),_=function(t){function e(){var e=t.call(this)||this;return e._units=[],e._new_kingdoms=[],e.id="KingdomBehCheckKing",e}return r(e,t),e.prototype.execute=function(t){var e,i,o,a;return(null===(e=t.data)||void 0===e?void 0:e.timer_new_king)>0?d.BehResult.Continue:(null===(o=null===(i=t.king)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive)?(this.tryToGiveGoldenTooth(t.king),d.BehResult.Continue):(this._new_kingdoms=[],t.clearKingData(),this._units=[],this.findKing(t),(null===(a=t.capital)||void 0===a?void 0:a.leader)&&this._units.remove(t.capital.leader),this.checkIndependants(t),d.BehResult.Continue)},e.prototype.tryToGiveGoldenTooth=function(t){t.data.age>45&&h.Toolbox.randomChance(.05)&&t.addTrait("golden_tooth")},e.prototype.findKing=function(t){var e=this;if(t.cities.forEach(function(t){var i,o;(null===(o=null===(i=t.leader)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive)&&e._units.push(t.leader)}),0!=this._units.length){this._units.shuffle();var i=null,o=0;this._units.forEach(function(t){var e=c.default.attributeDice(t);(!i||e>o)&&(o=e,i=t)}),i&&(this._units.remove(i),i.city.leader==i&&i.city.removeLeader(),t.setKing(i),f.default.logNewKing(t))}},e.prototype.checkIndependants=function(t){var e=this;if(p.default.inst.worldLaws.world_law_rebellions.boolVal&&p.default.inst.worldLaws.world_law_diplomacy.boolVal&&t.data.check_for_independence&&(t.data.check_for_independence=!1,0!=this._units.length&&t.king)){var i=c.default.attributeDice(t.king,3);this._units.forEach(function(t){var o=c.default.attributeDice(t);i<=o&&e.makeOrJoinKingdom(t)})}},e.prototype.makeOrJoinKingdom=function(t){var e,i,o,a,n,r;if(0==this._new_kingdoms.length)this.makeOwnKingdom(t);else{if((null===(r=null===(n=t.city)||void 0===n?void 0:n.data)||void 0===r?void 0:r.timer_revolt)>0)return;this._new_kingdoms.shuffle();try{for(var d=s(this._new_kingdoms),h=d.next();!h.done;h=d.next()){var p=h.value;p.king||l.default.d("HUH");var f=c.default.attributeDice(p.king);if(!(c.default.attributeDice(t)>f))try{for(var _=(o=void 0,s(p.cities)),m=_.next();!m.done;m=_.next()){var g=m.value;if(u.default.nearbyBorders(t.city,g))return void t.city.joinAnotherKingdom(p)}}catch(y){o={error:y}}finally{try{m&&!m.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}}}catch(v){e={error:v}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(e)throw e.error}}this.makeOwnKingdom(t)}},e.prototype.makeOwnKingdom=function(t){var e=t.city.makeOwnKingdom();t.city.removeLeader(),e.setKing(t),this._new_kingdoms.push(e)},e}(d.BehaviourActionKingdom);n.default=_,cc._RF.pop()},{}],KingdomBehRandomWait:[function(t,e,i){"use strict";cc._RF.push(e,"6b1c9bsUB1EsZxJMjV9tdF9","KingdomBehRandomWait");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=1);var o=t.call(this)||this;return o.min=0,o.max=0,o.min=e,o.max=i,o.id="KingdomBehRandomWait",o}return r(e,t),e.prototype.execute=function(t){return t.timer_action=l.Toolbox.randomFloat(this.min,this.max),s.BehResult.Continue},e}(s.BehaviourActionKingdom);n.default=c,cc._RF.pop()},{}],KingdomCheckAttackTarget:[function(t,e,i){"use strict";cc._RF.push(e,"6cd1eDVQZZGqJYntb/OrRqY","KingdomCheckAttackTarget");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("ToolBox"),c=a("Kingdom"),d=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomCheckAttackTarget",e}return r(e,t),e.prototype.execute=function(t){var e;if(t.data.timer_attack_target>0)return s.BehResult.Continue;if(t.data.timer_attack_target=10,0==t.civs_enemies.size)return s.BehResult.Continue;if(!t.king)return s.BehResult.Continue;if(null===(e=t.target_kingdom)||void 0===e?void 0:e.isEnemy(t))return s.BehResult.Continue;if(!t.diceAgressionSuccess())return t.target_kingdom=null,s.BehResult.Continue;var i=null,o=0,a=0;return t.civs_enemies.forEach(function(e,n){0!=n.cities.length&&(o=c.default.distanceBetweenKingdom(t,n),(!i||o<a)&&(i=n,a=o))}),i?(t.data.timer_attack_target=300+l.Toolbox.randomFloat(0,200),this.startAttackOn(t,i),s.BehResult.Continue):s.BehResult.Continue},e.prototype.startAttackOn=function(t,e){0!=e.cities.length&&t.capital&&(t.data.eventState=c.KingdomEventState.Wait,t.target_kingdom=e,t.findCityTarget())},e}(s.BehaviourActionKingdom);n.default=d,cc._RF.pop()},{}],KingdomCheckDeadKingdom:[function(t,e,i){"use strict";cc._RF.push(e,"debd5wccYdGo4T6hPJ03sgX","KingdomCheckDeadKingdom");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BehaviourActionBase"),l=a("MapBox"),c=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomCheckDeadKingdom",e}return r(e,t),e.prototype.execute=function(t){return t.data.timer_no_city>200?(l.default.inst.kingdoms.destroyKingdom(t),s.BehResult.Stop):s.BehResult.Continue},e}(s.BehaviourActionKingdom);n.default=c,cc._RF.pop()},{}],KingdomCheckDiplomacy:[function(t,e,i){"use strict";cc._RF.push(e,"40c7dOmID1NkLILxrly424c","KingdomCheckDiplomacy");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BehaviourActionBase"),c=a("ToolBox"),d=a("DiplomacyManager"),u=a("DiplomacyRelation"),h=a("Kingdom"),p=a("MapBox"),f=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomCheckDiplomacy",e}return r(e,t),e.prototype.execute=function(t){return p.default.inst.worldLaws.world_law_diplomacy.boolVal?0==t.cities.length?l.BehResult.Stop:(e._tempKingdoms=[],this.tryNewPeace(t),this.tryNewWar(t),l.BehResult.Continue):l.BehResult.Stop},e.prototype.tryNewWar=function(t){var e,i,o=t.countArmy();if(!(o<10)&&t.diceAgressionSuccess()){var a=null,n=0,r=0,l=Array.from(t.civs_allies.keys());try{for(var c=s(l),d=c.next();!d.done;d=c.next()){var f=d.value;if(!(f==t||o<f.countArmy()&&0==f.civs_enemies.size)){var _=p.default.inst.kingdoms.diplomacyManager.getRelation(t,f);_.data.stateChanged<22||(_.recalculate(),p.default.inst.kingdoms.diplomacyManager.getOpinion(t,f)._opinion_total<=0&&(n=h.default.distanceBetweenKingdom(t,f),(!a||n<r)&&(r=n,a=f)))}}}catch(m){e={error:m}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}a&&this.newDiplomacyEvent(t,a,u.DiplomacyState.War)}},e.prototype.tryNewPeace=function(t){var i=this;t.civs_enemies.forEach(function(t,i){e._tempKingdoms.push(i)}),e._tempKingdoms.forEach(function(e){i.newDiplomacyEvent(t,e,u.DiplomacyState.Ally)})},e.prototype.isThereActiveCityConquest=function(t,e){for(var i=0;i<t.cities.length;i++)if(t.cities[i].isGettingCapturedBy(e))return!0;for(i=0;i<e.cities.length;i++)if(e.cities[i].isGettingCapturedBy(t))return!0;return!1},e.prototype.newDiplomacyEvent=function(t,e,i){if(t.king&&0!=e.cities.length&&t!=e&&!this.isThereActiveCityConquest(t,e)){var o=p.default.inst.kingdoms.diplomacyManager.getRelation(t,e);if(!(o.data.stateChanged<22)){o.recalculate();var a=p.default.inst.kingdoms.diplomacyManager.getOpinion(t,e),n=0;o.data.state==u.DiplomacyState.War&&(n=p.default.inst.mapStats.year-o.data.warSince);var r=!1;switch(a._opinion_total<0&&(r=!0),t==d.default.kingdom_supreme&&e==d.default.kingdom_second&&(r=!0),i){case u.DiplomacyState.War:var s=t.king.curStats.personality_aggression;t.power>e.power&&(t.cities.length>t.getMaxCities()?s-=.1*(t.cities.length-t.getMaxCities()):t.cities.length<t.getMaxCities()&&t.diceAgressionSuccess()&&(s+=.1),r&&(s+=.05)),t.power<e.power&&(s-=e.power/t.power*.2),t.civs_enemies.size>0&&(s-=.3*t.civs_enemies.size),c.Toolbox.randomChance(s)&&p.default.inst.kingdoms.diplomacyManager.startWar(t,e);break;case u.DiplomacyState.Ally:var l=t.king.curStats.personality_diplomatic;n>10&&(l+=.1),t.diceAgressionSuccess()||(l+=.1),t.power<e.power&&(l+=.05),c.Toolbox.randomChance(l)&&p.default.inst.kingdoms.diplomacyManager.startPeace(t,e)}}}},e._tempKingdoms=[],e}(l.BehaviourActionKingdom);n.default=f,cc._RF.pop()},{}],KingdomCheckRevolts:[function(t,e,i){"use strict";cc._RF.push(e,"cd333WqAEJBZLB8iuyNMjGb","KingdomCheckRevolts");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ActorTool"),c=a("BehaviourActionBase"),d=a("MapBox"),u=a("WorldLog"),h=a("ModModule"),p=function(t){function e(){var e=t.call(this)||this;return e.id="KingdomCheckRevolts",e}return r(e,t),e.prototype.execute=function(t){var i,o,a,n,r;if(!d.default.inst.worldLaws.world_law_diplomacy.boolVal)return c.BehResult.Stop;if(!d.default.inst.worldLaws.world_law_rebellions.boolVal)return c.BehResult.Stop;if(t.data.timer_loyalty>0)return c.BehResult.Stop;if(!t.king)return c.BehResult.Stop;if(t==h.default.inst.kingdom)return c.BehResult.Stop;e._temp_cities=[],t.data.timer_loyalty=l.default.attributeDice(t.king,10);var p=0,f=null;try{for(var _=s(t.cities),m=_.next();!m.done;m=_.next()){var g=m.value;g!=t.capital&&g!=(null===(r=t.king)||void 0===r?void 0:r.city)&&(g.getRelationRating(),g.leader&&!(g._opinion_total>=0)&&(p++,!(g.captureTicks>0)&&!(g.data.timer_revolt>0)&&g.getArmy()>=g.getArmyMaxCity()/2&&g.getArmy()>=10&&(e._temp_cities.push(g),(!f||g._opinion_total<f._opinion_total)&&(f=g))))}}catch(x){i={error:x}}finally{try{m&&!m.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}if(!f)return c.BehResult.Stop;e._temp_cities.remove(f);var y=4+this.getBonusDice(f._opinion_total),v=l.default.attributeDice(t.king,4);if(l.default.attributeDice(f.leader,y)+2*p>v){u.default.logCityRevolt(f);var b=f.kingdom,w=f.makeOwnKingdom();d.default.inst.kingdoms.diplomacyManager.startWar(w,b,!0);var T=f.leader.curStats.cities,k=0;y=4;try{for(var B=s(e._temp_cities),S=B.next();!S.done;S=B.next()){var C=S.value;if(y=4+this.getBonusDice(f._opinion_total),v=l.default.attributeDice(t.king,4),l.default.attributeDice(C.leader,y)+3*p+7*k>v&&(C.joinAnotherKingdom(w),++k>=T))break}}catch(A){a={error:A}}finally{try{S&&!S.done&&(n=B.return)&&n.call(B)}finally{if(a)throw a.error}}return c.BehResult.Continue}return c.BehResult.Continue},e.prototype.getBonusDice=function(t){return t>0?0:Math.abs(t)/20},e._temp_cities=[],e}(c.BehaviourActionKingdom);n.default=p,cc._RF.pop()},{}],KingdomColorContainer:[function(t,e,i){"use strict";cc._RF.push(e,"c19d3xHrLRKCIZz08m+9rDK","KingdomColorContainer");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ToolBox"),r=o("MapBox"),s=o("KingdomColor"),l=function(){function t(){this.race="",this.curColor=0,this.list=[]}return t.prototype.addColor=function(t,e,i,o){void 0===o&&(o="");var a=new s.default(t,e,i);a.name=o,this.list.push(a)},t.prototype.prepare=function(){this.curColor=0;for(var t=0;t<this.list.length;t++)if(!this.haveColorInWorld(t))return void(this.curColor=t);this.curColor=n.Toolbox.randomInt(0,this.list.length)},t.prototype.haveColorInWorld=function(t){for(var e=0;e<r.default.inst.kingdoms.list_civs.length;e++){var i=r.default.inst.kingdoms.list_civs[e];if(i.data.raceID==this.race&&i.data.colorID==t)return!0}return!1},t.prototype.getColor=function(t){return t>this.list.length-1&&(t=0),this.list[t]},t}();a.default=l,cc._RF.pop()},{}],KingdomColors:[function(t,e,i){"use strict";cc._RF.push(e,"99c80HxCI5BRL7NnMbA/QIX","KingdomColors");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.KingdomColorsData=void 0;var n=o("ResMgr"),r=o("KingdomColor"),s=o("KingdomColorContainer");a.KingdomColorsData=function(){this.colors=[]};var l=function(){function t(){}return t.init=function(){n.default.loadRes("res/json/kingdom_colors",cc.JsonAsset).then(function(e){var i=function(i){if(Object.prototype.hasOwnProperty.call(e.json.colors,i)){var o=e.json.colors[i],a=new s.default;for(var n in o)a[n]=o[n];var r=[];a.list.forEach(function(e){var i=t.deserializedKingdomColor(e);i.initColor(),r.push(i)}),a.list=r,t.dict.set(a.race,a)}};for(var o in e.json.colors)i(o)})},t.getColor=function(e,i){return t.getContainer(e).getColor(i)},t.getContainer=function(e){return t.dict.get(e)},t.deserializedKingdomColor=function(e){var i=new r.default;return i.id=e.id,i.name=e.name,i.colorBorderInside=t.buildColor(e.colorBorderInside),i.colorBorderOut=t.buildColor(e.colorBorderOut),i.colorBorderBannerIcon=t.buildColor(e.colorBorderBannerIcon),i},t.buildColor=function(t){return cc.color(255*t.r,255*t.g,255*t.b,255*t.a)},t.dict=new Map,t}();a.default=l,cc._RF.pop()},{}],KingdomColor:[function(t,e,i){"use strict";cc._RF.push(e,"6891eVepQVMUIeIKmSbTA8N","KingdomColor");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ToolBox"),r=function(){function t(t,e,i){void 0===t&&(t="#FFFFFF"),void 0===e&&(e="#FFFFFF"),void 0===i&&(i="#FFFFFF"),this.id=0,this.name="not_set",this.colorBorderInside=n.Toolbox.makeColor(t),this.colorBorderOut=n.Toolbox.makeColor(e),this.colorBorderBannerIcon=n.Toolbox.makeColor(i),this.initColor()}return t.prototype.initColor=function(){this.id=t.last_id++,this.colorBorderInsideAlpha=cc.color(this.colorBorderInside.r,this.colorBorderInside.g,this.colorBorderInside.b,178.5),this.colorBorderInside_dark=cc.color(),this.colorBorderInside_dark.r=.8*this.colorBorderInside.r,this.colorBorderInside_dark.g=.8*this.colorBorderInside.g,this.colorBorderInside_dark.b=.8*this.colorBorderInside.b,this.colorBorderInside_dark.a=255,this.colorBorderInside_dark32=this.colorBorderInside_dark,this.colorBorderInside32=this.colorBorderInside,this.color32_unit=cc.Color.lerp(cc.color(),this.colorBorderInside32,cc.Color.WHITE,.3),this.color32_unit.a=255,this.k_color_0=this.colorBorderInside32,this.k_color_1=cc.Color.lerp(cc.color(),this.k_color_0,cc.Color.BLACK,.13),this.k_color_2=cc.Color.lerp(cc.color(),this.k_color_0,cc.Color.BLACK,.350000024),this.k_color_3=cc.Color.lerp(cc.color(),this.k_color_0,cc.Color.BLACK,.51),this.k_color_4=cc.Color.lerp(cc.color(),this.k_color_0,cc.Color.BLACK,.659999967)},t.last_id=0,t}();a.default=r,cc._RF.pop()},{}],KingdomElement:[function(t,e,i){"use strict";cc._RF.push(e,"61779/NbJdFf5diN0Ojr4nG","KingdomElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("ToolBox"),d=a("ViewController"),u=a("Config"),h=a("TextureLoader"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconRace=null,e.textPopulation=null,e.textArmy=null,e.textCities=null,e.textHouses=null,e.textZones=null,e.kingdomName=null,e.buttonCapital=null,e.buttonKing=null,e.banner=null,e.kingdom=null,e}return r(e,t),e.prototype.initItem=function(t){var e,i,o;this.kingdom=t,this.kingdomName.string=t.data.name,this.kingdomName.node.color=null===(o=t.kingdomColor)||void 0===o?void 0:o.colorBorderOut,this.iconRace.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.UIATLAS,"icons/"+t.race.icon);var a=0,n=0,r=t.cities.length;try{for(var s=l(t.cities),c=s.next();!c.done;c=s.next()){var d=c.value;a+=d.zones.length,n+=d.buildings.count}}catch(f){e={error:f}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(e)throw e.error}}this.textPopulation.string=""+t.getPopulationTotal(),this.textArmy.string=""+t.countArmy(),this.textZones.string=""+a,this.textHouses.string=""+n,this.textCities.string=""+r,this.buttonKing.active=null!=t.king,this.buttonCapital.active=null!=t.capital,this.showBanner()},e.prototype.showBanner=function(){var t,e="banners/"+this.kingdom.race.bannerId+"/background/banner_part_background"+c.Toolbox.randomInt(0,8),i="banners/"+this.kingdom.race.bannerId+"/icon/banner_part_object"+c.Toolbox.randomInt(0,8),o=this.banner.getComponent(cc.Sprite);o.node.color=null===(t=this.kingdom.kingdomColor)||void 0===t?void 0:t.colorBorderOut,o.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.WORLDATLAS,e);var a=this.banner.getChildByName("icon").getComponent(cc.Sprite);a.node.color=this.kingdom.kingdomColor.colorBorderBannerIcon,a.spriteFrame=h.TextureLoader.inst.getSpriteFrame(h.ATLAS_TYPE.WORLDATLAS,i)},e.prototype.clickKingdomElement=function(){u.default.selectedKingdom=this.kingdom,d.default.open(d.view_type.KingdomWindow)},e.prototype.clickKing=function(){u.default.selectedKingdom=this.kingdom,u.default.selectedUnit=this.kingdom.king,u.default.selectedUnit&&d.default.open(d.view_type.CreatureInfo)},e.prototype.clickCapital=function(){u.default.selectedKingdom=this.kingdom,u.default.selectedCity=this.kingdom.capital,u.default.selectedCity&&d.default.open(d.view_type.CityWindow)},s([_(cc.Sprite)],e.prototype,"iconRace",void 0),s([_(cc.Label)],e.prototype,"textPopulation",void 0),s([_(cc.Label)],e.prototype,"textArmy",void 0),s([_(cc.Label)],e.prototype,"textCities",void 0),s([_(cc.Label)],e.prototype,"textHouses",void 0),s([_(cc.Label)],e.prototype,"textZones",void 0),s([_(cc.Label)],e.prototype,"kingdomName",void 0),s([_(cc.Node)],e.prototype,"buttonCapital",void 0),s([_(cc.Node)],e.prototype,"buttonKing",void 0),s([_(cc.Node)],e.prototype,"banner",void 0),s([f],e)}(cc.Component);n.default=m,cc._RF.pop()},{}],KingdomJobLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"4cc8bcmp05IWI8zSW4iR+Rn","KingdomJobLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Kingdom"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new s.KingdomJob;e.id="kingdom",this.add(e),this.t.addTask("do_checks"),this.t.addTask("wait1"),this.t.addTask("check_dead_kingdom"),this.t.addTask("wait1"),this.t.addTask("check_diplomacy"),this.t.addTask("wait1"),this.t.addTask("check_attack_target"),this.t.addTask("check_revolts"),this.t.addTask("wait_random"),this.t.addTask("check_culture")},e}(a("AssetLibrary").default);n.default=l,cc._RF.pop()},{}],KingdomLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"10081H30nBK95OPktH6zDOf","KingdomLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.KingdomAsset=void 0;var l=a("KingdomColor"),c=a("AssetLibrary"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.civ=!1,e.nomads=!1,e.nature=!1,e.attack_each_other=!1,e.mobs=!1,e.mad=!1,e.brain=!1,e.friendly_tags=new Set,e.enemy_tags=new Set,e.tags=new Set,e.cached_enemies=new Map,e.default_kingdom_color=null,e}return r(e,t),e.prototype.addTag=function(t){this.tags.add(t)},e.prototype.addFriendlyTag=function(t){this.friendly_tags.add(t)},e.prototype.addEnemyTag=function(t){this.enemy_tags.add(t)},e.prototype.isFoe=function(t){var e=this.cached_enemies.get(t.id);return e?1==e:this.nature||t.nature?(this.cached_enemies.set(t.id,-1),!1):this==t?(this.cached_enemies.set(t.id,this.attack_each_other?1:-1),this.attack_each_other):this.enemy_tags.size>0&&this.overlaps(this.enemy_tags,t.tags)?(this.cached_enemies.set(t.id,1),!0):this.friendly_tags.size>0&&this.overlaps(this.friendly_tags,t.tags)?(this.cached_enemies.set(t.id,-1),!1):(this.cached_enemies.set(t.id,1),!0)},e.prototype.overlaps=function(t,e){var i,o,a=!1;try{for(var n=s(t),r=n.next();!r.done;r=n.next()){var l=r.value;if(e.has(l)){a=!0;break}}}catch(u){i={error:u}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return a},e}(c.Asset);n.KingdomAsset=d;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new d;e.id="human",e.civ=!0,this.add(e),this.t.addTag("civ"),this.t.addTag("human"),this.t.addFriendlyTag("human"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var i=new d;i.id="elf",i.civ=!0,this.add(i),this.t.addTag("civ"),this.t.addTag("elf"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("elf"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var o=new d;o.id="dwarf",o.civ=!0,this.add(o),this.t.addTag("civ"),this.t.addTag("dwarf"),this.t.addFriendlyTag("dwarf"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var a=new d;a.id="orc",a.civ=!0,this.add(a),this.t.addTag("orc"),this.t.addFriendlyTag("undead");var n=new d;n.id="nomads_human",n.nomads=!0,n.mobs=!0,this.add(n),this.t.default_kingdom_color=new l.default("#BACADD","#BACADD","#BACADD"),this.t.addTag("civ"),this.t.addTag("human"),this.t.addFriendlyTag("human"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var r=new d;r.id="nomads_elf",r.nomads=!0,r.mobs=!0,this.add(r),this.t.default_kingdom_color=new l.default("#98DB8C","#98DB8C","#98DB8C"),this.t.addTag("civ"),this.t.addTag("elf"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("elf"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var s=new d;s.id="nomads_orc",s.nomads=!0,s.mobs=!0,this.add(s),this.t.default_kingdom_color=new l.default("#FFCD70","#FFCD70","#FFCD70"),this.t.addTag("civ"),this.t.addTag("orc"),this.t.addFriendlyTag("orc"),this.t.addFriendlyTag("undead"),this.t.addEnemyTag("bandits");var c=new d;c.id="nomads_dwarf",c.nomads=!0,c.mobs=!0,this.add(c),this.t.default_kingdom_color=new l.default("#B1A0FF","#B1A0FF","#B1A0FF"),this.t.addTag("civ"),this.t.addTag("dwarf"),this.t.addFriendlyTag("dwarf"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("good"),this.t.addEnemyTag("bandits");var u=new d;u.id="nature",u.nature=!0,u.mobs=!0,this.add(u),this.t.default_kingdom_color=new l.default("#888888","#888888","#888888");var h=new d;h.id="ruins",h.nature=!0,h.mobs=!0,this.add(h),this.t.default_kingdom_color=new l.default("#444444","#444444","#444444");var p=new d;p.id="abandoned",p.nature=!0,p.mobs=!0,this.add(p),this.t.default_kingdom_color=new l.default("#888888","#888888","#888888");var f=new d;f.id="goldenBrain",f.mobs=!0,f.brain=!0,this.add(f),this.t.addTag("neutral"),this.t.addFriendlyTag("bandits"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addFriendlyTag("snowman");var _=new d;_.id="corruptedBrain",_.mobs=!0,_.brain=!0,this.add(_),this.t.addTag("mad");var m=new d;m.id="tumor",m.mobs=!0,this.add(m);var g=new d;g.id="biomass",g.mobs=!0,this.add(g);var y=new d;y.id="assimilators",y.mobs=!0,this.add(y);var v=new d;v.id="super_pumpkins",v.mobs=!0,this.add(v),this.t.addFriendlyTag("druid");var b=new d;b.id="neutral_animals",b.mobs=!0,this.add(b),this.t.addTag("neutral"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addFriendlyTag("snowman"),this.t.addFriendlyTag("civ");var w=new d;w.id="cats",w.mobs=!0,this.add(w),this.t.addTag("cats"),this.t.addTag("neutral"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addFriendlyTag("snowman"),this.t.addFriendlyTag("civ"),this.t.addEnemyTag("rats"),this.t.addEnemyTag("ratKings");var T=new d;T.id="wolves",T.mobs=!0,this.add(T),this.t.addTag("wolves"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("wolves"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses");var k=new d;k.id="hyenas",k.mobs=!0,this.add(k),this.t.addTag("hyenas"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("hyenas"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses");var B=new d;B.id="crocodiles",B.mobs=!0,this.add(B),this.t.addTag("crocodiles"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("crocodiles"),this.t.addFriendlyTag("nature_creature");var S=new d;S.id="snakes",S.mobs=!0,this.add(S),this.t.addTag("snakes"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("snakes"),this.t.addFriendlyTag("nature_creature"),this.t.addEnemyTag("civ");var C=new d;C.id="rhinos",C.mobs=!0,this.add(C),this.t.addTag("rhinos"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("rhinos"),this.t.addFriendlyTag("nature_creature"),this.t.addEnemyTag("hyenas"),this.t.addEnemyTag("snakes"),this.t.addEnemyTag("bears"),this.t.addEnemyTag("wolves"),this.t.addEnemyTag("rats");var x=new d;x.id="bears",x.mobs=!0,this.add(x),this.t.addTag("bears"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("bears"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addEnemyTag("rhinos");var A=new d;A.id="acids",A.mobs=!0,this.add(A),this.t.addTag("acids"),this.t.addFriendlyTag("acids"),this.t.addFriendlyTag("rats");var P=new d;P.id="demons",P.mobs=!0,this.add(P);var O=new d;O.id="walkers",O.mobs=!0,this.add(O),this.t.addTag("snow"),this.t.addFriendlyTag("snow");var R=new d;R.id="dragons",R.mobs=!0,this.add(R);var F=new d;F.id="aliens",F.mobs=!0,this.add(F);var L=new d;L.id="piranhas",L.mobs=!0,this.add(L);var D=new d;D.id="bandits",D.mobs=!0,this.add(D),this.t.addTag("bandits"),this.t.addTag("neutral"),this.t.addFriendlyTag("neutral"),this.t.addEnemyTag("civ");var M=new d;M.id="undead",M.mobs=!0,this.add(M),this.t.addTag("undead"),this.t.addFriendlyTag("orc");var I=new d;I.id="zombie",I.mobs=!0,this.add(I),this.t.addTag("zombie");var j=new d;j.id="living_plants",j.mobs=!0,this.add(j),this.t.addTag("nature_creature"),this.t.addTag("living_plants"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("mush");var E=new d;E.id="living_houses",E.mobs=!0,this.add(E),this.t.addTag("living_houses"),this.t.addFriendlyTag("living_houses");var N=new d;N.id="ants",N.mobs=!0,this.add(N),this.t.addTag("nature_creature"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses");var z=new d;z.id="santa",z.mobs=!0,this.add(z),this.t.addTag("santa"),this.t.addFriendlyTag("snowman");var G=new d;G.id="rats",G.mobs=!0,this.add(G),this.t.addTag("rats"),this.t.addTag("neutral"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("acids"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("rats"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("nature_creature"),this.t.addEnemyTag("cats");var U=new d;U.id="ratKings",U.attack_each_other=!0,U.mobs=!0,this.add(U),this.t.addTag("rats"),this.t.addTag("neutral"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("acids"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("rats"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("nature_creature"),this.t.addEnemyTag("cats");var W=new d;W.id="crab",W.mobs=!0,this.add(W),this.t.addTag("crab"),this.t.addTag("neutral"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("crab"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addFriendlyTag("snowman");var q=new d;q.id="crabzilla",q.mobs=!0,this.add(q),this.t.addTag("crab"),this.t.addFriendlyTag("crab");var H=new d;H.id="snowman",H.mobs=!0,this.add(H),this.t.addTag("snow"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("snow"),this.t.addFriendlyTag("santa");var V=new d;V.id="evil",V.mobs=!0,this.add(V),this.t.addTag("evil"),this.t.addFriendlyTag("evil");var Z=new d;Z.id="druid",Z.mobs=!0,this.add(Z),this.t.addTag("good"),this.t.addTag("nature_creature"),this.t.addFriendlyTag("good"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("super_pumpkins");var K=new d;K.id="good",K.mobs=!0,this.add(K),this.t.addTag("good"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("civ"),this.t.addFriendlyTag("neutral"),this.t.addFriendlyTag("nature_creature"),this.t.addFriendlyTag("living_houses"),this.t.addFriendlyTag("snowman"),this.t.addEnemyTag("wolves"),this.t.addEnemyTag("bears"),this.t.addEnemyTag("orc"),this.t.addEnemyTag("bandits");var J=new d;J.id="mad",J.attack_each_other=!0,J.mobs=!0,J.mad=!0,this.add(J),this.t.default_kingdom_color=new l.default("#E53B3B","#E53B3B","#E53B3B"),this.t.addTag("mad"),this.t.addFriendlyTag("mad");var Y=new d;Y.id="greg",Y.mobs=!0,this.add(Y),this.t.addTag("greg");var Q=new d;Q.id="mush",Q.mobs=!0,this.add(Q),this.t.addTag("mush"),this.t.addFriendlyTag("living_plants");var X=new d;X.id="godfinger",X.nature=!0,this.add(X)},e}(c.default);n.default=u,cc._RF.pop()},{}],KingdomListWindow:[function(t,e,i){"use strict";cc._RF.push(e,"f16ba3F7KdNt4Tbsq+vzD1s","KingdomListWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GamePopBase"),d=a("MapBox"),u=a("KingdomElement"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kingdomElementPrefab=null,e.content=null,e}return r(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.showList()},e.prototype.showList=function(){var t,e;d.default.inst.kingdoms.list_civs.sort(function(t,e){return t.getPopulationTotal()-e.getPopulationTotal()});try{for(var i=l(d.default.inst.kingdoms.list_civs),o=i.next();!o.done;o=i.next()){var a=o.value;this.showElement(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.showElement=function(t){var e=cc.instantiate(this.kingdomElementPrefab);e.parent=this.content,e.getComponent(u.default).initItem(t)},s([f(cc.Prefab)],e.prototype,"kingdomElementPrefab",void 0),s([f(cc.Node)],e.prototype,"content",void 0),s([p],e)}(c.GamePopBase);n.default=_,cc._RF.pop()},{}],KingdomManager:[function(t,e,i){"use strict";cc._RF.push(e,"dbdc6u9f2pG1phnFOLHqUBP","KingdomManager");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("ObjectUtils"),s=o("AchievData"),l=o("GameCommon"),c=o("AssetManager"),d=o("Config"),u=o("MapMarks"),h=o("MapBox"),p=o("WorldLog"),f=o("PowerButtonSelector"),_=o("DiplomacyManager"),m=o("DiplomacyRelation"),g=o("Kingdom"),y=function(){function t(){var t=this;this.dict_hidden=new Map,this.list=[],this.list_civs=[],this.list_hidden=[],this.diplomacyManager=null,this.diplomacyManager=new _.default(this),c.default.kingdoms.list.forEach(function(e){t.newHiddenKingdom(e)})}return Object.defineProperty(t.prototype,"length",{get:function(){return this.list_civs.length},enumerable:!1,configurable:!0}),t.prototype.save=function(){var t=[];return this.list_civs.forEach(function(e){t.push(e.save())}),t},t.prototype.setDiplomacyState=function(t,e,i){switch("string"==typeof t&&(t=this.getKingdomByID(t)),"string"==typeof e&&(e=this.getKingdomByID(e)),this.diplomacyManager.getRelation(t,e).data.state=i,t.setDiplomacyState(e,m.DiplomacyState.Clear),e.setDiplomacyState(t,m.DiplomacyState.Clear),i){case m.DiplomacyState.Ally:case m.DiplomacyState.War:t.setDiplomacyState(e,i),e.setDiplomacyState(t,i)}h.default.inst.zoneCalculator&&h.default.inst.zoneCalculator.setDrawnZonesDirty()},t.prototype.newHiddenKingdom=function(t){var e=new g.default;return e.asset=t,e.createHidden(),e.data.id=t.id,e.data.name=t.id,this.addKingdom(e),e},t.prototype.clear=function(){this.list_civs=[],this.list=[],this.diplomacyManager.clear(),this.list_hidden.forEach(function(t){t.clear()}),this.list.addRange(this.list_hidden)},t.prototype.getKingdomByID=function(t){if(this.dict_hidden.has(t))return this.dict_hidden.get(t);for(var e=0;e<this.list_civs.length;e++){var i=this.list_civs[e];if(i.data.id==t)return i}return null},t.prototype.checkKingdoms=function(){var t,e,i,o,a=this,r=[];try{for(var s=n(this.list_civs),l=s.next();!l.done;l=s.next())0==(u=l.value).cities.length&&0==u.getPopulationTotal()&&r.push(u)}catch(f){t={error:f}}finally{try{l&&!l.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}try{for(var c=n(r),d=c.next();!d.done;d=c.next()){var u=d.value;this.list_civs.remove(u)}}catch(_){i={error:_}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}this.list_civs.forEach(function(t){a.list_civs.forEach(function(e){t==e||t.allies.has(e)||a.setDiplomacyState(t,e,m.DiplomacyState.War)})})},t.prototype.makeNewCivKingdom=function(t,e,i,o){void 0===e&&(e=null),void 0===i&&(i=""),void 0===o&&(o=!0);var a=new g.default;return a.createAI(),t&&!e&&(e=t.race),e&&a.createCiv(e,i),t&&t.setKingdom(a),this.addKingdom(a,!0),o&&p.default.logNewKingdom(a),this.diplomacyManager.makeAllFriendlyTo(a),a},t.prototype.addKingdom=function(t,e){var i;void 0===e&&(e=!1),this.list.push(t),t.hashcode=r.default.getHashCode(t.data.id),e?this.list_civs.push(t):(this.dict_hidden.set(t.data.id,t),this.list_hidden.push(t)),null===(i=h.default.inst.zoneCalculator)||void 0===i||i.setDrawnZonesDirty()},t.prototype.logicUpdate=function(t){this.list.forEach(function(e){e.logicUpdate(t)}),l.default.isPaused||(this.updateCivKingdoms(t),this.diplomacyManager.logicUpdate(t),u.default.inst.drawArrows())},t.prototype.updateCivKingdoms=function(t){var e,i,o=new Map;try{for(var a=n(this.list_civs),r=a.next();!r.done;r=a.next()){var l=r.value;l.updateCiv(t);var c=o.get(l.race.id);(!c||c<l.units.length)&&o.set(l.race.id,l.units.length)}}catch(p){e={error:p}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}if(o.has("human")&&o.has("orc")&&o.get("human")>=100&&o.get("orc")>=100&&s.default.update(57,100,!0),4==o.size){var d=0;o.forEach(function(t){t>=50&&d++}),4==d&&s.default.update(56,50,!0)}},t.prototype.updateAge=function(){var t,e;try{for(var i=n(this.list_civs),o=i.next();!o.done;o=i.next())o.value.updateAge()}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.diplomacyManager.updateAge()},t.prototype.getRandom=function(){return 0==this.list_civs.length?null:(this.list_civs.shuffle(),this.list_civs[0])},t.prototype.destroyKingdom=function(t){var e;this.diplomacyManager.removeRelations(t),this.list.remove(t),this.list_civs.remove(t),h.default.inst.isSelectedPower("relations")&&d.default.selectedKingdom==t&&f.PowerButtonSelector.inst.unselectAll(),t.data.alive&&(t.data.alive=!1,p.default.logKingdomDestroyed(t)),this.list.forEach(function(e){e.enemies.has(t)&&e.setDiplomacyState(t,m.DiplomacyState.Clear),e.allies.has(t)&&e.setDiplomacyState(t,m.DiplomacyState.Clear)}),t.makeSurvivorsToNomads(),null===(e=h.default.inst.zoneCalculator)||void 0===e||e.setDrawnZonesDirty()},t}();a.default=y,cc._RF.pop()},{}],KingdomOpinion:[function(t,e,i){"use strict";cc._RF.push(e,"3c168k4t/hKU5IFEZt5f0qU","KingdomOpinion");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("AssetManager"),r=o("City"),s=o("MapBox"),l=o("DiplomacyManager"),c=function(){function t(t,e){this.main=null,this.target=null,this._opinion_king=0,this._opinion_race=0,this._opinion_close_borders=0,this._opinion_far_lands=0,this._opinion_kings_mood=0,this._in_war=0,this._opinion_peace_time=0,this._opinion_power=0,this._opinion_traits=0,this._opinion_zones=0,this._opinion_same_wars=0,this._opinion_is_supreme=0,this._opinion_culture=0,this._opinion_total=0,this.main=t,this.target=e}return t.prototype.calculate=function(t,e,i){if(t){this.main=t,this.target=e;var o=t.civs_allies.has(e);if(this._opinion_king=0,this._opinion_race=0,this._opinion_peace_time=0,this._opinion_power=0,this._opinion_total=0,this._opinion_same_wars=0,this._opinion_is_supreme=0,this._opinion_zones=0,this._in_war=0,this._opinion_traits=0,this._opinion_close_borders=0,this._opinion_far_lands=0,this._opinion_culture=0,!o)return this._in_war=-100,void(this._opinion_total=this._in_war);l.default.kingdom_supreme==e&&s.default.inst.kingdoms.list_civs.length>=3&&(this._opinion_is_supreme=-100);var a=5*t.cities.length+t.getPopulationTotal(),r=5*e.cities.length+e.getPopulationTotal()-a;if(this._opinion_power=r>0?r/10:0,e.king&&(this._opinion_king+=e.king.curStats.diplomacy),e.data.cultureID&&e.king&&t.king){var c=n.default.traits.checkTraitsMod(e.king,t.king);this._opinion_traits+=c}e.getCulture()&&(e.getCulture()==t.getCulture()?this._opinion_culture=10:this._opinion_culture=-10),this._opinion_kings_mood=0,t.king&&(this._opinion_kings_mood=t.king.curStats.opinion);var d=0,u=0;t.cities.forEach(function(t){d+=t.zones.length}),e.cities.forEach(function(t){u+=t.zones.length});var h=d-u;this._opinion_zones=h/5,this._opinion_zones>0&&(this._opinion_zones=0),this._opinion_zones<-20&&(this._opinion_zones=-20),e.civs_enemies.size>0&&(this._opinion_same_wars=50),this.areKingdomsClose(t,e)?this._opinion_close_borders=-50:this._opinion_far_lands=25,t.race==e.race?this._opinion_race=5:t.race.hateRaces.includes(e.race.id)&&(this._opinion_race-=20),o&&(this._opinion_peace_time=s.default.inst.mapStats.year-i.data.peaceSince,this._opinion_peace_time>20&&(this._opinion_peace_time=20),this._opinion_peace_time=0),this._opinion_total=this._opinion_close_borders+this._opinion_far_lands+this._opinion_king+this._opinion_peace_time+this._opinion_power+this._opinion_race+this._opinion_same_wars+this._opinion_zones+this._opinion_is_supreme+this._opinion_kings_mood+this._opinion_culture+this._opinion_traits}},t.prototype.areKingdomsClose=function(t,e){for(var i=0;i<t.cities.length;i++)for(var o=t.cities[i],a=0;a<e.cities.length;a++){var n=e.cities[a];if(r.default.nearbyBorders(o,n))return!0}return!1},t}();a.default=c,cc._RF.pop()},{}],KingdomStats:[function(t,e,i){"use strict";cc._RF.push(e,"3bf5axRgwtEKZQ/S4rd+T4C","KingdomStats");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.KingdomStatVal=void 0;var a=function(){function t(t){this.value=0,this.id="",this.id=t}return t.prototype.add=function(t){this.value+=t},t.prototype.set=function(t){this.value=t},t.prototype.clear=function(){this.value=0},t}();o.KingdomStatVal=a;var n=function(){function t(){this.list=[],this.dict=new Map,this.bonus_res_ore_amount=null,this.bonus_res_wood_amount=null,this.food_from_wheat=null,this.bonus_res_chance_wood=null,this.bonus_res_chance_ores=null,this.item_production_tries_weapons=null,this.item_production_tries_armor=null,this.mod_trading_bonus=null,this.bonus_damage=null,this.bonus_armor=null,this.bonus_max_cities=null,this.bonus_max_army=null,this.knowledge_gain=null,this.housing=null,this.culture_spread_speed=null,this.culture_spread_convert_chance=null,this.bonus_born_level=null,this.bonus_age=null,this.bonus_max_unit_level=null,this.bonus_watch_towers=null,this.bonus_watch_towers=this.newStat("bonus_watch_towers"),this.bonus_res_wood_amount=this.newStat("bonus_res_wood_amount"),this.bonus_res_chance_wood=this.newStat("bonus_res_chance_wood"),this.food_from_wheat=this.newStat("food_from_wheat"),this.bonus_res_ore_amount=this.newStat("bonus_res_ore_amount"),this.bonus_res_chance_ores=this.newStat("bonus_res_chance_ores"),this.item_production_tries_weapons=this.newStat("item_production_tries_weapons"),this.item_production_tries_armor=this.newStat("item_production_tries_armor"),this.mod_trading_bonus=this.newStat("mod_trading_bonus"),this.bonus_damage=this.newStat("bonus_damage"),this.bonus_armor=this.newStat("bonus_armor"),this.bonus_max_cities=this.newStat("bonus_max_cities"),this.bonus_max_army=this.newStat("bonus_max_army"),this.knowledge_gain=this.newStat("knowledge_gain"),this.housing=this.newStat("housing"),this.culture_spread_speed=this.newStat("culture_spread_speed"),this.culture_spread_convert_chance=this.newStat("culture_spread_convert_chance"),this.bonus_born_level=this.newStat("bonus_born_level"),this.bonus_age=this.newStat("bonus_age"),this.bonus_max_unit_level=this.newStat("bonus_max_unit_level")}return t.prototype.newStat=function(t){var e=new a(t);return this.list.push(e),this.dict.set(t,e),e},t.prototype.addStats=function(t){for(var e=0;e<t.list.length;e++){var i=t.list[e];0!=i.value&&(this.dict.get(i.id).value+=i.value)}},t.prototype.clear=function(){for(var t=0;t<this.list.length;t++)this.list[t].clear()},t}();o.default=n,cc._RF.pop()},{}],KingdomWindow:[function(t,e,i){"use strict";cc._RF.push(e,"7724crlcpBGSoL6QwbpsTJx","KingdomWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GamePopBase"),d=a("LocalizedTextManager"),u=a("ToolBox"),h=a("ViewController"),p=a("Config"),f=a("TextureLoader"),_=a("ToolTip"),m=a("CityInfoElement"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabCityInfo=null,e.txtName=null,e.population=null,e.army=null,e.cities=null,e.territory=null,e.buildings=null,e.banner=null,e.text_description=null,e.text_values=null,e.war_layout=null,e.allies_layout=null,e.layout_villages=null,e.buttonCapital=null,e.buttonKing=null,e.curKingdom=null,e}return r(e,t),e.prototype.start=function(){var t,e,i,o,a,n,r,s,c,h;if(p.default.selectedKingdom){this.curKingdom=p.default.selectedKingdom,this.showBanner(),this.txtName.string=this.curKingdom.data.name;var f=0,_=0;try{for(var m=l(this.curKingdom.cities),g=m.next();!g.done;g=m.next()){var y=g.value;_+=y.buildings.count,f+=y.zones.length}}catch(P){t={error:P}}finally{try{g&&!g.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}this.population.getChildByName("richText").getComponent(cc.RichText).string=""+this.curKingdom.getPopulationTotal(),this.buildings.getChildByName("richText").getComponent(cc.RichText).string=""+_,this.territory.getChildByName("richText").getComponent(cc.RichText).string=""+f,this.army.getChildByName("richText").getComponent(cc.RichText).string=this.curKingdom.countArmy()+"/"+this.curKingdom.countArmyMax();var v=p.default.selectedKingdom.getMaxCities(),b=this.curKingdom.cities.length+"/"+v;this.curKingdom.cities.length>v&&(b=u.Toolbox.coloredText(b,u.Toolbox.color_negative)),this.cities.getChildByName("richText").getComponent(cc.RichText).string=b,this.curKingdom.king?this.buttonKing.active=!0:this.buttonKing.active=!1,this.curKingdom.capital?this.buttonCapital.active=!0:this.buttonCapital.active=!1,this.layout_villages.destroyAllChildren(),this.curKingdom.cities.sort(this.citiesSorter.bind(this));try{for(var w=l(this.curKingdom.cities),T=w.next();!T.done;T=w.next()){var k=T.value;this.showElement(k)}}catch(O){i={error:O}}finally{try{T&&!T.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}var B=0,S=0;try{for(var C=l(p.default.selectedKingdom.units.list),x=C.next();!x.done;x=C.next()){var A=x.value;A.haveTrait("infected")?B++:A.haveTrait("plague")&&B++,A.data.hunger<=10&&S++}}catch(R){a={error:R}}finally{try{x&&!x.done&&(n=C.return)&&n.call(C)}finally{if(a)throw a.error}}this.text_description.string="",this.text_values.string="",this.showStat("kingdom_statistics_age",""+p.default.selectedKingdom.data.age),this.showStat("kingdom_statistics_born",""+p.default.selectedKingdom.data.born),this.showStat("kingdom_statistics_deaths",""+p.default.selectedKingdom.data.deaths),B>0&&this.showStat("kingdom_statistics_infected",""+B),S>0&&this.showStat("statistics_starving_people",""+S),this.text_description.string+="\n",this.text_values.string+="\n",this.showStat("kingdom_statistics_king",p.default.selectedKingdom.king?p.default.selectedKingdom.king.data.firstName:"",null===(s=null===(r=p.default.selectedKingdom)||void 0===r?void 0:r.kingdomColor)||void 0===s?void 0:s.colorBorderOut),p.default.selectedKingdom.king&&(this.showStat("creature_statistics_personality",d.LocalizedTextManager.getText("personality_"+p.default.selectedKingdom.king.s_personality.id)),this.showStat("kingdom_statistics_king_ruled",""+p.default.selectedKingdom.data.lastKingRuledFor)),this.showStat("kingdom_statistics_capital",p.default.selectedKingdom.capital?p.default.selectedKingdom.capital.data.cityName:"",null===(h=null===(c=p.default.selectedKingdom)||void 0===c?void 0:c.kingdomColor)||void 0===h?void 0:h.colorBorderOut),this.clearOldBanners(),this.loadWarBanners(),this.loadAlliedBanners()}},e.prototype.showBanner=function(){var t,e,i="banners/"+this.curKingdom.race.bannerId+"/background/banner_part_background"+u.Toolbox.randomInt(0,8),o="banners/"+this.curKingdom.race.bannerId+"/icon/banner_part_object"+u.Toolbox.randomInt(0,8),a=this.banner.getChildByName("bg").getComponent(cc.Sprite);a.node.color=null===(t=this.curKingdom.kingdomColor)||void 0===t?void 0:t.colorBorderOut,a.spriteFrame=f.TextureLoader.inst.getSpriteFrame(f.ATLAS_TYPE.WORLDATLAS,i);var n=this.banner.getChildByName("icon").getComponent(cc.Sprite);n.node.color=null===(e=this.curKingdom.kingdomColor)||void 0===e?void 0:e.colorBorderBannerIcon,n.spriteFrame=f.TextureLoader.inst.getSpriteFrame(f.ATLAS_TYPE.WORLDATLAS,o)},e.prototype.showStat=function(t,e,i){this.text_description.string+=d.LocalizedTextManager.getText(t)+"\n",this.text_values.string+=i?u.Toolbox.coloredString(e,i.toHEX())+"\n":e+"\n"},e.prototype.loadWarBanners=function(){var t=this,e=this.curKingdom.civs_enemies.size;if(0!=e){var i=0;this.curKingdom.civs_enemies.forEach(function(o,a){t.loadKingdomBannerFor(a,i,e,t.war_layout),i++})}},e.prototype.loadAlliedBanners=function(){var t=this,e=this.curKingdom.civs_allies.size;if(0!=e){var i=0;this.curKingdom.civs_allies.forEach(function(o,a){a!=t.curKingdom&&(t.loadKingdomBannerFor(a,i,e,t.allies_layout),i++)})}},e.prototype.loadKingdomBannerFor=function(t,e,i,o){var a,n,r="banners/"+t.race.bannerId+"/background/banner_part_background"+u.Toolbox.randomInt(0,8),s="banners/"+t.race.bannerId+"/icon/banner_part_object"+u.Toolbox.randomInt(0,8),l=new cc.Node;l.parent=o,l.attr({data:t}),l.addComponent(cc.Button),l.on("click",this.clickBanner,this),l.color=null===(a=t.kingdomColor)||void 0===a?void 0:a.colorBorderOut,l.addComponent(cc.Sprite).spriteFrame=f.TextureLoader.inst.getSpriteFrame(f.ATLAS_TYPE.WORLDATLAS,r);var c=new cc.Node;c.y=3,c.parent=l,c.color=null===(n=t.kingdomColor)||void 0===n?void 0:n.colorBorderBannerIcon,c.addComponent(cc.Sprite).spriteFrame=f.TextureLoader.inst.getSpriteFrame(f.ATLAS_TYPE.WORLDATLAS,s)},e.prototype.clearOldBanners=function(){this.war_layout.destroyAllChildren(),this.allies_layout.destroyAllChildren()},e.prototype.showElement=function(t){var e=cc.instantiate(this.prefabCityInfo);e.getComponent(m.default).initItem(t),e.parent=this.layout_villages},e.prototype.citiesSorter=function(t,e){return e.isCapitalCity()?1:t.isCapitalCity()?-1:t.getPopulationTotal()-e.getPopulationTotal()},e.prototype.clickKing=function(t){p.default.selectedUnit=p.default.selectedKingdom.king,h.default.open(h.view_type.CreatureInfo,null,t)},e.prototype.clickCapital=function(t){p.default.selectedCity=p.default.selectedKingdom.capital,h.default.open(h.view_type.CityWindow,null,t)},e.prototype.clickKingdom=function(t){h.default.open(h.view_type.KingdomList,null,t)},e.prototype.clickBanner=function(t){var e=t.node.data;_.default.info_kingdom=e,_.default.info_tip="kingdom",_.default.inst.show(t.node,"kingdom")},e.prototype.clickAttribute=function(t,e){var i=t.getCurrentTarget();_.default.info_tip=i.name,_.default.inst.show(i,"tip",i.name,e)},s([v(cc.Prefab)],e.prototype,"prefabCityInfo",void 0),s([v(cc.Label)],e.prototype,"txtName",void 0),s([v(cc.Node)],e.prototype,"population",void 0),s([v(cc.Node)],e.prototype,"army",void 0),s([v(cc.Node)],e.prototype,"cities",void 0),s([v(cc.Node)],e.prototype,"territory",void 0),s([v(cc.Node)],e.prototype,"buildings",void 0),s([v(cc.Node)],e.prototype,"banner",void 0),s([v(cc.RichText)],e.prototype,"text_description",void 0),s([v(cc.RichText)],e.prototype,"text_values",void 0),s([v(cc.Node)],e.prototype,"war_layout",void 0),s([v(cc.Node)],e.prototype,"allies_layout",void 0),s([v(cc.Node)],e.prototype,"layout_villages",void 0),s([v(cc.Node)],e.prototype,"buttonCapital",void 0),s([v(cc.Node)],e.prototype,"buttonKing",void 0),s([y],e)}(c.GamePopBase);n.default=b,cc._RF.pop()},{}],Kingdom:[function(t,e,i){"use strict";cc._RF.push(e,"5b32a//1eRJxK1+PkzcoKRQ","Kingdom");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.KingdomData=n.KingdomJob=n.KingdomEventState=void 0;var s,l=a("MathUtils"),c=a("AchievData"),d=a("ActorAsset"),u=a("ActorBase"),h=a("ActorJob"),p=a("AiSystem"),f=a("AssetManager"),_=a("BaseBuilding"),m=a("NameGenerator"),g=a("ToolBox"),y=a("MapBox"),v=a("HistoryHud"),b=a("ModModule"),w=a("DiplomacyRelation"),T=a("KingdomColors");(function(t){t[t.Idle=0]="Idle",t[t.NewAttack=1]="NewAttack",t[t.Wait=2]="Wait"})(s=n.KingdomEventState||(n.KingdomEventState={}));var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(h.JobAsset);n.KingdomJob=k;var B=function(){this.id="",this.name="",this.cultureID="",this.kingID="",this.capitalID="",this.raceID="",this.bannerSeed=-1,this.age=0,this.motto="",this.timer_loyalty=100,this.timer_no_city=0,this.timer_settle_target=100,this.timer_event=100,this.timer_attack_target=100,this.timer_new_king=10,this.colorID=-1,this.eventState=s.Idle,this.deaths=0,this.born=0,this.saved_allies=[],this.saved_enemies=[],this.lastKingRuledFor=0,this.check_for_independence=!1,this.alive=!0,this.count_cities=0,this.count_units=0};n.KingdomData=B;var S=function(){function t(){this.hashcode=0,this.asset=null,this.data=new B,this.timer_action=0,this.race=null,this.king=null,this.cities=[],this.units=new u.ActorContainer,this.buildings=new _.BuildingContainer,this.capital=null,this.allies=new Map,this.civs_allies=new Map,this.enemies=new Map,this.civs_enemies=new Map,this.target_kingdom=null,this.target_city=null,this.settlerTarget=null,this.ai=null,this.location=cc.Vec3.ZERO}return t.prototype.createHidden=function(){var t;this.kingdomColor=this.asset.default_kingdom_color,null===(t=this.kingdomColor)||void 0===t||t.initColor()},t.prototype.createAI=function(){this.ai=new p.AiSystemKingdom(this),this.ai.nextJobDelegate=this.getNextJob,this.ai.jobs_library=f.default.job_kingdom,this.ai.task_library=f.default.tasks_kingdom},t.initWithData=function(e){var i=new t;return i.data=e,i},t.prototype.getNextJob=function(){return"kingdom"},t.prototype.isCiv=function(){return this.asset.civ},t.prototype.isNature=function(){return this.asset.nature},t.prototype.isNomads=function(){return this.asset.nomads},t.prototype.save=function(){var t=this;return this.data.saved_allies=[],this.data.saved_enemies=[],this.allies.forEach(function(e,i){i.isCiv()&&i!=t&&t.data.saved_allies.push(i.data.id)}),this.enemies.forEach(function(e,i){i.isCiv()&&i!=t&&t.data.saved_enemies.push(i.data.id)}),this.data.count_cities=this.cities.length,this.data.count_units=this.units.length,this.data},t.prototype.isEnemy=function(t){return!t||(this.isCiv()&&t.isCiv()?t!=this&&!this.allies.has(t):!!this.asset.isFoe(t.asset))},t.prototype.createCiv=function(e,i){void 0===i&&(i=""),this.race=e,this.data.raceID=e.id,this.asset=f.default.kingdoms.get(this.data.raceID),""==i&&(this.data.id=y.default.inst.mapStats.getNextId("kingdom")),this.createColors(),t.kingdoms++},t.prototype.logicUpdate=function(){this.buildings.checkAddRemove(),this.units.checkAddRemove()},t.prototype.updateCiv=function(t){0==this.cities.length?(this.data.timer_no_city+=t,0==this.units.length&&(this.data.timer_no_city=1e3)):this.data.timer_no_city=0,this.data.timer_attack_target>0&&(this.data.timer_attack_target-=t),this.data.timer_settle_target>0&&(this.data.timer_settle_target-=t),this.data.timer_loyalty>0&&(this.data.timer_loyalty-=t),this.data.timer_new_king>0&&(this.data.timer_new_king-=t),this.data.timer_event>0&&(this.checkRelationships(),this.data.timer_event-=t,this.data.timer_event<=0&&this.data.eventState==s.Wait&&(this.clearTarget(),this.data.eventState=s.Idle,this.data.timer_event=200+g.Toolbox.randomFloat(0,100))),this.ai&&(this.timer_action>0?this.timer_action-=t:this.ai.logicUpdate(t))},t.prototype.checkRelationships=function(){t._temp_kingdoms=[],this.civs_allies.forEach(function(e,i){0==i.cities.length&&0==i.getPopulationTotal()&&t._temp_kingdoms.push(i)}),this.civs_enemies.forEach(function(e,i){0==i.cities.length&&0==i.getPopulationTotal()&&t._temp_kingdoms.push(i)}),t._temp_kingdoms.forEach(function(t){y.default.inst.kingdoms.destroyKingdom(t)})},t.prototype.addUnit=function(t){var e;if(!this.units.has(t))switch(this.units.add(t),!this.race&&t.race.civilization&&(this.race=t.race),null===(e=this.race)||void 0===e?void 0:e.id){case"human":c.default.update(58,this.units.length,!0);break;case"orc":c.default.update(59,this.units.length,!0);break;case"dwarf":c.default.update(60,this.units.length,!0);break;case"elf":c.default.update(61,this.units.length,!0)}},t.prototype.removeUnit=function(t){this.units.remove(t),t==this.king&&this.removeKing(),this.checkKingdomDead()},t.prototype.setKing=function(t){this.king=t,this.king.setProfession(d.UnitProfession.King),this.data.kingID=this.king.data.actorID},t.prototype.removeKing=function(){this.king&&this.king.setProfession(d.UnitProfession.Unit),this.king=null,this.data.kingID=null,this.data.timer_new_king=g.Toolbox.randomFloat(5,20)},t.prototype.removeCity=function(t){t.isCapitalCity()&&(this.capital=null,this.data.capitalID=null),this.cities.remove(t),this.checkKingdomDead()},t.prototype.capturedFrom=function(t){y.default.inst.kingdoms.diplomacyManager.getRelation(this,t)},t.prototype.addCity=function(t){this.cities.push(t),""==this.data.name&&(this.data.name=m.default.getName(this.race.name_template_kingdom)),t==this.target_city&&(this.data.timer_attack_target=0),c.default.update(23,this.cities.length,!0)},t.prototype.generateMotto=function(){this.data.motto=m.default.getName("kingdom_mottos")},t.prototype.load1=function(){-1==this.data.bannerSeed&&(this.data.bannerSeed=g.Toolbox.randomInt(0,1e6)),this.createColors(this.data.colorID),!this.race&&this.data.raceID&&(this.race=f.default.raceLibrary.get(this.data.raceID),this.asset=f.default.kingdoms.get(this.data.raceID))},t.prototype.load2=function(){t.kingdoms++,this.capital=y.default.inst.getCityByID(this.data.capitalID),this.capital&&(this.location=this.capital.cityCenter),this.king=y.default.inst.getActorByID(this.data.kingID),this.king&&this.king.setProfession(d.UnitProfession.King);for(var e=0;e<this.data.saved_allies.length;e++){var i=this.data.saved_allies[e],o=y.default.inst.kingdoms.getKingdomByID(i);o&&y.default.inst.kingdoms.setDiplomacyState(this,o,w.DiplomacyState.Ally)}for(e=0;e<this.data.saved_enemies.length;e++){i=this.data.saved_enemies[e];var a=y.default.inst.kingdoms.getKingdomByID(i);a&&y.default.inst.kingdoms.setDiplomacyState(this,a,w.DiplomacyState.War)}this.isCiv()&&this.createAI()},t.prototype.createColors=function(t){void 0===t&&(t=-1);var e=T.default.getContainer(this.data.raceID);e&&(e.prepare(this),this.data.colorID=t,-1==this.data.colorID&&(this.data.colorID=e.curColor),this.kingdomColor=T.default.getColor(this.data.raceID,this.data.colorID),-1==this.data.bannerSeed&&(this.data.bannerSeed=g.Toolbox.randomInt(0,1e6)))},t.prototype.findCityTarget=function(){if(!(this.target_city&&this.target_city.alive&&this.target_city.kingdom.isEnemy(this))&&this.capital){this.target_city=null;var t=0;this.target_city=null;for(var e=0;e<this.target_kingdom.cities.length;e++){var i=this.target_kingdom.cities[e],o=g.Toolbox.distVec3(this.capital.cityCenter,i.cityCenter);0!=i.zones.length&&(!this.target_city||o<t)&&(this.target_city=i,t=o)}this.target_city||this.clearTarget()}},t.prototype.checkKingdomDead=function(){this.isCiv()&&0==this.getPopulationTotal()&&0==this.cities.length&&(b.default.inst.kingdom&&v.default.inst.removeInvade(b.default.inst.kingdom,this),y.default.inst.kingdoms.destroyKingdom(this))},t.distanceBetweenKingdom=function(t,e){for(var i=-1,o=0;o<t.cities.length;o++)for(var a=t.cities[o],n=0;n<e.cities.length;n++){var r=e.cities[n],s=g.Toolbox.distVec3(a.cityCenter,r.cityCenter);(-1==i||s<i)&&(i=s)}return i},t.prototype.clear=function(){this.buildings.clear(),this.units.clear(),this.allies.clear(),this.enemies.clear(),this.civs_allies.clear(),this.civs_enemies.clear()},t.prototype.setDiplomacyState=function(t,e){switch(e){case w.DiplomacyState.War:this.enemies.set(t,!0),this.isCiv()&&t.isCiv()&&this.civs_enemies.set(t,!0);break;case w.DiplomacyState.Ally:this.allies.set(t,!0),this.isCiv()&&t.isCiv()&&this.civs_allies.set(t,!0);break;case w.DiplomacyState.Clear:this.allies.delete(t),this.enemies.delete(t),this.isCiv()&&t.isCiv()&&(this.civs_allies.delete(t),this.civs_enemies.delete(t))}w.DiplomacyState.Ally},t.prototype.hasEnemies=function(){return this.civs_enemies.size>0},t.prototype.checkTarget=function(){var t;!this.target_kingdom||this.target_kingdom.isEnemy(this)?((null===(t=this.target_city)||void 0===t?void 0:t.alive)&&this.target_city.kingdom!=this&&this.target_city.kingdom.isEnemy(this)||(this.target_city=null),this.target_city||this.findCityTarget()):this.clearTarget()},t.prototype.clearTarget=function(){this.target_city=null,this.target_kingdom=null},t.prototype.makeSurvivorsToNomads=function(){var t,e;if(0!=this.units.length){for(var i=0;i<this.units.list.length;i++){var o=this.units.list[i];if(null===(t=o.data)||void 0===t?void 0:t.alive){if("boat"==(null===(e=o.stats)||void 0===e?void 0:e.race)){o.killHimself(!0);continue}o.cancelAllBeh(),o.removeFromCity(),o.removeFromGroup(),o.setKingdom(y.default.inst.kingdoms.dict_hidden.get("nomads_"+o.stats.race))}}this.units.clear()}},t.prototype.clearKingData=function(){this.king=null,this.data.lastKingRuledFor>4&&(this.data.check_for_independence=!0),this.data.lastKingRuledFor=0},t.prototype.updateAge=function(){this.data.age++,this.king&&this.data.lastKingRuledFor++},t.prototype.newCityBuiltEvent=function(t){for(var e=0;e<this.cities.length;e++)this.cities[e].forceSettleTarget(t)},t.prototype.getPopulationTotal=function(){for(var t=this.units.length,e=0;e<this.cities.length;e++)t+=this.cities[e].getPopulationPopPoints();return t},t.prototype.countArmy=function(){for(var t=0,e=0;e<this.cities.length;e++)t+=this.cities[e].getArmy();return t},t.prototype.countArmyMax=function(){for(var t=0,e=0;e<this.cities.length;e++)t+=this.cities[e].getArmyMaxCity();return t},t.prototype.getMaxCities=function(){var t=this.race.civ_baseCities;this.king&&(t+=this.king.curStats.cities);var e=this.getCulture();return e&&(t+=l.default.intCast(e.stats.bonus_max_cities.value)),t},t.prototype.diceAgressionSuccess=function(){return!!this.king&&(this.cities.length<this.getMaxCities()||!!(this.cities.length>=this.getMaxCities()&&g.Toolbox.randomChance(this.king.curStats.personality_aggression)))},t.prototype.getCulture=function(){return this.data.cultureID?y.default.inst.cultures.get(this.data.cultureID):null},t.kingdoms=0,t._temp_kingdoms=[],t}();n.default=S,cc._RF.pop()},{}],LavaLayer:[function(t,e,i){"use strict";cc._RF.push(e,"09e47YtpfNKvIh9PMHVSQjM","LavaLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("GameCommon"),d=a("MapAction"),u=a("AssetManager"),h=a("TileLibrary"),p=a("BaseObjectData"),f=a("ToolBox"),_=a("MapBox"),m=a("TileTypeBase"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxLavaLevel=3,e.maxTicksToRemove=15,e.stopLavaUpdate=!1,e.lavaTypes=new Map,e._lavaIslands=[],e}return r(e,t),e.prototype.onLoad=function(){this.lavaTypes.set(0,h.default.lava0),this.lavaTypes.set(1,h.default.lava1),this.lavaTypes.set(2,h.default.lava2),this.lavaTypes.set(3,h.default.lava3),t.prototype.create.call(this)},e.prototype.loadLavaTile=function(t){t.lavaTick=0},e.prototype.increaseLava=function(t){t.type.lavaLevel<=this.maxLavaLevel&&(t.type.lavaLevel<this.maxLavaLevel?this.changeLavaTile(t,this.lavaTypes.get(t.type.lavaLevel+1)):this.changeLavaTile(t,this.lavaTypes.get(this.maxLavaLevel)))},e.prototype.decreaseLava=function(t){t.type.lavaLevel<=this.maxLavaLevel&&(t.type.lavaLevel>0?this.changeLavaTile(t,this.lavaTypes.get(t.type.lavaLevel-1)):this.putOut(t))},e.prototype.addLava=function(t,e){void 0===e&&(e="lava3"),t.type.lavaLevel<this.maxLavaLevel&&(t.type.explodable&&t.type.burnable&&(this.stopLavaUpdate=!0),t.setFire(),d.default.terraformMain(t,u.default.tiles.get(e),u.default.terraform.get("lavaDamage")))},e.prototype.changeLavaTile=function(t,e){var i="string"==typeof e?u.default.tiles.get(e):e;t.type!=i&&d.default.terraformMain(t,i,u.default.terraform.get("lavaDamage"))},e.prototype.lavaEffect=function(){},e.prototype.logicUpdate=function(){this.updateLava()},e.prototype.updateLava=function(){var t,e;if(!c.default.isPaused)if(this.timer>0)this.timer-=_.default.inst.elapsed;else{this.stopLavaUpdate=!1,this.timer=.05,this._lavaIslands=[];for(var i=0;i<_.default.inst.islandsCalculator.islands.length;i++){var o=_.default.inst.islandsCalculator.islands[i];o.type==m.TileLayerType.Lava&&this._lavaIslands.push(o)}for(i=0;i<this._lavaIslands.length;i++){var a=this._lavaIslands[i].regions.getRandom();try{for(var n=(t=void 0,l(a.tiles)),r=n.next();!r.done;r=n.next()){var s=r.value;if(!f.Toolbox.randomBool())if(s.building&&s.building.stats.affectedByLava&&s.building.getHit(10),s.type.lavaLevel>1){if(s.lavaTick>0)s.lavaTick--;else if(f.Toolbox.randomBool()){if(this.moveLava(s),this.stopLavaUpdate)break;s.flash_state<=0&&Math.random()>.995&&s.setFire(!0)}}else 1!=s.type.lavaLevel||_.default.inst.worldLaws.world_law_forever_lava.boolVal?0!=s.type.lavaLevel||_.default.inst.worldLaws.world_law_forever_lava.boolVal?s.lavaTick=0:(s.lavaTick++,s.lavaTick>10&&this.changeLavaTile(s,"hills")):(s.lavaTick++,s.lavaTick>5&&this.changeLavaTile(s,this.lavaTypes.get(0)))}}catch(h){t={error:h}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}}},e.prototype.moveLava=function(t){var e=this,i=null;return t.neighbours.shuffle(),t.neighbours.forEach(function(o){o.type.lava||(o.type.frozen?d.default.unfreezeTile(o):o.setFire()),o.type.render_z<=t.type.render_z&&o.type.lavaLevel!=t.type.lavaLevel&&(!o.type.lava||o.type.lavaLevel<e.maxLavaLevel)&&(!i||i.type.render_z>o.type.render_z)&&(i=o)}),i?(t.type.lavaLevel>0&&this.changeLavaTile(t,this.lavaTypes.get(t.type.lavaLevel-1)),-1==i.type.lavaLevel?this.changeLavaTile(i,this.lavaTypes.get(1)):this.changeLavaTile(i,this.lavaTypes.get(i.type.lavaLevel+1)),i.lavaTick=0,t.lavaTick=0,_.default.inst.flashEffects.flashPixel(i,10),this.lavaEffect(i),!0):(t.lavaTick=30,!1)},e.prototype.putOut=function(t){d.default.increaseTile(t)},e.prototype.removeLava=function(t){d.default.decreaseTile(t)},s([v],e.prototype,"maxLavaLevel",void 0),s([v],e.prototype,"maxTicksToRemove",void 0),s([y],e)}(p.BaseModule);n.default=b,cc._RF.pop()},{}],LuckyWheel:[function(t,e,i){"use strict";cc._RF.push(e,"5b997plIjNHMoicTcfQtr/X","LuckyWheel");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("Constants"),d=a("AdsManager"),u=a("RewardData"),h=a("UserData"),p=a("GamePopBase"),f=a("MsgCache"),_=a("AssetManager"),m=a("ToolBox"),g=a("ViewController"),y=a("TextureLoader"),v=a("GuideController"),b=a("AwardView"),w=cc._decorator,T=w.ccclass,k=w.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnStart=null,e.videoNode=null,e.btnClose=null,e.ruleBg=null,e.wheelPointer=null,e.selectFrame=null,e.rewardParents=[],e.cumulative=null,e.rewards=[],e.startIdx=4,e}return r(e,t),e.prototype.onLoad=function(){this.videoNode.active=h.default.member.luckyWheelCount>0,this.btnStart.interactable=!1,this.cumulative.active=QQ_GAME},e.prototype.clickRule=function(){this.ruleBg.active=!this.ruleBg.active},e.prototype.start=function(){this.reset()},e.prototype.reset=function(){for(var t=this,e=0;e<this.rewardParents.length;e++){var i=this.rewardParents[e];this.rewards[e]=u.default.getRewards(this.startIdx+e),this.fillRewards(this.rewards[e],i)}this.scheduleOnce(function(){t.wheelPointer.angle=0,t.btnClose.interactable=!0,t.btnStart.interactable=!0},.5)},e.prototype.fillRewards=function(t,e){for(var i=0;i<t.length;i++){var o=e.getChildByName("item"+i);if(o){var a=h.default.getPropConfigByID(t[i].propID),n=o.getChildByName("rare");if(n.active=a.rare>=0,n.active){var r=y.TextureLoader.inst.getSpriteFrame(y.ATLAS_TYPE.UIATLAS,"reward/rare_"+a.rare);r&&(n.getComponent(cc.Sprite).spriteFrame=r)}var s=o.getChildByName("icon"),l="propIcon/"+_.default.powers.dict.get(t[i].propID).icon,c=y.TextureLoader.inst.getSpriteFrame(y.ATLAS_TYPE.UIATLAS,l);c&&(s.getComponent(cc.Sprite).spriteFrame=c),o.getChildByName("num").getComponent(cc.Label).string="X"+t[i].reward}}},e.prototype.onClickStart=function(t){var e=this,i=t.getCurrentTarget().getComponent(cc.Button);if(i.interactable=!1,!this.videoNode.active)return v.default.inst.in(v.GUIDE_TYPE.luckyWheel,1)&&v.default.inst.do(v.GUIDE_TYPE.luckyWheel),void this.startTurn();c.default.REPORT_ID="luckyWheel",d.default.showVideoAds(function(t){if(1==t)e.startTurn();else{i.interactable=!0;var o=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";f.default.pushToast(o)}})},e.prototype.startTurn=function(){this.btnClose.interactable=!1,this.btnStart.interactable=!1;var t=4+m.Toolbox.randomFloat(0,3),e=1.5*t,i=this.wheelPointer.angle+360*e+m.Toolbox.randomFloat(0,360);cc.tween(this.wheelPointer).to(t,{angle:i},{easing:"sineInOut"}).call(this.stopTurn.bind(this)).start()},e.prototype.stopTurn=function(){var t=this;this.wheelPointer.angle%=360;var e=this.selectFrame.angle/60;e=l.default.clamp(e,0,5),h.default.member.luckyWheelCount++,h.default.save(),setTimeout(function(){g.default.open(g.view_type.AwardView,null,null,!0,function(i){i.getComponent(b.default).init(b.Reward_type.luckyWheel,t.rewards[e]),t.reset(),t.videoNode.active=!0})},1e3)},e.prototype.update=function(){this.selectFrame.angle=60*Math.floor((this.wheelPointer.angle+30)/60)%360},s([k({type:cc.Button,tooltip:"\u5f00\u59cb\u6309\u94ae"})],e.prototype,"btnStart",void 0),s([k(cc.Node)],e.prototype,"videoNode",void 0),s([k(cc.Button)],e.prototype,"btnClose",void 0),s([k({type:cc.Node,tooltip:"\u6982\u7387\u516c\u793a\u7a97\u53e3"})],e.prototype,"ruleBg",void 0),s([k({type:cc.Node,tooltip:"\u8f6e\u76d8\u8f6c\u52a8\u6307\u9488"})],e.prototype,"wheelPointer",void 0),s([k({type:cc.Node,tooltip:"\u9009\u62e9\u6846"})],e.prototype,"selectFrame",void 0),s([k({type:[cc.Node],tooltip:"\u5956\u52b1item\u7684\u7236\u8282\u70b9"})],e.prototype,"rewardParents",void 0),s([k(cc.Node)],e.prototype,"cumulative",void 0),s([T],e)}(p.GamePopBase);n.default=B,cc._RF.pop()},{}],MapAction:[function(t,e,i){"use strict";cc._RF.push(e,"a607cQX7/NBM6pdzi0UCvTF","MapAction");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MathUtils"),r=o("AchievData"),s=o("ActorAsset"),l=o("GodFinger"),c=o("Tornado"),d=o("AssetManager"),u=o("TerraformLibrary"),h=o("TopTileLibrary"),p=o("Brush"),f=o("ToolBox"),_=o("Config"),m=o("TileTypeBase"),g=o("WorldTile"),y=o("MapBox"),v=function(){function t(){}return t.checkAcidTerraform=function(e){var i;null!==(i=e.top_type)&&void 0!==i&&i.wasteland||(e.top_type?t.decreaseTile(e):e.type.ground&&(e.main_type.rankType==m.TileRank.Low?t.terraformTop(e,h.default.wasteland_low):e.main_type.rankType==m.TileRank.High&&t.terraformTop(e,h.default.wasteland_high)))},t.terraformMain=function(e,i,o){void 0===o&&(o=null);var a=o||u.default.flash;t.terraformTile(e,i,null,a)},t.terraformTop=function(e,i,o){void 0===o&&(o=null);var a=o||u.default.flash;t.terraformTile(e,e.main_type,i,a)},t.terraformTile=function(e,i,o,a){var n,r,s,l,c,d,h;a||(a=u.default.flash);var p=e.type.layerType,f=e.type.rocks,_=e.type;if(a.removeWater&&e.type.ocean&&(i=e.type.decreaseTo),a.removeTopTile&&e.top_type&&(i=e.type.decreaseTo),a.removeRoads&&e.type.road&&(i=e.type.decreaseTo),a.removeFrozen&&e.type.frozen&&(i=e.type.decreaseTo),i&&e.setTileType(i),e.setTopTileType(o),_.canBeFarmField!=e.type.canBeFarmField&&y.default.inst.cityPlaceFinder.setDirty(),p!=e.type.layerType||f!=e.type.rocks){y.default.inst.mapChunkManager.setDirty(e.chunk);for(var m=0;m<e.chunk.neighboursAll.length;m++){var g=e.chunk.neighboursAll[m];y.default.inst.mapChunkManager.setDirty(g,!1)}}if(a.removeTornado&&t.tryRemoveTornadoFromTile(e),(e.burned_stages>0&&!e.type.canBeSetOnFire||a.removeBurned)&&e.removeBurn(),0!=e.type.layerType&&y.default.inst.checkCityZone(e),y.default.inst.redrawTimer=-1,a.removeBorders&&y.default.inst.checkCityZone(e),a.flash&&y.default.inst.flashEffects.flashPixel(e,20),(null===(s=null===(r=null===(n=e.building)||void 0===n?void 0:n.stats)||void 0===r?void 0:r.canBePlacedOnlyOn)||void 0===s?void 0:s.length)>0){for(var v=!1,b=0;b<e.building.stats.canBePlacedOnlyOn.length;b++){var w=e.building.stats.canBePlacedOnlyOn[b];if(e.type.isType(w)){v=!0;break}}if(!v)return void(e.type.liquid||e.type.canBeFilledWithOcean?e.building.startDestroyBuilding(!0):e.building.startDestroyBuilding(a.removeBuilding))}if(a.destroyBuildings&&e.building){var T=!1;if((null===(l=a.ignoreKingdoms)||void 0===l?void 0:l.length)>0){T=!0;for(var k=0;k<a.ignoreKingdoms.length;k++)if(a.ignoreKingdoms[k]==(null===(c=e.building.kingdom)||void 0===c?void 0:c.data.name)){T=!1;break}}else if((null===(d=a.destroyOnly)||void 0===d?void 0:d.length)>0){T=!1;for(var B=0;B<a.destroyOnly.length;B++)if(a.destroyOnly[B]==e.building.stats.race){T=!0;break}}else if((null===(h=a.ignoreBuildings)||void 0===h?void 0:h.length)>0)for(var S=0;S<a.ignoreBuildings.length;S++){var C=a.ignoreBuildings[S];if(e.building.stats.id!=C){T=!0;break}}else T=!0;T&&e.building.startDestroyBuilding(a.removeBuilding)}else e.building&&!e.building.stats.canBePlacedOnLiquid&&e.type.liquid&&e.building.startDestroyBuilding(!0)},t.setOcean=function(e){e.type.fillToOcean&&t.terraformMain(e,d.default.tiles.get(e.type.fillToOcean),d.default.terraform.get("water_fill"))},t.decreaseTile=function(e,i){void 0===i&&(i="flash");var o=i instanceof u.TerraformOptions?i:d.default.terraform.get(i);e.top_type?t.terraformTile(e,e.main_type,null,o):e.type.decreaseTo&&t.terraformMain(e,e.type.decreaseTo,o)},t.increaseTile=function(e,i){void 0===i&&(i="flash"),e.top_type?t.terraformTile(e,e.main_type,null,d.default.terraform.get(i)):e.type.increaseTo&&t.terraformMain(e,e.type.increaseTo,d.default.terraform.get(i))},t.removeLiquid=function(e){e.type.liquid&&(y.default.inst.setTileDirty(e),t.decreaseTile(e))},t.growGreens=function(e,i){t.terraformTop(e,i,u.default.flash)},t.removeGreens=function(e){t.decreaseTile(e)},t.applyLightningEffect=function(e){if(e.type.lava&&e.heat>20&&(t.decreaseTile(e),f.Toolbox.randomChance(.9)&&y.default.inst.dropManager.spawnBurstPixel(e,"lava",f.Toolbox.randomFloat(.2,1.4),f.Toolbox.randomFloat(.5,1.6))),e.type.layerType==m.TileLayerType.Ocean&&(t.removeLiquid(e),f.Toolbox.randomChance(.8)&&y.default.inst.dropManager.spawnBurstPixel(e,"rain",f.Toolbox.randomFloat(.2,1.4),f.Toolbox.randomFloat(.5,1.6))),e.building&&("volcano"==e.building.stats.id||"geyser"==e.building.stats.id||"geyserAcid"==e.building.stats.id)&&(e.building.spawnBurstSpecial(10,4,1.9),e.building.data.spawnPixelActive=!e.building.data.spawnPixelActive,"volcano"==e.building.stats.id&&t.achievementLightningTimes)){var i=cc.sys.now();t.achievementLightningTimes.push(i),i-t.achievementLightningTimes[0]>1e4?t.achievementLightningTimes.shift():t.achievementLightningTimes.length>=20&&(r.default.update(32,20,!0),t.achievementLightningTimes=null)}},t.applyTileDamage=function(e,i,o){y.default.inst.redrawTimer=-1;var a=p.default.getBrushBySize(n.default.intCast(i));y.default.inst.conwayLayer.checkKillRange(e.pos,a.size),o.removeTornado&&t.tryRemoveTornadoFromTile(e),y.default.inst.waveController.checkTile(e,a.size),y.default.inst.cloudController.checkTile(e,a.size);for(var r=0;r<a.pos.length;r++){var s=a.pos[r],l=e.pos.x+s.x,c=e.pos.y+s.y;if(!(l<0||l>=y.default.width||c<0||c>=y.default.height)){var d=y.default.inst.getTileSimple(l,c);if(d.type.greyGoo&&(_.default.greyGooDamaged=!0),o.addBurned&&!d.type.liquid&&d.setBurned(),o.lightningEffect&&t.applyLightningEffect(d),0!=o.addHeat&&y.default.inst.heat.addTile(d,o.addHeat),d.building&&o.damageBuildings){var u=!0;if(o.ignoreKingdoms)for(var h=0;h<o.ignoreKingdoms.length;h++){var f=o.ignoreKingdoms[h];d.building&&d.building.data.alive&&!d.building.kingdom.isNature()&&(d.building.kingdom,d.building.kingdom.data.id==f&&(u=!1))}u&&d.building.getHit(o.damage)}o.setFire&&d.setFire(!0);var m=!1;if(o.explode_tile&&(m=this.explodeTile(d,s.dist,i,e,o)),o.transformToWasteland&&!m&&t.checkAcidTerraform(d),!(d.units.length<=0)&&o.addTrait)for(var g=0;g<d.units.length;g++){var v=d.units[g];v.data.alive&&v.addTrait(o.addTrait)}}}},t.explodeTile=function(e,i,o,a,r){var s;if(r.damage>0)for(var l=0;l<e.units.length;l++){var c=e.units[l];(null==c?void 0:c.stats)&&((null===(s=c.stats)||void 0===s?void 0:s.very_high_flyer)&&!r.applies_to_high_flyers||c.getHit(r.damage))}var d,h=1-(d=i/o),p=n.default.intCast(30*h);if(p<=0)return!1;var f=e.type.liquid;return r.spawnPixels&&this.pixelLimit<30&&Math.random()>.8&&(t.pixelLimit++,y.default.inst.dropManager.spawnPixel(e,a,!0)),!(!e.type.explodable&&Math.random()>h||(y.default.inst.gameStats.pixelsExploded++,r.explosion_pixel_effect&&y.default.inst.explosionLayer.setDirty(e,i,o),p-=n.default.intCast(.5*p*Math.random()*d),e.type.explodable&&0==e.explosionWave&&y.default.inst.explosionLayer.explodeBomb(e),e.type.explodableDelayed&&y.default.inst.explosionLayer.activateDelayedBomb(e),e.type.strength<=r.explode_strength&&t.decreaseTile(e,u.default.destroy),e.building&&e.type.liquid&&!e.building.stats.canBePlacedOnLiquid&&e.building.startDestroyBuilding(!0),f||(e.setBurned(),r.explode_and_set_random_fire&&(Math.random()>.8?e.setFire(!0):e.setFire())),0))},t.damageWorld=function(e,i,o){o.shake&&y.default.inst.startShake(o.shake_duration,o.shake_interval,o.shake_intensity),o.applyForce&&y.default.inst.applyForce(e,i,o.force_power,!0,!1,o.damage,o.ignoreKingdoms,null,o),t.applyTileDamage(e,i,o)},t.wormTile=function(e,i){if(y.default.inst.flashEffects.flashPixel(e,20),e.health-=i,!(e.health>0)&&(e.health=0,e.type.increaseTo)){var o=e.type.increaseTo.id.startsWith("mountain",4),a=e.type.increaseTo.id.startsWith("hill",4);e.type.id.startsWith("road",4)||(o||a||e.type.decreaseTo&&!f.Toolbox.randomBool()?e.type.decreaseTo&&t.decreaseTile(e,"destroy"):t.increaseTile(e,"destroy"))}},t.makeTileChanged=function(){y.default.inst.redrawTimer=-1},t.removeLifeFromTile=function(e){var i,o,a,n;y.default.inst.conwayLayer.remove(e),e.type.life&&t.decreaseTile(e,"destroy_life"),null===(o=null===(i=e.building)||void 0===i?void 0:i.city)||void 0===o||o.killRandomPopPoints();for(var r=0;r<e.units.length;r++){var s=e.units[r];(null===(a=s.base_data)||void 0===a?void 0:a.alive)&&s.isActor()&&(null===(n=s.a)||void 0===n?void 0:n.stats.canBeKilledByLifeEraser)&&s.killHimself()}},t.freezeTile=function(e){if(e.type.freezeToID){var i=d.default.topTiles.get(e.type.freezeToID);t.terraformTop(e,i)}e.type.remove_on_freeze&&e.top_type&&t.terraformTop(e,null),e.building&&e.building.stats.spawnPixel&&(e.building.data.spawnPixelActive=!1)},t.unfreezeTile=function(e){var i,o;e.type.frozen&&t.terraformTop(e,null),e.type.remove_on_heat&&e.top_type&&t.terraformTop(e,null),null!==(o=null===(i=e.building)||void 0===i?void 0:i.stats.spawnPixel)&&void 0!==o&&o&&(e.building.data.spawnPixelActive=!0)},t.createRoad=function(e,i,o,a){if(void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=!1),e instanceof g.default)t.terraformTop(e,h.default.road,d.default.terraform.get("road"));else{if(e.length>20)return;if(t.temp_list_tiles2=[],o.roadIsland&&o.roadIsland==i.roadIsland)return;for(var n=0;n<e.length;n++){var r=e[n];if(!r.type.road){if(i!=r&&i.roadIsland&&r.roadIsland==o.roadIsland)return;t.temp_list_tiles2.push(r),a&&t.createRoad(r)}}y.default.inst.redrawTimer=-1}},t.makeRoadBetween=function(e,i,o,a){void 0===o&&(o=null),void 0===a&&(a=!1),e.roadIsland&&e.roadIsland==i.roadIsland||(t.temp_list_tiles=[],y.default.inst.pathfindingParam.resetParam(),y.default.inst.pathfindingParam.roads=!0,y.default.inst.calcPath(e,i,t.temp_list_tiles),t.createRoad(t.temp_list_tiles,e,i,a),o&&o.addRoads(t.temp_list_tiles2))},t.tryRemoveTornadoFromTile=function(t){for(var e,i,o,a=0;a<t.units.length;){var n=t.units[a++];(null===(e=null==n?void 0:n.base_data)||void 0===e?void 0:e.alive)&&n.isActor()&&(null===(o=null===(i=n.a)||void 0===i?void 0:i.stats)||void 0===o?void 0:o.flag_tornado)&&n.getComponent(c.default).killTornado()}},t.checkSantaHit=function(t,e){var i=y.default.inst.kingdoms.getKingdomByID("santa");if(0!=i.units.length)for(var o=i.units.getSimpleList(),a=0;a<o.length;a++){var n=o[a];if(n.data.alive){var s=n.node.position;f.Toolbox.dist(t.x,0,s.x,0)>e||s.y<t.y||s.y-20>t.y||(n.data.health=0,r.default.update(49))}}},t.checkUFOHit=function(t,e){var i=y.default.inst.kingdoms.getKingdomByID("aliens");if(0!=i.units.length)for(var o=i.units.getSimpleList(),a=0;a<o.length;a++){var n=o[a];!n.data.alive||f.Toolbox.dist(t.x,0,n.node.x,0)>e||n.node.y<t.y||n.node.y-10>t.y||!n.stats.flag_ufo||(n.getHit(1e4),n.killHimself(!1,s.AttackType.None,!1))}},t.checkLightningAction=function(t,e){for(var i=!1,o=y.default.inst.units.getSimpleList(),a=0;a<o.length;a++){var n=o[a];if(f.Toolbox.distVec2(n.currentTile.pos,t)<=e)if("godFinger"==n.stats.id)n.getComponent(l.default).lightAction();else if("tornado"==n.stats.id){if(n.getComponent(c.default).split(!0))break}else n.haveTrait("immortal")||i||!f.Toolbox.randomChance(.2)||(n.addTrait("immortal"),n.addTrait("energized"),i=!0)}},t.pixelLimit=0,t.temp_list_tiles=[],t.temp_list_tiles2=[],t.achievementLightningTimes=[],t}();a.default=v,cc._RF.pop()},{}],MapBorder:[function(t,e,i){"use strict";cc._RF.push(e,"4ed09wfX/VLyIzzK2gz5SRf","MapBorder");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MapBorder=void 0;var l=a("MapBox"),c=a("PowerButtonSelector"),d=a("WorldTimer"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentState=0,e.updateTimer=null,e.alphaTimer=null,e.curWidth=0,e.curHeight=0,e.alpha=0,e.sprRenderer=null,e}return r(e,t),e.prototype.start=function(){this.updateTimer=new d.default(.12,this.updateEffect.bind(this)),this.alphaTimer=new d.default(.02,this.updateAlpha.bind(this))},e.prototype.generateTexture=function(){if(this.curWidth!=l.default.width||this.curHeight!=l.default.height){this.curWidth=l.default.width,this.curHeight=l.default.height,this.getComponent(cc.Widget).updateAlignment();var t=this.curWidth*this.curHeight,e=new Uint8Array(this.curWidth*this.curHeight*4);e.fill(0);for(var i=[],o=[],a=0,n=0,r=0;r<t;r++)if(0==n&&i.indexOf(r)<0&&o.push(r),++a>=this.curWidth){a=0,n++;break}i=i.addRange(o),o=[],a=0,n=0;for(var s=0;s<t;s++)a==this.curWidth-1&&i.indexOf(s)<0&&o.push(s),++a>=this.curWidth&&(a=0,n++);i=i.addRange(o),o=[],a=0,n=0;for(var c=0;c<t;c++)n==this.curHeight-1&&i.indexOf(c)<0&&o.push(c),++a>=this.curWidth&&(a=0,n++);i=i.addRange(o),o=[],a=0,n=0;for(var d=0;d<t;d++)0==a&&i.indexOf(d)<0&&o.push(d),++a>=this.curWidth&&(a=0,n++);o.reverse(),i=i.addRange(o);for(var u=0,h=0;h<i.length;h++){var p=i[h];0==u||1==u||2==u?(e[4*p]=255,e[4*p+1]=255,e[4*p+2]=255,e[4*p+3]=255,u++):u=0}var f=new cc.Texture2D;f.initWithData(e,cc.Texture2D.PixelFormat.RGBA8888,l.default.width,l.default.height),f.setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST);var _=new cc.SpriteFrame;_.setTexture(f),this.sprRenderer.spriteFrame=_}},e.prototype.update=function(){this.updateTimer.logicUpdate(),this.alphaTimer.logicUpdate()},e.prototype.updateAlpha=function(){c.PowerButtonSelector.inst.selectedButton?(this.alpha+=.02,this.alpha>.42&&(this.alpha=.42)):(this.alpha-=.02,this.alpha<0&&(this.alpha=0)),this.sprRenderer.node.opacity!=255*this.alpha&&this.setAlpha(this.alpha)},e.prototype.updateEffect=function(){if(0!=this.alpha)switch(this.currentState++,this.currentState>3&&(this.currentState=0),this.currentState){case 0:this.sprRenderer.node.scaleX=1,this.sprRenderer.node.scaleY=1;break;case 1:this.sprRenderer.node.scaleX=-1,this.sprRenderer.node.scaleY=1;break;case 2:this.sprRenderer.node.scaleX=-1,this.sprRenderer.node.scaleY=-1;break;case 3:this.sprRenderer.node.scaleX=1,this.sprRenderer.node.scaleY=-1}},e.prototype.setAlpha=function(t){this.alpha=t,this.sprRenderer.node.opacity=255*t},s([p(cc.Sprite)],e.prototype,"sprRenderer",void 0),s([h],e)}(cc.Component);n.MapBorder=f,cc._RF.pop()},{}],MapBox:[function(t,e,i){"use strict";cc._RF.push(e,"7502c8oTCtK+52mDPECj/kT","MapBox");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("MathUtils"),d=a("Constants"),u=a("OpenManager"),h=a("Log"),p=a("Tools"),f=a("UiUtil"),_=a("UMReport"),m=a("AchievData"),g=a("UserData"),y=a("GameCommon"),v=a("LoadLayer"),b=a("MsgCache"),w=a("MapAction"),T=a("WorldAction"),k=a("ActionLibrary"),B=a("Actor"),S=a("ActorAsset"),C=a("ActorBag"),x=a("ActorBase"),A=a("ActorStatus"),P=a("ActorTool"),O=a("Boat"),R=a("TaxiManager"),F=a("Dragon"),L=a("UFO"),D=a("UnitGroupManager"),M=a("AStarFinder"),I=a("AStarParam"),j=a("RegionPathFinder"),E=a("StaticGrid"),N=a("ActorAnimationLoader"),z=a("MapObjectShadow"),G=a("AssetManager"),U=a("BaseBuilding"),W=a("BaseEffect"),q=a("BaseSimObject"),H=a("JobManager"),V=a("WorldBehaviour"),Z=a("WorldBehaviourActionBurnedTiles"),K=a("WorldBehaviourActionCreepBiomass"),J=a("WorldBehaviourActionCreepDegeneration"),Y=a("WorldBehaviourActionEnchanted"),Q=a("WorldBehaviourActionErosion"),X=a("WorldBehaviourActionFire"),$=a("WorldBehaviourActionGrass"),tt=a("WorldBehaviourActionInferno"),et=a("WorldBehaviourActions"),it=a("WorldBehaviourActionSwampAnimation"),ot=a("WorldBehaviourOcean"),at=a("WorldBehaviourUnitTemperatures"),nt=a("Brush"),rt=a("Building"),st=a("City"),lt=a("CityBuildOrder"),ct=a("CityPlaceFinder"),dt=a("CityTaskList"),ut=a("GameUtils"),ht=a("FamilysManager"),pt=a("GeneratorTool"),ft=a("NameGenerator"),_t=a("WorldNameGenerator"),mt=a("MoveCamera"),gt=a("OceanHelper"),yt=a("PrefabLibrary"),vt=a("SmoothLoader"),bt=a("ToolBox"),wt=a("UnusedLibrary"),Tt=a("ViewController"),kt=a("Config"),Bt=a("CultureManager"),St=a("DebugConfig"),Ct=a("CloudController"),xt=a("EffectDivineLight"),At=a("ExplosionChecker"),Pt=a("ExplosionsEffects"),Ot=a("GlowParticles"),Rt=a("HeatRayEffect"),Ft=a("Meteorite"),Lt=a("PixelFlashEffects"),Dt=a("StackEffects"),Mt=a("WaveController"),It=a("GameAudio"),jt=a("GuideController"),Et=a("SignInSystem"),Nt=a("KingdomColors"),zt=a("KingdomManager"),Gt=a("DropManager"),Ut=a("BurnedTilesLayer"),Wt=a("ConwayLife"),qt=a("FireLayer"),Ht=a("FogLayer"),Vt=a("GreyGooLayer"),Zt=a("IslandsCalculator"),Kt=a("LavaLayer"),Jt=a("RoadsCalculator"),Yt=a("UnitLayer"),Qt=a("ZoneCalculator"),Xt=a("MapBorder"),$t=a("MapChunkManager"),te=a("MapGenerator"),ee=a("MapLayer"),ie=a("MapMarks"),oe=a("MapNamesManager"),ae=a("MapStats"),ne=a("PathFindingVisualiser"),re=a("QualityChanger"),se=a("RegionLinkHashes"),le=a("Heat"),ce=a("TileTypeBase"),de=a("UnitZones"),ue=a("WorldTile"),he=a("WorldTilemap"),pe=a("Earthquake"),fe=a("PrintLibrary"),_e=a("PlayerConfig"),me=a("SaveManager"),ge=a("StatsData"),ye=a("WorldLog"),ve=a("ModModule"),be=a("GodActions"),we=a("PowerActionsModule"),Te=a("PowerButtonSelector"),ke=a("UiController"),Be=a("WorldLaws"),Se=cc._decorator,Ce=Se.ccclass,xe=Se.property,Ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.savedGuideMap=[],e.prefab_city=null,e.mapPos=cc.Vec3.ZERO,e.saveManager=null,e.gameStats=new ge.GameStatsData,e.mapStats=null,e.worldLaws=new Be.default,e.tilesList=[],e.citiesList=[],e.units=null,e.buildings=null,e.job_manager_buildings=null,e.kingdoms=null,e.cultures=null,e.tilemap=null,e.sortZIndexTimer=0,e.autoSaveTimer=120,e.redrawTimer=0,e.behaviours=[],e.behavioursDict=new Map,e.temp_map_objects=[],e.initiated=!1,e.regionPathFinder=null,e.stackEffects=null,e.printLibrary=null,e.dropManager=null,e.pathFindingVisualiser=null,e.worldLayer=null,e.unitLayer=null,e.lavaLayer=null,e.greyGooLayer=null,e.flashEffects=null,e.fireLayer=null,e.islandsCalculator=null,e.zoneCalculator=null,e.roadsCalculator=null,e.burnedLayer=null,e.explosionLayer=null,e.conwayLayer=null,e.earthquakeManager=null,e.cloudController=null,e.waveController=null,e.mapChunkManager=null,e.mapLayers=[],e.mapModules=[],e.wind_direction=cc.Vec2.ZERO,e.searchGridGround=null,e.tilesDirty=[],e.particlesFire=null,e.particlesSmoke=null,e.updateWorldBehaviours=!0,e.hasFocus=!1,e.heat=null,e.heatRayFx=null,e.fxDivineLight=null,e.mapBorder=null,e.qualityChanger=null,e.transformParents=null,e.transformCreatures=null,e.transformPlants=null,e.transformShadows=null,e.cityPlaceFinder=null,e.unitZones=null,e.worldLog=null,e.actions=null,e.timer_hunger=0,e.unitGroupManager=null,e._unitSelectEffect=null,e.pathfindingParam=new I.default,e.holdPosition=cc.v2(-1,-1),e.firstClick=!0,e.lastClickTime=0,e.timerSpawnPixels=0,e._list_to_clean_effects=[],e._force_temp_actor_list=[],e.pixelLimit=0,e.shakeTimer=0,e.frameIndex=0,e.shakeIntervalTimer=0,e.shakeIntencity=1,e.shakeInterval=.1,e.shakeX=!0,e.shakeY=!0,e.elapsed=0,e.results=[],e.inspectTimerClick=0,e.touchTimer=0,e.alreadyUsedZoom=!1,e.alreadyUsedPower=!1,e.currentTouch=cc.Vec2.ZERO,e.firstPressedType=null,e.firstPressedTopType=null,e.dirtyTilesLast=0,e.isKeyDownCode=-1,e.guideHumansNum=0,e.guideSeedsNum=0,e.achievementDestructionKills=new Map,e.achievementDivineLightKills=new Map,e.placeBeehive=!1,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,this.initLibs(),this.actions=new we.default,this.worldLog=new ye.default,this.mapStats=new ae.default,this.regionPathFinder=new j.default,this.unitGroupManager=new D.default,this.islandsCalculator=new Zt.default,this.unitZones=new de.default,this.cityPlaceFinder=new ct.default,this.transformShadows=this.node.getChildByName("Shadows"),this.units=new x.ActorContainer,this.buildings=new U.BuildingContainer,this.job_manager_buildings=new H.JobManagerBuildings,this.kingdoms=new zt.default,this.cultures=new Bt.CultureManager,this.heat=new le.default,this.wind_direction=cc.v2(-.1,.2),this.newBehaviour(80,0,"disasters",et.default.updateDisasters),this.newBehaviour(1,1,"roads",et.default.updateRoadDegeneration),this.newBehaviour(1,1,"vegetation",et.default.growVegetation),this.newBehaviour(2.5,2,"unit_spawn",et.default.updateUnitSpawn),this.newBehaviour(5,2,"creep_degeneration",J.default.checkCreep,J.default.clear),this.newBehaviour(.2,0,"ocean",ot.default.updateOcean,ot.default.clear),this.newBehaviour(.3,.2,"grass",$.default.updateGrass,$.default.clear),this.newBehaviour(.2,0,"fire",X.default.updateFire,X.default.clear),this.newBehaviour(.1,.2,"burned_tiles",Z.default.updateBurnedTiles),this.newBehaviour(2,1,"erosion",Q.default.updateErosion),this.newBehaviour(.1,1,"biome_inferno_fires",tt.default.updateInfernoFireAction,null,!1),this.newBehaviour(.1,.3,"biome_inferno_tile_low_animations",tt.default.updateInfernalLowAnimations,null,!1),this.newBehaviour(.1,1,"biome_enchanted_sparks",Y.default.updateSparksAction,null,!1),this.newBehaviour(.01,.01,"creep_biomass",K.default.updateBiomassTiles,null,!1),this.newBehaviour(.01,.1,"biome_low_swamp_animations",it.default.updateSwampTiles,null,!1),this.newBehaviour(.1,.1,"unit_temperatures",at.default.updateUnitTemperatures,at.default.clear,!1),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.start=function(){var t=this;this.initiated=!0,this.mapLayers.push(this.worldLayer),this.mapLayers.push(this.unitLayer),this.mapLayers.push(this.zoneCalculator),this.mapLayers.push(this.fireLayer),this.mapLayers.push(this.burnedLayer),this.mapLayers.push(this.explosionLayer),this.mapLayers.push(this.conwayLayer),this.mapLayers.push(this.pathFindingVisualiser),this.mapLayers.push(this.flashEffects),this.mapModules.push(this.roadsCalculator),this.mapModules.push(this.greyGooLayer),this.mapModules.push(this.lavaLayer),this.mapChunkManager=new $t.default,this.scheduleOnce(function(){t.startTheGame()},.02)},e.prototype.initLibs=function(){bt.Toolbox.init(),_e.default.init(),lt.default.init(),ft.default.init(),G.default.init(),Nt.default.init(),N.default.init(),dt.default.init(),be.default.init(),pt.GeneratorTool.init(),nt.default.init(),ht.default.init()},e.prototype.startTheGame=function(){if(h.default.d("MapBox","startTheGame","start"),kt.default.gameLoaded=!0,kt.default.LOAD_TIME_CREATE=cc.sys.now(),kt.default.currentBrushData=nt.default.getBrushByID(kt.default.currentBrush),FIRST_PLAY&&this.savedGuideMap.length>0){var t=kt.default.mode_sandBox?this.savedGuideMap[0]:this.savedGuideMap[1];me.default.loadString(t.text)}else this.generateNewMap();kt.default.LOAD_TIME_GENERATE=cc.sys.now(),h.default.d("MapBox","startTheGame","end")},e.prototype.generateNewMap=function(t){var e=this;void 0===t&&(t="islands"),this.initiated&&(cc.log("MapBox","generateNewMap","start"),vt.default.prepare(),"custom"!=t&&(kt.default.customMapSize=OS_IOS?"small":kt.default.customMapSizeDefault),kt.default.ZONE_AMOUNT_Y=kt.default.ZONE_AMOUNT_X=te.MapSizePresset.getSize(kt.default.customMapSize),vt.default.add(function(){e.setMapSize(kt.default.ZONE_AMOUNT_X,kt.default.ZONE_AMOUNT_Y)},"Generate New Map (3/3)"),vt.default.add(function(){e.clearWorld()},"gen: Clearing World",!0),vt.default.add(function(){G.default.tiles.setListTo("generator"),i.inst.worldLaws.init()},"gen: World Laws"),vt.default.add(function(){e.mapStats=new ae.default,e.mapStats.name=_t.default.generateName();var t=bt.Toolbox.randomInt(10,1e3);bt.Toolbox.setRandomSeed(t)},"gen: Generating Name"),vt.default.add(function(){te.default.prepare(t)},"gen: Preparing "+t,!0),vt.default.add(function(){e.addBuilding("volcano",e.getTile(i.width/2,i.height/2))},"add_volcano"),kt.default.mode_sandBox||vt.default.add(function(){ve.default.inst.newRound()},"Mod Start",!0),vt.default.add(function(){e.finishMakingWorld(),_.default.report("buildMapFinish"),cc.log("MapBox","generateNewMap","end")},"gen: Finish Making World",!0))},e.prototype.addUnloadResources=function(){vt.default.add(function(){f.UiUtil.openModule("res/prefab/UnusedLibrary")},"UnloadUnusedAssets",!0)},e.prototype.setMapSize=function(t,e){kt.default.ZONE_AMOUNT_X=t,kt.default.ZONE_AMOUNT_Y=e,i.width=64*kt.default.ZONE_AMOUNT_X,i.height=64*kt.default.ZONE_AMOUNT_Y,this.recreateSizes()},e.prototype.finishMakingWorld=function(){var t=this;this.mapChunkManager.allDirty(),this.centerCamera(),this.scheduleOnce(function(){if(v.LoadLayer.closeLoading(),wt.default.inst||t.addUnloadResources(),!FIRST_PLAY){ke.default.inst.showBoxGift(),ke.default.inst.showBoxMonster(),ke.default.inst.showBanner(!BYTEDANCE_GAME),Et.default.inst.initFromUserData();var e=Et.default.inst.getTodaySignStatus();setTimeout(function(){e<g.SignInStatus.Normal&&ut.default.allowPopUi()&&ke.default.inst.onClickSign(null)},2e3)}},.02)},e.prototype.recreateSizes=function(){var t=this;vt.default.add(function(){t.node.width=i.width,t.node.height=i.height,t.getComponent(cc.Widget).updateAlignment(),t.mapPos=cc.v3(-i.width/2,-i.height/2),t.worldLayer.node.width=i.width,t.worldLayer.node.height=i.height,t.searchGridGround=new E.default(i.width,i.height)},"Recreate Sizes (1/4)"),vt.default.add(function(){t.createTiles()},"Recreate Sizes (2/4)");for(var e=function(e){var i=e;vt.default.add(function(){t.mapLayers[i].createTextureNew()},"Recreate Sizes (3/4) ("+(e+1)+"/"+o.mapLayers.length+")")},o=this,a=0;a<this.mapLayers.length;a++)e(a);vt.default.add(function(){t.tilemap.prepare(),t.mapBorder.generateTexture()},"Recreate Sizes (4/4)")},e.prototype.getObjectsInChunks=function(t,e,i){void 0===e&&(e=3),void 0===i&&(i=ee.MapObjectType.All),this.temp_map_objects=[],this.checkChunk(t.chunk,t,e,i);for(var o=0;o<t.chunk.neighbours.length;o++){var a=t.chunk.neighbours[o];this.checkChunk(a,t,e,i)}},e.prototype.checkChunk=function(t,e,i,o){var a;void 0===o&&(o=ee.MapObjectType.All);for(var n=0;n<t.k_list_objects.length;n++)for(var r=t.k_list_objects[n],s=t.k_dict_objects.get(r),l=0;l<s.length;l++){var c=s[l];if(null===(a=null==c?void 0:c.base_data)||void 0===a?void 0:a.alive){if(c.isActor()){if(o==ee.MapObjectType.Building)continue}else if(o==ee.MapObjectType.Actor)continue;0!=i&&bt.Toolbox.distTile(c.currentTile,e)>i||this.temp_map_objects.push(c)}}},e.prototype.getBuildingByID=function(t){var e,i,o;try{for(var a=l(this.buildings.list),n=a.next();!n.done;n=a.next()){var r=n.value;if(t==(null===(o=r.data)||void 0===o?void 0:o.objectID))return r}}catch(d){e={error:d}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return null},e.prototype.getActorByID=function(t){var e,i,o;try{for(var a=l(this.units.list),n=a.next();!n.done;n=a.next()){var r=n.value;if((null===(o=r.data)||void 0===o?void 0:o.actorID)==t)return r}}catch(d){e={error:d}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return null},e.prototype.getCityByID=function(t){var e,i,o;try{for(var a=l(this.citiesList),n=a.next();!n.done;n=a.next()){var r=n.value;if((null===(o=r.data)||void 0===o?void 0:o.cityID)==t)return r}}catch(d){e={error:d}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}return null},e.prototype.newBehaviour=function(t,e,i,o,a,n){void 0===a&&(a=null),void 0===n&&(n=!0);var r=new V.default(t,e,i,o,a);return r.enabled_on_minimap=n,this.behaviours.push(r),this.behavioursDict.set(i,r),r},e.prototype.calcPath=function(t,e,i){i=[];var o,a=this.searchGridGround,n=I.HeuristicMode.MANHATTAN,r=2,s=null;this.pathfindingParam.ocean?(o=50,s=E.DiagonalMovement.OnlyWhenNoObstacles):(o=this.pathfindingParam.limit?500:-1,s=E.DiagonalMovement.Always),o=-1,this.pathfindingParam.roads&&(r=1,s=E.DiagonalMovement.Never,n=I.HeuristicMode.EUCLIDEAN),a.reset();var l=cc.v2(t.pos.x,t.pos.y),c=cc.v2(e.pos.x,e.pos.y);return t.isSameIsland(e)||this.pathfindingParam.ocean?(this.pathfindingParam.setGrid(a,l,c),this.pathfindingParam.diagonalMovement=s,this.pathfindingParam.setHeuristic(n),this.pathfindingParam.maxOpenList=o,this.pathfindingParam.weight=r,M.default.findPath(this.pathfindingParam,i),0!=i.length):(i.push(t),i.push(e),this.pathFindingVisualiser.showPath(a,i),!0)},e.prototype.centerCamera=function(){mt.MoveCamera.inst.centerCamera()},e.prototype.createTiles=function(){var t=this;vt.default.add(function(){t.tilesList=[];var e=0;i.tile_id=0;for(var o=0;o<i.height;o++)for(var a=0;a<i.width;a++){e=o*i.width+a,i.tile_id++;var n=new ue.default(a,o,e);t.searchGridGround.setTileNode(a,o,n),t.tilesList.push(n)}},"Prepare Tiles"),vt.default.add(function(){for(var e=0;e<t.tilesList.length;e++)t.tilesList[e].createNeighbourLists()},"Create Neighbours (1/2)",!0),vt.default.add(function(){pt.GeneratorTool.generateTileNeighbours()},"Create Neighbours (2/2)",!0),vt.default.add(function(){t.zoneCalculator.generate(),t.mapChunkManager.prepare()},"Create Zones",!0)},e.prototype.spawnBeehvies=function(t){for(var e=0;e<t;e++){var i=this.tilesList.getRandom();i.type.grass&&this.addBuilding("beehive",i,null,!0)}},e.prototype.spawnResource=function(t,e,i){void 0===i&&(i=!0);for(var o="",a=0;a<t;a++){var n=this.tilesList.getRandom();n.type.ground&&(o="",i&&(bt.Toolbox.randomBool()?o="_s":bt.Toolbox.randomBool()&&(o="_m")),this.addBuilding(e+o,n,null,!0))}},e.prototype.tryGrowVegetation=function(t,e,i,o){void 0===e&&(e=!1),void 0===i&&(i=""),void 0===o&&(o=!0);var a=G.default.buildings.get(i);if(t.building&&!t.building.isNonUsable()||!a)return!1;if(o){var n=a.limit_per_zone;if(t.zone.isInLimitFor(t,a,n))return}this.canBuildFrom(t,a,null)&&(this.addBuilding(a.id,t,null,!1,e),this.gameStats.treesGrown++,m.default.update(69,this.gameStats.treesGrown-this.gameStats.treesDeath,!0))},e.prototype.tryGrowVegetationRandom=function(t,e,i,o){void 0===i&&(i=!1),void 0===o&&(o=!0);var a=null;if(t.type.grow_vegetation_auto&&(!t.building||t.building.isNonUsable())){switch(e){case U.VegetationType.Plants:t.type.grow_type_selector_plants&&(a=t.type.grow_type_selector_plants(t));break;case U.VegetationType.Trees:t.type.grow_type_selector_trees&&(a=t.type.grow_type_selector_trees(t),m.default.update(2),t.type.sand&&m.default.update(19))}if(a){if(o){var n=a.limit_per_zone;if(t.zone.isInLimitFor(t,a,n))return}a.vegetationRandomChance<Math.random()||!this.canBuildFrom(t,a,null)||(this.addBuilding(a.id,t),this.gameStats.treesGrown++,m.default.update(69,this.gameStats.treesGrown-this.gameStats.treesDeath,!0))}}},e.prototype.buildNewCity=function(t,e,i,o,a){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=!1),void 0===a&&(a=null),e){var n=this.kingdoms.getKingdomByID(e.kingdomID);if(n||(n=this.kingdoms.makeNewCivKingdom(null,G.default.raceLibrary.get(e.race),e.kingdomID,!1)),!n.isCiv())return null;if(!e.race)return null}var r=cc.instantiate(this.prefab_city).getComponent(st.default);if(r.create(),i&&r.setRace(i),e&&r.loadCity(e),o?r.setKingdom(this.kingdoms.getKingdomByID(e.kingdomID)):(r.setKingdom(a),r.createNewCity()),r.node.parent=cc.find("Cities",this.node),r.kingdom||this.kingdoms.makeNewCivKingdom(r),r.addZone(t),!o)for(var s=0;s<t.neighboursAll.length;s++){var l=t.neighboursAll[s];l.city||r.addZone(l)}return this.citiesList.push(r),this.cityPlaceFinder.cleanGoodList(),r},e.prototype.getEmptyKingdomCity=function(t,e){for(var i=[],o=0;o<e.cities.length;o++){var a=e.cities[o];a.status.population<=40&&(a.status.population<=5||0!=a.status.homesFree)&&i.push(a)}return bt.Toolbox.getRandom(i)},e.prototype.newAttack=function(t,e,i,o){var a,n,r;if(!i)return!1;var s=t.curStats.targets;bt.Toolbox.temp_list_objects_enemies=[],bt.Toolbox.findEnemiesOfKingdomInChunk(i.chunk,t.kingdom),0==bt.Toolbox.temp_list_objects_enemies.length&&bt.Toolbox.temp_list_objects_enemies.push([]),bt.Toolbox.temp_list_objects_enemies[0].push(o);var c=bt.Toolbox.randomChance(t.curStats.s_crit_chance),d=!1;try{for(var u=l(bt.Toolbox.temp_list_objects_enemies),h=u.next();!h.done;h=u.next()){var p=h.value;if(0!=s){p.shuffle();for(var f=0;f<p.length;f++){var _=p[f];if(0==s)break;if((null===(r=null==_?void 0:_.base_data)||void 0===r?void 0:r.alive)&&t.canAttackTarget(_)&&bt.Toolbox.dist(_.currentPosition.x,_.currentPosition.y+_.getZ(),e.x,e.y)<t.curStats.areaOfEffect+_.curStats.size){s--;var m=_.currentPosition;(m=bt.Toolbox.moveTowards(e,_.currentPosition,.9*_.curStats.size)).y+=_.getZ(),!this.qualityChanger.lowRes&&_.spriteRenderer&&_.spriteRenderer.enabled&&(c?this.stackEffects.get("hitCritical").spawnAt(m,.1):this.stackEffects.get("hit").spawnAt(m,.1)),this.applyAttack(t,_,e,i,c),d=!0}}}}}catch(v){a={error:v}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(a)throw a.error}}return d},e.prototype.applyAttack=function(t,e,i,o,a){var n,r;void 0===a&&(a=!1);var s=t.curStats.damage;if(a&&(s=c.default.intCast(t.curStats.damage*t.curStats.damageCritMod)),e.getHit(s,!0,S.AttackType.Other,t),t.isActor()){t.a.addExperience(2);var l=t.a.getWeaponAsset();l.attackAction.isEmpty||l.attackAction.do(e,o)}e.isActor()&&t.isActor()&&(e.a.stats.canTurnIntoZombie&&t.a.haveTrait("zombie")&&bt.Toolbox.randomChance(.3)&&e.a.addTrait("infected"),!(null===(n=e.base_data)||void 0===n?void 0:n.alive)&&t.a.stats.animal&&t.a.stats.diet_meat&&e.a.stats.source_meat&&t.a.restoreStatsFromEating(70,0,!0));var d=(null===(r=e.base_data)||void 0===r?void 0:r.health)<=0?.3*t.curStats.knockback:.2*t.curStats.knockback;if((d-=d*(e.curStats.knockbackReduction/100))<0&&(d=0),d>0&&e.isActor()){var u=bt.Toolbox.getAngle(e.node.x,e.node.y,i.x,i.y);e.a.addForce((0-Math.cos(u))*d,(0-Math.sin(u))*d,d)}},e.prototype.destroyCity=function(t){ye.default.logCityDestroyed(t),t.destroyCity(),t.node.destroy(),this.citiesList.remove(t),this.cityPlaceFinder.setDirty()},e.prototype.clearWorld=function(){var t,e,i,o,a,n,r,s,c,d,u,p,f,_,m,g,y,v,b,w,T,k,B,S,C,x;h.default.d("MapBox","clearWorld","start"),q.default.LAST_HASH_ID=0,Te.PowerButtonSelector.inst.unselectAll(),this.firstClick=!0,null===(c=this.worldLog)||void 0===c||c.clear(),null===(d=this.islandsCalculator)||void 0===d||d.clear(),null===se.default||void 0===se.default||se.default.clear(),null===(u=this.unitZones)||void 0===u||u.clear(),null===(p=oe.default.inst)||void 0===p||p.clear(),null===(f=this.mapChunkManager)||void 0===f||f.clearAll(),null===(_=this.qualityChanger)||void 0===_||_.reset(),null===(m=this.tilemap)||void 0===m||m.clear(),null===(g=this.heat)||void 0===g||g.clear(),ve.default.inst.clear();try{for(var A=l(this.tilesList),P=A.next();!P.done;P=A.next()){var O=P.value;null==O||O.clear()}}catch(z){t={error:z}}finally{try{P&&!P.done&&(e=A.return)&&e.call(A)}finally{if(t)throw t.error}}try{for(var R=l(this.citiesList),F=R.next();!F.done;F=R.next())F.value.node.destroy()}catch(U){i={error:U}}finally{try{F&&!F.done&&(o=R.return)&&o.call(R)}finally{if(i)throw i.error}}try{for(var L=l(G.default.tiles.list),D=L.next();!D.done;D=L.next())D.value.hashsetClear()}catch(W){a={error:W}}finally{try{D&&!D.done&&(n=L.return)&&n.call(L)}finally{if(a)throw a.error}}try{for(var M=l(G.default.topTiles.list),I=M.next();!I.done;I=M.next())I.value.hashsetClear()}catch(H){r={error:H}}finally{try{I&&!I.done&&(s=M.return)&&s.call(M)}finally{if(r)throw r.error}}this.behaviours.forEach(function(t){null==t||t.clear()}),this.transformShadows.destroyAllChildren(),null===(y=G.default.unitStats)||void 0===y||y.clear(),null===(v=G.default.raceLibrary)||void 0===v||v.clear(),null===(b=this.dropManager)||void 0===b||b.clear(),this.citiesList=[],null===(w=this.kingdoms)||void 0===w||w.clear(),null===(T=this.cultures)||void 0===T||T.clear(),null===(k=this.waveController)||void 0===k||k.clear(),null===(B=this.cloudController)||void 0===B||B.clear(),null===(S=this.particlesFire)||void 0===S||S.clear(),null===(C=this.particlesSmoke)||void 0===C||C.clear(),null===(x=this.stackEffects)||void 0===x||x.clear(),this.clearSimObjects(),this.mapLayers.forEach(function(t){null==t||t.clear()}),this.mapModules.forEach(function(t){null==t||t.clear()});for(var j=0;j<this.tilesDirty.length;j++)this.tilesDirty[j].dirty=!1;this.tilesDirty=[],h.default.d("MapBox","clearWorld","en")},e.prototype.clearSimObjects=function(){var t=this;this.units.checkAddRemove(),this.buildings.checkAddRemove(),this.units.list.forEach(function(e){t.destroyActor(e)}),this.buildings.list.forEach(function(e){t.removeBuildingFully(e)}),this.units.clear(),this.buildings.clear(),this.job_manager_buildings.clear()},e.prototype.getTile=function(t,e){if(t%1>0||e%1>0)throw new Error("use int input!");return t<0||t>=i.width||e<0||e>=i.height?null:this.tilesList[e*i.width+t]},e.prototype.getTileSimple=function(t,e){if(t%1>0||e%1>0)throw new Error("use int input!");return this.tilesList[e*i.width+t]},e.prototype.getActorNearCursor=function(){return k.default.getActorNearPos(this.currentTouch)},e.prototype.getMouseTilePos=function(){return this.getTile(this.currentTouch.x,this.currentTouch.y)},e.prototype.clicked=function(t,e,i){var o,a,n,r;if(void 0===e&&(e=null),void 0===i&&(i=null),(e||(e=Te.PowerButtonSelector.inst.selectedButton.godPower))&&this.doPropCheck(e)){t.x=c.default.intCast(t.x),t.y=c.default.intCast(t.y);var s=this.getTile(t.x,t.y);if(s)if(!kt.default.mode_sandBox&&kt.default.useFog&&Ht.default.inst.isLock(s))b.default.pushToast("\u672a\u63a2\u7d22\u533a\u57df\u65e0\u6cd5\u64cd\u4f5c\uff01");else if("relations"!=e.id){this.firstPressedType||(this.firstPressedType=s.main_type,this.firstPressedTopType=s.top_type);var l=Math.floor(cc.sys.now()/1e3);if("czarBomba"==e.id){var d=cc.sys.os==cc.sys.OS_IOS?4:2;if(l-this.lastClickTime<d)return;this.lastClickTime=l}else if("atomicBomb"==e.id){if(d=cc.sys.os==cc.sys.OS_IOS?3:1,l-this.lastClickTime<d)return;this.lastClickTime=l}else this.lastClickTime=0;kt.default.propUseCount=1,(null===(o=e.click_power_action)||void 0===o?void 0:o.isEmpty)&&(null===(a=e.click_power_brush_action)||void 0===a?void 0:a.isEmpty)?(null===(n=e.click_action)||void 0===n?void 0:n.isEmpty)&&(null===(r=e.click_brush_action)||void 0===r?void 0:r.isEmpty)||(e.click_brush_action.isEmpty?e.click_action.isEmpty||e.click_action.do(s,e.id):e.click_brush_action.do(s,e.id)):e.click_power_brush_action.isEmpty?e.click_power_action.isEmpty||e.click_power_action.do(s,e):e.click_power_brush_action.do(s,e),this.doPropUse(e)}else s.zone.city&&(kt.default.selectedKingdom!=s.zone.city.kingdom?kt.default.selectedKingdom=s.zone.city.kingdom:Tt.default.open(Tt.view_type.KingdomWindow))}},e.prototype.doPropUse=function(t){switch(t.id){case ve.default.inst.race:jt.default.inst.isGuiding&&this.guideHumansNum++,jt.default.inst.in(jt.GUIDE_TYPE.novice,5)&&1==this.guideHumansNum&&jt.default.inst.do(jt.GUIDE_TYPE.novice),jt.default.inst.in(jt.GUIDE_TYPE.novice,6)&&this.guideHumansNum>=1&&jt.default.inst.do(jt.GUIDE_TYPE.novice),jt.default.inst.in(jt.GUIDE_TYPE.novice,7)&&this.guideHumansNum>=10&&jt.default.inst.do(jt.GUIDE_TYPE.novice);break;case"fertilizerTrees":jt.default.inst.isGuiding&&(this.guideSeedsNum+=kt.default.propUseCount),jt.default.inst.in(jt.GUIDE_TYPE.novice,14)&&this.guideSeedsNum>=75&&jt.default.inst.do(jt.GUIDE_TYPE.novice)}if(Te.PowerButtonSelector.inst.selectedButton){var e=g.default.getPropByID(kt.default.selectedProp),i=g.default.getPropConfigByID(kt.default.selectedProp);kt.default.mode_count?e.number>0&&0==e.infiniteTime&&!St.default.Prop_infinite&&(e.number-=kt.default.propUseCount,e.useNum=kt.default.propUseCount,e.number<0&&(e.number=0),g.default.save()):ve.default.inst.mp-=Math.floor(kt.default.propUseCount*i.mp/4),this.checkAchievementByPower(t.id,e,kt.default.propUseCount),!BYTEDANCE_GAME||ke.default.inst.toggleRec.isChecked||jt.default.inst.isGuiding||(ke.default.inst.toggleRec.isChecked=!0,ke.default.inst.toggleRec.checkEvents[0].emit([ke.default.inst.toggleRec]))}},e.prototype.doPropCheck=function(){var t=g.default.getPropByID(kt.default.selectedProp),e=g.default.getPropConfigByID(kt.default.selectedProp);if(e.rare!=g.RARE_TYPE.NORMAL&&!St.default.Prop_infinite){if(t.lock)return b.default.pushToast("\u9053\u5177\u672a\u89e3\u9501\uff01"),!1;if(kt.default.mode_count){if(t.number<=0)return d.default.IS_LOCAL||WECHAT_GAME||BYTEDANCE_GAME||OPPO_GAME||QQ_GAME||XIAOMI_GAME||VIVO_GAME?ut.default.allowPopUi()&&Tt.default.open(Tt.view_type.InfiniteProp):b.default.pushToast("\u9053\u5177\u6570\u91cf\u4e0d\u8db3\uff01"),!1}else if(ve.default.inst.mp<e.mp/4)return b.default.pushToast("\u6cd5\u529b\u503c\u4e0d\u8db3\uff01"),!1}return!0},e.prototype.loadBuilding=function(t){var e=this.getTileSimple(t.mainX,t.mainY),i=this.addBuilding(t.templateID,e,t,!0,!1,U.BuildPlacingType.Load);if(!i)return null;if(t.cityID){var o=this.getCityByID(t.cityID);o&&o.addBuilding(i)}return i},e.prototype.addBuilding=function(t,e,i,o,a,n){void 0===i&&(i=null),void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===n&&(n=U.BuildPlacingType.New);var r=G.default.buildings.get(t);if(o&&!this.canBuildFrom(e,r,null,n))return null;var s=cc.instantiate(yt.default.inst.building);s.parent=r.buildingType==U.BuildingType.Plant?this.transformPlants:this.transformParents;var l=s.getComponent(rt.default);return l.create(),l.setBuilding(e,r,i),i?(l.finishScaleTween(),l.setAnimData(i.frameID),l.applyAnimDataToAnimation(),l.spriteAnimation.forceUpdateFrame()):QQ_GAME&&r.cityBuilding&&(g.default.member.buildCount++,g.default.save(),u.default.getInstance().setUserCloudStorage(g.default.member.buildCount)),l.resetShadow(),this.buildings.add(l),a&&"none"!=l.stats.sfx&&It.default.play(l.stats.sfx),kt.default.timeScale>10&&l.finishScaleTween(),l},e.prototype.canBuildFrom=function(t,e,o,a){void 0===a&&(a=U.BuildPlacingType.New);var n=null,r=t.x-e.fundament.left,s=t.y-e.fundament.bottom,l=e.fundament.right+e.fundament.left+1,c=e.fundament.top+e.fundament.bottom+1,d=!1,u=!1;i.temp_list_tiles=[];var h=null==o?void 0:o.getTile();if(o&&!h)return!1;for(var p=0;p<l;p++)for(var f=0;f<c;f++){if(!(n=this.getTile(r+p,s+f)))return!1;if(i.temp_list_tiles.push(n),e.docks&&(n.type.ocean&&gt.default.goodForNewDock(n)&&(u=!0),n.type.ground&&(d=!0)),o&&o.getTile()){if(!e.docks&&!n.isSameIsland(o.getTile()))return!1;if(n.zone.city!=o)return!1;if(e.onlyBuildTiles&&!n.type.canBuildOn)return!1}if(e.canBePlacedOnlyOn.length>0&&!e.canBePlacedOnlyOn.includes(n.type.id))return!1;if(e.fauna&&!n.canGrow())return!1;if(n.type.liquid&&!e.canBePlacedOnLiquid)return!1;if(e.destroyOnLiquid&&n.type.ocean)return!1;if(e.buildingType==U.BuildingType.Tree&&n.building&&n.building.stats.buildingType!=U.BuildingType.Plant&&!n.building.isNonUsable())return!1;if(!n.canBuildOn(e))return!1;if(e.checkForCloseBuilding&&0==a){if(0==p){if(this.isBuildingNearby(n.tile_left))return!1}else if(p==l-1&&this.isBuildingNearby(n.tile_right))return!1;if(0==f){if(this.isBuildingNearby(n.tile_down))return!1;if(n.tile_down&&this.isBuildingNearby(n.tile_down.tile_down))return!1}else if(f==c-1){if(this.isBuildingNearby(n.tile_up))return!1;if(n.tile_up&&this.isBuildingNearby(n.tile_up.tile_up))return!1}}}if(e.docks&&a==U.BuildPlacingType.New){if(u&&!d)for(p=0;p<i.temp_list_tiles.length;p++){var _=i.temp_list_tiles[p];for(f=0;f<_.neighbours.length;f++){var m=_.neighbours[f];if(m.type.ground&&m.region.island==(null==h?void 0:h.region.island))return!0}}return!1}return!0},e.prototype.isBuildingNearby=function(t){return!t||!(!t.building||t.building.isNonUsable()||!t.building.stats.cityBuilding)},e.prototype.loopWithBrush=function(t,e,o,a){for(var n=0,r=0,s=0;s<e.pos.length;s++){var l=e.pos[s];if(n=t.x+l.x,r=t.y+l.y,n>=0&&n<i.width&&r>=0&&r<i.height){var c=this.getTileSimple(n,r);o instanceof T.default?o.do(c,a):o(c,a)}}},e.prototype.checkCityZone=function(t){var e,i;if(t.zone.city){var o=!1;try{for(var a=l(t.zone.buildings),n=a.next();!n.done;n=a.next())if(n.value.city==t.zone.city){o=!0;break}}catch(c){e={error:c}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}o||t.zone.city.removeZone(t.zone)}},e.prototype.spawnFlash=function(t,e){var i=this.stackEffects.get("explosionWave").spawnNew();i&&i.startFlash(t,e)},e.spawnLightning=function(t,e){var o;void 0===e&&(e=.25);var a=null===(o=i.inst.stackEffects.get("lightning"))||void 0===o?void 0:o.spawnAt(t,e);if(a){var n=25*e;w.default.damageWorld(t,n,G.default.terraform.get("lightning")),It.default.playLightning();var r=bt.Toolbox.randomBool()?1:-1;a.sprRenderer.node.scaleX*=r,w.default.checkLightningAction(t.pos,n),w.default.checkSantaHit(t.pos,n),w.default.checkUFOHit(t.pos,n)}},e.prototype.spawnMeteorite=function(t){var e=cc.instantiate(wt.default.inst.meteorite).getComponent(Ft.default);e.spawnOn(t),e.node.parent=this.stackEffects.node},e.prototype.spawnAndLoadUnit=function(t,e,i){var o=e.status.health;if(cc.sys.os==cc.sys.OS_IOS&&this.units.count>200)return null;var a=this.createNewUnit(t,i,null,0,e);if(!a)return null;!e.status||e.status instanceof A.default||(e.status=p.default.fromJson(e.status,new A.default)),a.setData(e.status),e.inventory&&(e.inventory instanceof C.default||(e.inventory=p.default.fromJson(e.inventory,new C.default)),a.inventory=e.inventory),a.stats.use_items&&a.equipment.load(e.items),a.stats.unit&&a.reloadInventory(),a.loadFromSave(),a.cancelAllBeh(),a.updateStats(),o>a.curStats.health&&(o=a.curStats.health),a.data.health=o;var n=this.getCityByID(e.cityID);if(n&&(a.stats.isBoat?(a.setKingdom(n.kingdom),a.getComponent(O.default).updateTexture(),a.setCity(n)):n.addNewUnit(a)),"livingPlants"==a.stats.id||"livingHouse"==a.stats.id){var r=e.status.special_graphics.split("#"),s=r[0],l=parseInt(r[1]),c=G.default.buildings.get(s);a.spriteRenderer.spriteFrame=c.sprites.animationData[l].main[0]}return a},e.prototype.reachCreatureMaxLimit=function(t){return t>=kt.PerformanceConfig.maxCreatures*(cc.sys.os==cc.sys.OS_IOS||cc.sys.isNative?1:1.5)},e.prototype.spawnNewUnit=function(t,e,i,o){void 0===i&&(i=""),void 0===o&&(o=6);var a=this.createNewUnit(t,e,i,o);if(a.stats.unit){a.data.age=18;for(var n=0;n<6;n++)a.data.updateAttributes(a.stats,a.race,!0);a.setKingdom(this.kingdoms.dict_hidden.get("nomads_"+a.stats.race)),a.setStatsDirty()}return P.default.setSkinSet(a,e.type.forceUnitSkinSet),a},e.prototype.createNewUnit=function(t,e,i,o,a){void 0===i&&(i=""),void 0===o&&(o=0),void 0===a&&(a=null);var n=G.default.unitStats.get(t);if(!n)return null;var r="p_unit"==n.prefab?yt.default.inst.unit:wt.default.inst.getActorPrefab(n.prefab),s=cc.instantiate(r);s.name=n.id,s.position=e.posV3;var l=s.getComponent(B.default);return l.new_creature=!0,a&&(l.new_creature=!1),l.loadStats(n),a&&(l.data=a.status,l.professionAsset=G.default.professions.getAsset(a.status.profession)),l.new_creature&&l.newCreature(this.gameStats.gameTime+this.units.length),l.spawnOn(e,o),l.create(),l.stats.kingdom&&l.setKingdom(this.kingdoms.dict_hidden.get(l.stats.kingdom)),l.node.parent=l.stats.hideOnMinimap?this.transformParents:this.transformCreatures,this.units.add(l),l},e.prototype.destroyActor=function(t){var e,i,o,a;t.data.alive=!1,t.kingdom&&t.kingdom.removeUnit(t),t.city&&t.city.removeCitizen(t),this.units.remove(t),t.shadow&&t.shadow.node.destroy(),this._list_to_clean_effects=[];try{for(var n=l(t.node.children),r=n.next();!r.done;r=n.next()){var s=r.value;s.getComponent(W.default)&&this._list_to_clean_effects.push(s.getComponent(W.default))}}catch(f){e={error:f}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}try{for(var c=l(this._list_to_clean_effects),d=c.next();!d.done;d=c.next()){var u=d.value;u.makeParentController(),u.kill()}}catch(_){o={error:_}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}t.object_destroyed=!0,t.node.destroy()},e.prototype.removeBuildingFully=function(t){t.data.alive=!1,this.buildings.remove(t),t.shadow&&t.shadow.node.destroy(),t.object_destroyed=!0,t.node.destroy(),this.job_manager_buildings.removeObject(t),"trees"==t.stats.type&&this.gameStats.treesDeath++},e.prototype.applyForce=function(t,e,i,o,a,n,r,s,c){var d,u,h,p,f,_;void 0===e&&(e=10),void 0===i&&(i=1.5),void 0===o&&(o=!0),void 0===a&&(a=!1),void 0===n&&(n=0),void 0===r&&(r=[]),void 0===s&&(s=null),void 0===c&&(c=null),this._force_temp_actor_list=[],bt.Toolbox.fillListWithUnitsFromChunk(t.chunk,this._force_temp_actor_list);for(var m=0;m<t.chunk.neighboursAll.length;m++){var g=t.chunk.neighboursAll[m];bt.Toolbox.fillListWithUnitsFromChunk(g,this._force_temp_actor_list)}var y=0,v=0;for(m=0;m<this._force_temp_actor_list.length;m++){var b=this._force_temp_actor_list[m];if((null===(h=null==b?void 0:b.data)||void 0===h?void 0:h.alive)&&(null==b?void 0:b.stats)&&(!(c&&(null===(p=null==b?void 0:b.stats)||void 0===p?void 0:p.very_high_flyer))||c.applies_to_high_flyers)&&(y=bt.Toolbox.distVec2(b.currentTile.pos,t.pos),(a||"nature"!=b.race.id)&&y<=e)){if(r){var w=!1;try{for(var T=(d=void 0,l(r)),k=T.next();!k.done;k=T.next()){var B=k.value;if((null===(f=b.kingdom)||void 0===f?void 0:f.data.id)==B){w=!0;break}}}catch(P){d={error:P}}finally{try{k&&!k.done&&(u=T.return)&&u.call(T)}finally{if(d)throw d.error}}if(w)continue}if((null===(_=b.stats)||void 0===_?void 0:_.canBeHurtByPowers)&&b.getHit(n,!0,S.AttackType.Other,s),(v=i-i*(b.curStats.knockbackReduction/100))<0&&(v=0),v>0){var C=bt.Toolbox.getAngle(b.currentTile.x,b.currentTile.y,t.x,t.y);o?b.addForce((0-Math.cos(C))*v*1,(0-Math.sin(C))*v*1,1):b.addForce(Math.cos(C)*v*1,Math.sin(C)*v*1,1)}}}},e.prototype.stopAttacksFor=function(t){for(var e,i,o,a,n,r=this.units.getSimpleList(),s=0;s<r.length;s++){var l=r[s];l.attackTarget&&((null===(i=null===(e=l.kingdom)||void 0===e?void 0:e.asset)||void 0===i?void 0:i.mobs)||(null===(n=null===(a=null===(o=l.attackTarget)||void 0===o?void 0:o.kingdom)||void 0===a?void 0:a.asset)||void 0===n?void 0:n.mobs))==t&&l.cancelAllBeh()}},e.prototype.allDirty=function(){for(var t=0;t<this.tilesList.length;t++){var e=this.tilesList[t];e.dirty=!0,this.tilesDirty.push(e)}},e.prototype.onApplicationFocus=function(t){this.hasFocus=t},e.prototype.onApplicationPause=function(t){this.hasFocus=!t},e.prototype.updateShake=function(t){if(0!=this.shakeTimer){if(this.shakeTimer>0&&(this.shakeTimer-=t),this.shakeTimer<=0)return this.shakeTimer=0,void(this.node.position=this.mapPos.clone());this.shakeIntervalTimer>0?this.shakeIntervalTimer-=t:(this.shakeIntervalTimer=this.shakeInterval,this.shakeX&&(this.node.x=this.mapPos.x+bt.Toolbox.randomRange(0-this.shakeIntencity,this.shakeIntencity)),this.shakeY&&(this.node.y=this.mapPos.y+bt.Toolbox.randomRange(0-this.shakeIntencity,this.shakeIntencity)))}},e.prototype.startShake=function(t,e,i,o,a){void 0===t&&(t=.3),void 0===e&&(e=.01),void 0===i&&(i=2),void 0===o&&(o=!0),void 0===a&&(a=!0),this.shakeTimer=t,this.shakeInterval=e,this.shakeIntencity=i,this.shakeX=o,this.shakeY=a},e.prototype.updateMapLayers=function(t){if(!vt.default.isLoading()){this.heat.logicUpdate(t),this.mapChunkManager.logicUpdate(t);for(var e=0;e<this.mapLayers.length;e++)this.mapLayers[e].logicUpdate(t);for(e=0;e<this.mapModules.length;e++)this.mapModules[e].logicUpdate(t)}},e.prototype.getCurElapsed=function(){return cc.director.getDeltaTime()*kt.default.timeScale},e.prototype.update=function(t){if(kt.default.gameLoaded)if(vt.default.isLoading())vt.default.logicUpdate(t);else{this.frameIndex++,this.timerSpawnPixels>0&&(this.timerSpawnPixels-=t),this.elapsed=this.getCurElapsed(),G.default.raceLibrary.logicUpdate(this.elapsed),this.islandsCalculator.logicUpdate(this.elapsed),this.unitZones.logicUpdate(this.elapsed),this.cityPlaceFinder.logicUpdate(this.elapsed),At.default.inst.logicUpdate(this.elapsed),ie.default.inst.drawMarks(),this.kingdoms.logicUpdate(this.elapsed),y.default.isPaused||(this.gameStats.gameTime+=this.elapsed,this.unitGroupManager.logicUpdate(this.elapsed),this.updateUnitsHunger(this.elapsed),this.mapStats.updateAge(this.elapsed),R.default.logicUpdate(this.elapsed)),bt.Toolbox.temp_list_objects_enemies=[],bt.Toolbox.temp_list_objects_enemies_chunk=null,bt.Toolbox.temp_list_objects_enemies_kingdom=null;for(var e=0;e<kt.default.actorFastMode;e++){this.updateMapLayers(this.elapsed),this.updateCities(this.elapsed),this.updateActors(this.elapsed),this.updateBuildings(this.elapsed),this.updateShake(this.elapsed),this.dropManager.logicUpdate(this.elapsed),this.cultures.logicUpdate(this.elapsed);for(var i=0;i<this.behaviours.length;i++)this.behaviours[i].logicUpdate(this.elapsed)}this.qualityChanger.logicUpdate(t),this.stackEffects.logicUpdate(this.elapsed),this.heatRayFx.logicUpdate(this.elapsed),oe.default.inst.logicUpdate(this.elapsed),this.updateSpriteSystems(),this.cloudController.logicUpdate(this.elapsed),this.waveController.logicUpdate(this.elapsed),ve.default.inst.logicUpdate(this.elapsed),60==cc.game.getFrameRate()?this.frameIndex%1==0&&this.updateControls():this.updateControls(),this.frameIndex%=cc.game.getFrameRate(),this.sortZIndexTimer-=t,this.sortZIndexTimer<=0&&(this.sortZIndex(),this.sortZIndexTimer=kt.PerformanceConfig.intervalOfSortActors),this.redrawTimer>0?this.redrawTimer-=this.elapsed:(this.redrawTimer=1,this.tilesDirty.length>0&&this.redrawMap())}},e.prototype.updateSpriteSystems=function(){},e.prototype.updateSpriteConstructor=function(){},e.prototype.sortZIndex=function(){this.transformParents.children.sort(function(t,e){return e.y-t.y})},e.prototype.updateUnitsHunger=function(t){var e;if(i.inst.worldLaws.world_law_hunger.boolVal)if(this.timer_hunger>0)this.timer_hunger-=t;else{this.timer_hunger=8;for(var o=this.units.getSimpleList(),a=0;a<o.length;a++){var n=o[a];n.created&&(null===(e=n.stats)||void 0===e?void 0:e.needFood)&&n.updateHunger()}}},e.prototype.updateObjectAge=function(){for(var t=this.units.getSimpleList(),e=0;e<t.length;e++){var i=t[e];i.created&&i.updateAge()}for(var o=0;o<this.citiesList.length;o++){var a=this.citiesList[o];a.created&&a.updateAge()}this.kingdoms.updateAge()},e.prototype.updateCultures=function(){this.cultures.updateProgress()},e.prototype.updateCities=function(t){for(var e=0;e<this.citiesList.length;e++){var i=this.citiesList[e];i.created&&i.logicUpdate(t)}},e.prototype.updateBuildings=function(t){this.buildings.checkAddRemove(),this.job_manager_buildings.logicUpdate(t),this.buildings.checkAddRemove(),m.default.update(74,0,!0)},e.prototype.updateActors=function(t){var e=0;this.units.checkAddRemove();for(var i=this.units.getSimpleList(),o=0;o<i.length;o++){var a=i[o];a.created&&(a.updateTimers(t),a.logicUpdate(t),a.stats.animal&&e++)}this.units.checkAddRemove(),m.default.update(70,e,!0)},e.prototype.onTouchStart=function(t){var e,i;(null===(i=null===(e=Te.PowerButtonSelector.inst.selectedButton)||void 0===e?void 0:e.godPower)||void 0===i?void 0:i.holdAction)&&1===t.getTouches().length&&(this.holdPosition=t.getLocation(),this.isKeyDownCode=0)},e.prototype.onTouchMove=function(t){var e,i;(null===(i=null===(e=Te.PowerButtonSelector.inst.selectedButton)||void 0===e?void 0:e.godPower)||void 0===i?void 0:i.holdAction)&&1===t.getTouches().length&&(this.holdPosition=t.getLocation(),this.isKeyDownCode=1)},e.prototype.onTouchEnd=function(t){this.holdPosition=cc.v2(-1,-1),this.isKeyDownCode=-1,mt.MoveCamera.inst.touchTimer>.2||mt.MoveCamera.inst.isMoving||t.getTouches().length>0&&!mt.MoveCamera.inst.alreadyUsedZoom&&(Te.PowerButtonSelector.inst.selectedButton&&Te.PowerButtonSelector.inst.selectedButton.godPower?this.processClick(t.getLocation()):(this.currentTouch=this.inputLocationToMapPosition(t.getLocation()),this.checkEmptyClick(this.currentTouch)))},e.prototype.inputLocationToMapPosition=function(t){var e=mt.MoveCamera.inst.camera.getScreenToWorldPoint(t),o=this.node.convertToNodeSpaceAR(e);return o.x=Math.max(0,o.x),o.x=Math.min(i.width-1,o.x),o.y=Math.max(0,o.y),o.y=Math.min(i.height-1,o.y),cc.v2(Math.floor(o.x),Math.floor(o.y))},e.prototype.processClick=function(t){this.firstClick=!0;var e=this.inputLocationToMapPosition(t);this.clicked(e,Te.PowerButtonSelector.inst.selectedButton.godPower)},e.prototype.checkEmptyClick=function(t){this.isKeyDownCode<0||this.getTile(t.x,t.y)&&this.units.list.forEach(function(e){bt.Toolbox.distVec2(e.currentTile.pos,t)<=10&&(e.stats.id.includes("dragon")&&e.getComponent(F.default).clickToWakeup(),e.stats.id.includes("UFO")&&e.getComponent(L.default).click())})},e.prototype.isActionHappening=function(){return!!this.earthquakeManager.quakeActive},e.prototype.updateControls=function(){var t,e,i=null;(null===(e=null===(t=Te.PowerButtonSelector.inst.selectedButton)||void 0===t?void 0:t.godPower)||void 0===e?void 0:e.holdAction)&&(i=Te.PowerButtonSelector.inst.selectedButton.godPower),i&&!mt.MoveCamera.inst.isMoving&&mt.MoveCamera.inst.touchTimer>.2&&!mt.MoveCamera.inst.alreadyUsedZoom&&i.holdAction&&-1!=this.holdPosition.x&&(this.firstPressedType=null,this.processClick(this.holdPosition)),this.actions.magnetAction(!0)},e.prototype.allTilesDirty=function(){for(var t=0;t<this.tilesList.length;t++){var e=this.tilesList[t];this.setTileDirty(e)}},e.prototype.redrawRenderedTile=function(t){t.lastDrawnType=null,this.setTileDirty(t)},e.prototype.setTileDirty=function(t,e){void 0===e&&(e=!1),t.dirty||(t.dirty=!0,this.tilesDirty.push(t),e||(t.tile_up&&(t.tile_up.dirty=!0,this.tilesDirty.push(t.tile_up)),t.tile_down&&(t.tile_down.dirty=!0,this.tilesDirty.push(t.tile_down))))},e.prototype.zoomUpdated=function(t,e){this.qualityChanger.zoomUpdated(t,e)},e.prototype.redrawMap=function(){this.dirtyTilesLast=this.tilesDirty.length,this.tilemap.updateTileMap();for(var t=0;t<this.tilesDirty.length;t++){var e=this.tilesDirty[t];this.updateDirtyTile(e)}this.tilesDirty=[],this.worldLayer.updatePixels()},e.prototype.checkBehaviours=function(t){var e,i,o,a,n,r,s,l,c,d,u,h;t.type.explodableTimed&&(null===(i=(e=this.explosionLayer).addTimedTnt)||void 0===i||i.call(e,t)),(null===(o=t.type)||void 0===o?void 0:o.canBeFilledWithOcean)?null===(n=null===(a=ot.default.tiles)||void 0===a?void 0:a.add)||void 0===n||n.call(a,t):null===(s=null===(r=ot.default.tiles)||void 0===r?void 0:r.delete)||void 0===s||s.call(r,t),(null===(l=t.data)||void 0===l?void 0:l.fire)?null===(d=null===(c=X.default.tiles)||void 0===c?void 0:c.add)||void 0===d||d.call(c,t):null===(h=null===(u=X.default.tiles)||void 0===u?void 0:u.delete)||void 0===h||h.call(u,t)},e.prototype.updateDirtyTile=function(t){var e,i,o,a,n,r,s;if((null===(i=null===(e=t.building)||void 0===e?void 0:e.getColor(t))||void 0===i?void 0:i.a)>0)this.worldLayer.updateSinglePixel(t.data.tile_id,t.building.getColor(t));else if(!t.type.edge_hills||(null===(o=t.tile_down)||void 0===o?void 0:o.type.rocks))if(t.type.edge_mountains&&null!==(n=null===(a=t.tile_down)||void 0===a?void 0:a.type.edge_hills)&&void 0!==n&&n)this.worldLayer.updateSinglePixel(t.data.tile_id,ce.TileTypeBase.edge_color_mountain);else{if(t.type.rocks){var l=t.tile_down;if(l&&!l.type.rocks)return void this.worldLayer.updateSinglePixel(t.data.tile_id,ce.TileTypeBase.edge_color_mountain)}if(null!==(s=null===(r=t.tile_up)||void 0===r?void 0:r.type.ground)&&void 0!==s&&s){if(t.type.layerType==ce.TileLayerType.Ocean)return void this.worldLayer.updateSinglePixel(t.data.tile_id,ce.TileTypeBase.edge_color_ocean);if(t.type.canBeFilledWithOcean)return void this.worldLayer.updateSinglePixel(t.data.tile_id,ce.TileTypeBase.edge_color_no_ocean)}this.worldLayer.updateSinglePixel(t.data.tile_id,t.getColor())}else this.worldLayer.updateSinglePixel(t.data.tile_id,ce.TileTypeBase.edge_color_hills)},e.prototype.specialPowerAction=function(t){t&&this.isSelectedPower("relations")&&(kt.default.selectedKingdom=this.kingdoms.getRandom())},e.prototype.isSelectedPower=function(t){var e,i;return(null===(i=null===(e=Te.PowerButtonSelector.inst.selectedButton)||void 0===e?void 0:e.godPower)||void 0===i?void 0:i.id)==t},e.prototype.getSelectedPower=function(){var t;return Te.PowerButtonSelector.inst.selectedButton?null===(t=Te.PowerButtonSelector.inst.selectedButton.godPower)||void 0===t?void 0:t.id:""},e.prototype.isSelectedPowerAny=function(){return!!Te.PowerButtonSelector.inst.selectedButton},e.prototype.isPowerForceMapMode=function(t){var e;return void 0===t&&(t=ee.MapMode.None),!!Te.PowerButtonSelector.inst.selectedButton&&(null===(e=Te.PowerButtonSelector.inst.selectedButton.godPower)||void 0===e?void 0:e.force_map_text)==t},e.prototype.getForcedMapMode=function(t){var e;return void 0===t&&(t=ee.MapMode.None),Te.PowerButtonSelector.inst.selectedButton?null===(e=Te.PowerButtonSelector.inst.selectedButton.godPower)||void 0===e?void 0:e.force_map_text:ee.MapMode.None},e.prototype.showCityZones=function(){return!!_e.default.optionBoolEnabled("map_city_zones")||this.isPowerForceMapMode(ee.MapMode.Villages)},e.prototype.showKingdomZones=function(){return!!_e.default.optionBoolEnabled("map_kingdom_zones")||this.isPowerForceMapMode(ee.MapMode.Kingdoms)},e.prototype.showCultureZones=function(){return!!_e.default.optionBoolEnabled("map_culture_zones")||this.isPowerForceMapMode(ee.MapMode.Cultures)},e.prototype.showMapNames=function(){return!!_e.default.optionBoolEnabled("map_names")||this.isPowerForceMapMode(ee.MapMode.Villages)},e.prototype.spawnCongratulationFireworks=function(){var t,e=bt.Toolbox.getRandom(this.citiesList);if(e){var i=e.buildings.getRandom();(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.underConstruction)||this.stackEffects.spawnFireworks(i.currentTile,.2)}},e.prototype.spawnForcedFireworks=function(){var t=bt.Toolbox.getRandom(this.tilesList);_e.default.dict.get("sound").boolVal=!0,this.stackEffects.spawnFireworks(t,0)},e.prototype.spawnPeaceFireworks=function(t){var e,i=t.capital;if(i){var o=null===(e=i.buildings)||void 0===e?void 0:e.getRandom();(null==o?void 0:o.data)&&(null==o?void 0:o.currentTile)&&!o.data.underConstruction&&this.stackEffects.spawnFireworks(o.currentTile,.2)}},e.prototype.createShadow=function(t,e){void 0===e&&(e="");var i=cc.instantiate(yt.default.inst.shadow);i.parent=this.transformShadows;var o=i.getComponent(z.default);return o.setShadow(e),o},e.prototype.getCivWorldPopulation=function(){for(var t=0,e=this.countPopPoints(),i=this.units.getSimpleList(),o=0;o<i.length;o++)i[o].stats.unit&&t++;return t+e},e.prototype.countPopPoints=function(){for(var t=0,e=0;e<this.citiesList.length;e++)t+=this.citiesList[e].getPopulationPopPoints();return t},e.prototype.checkAchievementByPower=function(t,e){var i=g.default.getPropConfigByID(e.propID);if(2==i.index&&m.default.update(12),i.index>=2&&!g.default.member.usedProp.usedAll){var o=new Set(g.default.member.usedProp.list);o.add(e.propID),o.size>=115?(g.default.member.usedProp.list=[],g.default.member.usedProp.usedAll=!0,m.default.update(63)):g.default.member.usedProp.list=Array.from(o),g.default.save()}"beehive"==t&&(this.placeBeehive=!0)},e.prototype.countKillByDestructionPowers=function(){if(!m.default.isComplete(36)){var t=Math.floor(cc.sys.now()/1e3);if(this.achievementDestructionKills.set(t,this.mapStats.deaths_explosion),this.achievementDestructionKills.size>=5){var e=Array.from(this.achievementDestructionKills.keys()),i=this.achievementDestructionKills.get(e[4])-this.achievementDestructionKills.get(e[0]);i>=100?(m.default.update(36,i,!0),this.achievementDestructionKills=null):this.achievementDestructionKills.delete(e[0])}}m.default.update(75,this.mapStats.deaths_explosion,!0)},e.prototype.countKillByDivineLightPowers=function(){if(!m.default.isComplete(45)){var t=Math.floor(cc.sys.now()/1e3);if(this.achievementDivineLightKills.set(t,this.mapStats.deaths_divine),this.achievementDivineLightKills.size>=10){var e=Array.from(this.achievementDivineLightKills.keys()),i=this.achievementDivineLightKills.get(e[9])-this.achievementDivineLightKills.get(e[0]);i>=50?(m.default.update(45,i,!0),this.achievementDivineLightKills=null):this.achievementDivineLightKills.delete(e[0])}}},e.inst=null,e.tile_id=0,e.temp_list_tiles=[],e.temp_list_tiles2=[],s([xe({type:[cc.TextAsset],tooltip:"\u65b0\u624b\u5f15\u5bfc\u7528\u7684\u5730\u56fe"})],e.prototype,"savedGuideMap",void 0),s([xe({type:cc.Prefab,tooltip:"\u57ce\u5e02\u4fe1\u606f\u9884\u5236"})],e.prototype,"prefab_city",void 0),s([xe({type:me.default,tooltip:"\u5730\u56fe\u4fdd\u5b58\u7ba1\u7406"})],e.prototype,"saveManager",void 0),s([xe({type:he.default,tooltip:"\u5730\u56fe\u7f29\u653e\u63a7\u5236"})],e.prototype,"tilemap",void 0),s([xe({type:Dt.default,tooltip:"\u7279\u6548\u7ba1\u7406"})],e.prototype,"stackEffects",void 0),s([xe({type:fe.default,tooltip:"\u6253\u5370\u7ba1\u7406"})],e.prototype,"printLibrary",void 0),s([xe({type:Gt.default,tooltip:"\u6389\u843d\u7ba1\u7406"})],e.prototype,"dropManager",void 0),s([xe({type:ne.default,tooltip:"\u5bfb\u8def\u7ba1\u7406"})],e.prototype,"pathFindingVisualiser",void 0),s([xe({type:ee.default,tooltip:"\u7f29\u7565\u5730\u56fe\u7ed8\u5236\u5c42"})],e.prototype,"worldLayer",void 0),s([xe({type:Yt.default,tooltip:"\u5355\u4f4d\u7ed8\u5236\u5c42"})],e.prototype,"unitLayer",void 0),s([xe({type:Kt.default,tooltip:"\u5ca9\u6d46\u7ed8\u5236\u5c42"})],e.prototype,"lavaLayer",void 0),s([xe({type:Vt.default,tooltip:"\u7070\u8272\u7c98\u7a20\u5c42"})],e.prototype,"greyGooLayer",void 0),s([xe({type:Lt.default,tooltip:"\u50cf\u7d20\u6389\u843d\u7ed8\u5236\u5c42"})],e.prototype,"flashEffects",void 0),s([xe({type:qt.default,tooltip:"\u71c3\u70e7\u7ed8\u5236\u5c42"})],e.prototype,"fireLayer",void 0),s([xe({type:Qt.default,tooltip:"\u5730\u533a\u8ba1\u7b97\u5c42"})],e.prototype,"zoneCalculator",void 0),s([xe({type:Jt.default,tooltip:"\u9053\u8def\u8ba1\u7b97\u6a21\u5757"})],e.prototype,"roadsCalculator",void 0),s([xe({type:Ut.default,tooltip:"\u70e7\u6bc1\u7ed8\u5236\u5c42"})],e.prototype,"burnedLayer",void 0),s([xe({type:Pt.default,tooltip:"\u7206\u70b8\u7ed8\u5236\u5c42"})],e.prototype,"explosionLayer",void 0),s([xe({type:Wt.default,tooltip:"\u5eb7\u5a01\u751f\u547d\u7ed8\u5236\u5c42"})],e.prototype,"conwayLayer",void 0),s([xe({type:pe.default,tooltip:"\u5730\u9707\u63a7\u5236\u5236\u5c42"})],e.prototype,"earthquakeManager",void 0),s([xe({type:Ct.CloudController,tooltip:"\u4e91\u63a7\u5236\u5c42"})],e.prototype,"cloudController",void 0),s([xe({type:Mt.WaveController,tooltip:"\u6ce2\u6d6a\u63a7\u5236\u5c42"})],e.prototype,"waveController",void 0),s([xe({type:Ot.GlowParticles,tooltip:"\u71c3\u70e7\u7c92\u5b50\u53d1\u5c04\u5668"})],e.prototype,"particlesFire",void 0),s([xe({type:Ot.GlowParticles,tooltip:"\u70df\u96fe\u7c92\u5b50\u53d1\u5c04\u5668"})],e.prototype,"particlesSmoke",void 0),s([xe({type:Rt.default,tooltip:"\u707c\u70ed\u5c04\u7ebf\u7ed8\u5236\u5c42"})],e.prototype,"heatRayFx",void 0),s([xe({type:xt.default,tooltip:"\u795e\u5149\u7ed8\u5236\u5c42"})],e.prototype,"fxDivineLight",void 0),s([xe({type:Xt.MapBorder,tooltip:"\u5730\u56fe\u8fb9\u754c\u7ed8\u5236\u5c42"})],e.prototype,"mapBorder",void 0),s([xe({type:re.default,tooltip:"\u5730\u56fe\u7f29\u653e\u63a7\u5236"})],e.prototype,"qualityChanger",void 0),s([xe({type:cc.Node,tooltip:"\u6240\u6709\u9700\u8981\u5c42\u7ea7\u6392\u5e8f\u7684\u5143\u7d20\u7684\u7236\u8282\u70b9"})],e.prototype,"transformParents",void 0),s([xe({type:cc.Node,tooltip:"\u4e0d\u5728\u5c0f\u5730\u56fe\u9690\u85cf\u7684actor\u7236\u8282\u70b9"})],e.prototype,"transformCreatures",void 0),s([xe({type:cc.Node,tooltip:"Plants\u7236\u8282\u70b9"})],e.prototype,"transformPlants",void 0),i=s([Ce],e)}(cc.Component);n.default=Ae,cc._RF.pop()},{}],MapChunkManager:[function(t,e,i){"use strict";cc._RF.push(e,"fe04d7Lf3dGr4qqn/e3Lbi/","MapChunkManager");var o=t,a=i,n=function(t,e,i,o){return new(i||(i=Promise))(function(a,n){function r(t){try{l(o.next(t))}catch(e){n(e)}}function s(t){try{l(o.throw(t))}catch(e){n(e)}}function l(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}l((o=o.apply(t,e||[])).next())})},r=function(t,e){var i,o,a,n,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(t){return function(e){return l([t,e])}}function l(n){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,o=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(a=(a=r.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){r.label=n[1];break}if(6===n[0]&&r.label<a[1]){r.label=a[1],a=n;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(n);break}a[2]&&r.ops.pop(),r.trys.pop();continue}n=e.call(t,r)}catch(s){n=[6,s],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(a,"__esModule",{value:!0});var s=o("CachedRaycastIslands"),l=o("Config"),c=o("MapBox"),d=o("WorldTile"),u=o("MapChunk"),h=function(){function t(){this.color1=cc.Color.GRAY,this.color2=cc.Color.WHITE,this.list=[],this.dirtyChunks_regions=[],this.dirtyChunks_links=[],this.m_dirtyChunks=0,this.timer=.4,this.amountX=0,this.amountY=0}return t.prototype.logicUpdate=function(t){this.timer>0?this.timer-=t:this.updateDirty()},t.prototype.prepare=function(){this.list=[],this.amountX=8*l.default.ZONE_AMOUNT_X,this.amountY=8*l.default.ZONE_AMOUNT_Y;for(var t=0,e=0;e<this.amountY;e++)for(var i=0;i<this.amountX;i++){var o=new u.default;o.id=t++,o.x=i,o.y=e,o.color=(i+e)%2==0?this.color1:this.color2;var a=c.default.inst.zoneCalculator.getZoneByID(o.id);a.chunk=o,o.zone=a,this.list.push(o),this.fill(o)}this.generateNeighbours()},t.prototype.fill=function(t){for(var e=8*t.x,i=8*t.y,o=null,a=0;a<8;a++)for(var n=0;n<8;n++)(o=c.default.inst.getTile(a+e,n+i)).chunk=t,t.addTile(o,a,n);for(var r=0;r<8;r++)(o=c.default.inst.getTile(r+e,i))&&t.edges_down.push(o);for(var s=0;s<8;s++)(o=c.default.inst.getTile(s+e,i+8))&&t.edges_up.push(o);for(var l=0;l<8;l++)(o=c.default.inst.getTile(e,i+l))&&t.edges_left.push(o);for(var d=0;d<8;d++)(o=c.default.inst.getTile(e+8,i+d))&&t.edges_right.push(o);(o=c.default.inst.getTile(e+8,i+8))&&t.edge_special.push(o),(o=c.default.inst.getTile(e,i))&&t.edge_special_bottom.push(o)},t.prototype.generateNeighbours=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];e.neighbours=[],e.neighboursAll=[];var i=this.get(e.x-1,e.y);e.addNeighbour(i,d.TileDirection.Left),i=this.get(e.x+1,e.y),e.addNeighbour(i,d.TileDirection.Right),i=this.get(e.x,e.y-1),e.addNeighbour(i,d.TileDirection.Down),i=this.get(e.x,e.y+1),e.addNeighbour(i,d.TileDirection.Up),i=this.get(e.x-1,e.y-1),e.addNeighbour(i,d.TileDirection.Null,!0),i=this.get(e.x-1,e.y+1),e.addNeighbour(i,d.TileDirection.Null,!0),i=this.get(e.x+1,e.y-1),e.addNeighbour(i,d.TileDirection.Null,!0),i=this.get(e.x+1,e.y+1),e.addNeighbour(i,d.TileDirection.Null,!0)}},t.prototype.get=function(t,e){if(t<0||t>=this.amountX||e<0||e>=this.amountY)return null;var i=e*this.amountX+t;return i>=this.list.length?null:this.list[i]},t.prototype.getByID=function(t){return this.list[t]},t.prototype.clearAll=function(){c.default.inst.islandsCalculator.clear(),this.dirtyChunks_links=[],this.dirtyChunks_regions=[];for(var t=0;t<this.list.length;t++)this.list[t].clearFull()},t.prototype.setDirty=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),e&&!t.dirty_regions&&(t.dirty_regions=!0,this.dirtyChunks_regions.push(t)),i&&!t.dirty_links&&(t.dirty_links=!0,this.dirtyChunks_links.push(t))},t.prototype.allDirty=function(){this.dirtyChunks_links=[],this.dirtyChunks_regions=[];for(var t=0;t<this.list.length;t++){var e=this.list[t];e.dirty_links=!0,e.dirty_regions=!0}this.dirtyChunks_links.addRange(this.list),this.dirtyChunks_regions.addRange(this.list),this.updateDirty()},t.prototype.updateDirty=function(){return n(this,void 0,void 0,function(){var e,i,o,a,n,l,d,u,h,p,f,_;return r(this,function(){if(c.default.inst.isActionHappening()||0==this.dirtyChunks_links.length&&0==this.dirtyChunks_regions.length)return[2];for(this.timer=.4,this.m_dirtyChunks=this.dirtyChunks_regions.length,t.m_newRegions=0,t.m_newLinks=0,t.m_newIslands=0,cc.sys.now(),e=0;e<this.dirtyChunks_regions.length;e++)(h=this.dirtyChunks_regions[e]).clearFull();for(i=0;i<this.dirtyChunks_links.length;i++)(h=this.dirtyChunks_links[i]).clearIsland();if(t.PARALLEL)async.map(this.dirtyChunks_regions,function(t){t.calculateRegions()},function(){});else for(o=0;o<this.dirtyChunks_regions.length;o++)(h=this.dirtyChunks_regions[o]).calculateRegions();for(a=0;a<this.dirtyChunks_regions.length;a++)h=this.dirtyChunks_regions[a],t.m_newRegions+=h.regions.length,h.shuffleRegionTiles();if(t.PARALLEL)async.map(this.dirtyChunks_links,function(t){t.calculateLinks(t)},function(){});else for(n=0;n<this.dirtyChunks_links.length;n++)(h=this.dirtyChunks_links[n]).calculateLinks(h);for(l=0;l<this.dirtyChunks_links.length;l++)(h=this.dirtyChunks_links[l]).checkLinksResults();if(t.PARALLEL)d=this,async.map(this.dirtyChunks_links,function(t){d.calculateRegionNeighbours(t)},function(){});else for(u=0;u<this.dirtyChunks_links.length;u++)h=this.dirtyChunks_links[u],this.calculateRegionNeighbours(h);for(c.default.inst.islandsCalculator.findIslands(),p=0;p<c.default.inst.islandsCalculator.islands.length;p++)for(f=c.default.inst.islandsCalculator.islands[p].regions.getSimpleList(),_=0;_<f.length;_++)f[_].calculateCenterRegion();return this.dirtyChunks_links=[],this.dirtyChunks_regions=[],c.default.inst.cityPlaceFinder.setDirty(),c.default.inst.regionPathFinder.clearCache(),s.default.clear(),cc.sys.now(),[2]})})},t.prototype.calculateRegionNeighbours=function(t){for(var e=0;e<t.regions.length;e++)t.regions[e].calculateNeighbours()},t.prototype.calcRegions=function(){for(var t=0,e=0;e<this.list.length;e++)t+=this.list[e].regions.length;return t},t.PARALLEL=!1,t.m_newRegions=0,t.m_newLinks=0,t.m_newIslands=0,t}();a.default=h,cc._RF.pop()},{}],MapChunk:[function(t,e,i){"use strict";cc._RF.push(e,"c8e97m0lD9FJZUX/SRchPrf","MapChunk");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapBox"),r=o("WorldTile"),s=o("MapChunkManager"),l=o("MapRegion"),c=o("RegionLinkHashes"),d=function(){function t(){this.k_list_objects=[],this.k_dict_objects=new Map,this.neighbours=[],this.neighboursAll=[],this.tiles=[],this.regions=[],this.edges_left=[],this.edges_up=[],this.edges_down=[],this.edges_right=[],this.edge_special_bottom=[],this.edge_special=[],this.world_edge=!1,this.zone=null,this.x=0,this.y=0,this.id=0,this.color=cc.Color.TRANSPARENT,this.dirty_regions=!1,this.dirty_links=!1,this.chunk_up=null,this.chunk_down=null,this.chunk_left=null,this.chunk_right=null,this._temp_tiles=[],this._tilesToCheck=[],this._newHashes=[]}return t.prototype.addTile=function(t){this.tiles.push(t)},t.prototype.addNeighbour=function(t,e,i){if(void 0===i&&(i=!1),t)switch(i||this.neighbours.push(t),this.neighboursAll.push(t),e){case r.TileDirection.Up:this.chunk_up=t;break;case r.TileDirection.Down:this.chunk_down=t;break;case r.TileDirection.Left:this.chunk_left=t;break;case r.TileDirection.Right:this.chunk_right=t}else this.world_edge=!0},t.prototype.calculateRegions=function(){this.dirty_regions=!1;for(var t=0;t<this.tiles.length;t++){var e=this.tiles[t];e.checkedTile=!1,e.region=null,e.edge_region_right=null,e.edge_region_up=null}var i=!0;for(t=0;t<this.tiles.length;t++){var o=this.tiles[t];if(!o.region){s.default.m_newRegions++;var a=new l.default;a.type=o.type.layerType,a.chunk=this;var n=this.newRegion(o,o.type.layerType,a,i),r=a.tiles[0];if(a.id=1e3*r.zone.id+this.regions.length,a.zone_id=r.zone.id,a.zone=r.zone,this.regions.push(a),n)break;i=!1}}},t.prototype.shuffleRegionTiles=function(){for(var t=0;t<this.regions.length;t++){var e=this.regions[t];this.regions.length>1?e.centerRegion=!1:e.centerRegion=!0,e.tiles.shuffle()}},t.prototype.newRegion=function(e,i,o,a){if(t._nextWave=[],t._nextWave.push(e),a){for(var n=!1,r=0;r<this.tiles.length;r++)if(this.tiles[r].type.layerType!=i){n=!0;break}if(!n){for(r=0;r<this.tiles.length;r++){var s=this.tiles[r];s.region=o,o.tiles.push(s)}return!0}}for(var l=0;l<t._nextWave.length;){var c=t._nextWave[l];for(c.checkedTile=!0,c.region=o,o.tiles.push(c),l++,r=0;r<c.neighboursAll.length;r++){var d=c.neighboursAll[r];d.checkedTile||d.type.layerType!=c.region.type||d.chunk!=this||(d.checkedTile=!0,d.region=o,t._nextWave.push(d))}}return 64==o.tiles.length},t.prototype.canContinue=function(t,e){return!!t&&!t.checkedTile&&t.type.layerType==e&&t.chunk==this},t.prototype.clearObjects=function(){this.k_dict_objects.clear(),this.k_list_objects=[]},t.prototype.addObject=function(e){e.kingdom&&(t._objectList=this.k_dict_objects.get(e.kingdom),t._objectList&&0!=t._objectList.length||(t._objectList=[],this.k_list_objects.push(e.kingdom),this.k_dict_objects.set(e.kingdom,t._objectList)),t._objectList.push(e))},t.prototype.clearFull=function(){this.clearIsland(),this.regions=[],this.clearObjects()},t.prototype.clearIsland=function(){for(var t=0;t<this.regions.length;t++){var e=this.regions[t];e.clear(),e.island&&e.island.clearRegionsFromIsland()}},t.prototype.calculateLinks=function(t){t.dirty_links=!1,this.calculateLink(t.edges_right,l.LinkDirection.Right,l.LinkDirection.LR),this.calculateLink(t.edges_left,l.LinkDirection.Left,l.LinkDirection.LR),this.calculateLink(t.edges_up,l.LinkDirection.Up,l.LinkDirection.UD),this.calculateLink(t.edges_down,l.LinkDirection.Down,l.LinkDirection.UD),t.edge_special.length>0&&this.calculateLink(t.edge_special,l.LinkDirection.Up,l.LinkDirection.UD),t.edge_special_bottom.length>0&&this.calculateLink(t.edge_special_bottom,l.LinkDirection.Down,l.LinkDirection.UD)},t.prototype.checkTileEdges=function(t,e,i,o){if(!e){var a=n.default.inst.getTile(t.x+i,t.y+o);a&&this._tilesToCheck.push(a)}},t.prototype.findRegionToLink=function(t,e,i,o,a){for(var n=0;n<t.length;n++){var r=t[n];switch(this._tilesToCheck=[],e){case l.LinkDirection.Up:this._tilesToCheck.push(r.tile_down),this.checkTileEdges(r,o,-1,-1),this.checkTileEdges(r,a,1,-1);break;case l.LinkDirection.Down:this._tilesToCheck.push(r),this.checkTileEdges(r,o,-1,1),this.checkTileEdges(r,a,1,1);break;case l.LinkDirection.Left:this._tilesToCheck.push(r),this.checkTileEdges(r,o,-1,-1),this.checkTileEdges(r,a,-1,1);break;case l.LinkDirection.Right:this._tilesToCheck.push(r.tile_left),this.checkTileEdges(r,o,1,-1),this.checkTileEdges(r,a,1,1)}if(0!=this._tilesToCheck.length)for(var s=0;s<this._tilesToCheck.length;s++){var d=this._tilesToCheck[s];if(d.type.layerType==r.type.layerType){var u=d.region.newConnection(this._temp_tiles,e,i),h=new c.TempLinkStruct;h.region=d.region,h.hash=u,this._newHashes.push(h)}}}},t.prototype.checkLinksResults=function(){for(var t=0;t<this._newHashes.length;t++){var e=this._newHashes[t];c.default.addHash(e.hash,e.region)}s.default.m_newLinks+=this._newHashes.length,this._newHashes=[]},t.prototype.calculateLink=function(t,e,i){this._temp_tiles=[];for(var o=null,a=null,n=!1,r=!1,s=0;s<t.length;s++)o=t[s],(a=s+1>=t.length?null:t[s+1])&&o.type.layerType==a.type.layerType?this._temp_tiles.push(o):(this._temp_tiles.push(o),t.length>1?(n=this._temp_tiles[0]==t[0],r=this._temp_tiles[this._temp_tiles.length-1]==t[t.length-1]):(n=!1,r=!1),this.findRegionToLink(this._temp_tiles,e,i,n,r),this._temp_tiles=[])},t.debug=!1,t._nextWave=[],t._objectList=[],t}();a.default=d,cc._RF.pop()},{}],MapEdges:[function(t,e,i){"use strict";cc._RF.push(e,"f0194Bq/RdLrbux77Sy8vlr","MapEdges");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MathUtils"),r=o("MapBox"),s=o("TextureLoader"),l=function(){function t(){}return t.addEdge=function(){t.textureLeft||(t.textureLeft=s.TextureLoader.inst.getTexture(s.BIN_TYPE.edges,"edge100xLeft"),t.textureRight=s.TextureLoader.inst.getTexture(s.BIN_TYPE.edges,"edge100xRight"),t.textureUp=s.TextureLoader.inst.getTexture(s.BIN_TYPE.edges,"edge100xUp"),t.textureDown=s.TextureLoader.inst.getTexture(s.BIN_TYPE.edges,"edge100xDown"));for(var e=n.default.intCast(r.default.width/t.edgeSize)+1,i=n.default.intCast(r.default.height/t.edgeSize)+1,o=0;o<i;o++)t.fill(0,o,t.textureLeft);for(var a=0;a<i;a++)t.fill(e-2,a,t.textureRight,!0,!1);for(var l=0;l<e;l++)t.fill(l,0,t.textureDown);for(var c=0;c<e;c++)t.fill(c,i-2,t.textureUp,!1,!0)},t.fill=function(e,i,o,a,n){void 0===a&&(a=!1),void 0===n&&(n=!1);for(var s=0;s<o.height;s++)for(var l=0;l<o.width;l++){var c=o.getPixel(l,s).a,d=a?r.default.width-t.edgeSize+l:l+e*t.edgeSize,u=n?r.default.height-t.edgeSize+s:s+i*t.edgeSize,h=r.default.inst.getTile(d,u);h&&(h.height-=c)}},t.textureLeft=null,t.textureRight=null,t.textureUp=null,t.textureDown=null,t.edgeSize=50,t}();a.default=l,cc._RF.pop()},{}],MapGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"d5bf425t+FDrbaP0UaZ89E2","MapGenerator");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.MapSizePresset=void 0;var r=o("MapAction"),s=o("AssetManager"),l=o("DropsLibrary"),c=o("TopTileLibrary"),d=o("BaseBuilding"),u=o("GeneratorTool"),h=o("SmoothLoader"),p=o("ToolBox"),f=o("Config"),_=o("MapBox"),m=o("TileTypeBase"),g=o("MapEdges"),y=function(){function t(){this.Tiny="tiny",this.Small="small",this.Standard="standard",this.Large="large",this.Huge="huge",this.Gigantic="gigantic",this.Titanic="titanic",this.Iceberg="iceberg"}return t.getSize=function(t){switch(t){case"tiny":return 2;case"small":return 3;case"standard":return 4;case"large":return 5;case"huge":return 6;case"gigantic":return 7;case"titanic":return 8;case"iceberg":return 9;default:return 2}},t.getPreset=function(t){switch(t){case 2:return"tiny";case 3:return"small";case 4:return"standard";case 5:return"large";case 6:return"huge";case 7:return"gigantic";case 8:return"titanic";case 9:return"iceberg";default:return""}},t.isSizeValid=function(e){return!(!t.getPreset(e)||e>t.getSize(f.default.maxMapSize))},t}();a.MapSizePresset=y;var v=function(){function t(){}return t.prepare=function(e){switch(t._width=_.default.width,t._height=_.default.height,t._random_shapes_amount=0,t._water_level=0,t._random_shapes=!1,e){case"archipelago":case"islands":t._random_shapes=!0,t._random_shapes_amount=20}"archipelago"==e?t._perlinScale=20:"islands"==e&&(t._perlinScale=5),"custom"==e&&(t._random_shapes_amount=f.default.customRandomShapes,t._perlinScale=f.default.customPerlinScale,t._water_level=f.default.customWaterLevel,t._random_shapes=!0),t._random_shapes&&t.schedulePerlinNoiseMap();for(var i=_.default.inst.tilesList.length/4,o=0,a=function(){var t=Math.min(_.default.inst.tilesList.length-o,i),e=o;o+=t,h.default.add(function(){u.GeneratorTool.updateTileTypes(!0,e,t)},"Generate Tiles ("+o+"/"+_.default.inst.tilesList.length+")",!0)},n=0;n<4;n++)a();h.default.add(function(){_.default.inst.mapChunkManager.allDirty()},"Map Chunk Manager (1/2)",!0),h.default.add(function(){_.default.inst.mapChunkManager.updateDirty()},"Map Chunk Manager (2/2)",!0),h.default.add(function(){t.addRandomBiome()},"Add Random Biome"),h.default.add(function(){t.tryToAddRandomBiomeIslands()},"Add Random Biome Islands"),h.default.add(function(){t.freezeMountainTops()},"Freeze Mountain Tops");for(var r=_.default.inst.tilesList.length/20,l=0;l<12;l++)h.default.add(function(){s.default.tiles.setListTo("gameplay"),t.spawnVegetation(r)},"Add Vegetation ("+(l+1)+"/12)");h.default.add(function(){t.spawnResources()},"Add Resources")},t.schedulePerlinNoiseMap=function(e){void 0===e&&(e=!0);for(var i=0;i<t._random_shapes_amount;i++)h.default.add(function(){u.GeneratorTool.applyRandomShape(2,.7,!0)},"Perlin Random Shapes ("+(i+1)+"/"+t._random_shapes_amount+")");h.default.add(function(){t._perlinX=p.Toolbox.randomInt(0,15e3),t._perlinY=p.Toolbox.randomInt(0,15e3);var e=t._perlinScale;u.GeneratorTool.applyPerlinNoice(t._width,t._height,t._perlinX,t._perlinY,1,1*e)},"Perlin Noise",!0),h.default.add(function(){e&&g.default.addEdge()},"Perlin Edges",!0),h.default.add(function(){var e=t._perlinScale,i=p.Toolbox.randomInt(0,1e4),o=p.Toolbox.randomInt(0,1e4);u.GeneratorTool.applyPerlinNoice(t._width,t._height,i,o,.2,4*e,!0)},"Perlin Noise (1/2)"),h.default.add(function(){var e=t._perlinScale,i=p.Toolbox.randomInt(0,1e4),o=p.Toolbox.randomInt(0,1e4);u.GeneratorTool.applyPerlinNoice(t._width,t._height,i,o,.1,10*e,!0)},"Perlin Noise (2/2)");for(var o=0;o<t._random_shapes_amount/2;o++)h.default.add(function(){u.GeneratorTool.applyRandomShape(2,.7,!0)},"Perlin Random Shapes ("+(o+1)+"/"+t._random_shapes_amount+")");h.default.add(function(){u.GeneratorTool.applyWaterLevel(t._width,t._height,t._water_level)},"Perlin Water",!0),h.default.add(function(){u.GeneratorTool.applyRingEffect()},"Perlin Ring",!0)},t.addRandomShapes=function(t){for(var e=0;e<t;e++)u.GeneratorTool.applyRandomShape(2,.7,!0)},t.addRandomBiome=function(){for(var t,e,i=0;i<_.default.inst.islandsCalculator.islands.length;i++){var o=_.default.inst.islandsCalculator.islands[i];if(0==o.type){var a=c.default.pool_biomes.getRandom();try{for(var r=(t=void 0,n(o.regions.list)),s=r.next();!s.done;s=r.next())for(var d=s.value,u=0;u<d.tiles.length;u++)l.default.useSeedOn(d.tiles[u],a.low,a.high)}catch(f){t={error:f}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}}},t.tryToAddRandomBiomeIslands=function(){if(_.default.inst.gameStats.gameTime>200)for(var t=0;t<_.default.inst.islandsCalculator.islands.length;t++){var e=_.default.inst.islandsCalculator.islands[t];p.Toolbox.randomChance(.2)||e.type!=m.TileLayerType.Ground||u.GeneratorTool.modifyIsland(e)}},t.freezeMountainTops=function(){for(var t=0;t<_.default.inst.tilesList.length;t++){var e=_.default.inst.tilesList[t];e.type.isType("mountains")&&e.height>220&&r.default.freezeTile(e)}},t.spawnVegetation=function(t){for(var e=0;e<t;e++){var i=_.default.inst.tilesList.getRandom();i.type.ground&&i.zone.trees.size<3&&i.type.grow_vegetation_auto&&(p.Toolbox.randomBool()?_.default.inst.tryGrowVegetationRandom(i,d.VegetationType.Plants,!0):_.default.inst.tryGrowVegetationRandom(i,d.VegetationType.Trees,!0))}},t.spawnResources=function(){var t=_.default.inst.tilesList.length/1e3,e=t/2,i=e/2,o=i;_.default.inst.spawnResource(t,"stone"),_.default.inst.spawnResource(i,"gold"),_.default.inst.spawnResource(e,"ore_deposit"),_.default.inst.spawnResource(o,"fruit_bush",!1),_.default.inst.spawnBeehvies(o/2)},t._perlinScale=1,t._perlinX=1,t._perlinY=1,t._random_shapes_amount=0,t._water_level=0,t._width=0,t._height=0,t._random_shapes=!1,t}();a.default=v,cc._RF.pop()},{}],MapLayer:[function(t,e,i){"use strict";cc._RF.push(e,"4ae0beddDhIh5mhliY15TWw","MapLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MapMode=n.MapObjectType=void 0;var l=a("BaseMapObject"),c=a("MapBox"),d=a("TileDictionary");(function(t){t[t.Actor=0]="Actor",t[t.Building=1]="Building",t[t.All=2]="All"})(n.MapObjectType||(n.MapObjectType={})),function(t){t[t.None=0]="None",t[t.Kingdoms=1]="Kingdoms",t[t.Cultures=2]="Cultures",t[t.Villages=3]="Villages"}(n.MapMode||(n.MapMode={}));var u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoDisable=!1,e.autoDisableCheckPixels=!1,e.textureID=0,e.timer=0,e.colorValues=cc.Color.TRANSPARENT,e.colors_amount=1,e.sprRnd=null,e.texture=new cc.Texture2D,e.textureData=null,e.pixels_to_update=new d.TileDictionary,e.colors=[],e.tileDictionary=new d.TileDictionary,e.textureWidth=0,e.textureHeight=0,e}return r(e,t),e.prototype.getTextureData=function(){return this.textureData},e.prototype.onLoad=function(){this.create()},e.prototype.create=function(){t.prototype.create.call(this),this.sprRnd=this.getComponent(cc.Sprite),this.colors=[],this.createColors(),this.texture.setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST)},e.prototype.checkAutoDisable=function(){this.autoDisable&&(this.autoDisableCheckPixels?this.sprRnd.enabled=this.pixels_to_update.count()>0:this.tileDictionary.count()>0?this.sprRnd.enabled=!0:this.sprRnd.enabled=!1)},e.prototype.createTextureNew=function(t,e){void 0===t&&(t=c.default.width),void 0===e&&(e=c.default.height),t==this.textureWidth&&e==this.textureHeight||(this.textureWidth=t,this.textureHeight=e,this.sprRnd&&(delete this.textureData,this.node.width=t,this.node.height=e,this.textureData=new Uint8Array(t*e*4),this.textureData.fill(0),this.texture.initWithData(this.textureData,cc.Texture2D.PixelFormat.RGBA8888,t,e),this.sprRnd.spriteFrame||(this.sprRnd.spriteFrame=new cc.SpriteFrame,this.sprRnd.spriteFrame.setTexture(this.texture))),this.updatePixels())},e.prototype.contains=function(t){return this.pixels_to_update.contains(t)},e.prototype.clear=function(){this.pixels_to_update.clear(),this.textureData&&(this.textureData.fill(0),this.updatePixels())},e.prototype.setRendererEnabled=function(t){this.sprRnd||(this.sprRnd=this.getComponent(cc.Sprite)),this.sprRnd.enabled=t},e.prototype.createColors=function(){for(var t=0;t<this.colors_amount;t++){var e=t<=0?0:1/this.colors_amount*t;this.colors.push(cc.color(this.colorValues.r,this.colorValues.g,this.colorValues.b,e*this.colorValues.a))}},e.prototype.logicUpdate=function(t){var e;this.sprRnd||(this.sprRnd=this.getComponent(cc.Sprite)),this.checkAutoDisable(),(null===(e=this.sprRnd)||void 0===e?void 0:e.enabled)&&this.updateDirty(t)},e.prototype.updateSinglePixel=function(t,e){if(this.texture&&this.textureData){var i=Math.floor(t/this.textureWidth),o=t-i*this.textureWidth;this.updateTilePixel(o,i,e)}},e.prototype.updateTilePixel=function(t,e,i){if(!(t<0||t>=this.textureWidth||e<0||e>=this.textureHeight)){var o=(this.textureHeight-1-e)*this.textureWidth+t;this.textureData[4*o+0]=i.r,this.textureData[4*o+1]=i.g,this.textureData[4*o+2]=i.b,this.textureData[4*o+3]=i.a}},e.prototype.updatePixels=function(){var t;this.texture&&this.textureData&&(null===(t=this.sprRnd)||void 0===t?void 0:t.enabled)&&this.texture.initWithData(this.textureData,cc.Texture2D.PixelFormat.RGBA8888,this.textureWidth,this.textureHeight)},e.prototype.updateDirty=function(){},s([p],e.prototype,"autoDisable",void 0),s([p],e.prototype,"autoDisableCheckPixels",void 0),s([p],e.prototype,"textureID",void 0),s([h],e)}(l.default);n.default=f,cc._RF.pop()},{}],MapMarks:[function(t,e,i){"use strict";cc._RF.push(e,"69657hMRY5DtaN3Y2njGRW/","MapMarks");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("AssetManager"),d=a("ToolBox"),u=a("Config"),h=a("MapBox"),p=a("MarkContainer"),f=cc._decorator,_=f.ccclass,m=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pbMapArrow=null,e.pbMapLeader=null,e.pbMapKing=null,e.pbMapArmy=null,e.pbMapMarkBoat=null,e.arrows=null,e.leaders=null,e.kings=null,e.army=null,e.boats=null,e.maxScale=.4,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,this.arrows=new p.default(this.pbMapArrow),this.leaders=new p.default(this.pbMapLeader),this.kings=new p.default(this.pbMapKing),this.army=new p.default(this.pbMapArmy),this.boats=new p.default(this.pbMapMarkBoat)},e.prototype.drawMarks=function(){this.kings.clear(),this.leaders.clear(),this.army.clear(),this.boats.clear(),h.default.inst.qualityChanger.lowRes&&(u.default.showkingsAndLeadersInfo&&this.drawMarksLeaders(),u.default.showmarks_boatsInfo&&this.drawMarksBoats())},e.prototype.drawMarksBoats=function(){var t,e,i,o,a,n,r=null===(i=c.default.raceLibrary.get("boat"))||void 0===i?void 0:i.units;if(r&&0!=r.count)try{for(var s=l(r.list),u=s.next();!u.done;u=s.next()){var h=u.value;if((null===(o=null==h?void 0:h.data)||void 0===o?void 0:o.alive)&&(null===(a=null==h?void 0:h.stats)||void 0===a?void 0:a.drawBoatMark)){var p=null===(n=h.kingdom)||void 0===n?void 0:n.kingdomColor;p?this.drawMark(h.currentTile,null,p.colorBorderOut,this.boats):this.drawMark(h.currentTile,null,d.Toolbox.color_white,this.boats)}}}catch(m){t={error:m}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}},e.prototype.drawMarksLeaders=function(){for(var t,e,i,o,a,n,r,s,l,c,d,u=0;u<h.default.inst.kingdoms.list_civs.length;u++){var p=h.default.inst.kingdoms.list_civs[u];(null===(e=null===(t=p.king)||void 0===t?void 0:t.data)||void 0===e?void 0:e.alive)&&this.drawMark(p.king.currentTile,null,null===(i=p.kingdomColor)||void 0===i?void 0:i.colorBorderOut,this.kings)}for(u=0;u<h.default.inst.kingdoms.list_civs.length;u++){var f=h.default.inst.kingdoms.list_civs[u];for(var _ in f.cities)(null===(a=null===(o=_.leader)||void 0===o?void 0:o.data)||void 0===a?void 0:a.alive)&&this.drawMark(_.leader.currentTile,null,null===(n=f.kingdomColor)||void 0===n?void 0:n.colorBorderOut,this.leaders)}for(u=0;u<h.default.inst.unitGroupManager.groups.length;u++){var m=h.default.inst.unitGroupManager.groups[u];(null===(s=null===(r=m.groupLeader)||void 0===r?void 0:r.data)||void 0===s?void 0:s.alive)&&(null===(c=null===(l=m.groupLeader)||void 0===l?void 0:l.kingdom)||void 0===c?void 0:c.isCiv())&&this.drawMark(m.groupLeader.currentTile,null,null===(d=m.groupLeader.kingdom.kingdomColor)||void 0===d?void 0:d.colorBorderOut,this.army)}},e.prototype.drawArrows=function(){var t,e,i,o,a,n;if(this.arrows&&(this.arrows.clear(),h.default.inst.qualityChanger.lowRes&&u.default.showkingsAndLeadersInfo)){try{for(var r=l(h.default.inst.kingdoms.list_civs),s=r.next();!s.done;s=r.next()){var c=s.value;try{for(var p=(i=void 0,l(c.cities)),f=p.next();!f.done;f=p.next()){var _=f.value;if(_.settleTarget){var m=_.getTile(),g=_.settleTarget.centerTile;m&&g&&this.drawMark(m,g,d.Toolbox.color_yellow,this.arrows)}}}catch(w){i={error:w}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}}}catch(T){t={error:T}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}try{for(var y=l(h.default.inst.kingdoms.list_civs),v=y.next();!v.done;v=y.next()){var b=v.value;b.target_city&&b.capital&&(m=b.capital.getTile(),g=b.target_city.getTile(),m&&g&&this.drawMark(m,g,d.Toolbox.color_red,this.arrows))}}catch(k){a={error:k}}finally{try{v&&!v.done&&(n=y.return)&&n.call(y)}finally{if(a)throw a.error}}}},e.prototype.drawMark=function(t,e,i,o){if(t){var a=o.get();if(a.node.active=!0,a.node.position=t.posV3,a.node.scale=.5,o==this.arrows){var n=57.29578*d.Toolbox.getAngle(t.posV3.x,t.posV3.y,e.posV3.x,e.posV3.y);a.node.angle=n;var r=d.Toolbox.distTile(t,e),s=a.spriteRenderer.node.width;a.node.scaleX=r/s,a.spriteRenderer.node.color=i}else o==this.kings?(a.spriteRenderer.node.color=i,a.node.position=t.posV3):o==this.leaders?(a.spriteRenderer.node.color=i,a.node.position=t.posV3):o==this.army?(a.spriteRenderer.node.color=i,a.node.position=t.posV3):o==this.boats&&(a.spriteRendererSail.node.color=i,a.node.position=t.posV3)}},e.inst=null,s([m(cc.Prefab)],e.prototype,"pbMapArrow",void 0),s([m(cc.Prefab)],e.prototype,"pbMapLeader",void 0),s([m(cc.Prefab)],e.prototype,"pbMapKing",void 0),s([m(cc.Prefab)],e.prototype,"pbMapArmy",void 0),s([m(cc.Prefab)],e.prototype,"pbMapMarkBoat",void 0),i=s([_],e)}(cc.Component);n.default=g,cc._RF.pop()},{}],MapMark:[function(t,e,i){"use strict";cc._RF.push(e,"24b04R68/JJmIuNRpaVhz5W","MapMark");var o,a=i,n=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=cc._decorator,l=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteRenderer=null,e.spriteRendererSail=null,e}return n(e,t),e.prototype.onLoad=function(){this.spriteRenderer=this.node.getComponent(cc.Sprite);var t=this.node.getChildByName("sail");t&&(this.spriteRendererSail=t.getComponent(cc.Sprite))},r([l],e)}(cc.Component));a.default=c,cc._RF.pop()},{}],MapNamesManager:[function(t,e,i){"use strict";cc._RF.push(e,"6cbedG573RIQ6eTNmu0zwah","MapNamesManager");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Globals"),c=a("MapBox"),d=a("MapLayer"),u=a("MapText"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=[],e.cur_active=0,e._lastMode=d.MapMode.None,e.prefab=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.logicUpdate=function(t){this.clear();var e=this.getCurrentMode();switch(this.setMode(e),e){case d.MapMode.None:this.node.active&&(this.node.active=!1);break;case d.MapMode.Cultures:this.node.active||(this.node.active=!0),this.showNameCultures();break;case d.MapMode.Kingdoms:this.node.active||(this.node.active=!0),this.showNameKingdoms();break;case d.MapMode.Villages:this.node.active||(this.node.active=!0),this.showNameCities()}0!=e&&this.updatePositions();for(var i=0;i<this.list.length;i++)this.list[i].logicUpdate(t)},e.prototype.getCurrentMode=function(){var t=d.MapMode.None;return c.default.inst.showMapNames()&&(t=c.default.inst.getForcedMapMode())==d.MapMode.None&&(t=c.default.inst.showCultureZones()?d.MapMode.Cultures:c.default.inst.showKingdomZones()?d.MapMode.Kingdoms:d.MapMode.Villages),t},e.prototype.setMode=function(t){if(this._lastMode!=t){this._lastMode=t;for(var e=0;e<this.list.length;e++)this.list[e].tweenScale=0}},e.prototype.showNameCultures=function(){for(var t=0;t<c.default.inst.cultures.list.length;t++){var e=c.default.inst.cultures.list[t];e.titleCenter!=l.default.POINT_IN_VOID&&this.getTextFor().showTextCulture(e)}},e.prototype.showNameKingdoms=function(){for(var t=0;t<c.default.inst.kingdoms.list.length;t++){var e=c.default.inst.kingdoms.list[t];if(e.capital){var i=this.getTextFor();i.kingdom=e,i.showTextKingdom(e)}}},e.prototype.showNameCities=function(){for(var t=0;t<c.default.inst.citiesList.length;t++){var e=c.default.inst.citiesList[t],i=this.getTextFor();i.city=e,i.showTextCity()}},e.prototype.updatePositions=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];if(e.showing)for(var i=0;i<this.list.length;i++){var o=this.list[i];e!=o&&e.showing&&o.showing&&e.overlaps(o)&&(e.priority_capital&&!o.priority_capital?o.setShowing(!1):!e.priority_capital&&o.priority_capital?e.setShowing(!1):e.priority_population>o.priority_population?o.setShowing(!1):e.setShowing(!1))}}},e.prototype.getTextFor=function(){var t=null;if(this.cur_active==this.list.length){var e=cc.instantiate(this.prefab);e.parent=this.node,(t=e.getComponent(u.default)).clear(),t.manager=this,t.name="map text "+this.list.length,this.list.push(t)}else t=this.list[this.cur_active],this.cur_active++;return t.setShowing(!0),t},e.prototype.clear=function(){this.cur_active=0;for(var t=0;t<this.list.length;t++)this.list[t].clear()},e.inst=null,s([f(cc.Prefab)],e.prototype,"prefab",void 0),i=s([p],e)}(cc.Component);n.default=_,cc._RF.pop()},{}],MapObjectShadow:[function(t,e,i){"use strict";cc._RF.push(e,"04852GyG7JGxZSHhpdNYW2m","MapObjectShadow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("TextureLoader"),c=cc._decorator,d=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteRenderer=null,e.actor=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){this.spriteRenderer=this.getComponent(cc.Sprite)},e.prototype.setShadow=function(t,e){void 0===e&&(e=!1),i.createDict(),this.spriteRenderer=this.getComponent(cc.Sprite),i.shadowSprites.has(t)||i.addSprite(t),this.node.scale=0,this.spriteRenderer.spriteFrame=i.shadowSprites.get(t)},e.createDict=function(){null==i.shadowSprites&&(i.shadowSprites=new Map,l.TextureLoader.inst.getSpriteFrames(l.ATLAS_TYPE.WORLDATLAS,"shadows/buildingShadows").forEach(function(t,e){i.shadowSprites.set(e,t)}))},e.addSprite=function(t){var e=l.TextureLoader.inst.getSpriteFrame(l.ATLAS_TYPE.WORLDATLAS,"shadows/"+t);i.shadowSprites.set(t,e)},e.shadowSprites=null,i=s([d],e)}(cc.Component));n.default=u,cc._RF.pop()},{}],MapRegion:[function(t,e,i){"use strict";cc._RF.push(e,"94b1dK4H4ROkpdQn/vRY0Ex","MapRegion");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.RegionsContainer=n.LinkDirection=void 0;var l,c=a("MathUtils"),d=a("BaseContainer"),u=a("RegionLinkHashes");(function(t){t[t.Up=0]="Up",t[t.Down=1]="Down",t[t.Left=2]="Left",t[t.Right=3]="Right",t[t.LR=4]="LR",t[t.UD=5]="UD"})(l=n.LinkDirection||(n.LinkDirection={}));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(d.ObjectContainer);n.RegionsContainer=h;var p=function(){function t(){this.lastGrassGrowth=0,this.lastBurnedUpdate=0,this.id=0,this.zone_id=0,this.zone=null,this.usedByPathLock=!1,this.regionPathID=-1,this.tiles_corners=[],this.tiles=[],this.links=[],this.edges_left=[],this.edges_up=[],this.edges_down=[],this.edges_right=[],this.island=null,this.isIslandChecked=!1,this.isCheckedPath=!1,this.path_wave_id=-1,this.regionPath=!1,this.chunk=null,this.cornersDirty=!0,this.centerRegion=!1,this.neighbours=[],this._neighbours_hash=new Set}return t.prototype.newConnection=function(t,e,i){switch(e){case l.Right:for(var o=0;o<t.length;o++)t[o].edge_region_right=this;break;case l.Up:for(o=0;o<t.length;o++)t[o].edge_region_up=this}return this.newHash(t,t.length,e,i)},t.prototype.checkDebugEdges=function(t,e){var i=[];switch(e){case l.Left:i=this.edges_left;break;case l.Down:i=this.edges_down;break;case l.Right:i=this.edges_right;break;case l.Up:i=this.edges_up}i.addRange(t)},t.prototype.newHash=function(t,e,i,o){var a=t[0],n=a.x,r=a.y,s=(199*n+7*r)*e*1e4+1e3*e+100*c.default.intCast(a.type.layerType+1)+10*n+r;return o==l.LR&&(s=-s),s},t.prototype.clear=function(){var t,e;try{for(var i=s(this.links),o=i.next();!o.done;o=i.next()){var a=o.value;u.default.remove(a,this)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.links=[],this.regionPathID=-1},t.prototype.calculateNeighbours=function(){var t,e,i,o,a,n;this.neighbours=[],this._neighbours_hash.clear();try{for(var r=s(this.links),l=r.next();!l.done;l=r.next()){var c=l.value;try{for(var d=(i=void 0,s(c.regions)),u=d.next();!u.done;u=d.next()){var h=u.value;h==this||this._neighbours_hash.has(h)||this._neighbours_hash.add(h)}}catch(m){i={error:m}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}}}catch(g){t={error:g}}finally{try{l&&!l.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}try{for(var p=s(this._neighbours_hash),f=p.next();!f.done;f=p.next()){var _=f.value;this.neighbours.push(_)}}catch(y){a={error:y}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(a)throw a.error}}},t.prototype.calculateCenterRegion=function(){if(this.centerRegion=!0,this.chunk.regions.length>1)this.centerRegion=!1;else for(var t=0;t<this.chunk.neighboursAll.length;t++){var e=this.chunk.neighboursAll[t];if(e.regions.length>1){this.centerRegion=!1;break}if(e.regions[0].island!=this.island){this.centerRegion=!1;break}}this.centerRegion||this.island.regionsCorners.push(this)},t.prototype.calculateTileCorners=function(){if(!this.centerRegion&&this.cornersDirty){this.cornersDirty=!1;for(var t=0;t<this.tiles.length;t++)for(var e=0;e<this.tiles[t].neighboursAll.length;e++){var i=this.tiles[t].neighboursAll[e];i.type.layerType!=this.type&&this.tiles_corners.push(i)}this.tiles_corners.shuffle()}},t.prototype.getTileCorners=function(){return this.cornersDirty&&this.calculateTileCorners(),this.tiles_corners},t.prototype.getHashCode=function(){return this.id},t.prototype.equals=function(t){return this.id==t.id},t}();n.default=p,cc._RF.pop()},{}],MapSetting:[function(t,e,i){"use strict";cc._RF.push(e,"88d05vco8pKOJu9+JAfzUEv","MapSetting");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("Constants"),d=a("ShuFenReport"),u=a("AdsManager"),h=a("AchievData"),p=a("UserData"),f=a("GamePopBase"),_=a("LoadLayer"),m=a("MsgCache"),g=a("LocalizedTextManager"),y=a("AssetManager"),v=a("ViewController"),b=a("Config"),w=a("GameAudio"),T=a("ModModule"),k=cc._decorator,B=k.ccclass,S=k.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnSize=null,e.btnLarge=null,e.btnLarge_sandbox=null,e.raceNode=null,e.btnRace=[],e.materials=[],e.texts={small:"\u5c0f",standard:"\u6807\u51c6",large:"\u5927",huge:"\u5de8\u5927",gigantic:"\u8d85\u7ea7\u5927"},e}return r(e,t),e.prototype.onLoad=function(){var t,e;this.btnSize.getChildByName("label").getComponent(cc.Label).string=this.texts[b.default.customMapSize]+(b.default.mode_sandBox?"\uff08\u6c99\u76d2\u6a21\u5f0f\uff09":""),this.btnLarge.getChildByName("video").active=!p.default.member.unLockMap[2],cc.find("layout/video",this.btnLarge_sandbox).active=!p.default.member.unLockMap[3];try{for(var i=l(this.btnRace),o=i.next();!o.done;o=i.next()){var a=o.value,n=a.getChildByName("icon"),r=a.getChildByName("lock"),s=a.name.substring(4);r.active=p.default.getPropByID(s).lock;var c=s==T.default.inst.race?this.materials[0]:this.materials[1];n.getComponent(cc.Sprite).setMaterial(0,c)}}catch(f){t={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}if(T.default.inst.race){var d=y.default.powers.dict.get(T.default.inst.race);this.raceNode.getChildByName("desc").getComponent(cc.Label).string=g.LocalizedTextManager.getGodPowerName(d.name)+"\n"+g.LocalizedTextManager.getGodPowerDesc(d.name)}},e.prototype.click=function(t){w.default.playClick();var e=t.getCurrentTarget(),i=e.getChildByName("layout"),o=!i.active;i.active=o,e.getChildByName("mask").active=o,e.zIndex=o?2:0},e.prototype.clickRace=function(t){var e,i,o=t.getCurrentTarget();if(b.default.selectedProp=o.name.substring(4),T.default.inst.race!=b.default.selectedProp)try{for(var a=l(this.btnRace),n=a.next();!n.done;n=a.next()){var r=n.value,s=r.getChildByName("icon"),c=r.getChildByName("lock"),d=r.name.substring(4),u=p.default.getPropByID(d);c.active=u.lock,d==b.default.selectedProp?u.lock?v.default.open(v.view_type.UnLockProp):(T.default.inst.race=b.default.selectedProp,s.getComponent(cc.Sprite).setMaterial(0,this.materials[0])):s.getComponent(cc.Sprite).setMaterial(0,this.materials[1])}}catch(_){e={error:_}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}},e.prototype.clickSize=function(t,e){var i=this,o=t.getCurrentTarget();w.default.playClick();var a=cc.find("video",o)||cc.find("layout/video",o);(null==a?void 0:a.active)?(c.default.REPORT_ID="unLockMap",u.default.showVideoAds(function(t){if(1==t)b.default.customMapSize=e,a.active=!1,o.parent.active=!1,i.btnSize.zIndex=0,i.btnSize.getChildByName("mask").active=!1,i.btnSize.getChildByName("labelTip").active=!0,i.btnSize.getChildByName("label").getComponent(cc.Label).string=i.texts[b.default.customMapSize],o.name.includes("sandbox")||(p.default.member.unLockMap[2]=!0),o.name.includes("sandbox")&&(p.default.member.unLockMap[3]=!0),p.default.save(),i.btnLarge.getChildByName("video").active=!p.default.member.unLockMap[2],cc.find("layout/video",i.btnLarge_sandbox).active=!p.default.member.unLockMap[3];else{var n=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";m.default.pushToast(n)}})):(b.default.customMapSize=e,b.default.mode_sandBox=o.name.includes("sandbox"),o.parent.active=!1,this.raceNode.active=!b.default.mode_sandBox,this.btnSize.zIndex=0,this.btnSize.getChildByName("mask").active=!1,this.btnSize.getChildByName("labelTip").active=!1,this.btnSize.getChildByName("label").getComponent(cc.Label).string=this.texts[b.default.customMapSize]+(b.default.mode_sandBox?"\uff08\u6c99\u76d2\u6a21\u5f0f\uff09":""))},e.prototype.buildMap=function(t,e){_.LoadLayer.openLoading(),d.default.reportCustom("buildWorld"),h.default.update(16),this.close(),this.clickCB&&this.clickCB(e)},s([S(cc.Node)],e.prototype,"btnSize",void 0),s([S(cc.Node)],e.prototype,"btnLarge",void 0),s([S(cc.Node)],e.prototype,"btnLarge_sandbox",void 0),s([S(cc.Node)],e.prototype,"raceNode",void 0),s([S([cc.Node])],e.prototype,"btnRace",void 0),s([S([cc.Material])],e.prototype,"materials",void 0),s([B],e)}(f.GamePopBase);n.default=C,cc._RF.pop()},{}],MapStats:[function(t,e,i){"use strict";cc._RF.push(e,"07e37hCe6tEprzmSUTJLIx/","MapStats");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("Log"),r=o("MapBox"),s=function(){function t(){this.name="WorldBox",this.description="",this.month=0,this.year=0,this.worldTime=0,this.deaths=0,this.deaths_age=0,this.deaths_hunger=0,this.deaths_eaten=0,this.deaths_plague=0,this.deaths_other=0,this.deaths_explosion=0,this.deaths_divine=0,this.housesDestroyed=0,this.population=0,this.id_unit=0,this.id_building=0,this.id_kingdom=0,this.id_city=0,this.id_culture=0}return t.prototype.updateAge=function(t){this.worldTime+=t,this.worldTime>3&&(this.month++,this.worldTime=0,r.default.inst.updateCultures()),this.month>11&&(this.year++,this.month=0,r.default.inst.updateObjectAge())},t.prototype.getNextId=function(t){var e="";switch(t){case"culture":e="c_"+this.id_culture++;break;case"unit":e="u_"+this.id_unit++;break;case"building":e="b_"+this.id_building++;break;case"kingdom":e="k_"+this.id_kingdom++;break;case"city":e="c_"+this.id_city++;break;default:n.default.e("NO pType for id "+t)}return e},t}();a.default=s,cc._RF.pop()},{}],MapText:[function(t,e,i){"use strict";cc._RF.push(e,"90fd5sMg5NB8KfE2VZuenWV","MapText");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Globals"),c=a("MoveCamera"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxScale=.4,e.manager=null,e.city=null,e.kingdom=null,e.nameText=null,e.capital=null,e.conquerContainer=null,e.conquerText=null,e.showing=!1,e.tweenScale=0,e.priority_capital=!1,e.priority_population=0,e._old_text="",e.doAction=!1,e}return r(e,t),Object.defineProperty(e.prototype,"textRect",{get:function(){return this.node.getBoundingBox()},enumerable:!1,configurable:!0}),e.prototype.logicUpdate=function(){this.showing?this.doScale():(this.tweenScale=0,this.node.scaleY=0)},e.prototype.doScale=function(){this.node.active&&!this.doAction&&(this.maxScale=1.1*Math.min(1/c.MoveCamera.inst.camera.zoomRatio,.4),this.node.scale=this.maxScale)},e.prototype.setShowing=function(t){this.showing=t,t?this.doScale():this.node.position=l.default.POINT_IN_VOID},e.prototype.clear=function(){this.node.position=l.default.POINT_IN_VOID,this.priority_capital=!1,this.priority_population=0,this.city=null,this.kingdom=null,this.setShowing(!1)},e.prototype.showTextKingdom=function(t){this.nameText.node.color=t.kingdomColor.colorBorderOut;var e=t.data.name+"  "+t.getPopulationTotal();this.setText(e,t.capital.cityCenter),this.priority_population=t.units.length},e.prototype.showTextCulture=function(t){this.nameText.node.color=t.color32_text;var e=t.name+"  "+t.followers;this.setText(e,t.titleCenter),this.priority_population=t.followers},e.prototype.showTextCity=function(){var t,e=this.city.data.cityName+"  "+this.city.getPopulationTotal();if(this.nameText.node.color!=this.city.kingdom.kingdomColor.colorBorderOut&&(this.nameText.node.color=this.city.kingdom.kingdomColor.colorBorderOut),this.setText(e,this.city.cityCenter),(null===(t=this.city.kingdom)||void 0===t?void 0:t.capital)==this.city?this.capital.active=!0:this.capital.active=!1,0==this.city.lastTicks)this.conquerContainer.active=!1;else{this.conquerContainer.active=!0,this.city.capturingBy&&(this.conquerText.node.color=this.city.capturingBy.kingdomColor.colorBorderOut);var i=this.city.lastTicks;this.conquerText.string=i+"%"}this.priority_capital=this.city.kingdom&&this.city.kingdom.capital==this.city,this.priority_population=this.city.status.population},e.prototype.setText=function(t,e){var i=this;this.node.position=e,this._old_text!==t&&(this._old_text=t,this.nameText.string=t,0==this.tweenScale&&(this.doAction=!0,this.node.scaleY=0,this.tweenScale=this.maxScale,cc.tween(this.node).to(.3,{scaleY:this.maxScale},{easing:"backOut"}).call(function(){i.doAction=!1}).start()))},e.prototype.overlaps=function(t){return this.textRect.containsRect(t.textRect)},s([h(cc.Label)],e.prototype,"nameText",void 0),s([h(cc.Node)],e.prototype,"capital",void 0),s([h(cc.Node)],e.prototype,"conquerContainer",void 0),s([h(cc.Label)],e.prototype,"conquerText",void 0),s([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],MarkContainer:[function(t,e,i){"use strict";cc._RF.push(e,"c72966Wv4FKK4IQdAbVddkz","MarkContainer");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapMark"),r=o("MapMarks"),s=function(){function t(t){this.stack=[],this.active=[],this.prefab=null,this.prefab=t}return t.prototype.get=function(){var t=null;if(0!=this.stack.length)t=this.stack.pop();else{var e=cc.instantiate(this.prefab);t=e.getComponent(n.default),e.parent=r.default.inst.node}return this.active.push(t),t},t.prototype.clear=function(){for(var t=0;t<this.active.length;t++){var e=this.active[t];e.node.active=!1,e.node.position=cc.v3(0,0,0),this.stack.push(e)}this.active=[]},t}();a.default=s,cc._RF.pop()},{}],Meteorite:[function(t,e,i){"use strict";cc._RF.push(e,"f002aB863RNkLrIPmgstMeQ","Meteorite");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MapAction"),c=a("AssetManager"),d=a("BaseMapObject"),u=a("ToolBox"),h=a("GameAudio"),p=a("MapBox"),f=cc._decorator,_=f.ccclass,m=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mainSprite=null,e.shadow=null,e.rotationSpeed=150,e.fallingSpeed=200,e.tile=null,e.radius=0,e.alpha=0,e.timerSmoke=.01,e.sqrRemainingDistance=9999,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this)},e.prototype.spawnOn=function(t){this.tile=t,this.radius=20,this.node.position=cc.v3(t.posV3.x,t.posV3.y,t.y),this.sqrRemainingDistance=cc.v2(t.pos.x,t.pos.y).magSqr(),this.setAlpha(0),h.default.playMeteoriteFall()},e.prototype.update=function(){if(this.alpha+=2*p.default.inst.elapsed,this.setAlpha(this.alpha),this.mainSprite.angle=this.rotationSpeed*p.default.inst.elapsed,this.shadow.angle=this.rotationSpeed*p.default.inst.elapsed,this.timerSmoke>0)this.timerSmoke-=p.default.inst.getCurElapsed();else if(p.default.inst.stackEffects.get("fireSmoke").spawnAt(cc.v3(this.mainSprite.x+this.node.x,this.mainSprite.y+this.node.y),1),this.timerSmoke=.01,this.sqrRemainingDistance>Number.EPSILON){var t=u.Toolbox.moveTowards(this.mainSprite.position,cc.Vec3.ZERO,this.fallingSpeed*p.default.inst.elapsed);this.mainSprite.position=cc.v3(t),this.shadow.position=cc.v3(t.x,this.shadow.position.y,this.shadow.position.z),this.sqrRemainingDistance=t.magSqr()}else this.explode()},e.prototype.setAlpha=function(t){this.alpha=t,this.alpha<0&&(this.alpha=0),this.shadow.opacity=this.alpha},e.prototype.explode=function(){p.default.inst.gameStats.meteoritesLaunched++,l.default.damageWorld(this.tile,this.radius,c.default.terraform.get("bomb")),this.node.destroy(),p.default.inst.spawnFlash(this.tile,this.radius);var t=cc.v3(this.tile.pos.x,this.tile.pos.y-2),e=u.Toolbox.randomFloat(.8,.9);p.default.inst.stackEffects.get("explosionSmall").spawnAt(t,e),h.default.playExplosionMeteorite()},s([m(cc.Node)],e.prototype,"mainSprite",void 0),s([m(cc.Node)],e.prototype,"shadow",void 0),s([_],e)}(d.default);n.default=g,cc._RF.pop()},{}],ModModule:[function(t,e,i){"use strict";cc._RF.push(e,"ab473u4R+lHLLkgS+LFI5zt","ModModule");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.ModData=void 0;var c=a("MathUtils"),d=a("UserData"),u=a("LocalizedTextManager"),h=a("AssetManager"),p=a("ResourceLibrary"),f=a("MoveCamera"),_=a("ToolBox"),m=a("Config"),g=a("FogLayer"),y=a("MapBox"),v=a("TextureLoader"),b=a("TechElement"),w=cc._decorator,T=w.ccclass,k=w.property,B=function(t){this.race="",this.kingdomId="",this.fog=null,this.race=t.race,this.kingdomId=t.kingdom.data.id,this.fog=g.default.inst.data};n.ModData=B;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.race="humans",e.kingdom=null,e.ancestors=[],e.placeTiles=[],e.researchBar=null,e.node_mp=null,e.techEffect=null,e.resources=null,e.population=null,e._mp=0,e.interval=0,e}var i;return r(e,t),i=e,Object.defineProperty(e.prototype,"mp",{get:function(){return this._mp},set:function(t){this._mp=t;var e=this.getMPLimit();this._mp>e&&(this._mp=e),this._mp<0&&(this._mp=0),this.showMagicValue()},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){i.inst=this},e.prototype.save=function(){return m.default.mode_sandBox?null:new B(this)},e.prototype.loadModData=function(t){var e=this;this.race=t.race,this.kingdom=y.default.inst.kingdoms.getKingdomByID(t.kingdomId),g.default.inst.loadFogs(t.fog),this.initMagic(),this.scheduleOnce(function(){f.MoveCamera.inst.focusOn(e.kingdom.capital.cityCenter)},.2),this.scheduleOnce(function(){var t,i;try{for(var o=l(e.kingdom.units.getSimpleList()),a=o.next();!a.done;a=o.next()){var n=a.value;n.haveTrait("ancestor")&&(n.addStatusEffect("ancestor"),e.ancestors.push(n))}}catch(c){t={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}},4)},e.prototype.clear=function(){this.kingdom=null,this.ancestors=[],this.placeTiles=[],g.default.inst.clear(),this.initMagic()},e.prototype.initMagic=function(){this.interval=0,this.mp=this.getMPLimit(),this.showMagicValue(),this.node_mp.active=!m.default.mode_count},e.prototype.newRound=function(){var t,e;if(!this.race){var i=[];try{for(var o=l(["humans","orcs","elves","dwarfs"]),a=o.next();!a.done;a=o.next()){var n=a.value;d.default.getPropByID(n).lock||i.push(n)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.race=i.getRandom()}m.default.useFog&&g.default.inst.denseFog(),this.placeUnit(this.race,!0,2)},e.prototype.placeEnemy=function(){this.initMagic(),f.MoveCamera.inst.focusOn(this.placeTiles[0].posV3);var t=["humans","orcs","elves","dwarfs"];t.remove(this.race);for(var e=m.default.ZONE_AMOUNT_Y<=3?1:2,i=0;i<e;i++)this.placeUnit(t.getRandom(!0),!1,3),this.placeUnit(this.race,!1,3)},e.prototype.placeUnit=function(t,e,i){var o=this;void 0===i&&(i=2);var a=this.getPlaceTile(e);if(a)for(var n=0;n<i;n++)setTimeout(function(){var i=h.default.powers.get(t),n=i.actorStatsId.includes(",")?_.Toolbox.getRandom(i.actorStatsId.split(",")):i.actorStatsId,r=y.default.inst.spawnNewUnit(n,a,"",i.actorSpawnHeight);e&&(r.addTrait("ancestor"),r.addStatusEffect("ancestor"),o.ancestors.push(r))},1)},e.prototype.restoreStatus=function(){var t,e,i;if(0!=this.ancestors.length){try{for(var o=l(this.ancestors),a=o.next();!a.done;a=o.next()){var n=a.value;(null===(i=null==n?void 0:n.data)||void 0===i?void 0:i.alive)&&(n.removeTrait("ancestor"),n.removeStatusEffect("ancestor"))}}catch(c){t={error:c}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.ancestors=[]}},e.prototype.unmanned=function(){return this.ancestors.length<=0},e.prototype.logicUpdate=function(t){var e,i,o,a,n,r,s,c,d;if(m.default.mode_count||(this.interval+=t,this.interval>=1&&(this.interval=0,this.mp+=this.getRecoverySpeed(),this.showMagicValue())),this.updateCurrentTech(),this.kingdom&&m.default.useFog){this.updateInfo();try{for(var u=l(this.kingdom.cities),h=u.next();!h.done;h=u.next()){var p=h.value;try{for(var f=(o=void 0,l(p.zones)),_=f.next();!_.done;_=f.next()){var y=_.value;try{for(var v=(n=void 0,l(y.tiles)),b=v.next();!b.done;b=v.next()){var w=b.value;g.default.inst.unLockTile(w)}}catch(C){n={error:C}}finally{try{b&&!b.done&&(r=v.return)&&r.call(v)}finally{if(n)throw n.error}}}}catch(x){o={error:x}}finally{try{_&&!_.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}}}catch(A){e={error:A}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}var T=null===(d=this.kingdom.units)||void 0===d?void 0:d.getSimpleList();try{for(var k=l(T),B=k.next();!B.done;B=k.next()){var S=B.value;g.default.inst.unLockTile(S.currentTile)}}catch(P){s={error:P}}finally{try{B&&!B.done&&(c=k.return)&&c.call(k)}finally{if(s)throw s.error}}g.default.inst.updatePixels()}},e.prototype.getPlaceTile=function(t){var e,i,o,a,n;y.default.inst.cityPlaceFinder.calculate();var r=y.default.inst.getTile(y.default.width/2,y.default.height/2),s=null;if(t)s=(null===(n=this.kingdom)||void 0===n?void 0:n.capital)?this.kingdom.capital.getTile():y.default.inst.islandsCalculator.getStartTile(r);else try{for(var c=l(y.default.inst.cityPlaceFinder.zones),d=c.next();!d.done;d=c.next()){var u=d.value;if(u.goodForNewCity&&_.Toolbox.distTile(r,u.centerTile)>=30){var h=!1;try{for(var p=(o=void 0,l(this.placeTiles)),f=p.next();!f.done;f=p.next()){var m=f.value;if(u.tiles[0].isSameIsland(m)&&_.Toolbox.distTile(u.tiles[0],m)<80){h=!0;break}}}catch(b){o={error:b}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}if(h)continue;s=u.centerTile;break}}}catch(w){e={error:w}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}return s&&this.placeTiles.push(s),s},e.prototype.showMagicValue=function(){var t=this.node_mp.getChildByName("label").getComponent(cc.Label),e=this.node_mp.getChildByName("mask");t.string=this.mp+"/"+this.getMPLimit(),e.height=this.mp/this.getMPLimit()*90},e.prototype.getRecoverySpeed=function(){return m.default.mode_sandBox?1:this.kingdom?c.default.intCast(Math.log(.05*this.kingdom.units.length+1)+1):1},e.prototype.getMPLimit=function(){var t,e;if(m.default.mode_sandBox)return 200;if(this.kingdom){var i=0;try{for(var o=l(this.kingdom.cities),a=o.next();!a.done;a=o.next())i+=a.value.zones.length}catch(s){t={error:s}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return c.default.intCast(150*Math.log(.03*i+1)+50)}return 100},e.prototype.updateInfo=function(){var t,e,i,o,a,n,r,s;this.resources.parent.active=!m.default.mode_sandBox;try{for(var d=l(this.resources.children),u=d.next();!u.done;u=d.next()){var f=u.value,_=0,g=f.getChildByName("label");if("food"==f.name)try{for(var y=(i=void 0,l(h.default.resources.list)),v=y.next();!v.done;v=y.next()){var b=v.value;if(b.type==p.ResType.Food)try{for(var w=(a=void 0,l(this.kingdom.cities)),T=w.next();!T.done;T=w.next())_+=T.value.data.storage.get(b.id)}catch(S){a={error:S}}finally{try{T&&!T.done&&(n=w.return)&&n.call(w)}finally{if(a)throw a.error}}}}catch(C){i={error:C}}finally{try{v&&!v.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}else try{for(var k=(r=void 0,l(this.kingdom.cities)),B=k.next();!B.done;B=k.next())_+=B.value.data.storage.get(f.name)}catch(x){r={error:x}}finally{try{B&&!B.done&&(s=k.return)&&s.call(k)}finally{if(r)throw r.error}}g.getComponent(cc.Label).string=c.default.intCast(_).toString()}}catch(A){t={error:A}}finally{try{u&&!u.done&&(e=d.return)&&e.call(d)}finally{if(t)throw t.error}}this.population.node.parent.active=!m.default.mode_sandBox,this.population.string=this.kingdom.units.length+"/"+this.kingdom.getPopulationTotal()},e.prototype.updateCurrentTech=function(){var t,e=null===(t=this.kingdom)||void 0===t?void 0:t.getCulture();if(e){this.researchBar.node.active=!0;var i=e.research_progress;e.checkResearchingTech();var o=0,a=this.researchBar.node.getChildByName("currentTech").getComponent(b.default);if(e.researching_tech){o=e.getKnowledgeCostForResearch();var n=h.default.culture_tech.get(e.researching_tech);a.node.active=!0,a.load(n)}else i=0,o=0,a.node.active=!1;this.researchBar.node.getChildByName("label").getComponent(cc.Label).string=Math.floor(10*i)/10+"/"+o,this.researchBar.progress=i/o}else this.researchBar.node.active=!1},e.prototype.showTechEffect=function(t){var e=this,i=h.default.culture_tech.get(t);if(i){this.techEffect.active=!0;var o=this.techEffect.getChildByName("circle");o.angle=0,o.scale=.2,o.opacity=0;var a=this.techEffect.getChildByName("icon");a.scale=.5,a.opacity=255;var n=v.TextureLoader.inst.getSpriteFrame(v.ATLAS_TYPE.UIATLAS,"icons/"+i.icon);a.getComponent(cc.Sprite).spriteFrame=n;var r=this.researchBar.node.getChildByName("currentTech"),s=r.parent.convertToWorldSpaceAR(r.position);a.position=this.techEffect.convertToNodeSpaceAR(s);var l=this.techEffect.getChildByName("node");l.opacity=0,l.scale=.5,l.y=0,l.getChildByName("techName").getComponent(cc.Label).string=u.LocalizedTextManager.getText("tech_"+i.id),l.getChildByName("techDesc").getComponent(cc.Label).string=u.LocalizedTextManager.getText("tech_info_"+i.id),cc.tween(a).to(.6,{position:cc.Vec3.ZERO,angle:360,scale:1}).call(function(){a.angle=35}).delay(.1).to(.3,{angle:-35}).to(.25,{angle:25}).to(.2,{angle:-15}).to(.15,{angle:7}).to(.1,{angle:0}).delay(.2).call(function(){cc.tween(a).to(.2,{position:cc.v3(0,100)}).call(function(){o.opacity=255,cc.tween(o).to(.1,{scale:1}).to(1.5,{angle:45}).to(.2,{opacity:0}).start()}).to(.4,{scale:2},{easing:"bounceOut"}).delay(1.5).to(.2,{position:cc.Vec3.ZERO,opacity:0}).call(function(){e.techEffect.active=!1}).start(),l.opacity=255,cc.tween(l).to(.2,{position:cc.v3(0,-100)}).to(.4,{scale:2},{easing:"bounceOut"}).delay(1.5).to(.2,{position:cc.Vec3.ZERO,opacity:0,scale:.5}).start()}).start()}},e.inst=null,s([k(cc.ProgressBar)],e.prototype,"researchBar",void 0),s([k(cc.Node)],e.prototype,"node_mp",void 0),s([k(cc.Node)],e.prototype,"techEffect",void 0),s([k(cc.Node)],e.prototype,"resources",void 0),s([k(cc.Label)],e.prototype,"population",void 0),i=s([T],e)}(cc.Component);n.default=S,cc._RF.pop()},{}],MoodLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"31341BS/zVJjZQgJACqmahG","MoodLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.MoodAsset=void 0;var s=a("BaseStats"),l=a("TextureLoader"),c=a("AssetLibrary"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.baseStats=new s.default,e.icon="",e.sprite=null,e}return r(e,t),e.prototype.getSprite=function(){return this.sprite||(this.sprite=l.TextureLoader.inst.getSpriteFrame(l.ATLAS_TYPE.UIATLAS,"icons/"+this.icon)),this.sprite},e}(c.Asset);n.MoodAsset=d;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new d;e.id="sad",e.icon="iconMoodSad",this.add(e),this.t.baseStats.mod_speed=-20,this.t.baseStats.mod_diplomacy=-10,this.t.baseStats.mod_attackSpeed=-10,this.t.baseStats.loyalty_mood=-5,this.t.baseStats.opinion=-5;var i=new d;i.id="normal",i.icon="iconMoodNormal",this.add(i);var o=new d;o.id="happy",o.icon="iconMoodHappy",this.add(o),this.t.baseStats.mod_speed=10,this.t.baseStats.mod_diplomacy=10,this.t.baseStats.mod_attackSpeed=10,this.t.baseStats.loyalty_mood=10,this.t.baseStats.opinion=10;var a=new d;a.id="angry",a.icon="iconMoodAngry",this.add(a),this.t.baseStats.mod_speed=10,this.t.baseStats.mod_diplomacy=-30,this.t.baseStats.mod_attackSpeed=10,this.t.baseStats.loyalty_mood=-15,this.t.baseStats.opinion=-15;var n=new d;n.id="dark",this.add(n),this.t.baseStats.loyalty_mood=-20,this.t.baseStats.opinion=-20},e}(c.default);n.default=u,cc._RF.pop()},{}],MoveCamera:[function(t,e,i){"use strict";cc._RF.push(e,"85ebbTycc1Jn4M83wZoZb7o","MoveCamera");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.MoveCamera=void 0;var l=a("MapBox"),c=a("MathUtils"),d=a("AudioMgr"),u=a("iTween"),h=a("GameCommon"),p=a("Config"),f=a("GuideController"),_=a("PowerButtonSelector"),m=a("WorldTip"),g=a("Constants"),y=a("ToolBox"),v=cc._decorator,b=v.ccclass,w=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e.minZoomRatio=1,e.maxZoomRatio=22,e.targetZoom=1,e.fingerIncreaseRate=1,e.moveOffset=2,e.zoomDelta=.1,e.followUnit=null,e.locked=!1,e.lockDrag_=!1,e.halfBounds_=null,e.touchTimer_=0,e.isMoving_=!1,e.alreadyUsedZoom_=!1,e.mapTouchList=[],e.focusZoom=-1e6,e.focusUnitZoom=-1e6,e.focusTimer=0,e.cameraZoomSpeed=5,e.cameraMoveSpeed=.01,e}var i;return r(e,t),i=e,Object.defineProperty(e.prototype,"lockDrag",{get:function(){return this.lockDrag_},set:function(t){this.lockDrag_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"halfBounds",{set:function(t){this.halfBounds_=t,t&&this.cameraToBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"touchTimer",{get:function(){return this.touchTimer_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMoving",{get:function(){return this.isMoving_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alreadyUsedZoom",{get:function(){return this.alreadyUsedZoom_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"magnification",{get:function(){return 1-this.targetZoom/this.maxZoomRatio},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){i.inst=this},e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this.onMouseWheel,this),this.node._touchListener.setSwallowTouches(!1),this.resetZoom()},e.prototype.update=function(t){0==this.mapTouchList.length?(this.isMoving_=!1,this.touchTimer_=0):1==this.mapTouchList.length&&(this.touchTimer_+=t),this.mapTouchList.length<2&&(this.alreadyUsedZoom_=!1)},e.prototype.centerCamera=function(){this.resetZoom(),this.camera.node.position=cc.Vec3.ZERO,this.camera.backgroundColor=!p.default.mode_sandBox&&p.default.useFog?y.Toolbox.makeColor("#145F68"):y.Toolbox.makeColor(g.default.OLD_SKIN?"#3370CC":"#25ABBC")},e.prototype.focusOn=function(t){this.clearFocusUnit(),this.setCameraZoomRatio(18),this.focusZoom=this.targetZoom,this.camera.node.position=t.sub(cc.v3(l.default.width/2,l.default.height/2))},e.prototype.focusOnAndFollow=function(t){this.clearFocusUnit(),this.setCameraZoomRatio(18),this.focusZoom=this.targetZoom,this.focusUnitZoom=this.targetZoom,i.focusUnit=t,this.focusTimer=0,m.default.addWordReplacement("$name$",i.focusUnit.coloredName),m.default.inst.show("tip_following_unit",!0,"top"),_.PowerButtonSelector.inst.clickPowerButton(this.followUnit)},e.prototype.resetZoom=function(){this.halfBounds=cc.v2(l.default.width/2+10,l.default.height/2+10),this.setCameraZoomRatio(this.minZoomRatio)},e.prototype.setCameraZoomRatio=function(t){if(t=Math.max(this.minZoomRatio,t),t=Math.min(this.maxZoomRatio,t),f.default.inst.in(f.GUIDE_TYPE.novice,1)&&t>=5&&(t=13,f.default.inst.do(f.GUIDE_TYPE.novice)),t!=this.camera.zoomRatio){this.targetZoom=t,this.camera.zoomRatio=t,this.cameraToBounds();var e=(t-this.minZoomRatio)/(this.maxZoomRatio-this.minZoomRatio);d.default.setEffectVolume(e)}l.default.inst.zoomUpdated(t,this.maxZoomRatio)},e.prototype.onTouchStart=function(t){var e=this,i=t.getTouches();1==i.length&&(this.mapTouchList=[]),i.forEach(function(t){0===e.mapTouchList.filter(function(e){return e.id===t.getID()}).length&&(e.mapTouchList[e.mapTouchList.length]={id:t.getID(),touch:t})})},e.prototype.onTouchMove=function(t){var e=this;if(!this.locked){var i=t.getTouches();if(i.forEach(function(t){0===e.mapTouchList.filter(function(e){return e.id===t.getID()}).length&&(e.mapTouchList[e.mapTouchList.length]={id:t.getID(),touch:t})}),i=this.mapTouchList.map(function(t){return t.touch}),!(f.default.inst.isType(f.GUIDE_TYPE.novice)&&f.default.inst.step>=2&&f.default.inst.step<=9))if(i.length>=2){this.isMoving_=!0,this.alreadyUsedZoom_=!0;var o,a=i[0],n=i[1],r=cc.v2(a.getDelta()),s=cc.v2(n.getDelta()),l=cc.v2(a.getLocation()),c=cc.v2(n.getLocation()),d=l.sub(c),u=cc.v2(this.fingerIncreaseRate,this.fingerIncreaseRate),h=r.sub(s).scale(u);o=Math.abs(d.x)>Math.abs(d.y)?(d.x+h.x)/d.x:(d.y+h.y)/d.y,this.setCameraZoomRatio(this.camera.zoomRatio*o)}else if(1===i.length&&!this.lockDrag_&&(this.isMoving_||this.canStartMove(i[0]))){this.isMoving_=!0;var p=cc.v2(i[0].getDelta()).div(this.camera.zoomRatio),_=cc.v3(this.camera.node.position).sub(cc.v3(p));this.camera.node.position=_,this.cameraToBounds()}}},e.prototype.onTouchEnd=function(t){this.locked||this.removeTouchFromContent(t,this.mapTouchList)},e.prototype.onTouchCancel=function(t){this.locked||this.removeTouchFromContent(t,this.mapTouchList)},e.prototype.onMouseWheel=function(t){if(!(this.locked||f.default.inst.isType(f.GUIDE_TYPE.novice)&&f.default.inst.step>=2&&f.default.inst.step<=9)){var e=t.getScrollY(),i=this.camera.zoomRatio;i*=1+Math.sign(e)*this.zoomDelta,this.setCameraZoomRatio(i)}},e.prototype.canStartMove=function(t){var e=t.getStartLocation(),i=t.getLocation();return Math.abs(i.x-e.x)>this.moveOffset||Math.abs(i.y-e.y)>this.moveOffset},e.prototype.removeTouchFromContent=function(t,e){for(var i=t.getTouches().map(function(t){return t.getID()}),o=e.length-1;o>=0;--o)i.indexOf(e[o].id)>-1&&e.splice(o,1)},e.prototype.followFocusUnit=function(){var t,e,o,a,n;if(i.focusUnit)if(null===(t=i.focusUnit.data)||void 0===t?void 0:t.alive)if(this.isMoving||this.alreadyUsedZoom)this.focusTimer=0;else{var r=i.focusUnit.currentPosition.clone();r.z=this.camera.node.z,r=r.subSelf(cc.v3(l.default.width/2,l.default.height/2)),this.focusTimer<=1&&(this.focusTimer+=cc.director.getDeltaTime(),this.focusTimer=c.default.clamp(this.focusTimer,0,1),r.x=u.default.easeOutCubic(this.camera.node.x,r.x,this.focusTimer),r.y=u.default.easeOutCubic(this.camera.node.y,r.y,this.focusTimer)),this.camera.node.position=r}else if(i.focusUnit.attackedBy&&(null===(o=null===(e=i.focusUnit)||void 0===e?void 0:e.attackedBy)||void 0===o?void 0:o.a)){m.default.addWordReplacement("$name$",i.focusUnit.coloredName),m.default.addWordReplacement("$killer$",i.focusUnit.attackedBy.a.coloredName),m.default.inst.show("tip_followed_unit_killed",!0,"top");var s=null===(n=null===(a=i.focusUnit)||void 0===a?void 0:a.attackedBy)||void 0===n?void 0:n.a;i.focusUnit.attackedBy=null,i.focusUnit=s,this.focusTimer=0}else m.default.addWordReplacement("$name$",i.focusUnit.coloredName),m.default.inst.show("tip_followed_unit_died",!0,"top"),this.clearFocusUnit()},e.prototype.clearFocus=function(){this.focusZoom=-1e6},e.prototype.clearFocusUnit=function(){this.focusUnitZoom=-1e6,i.focusUnit=null,this.focusTimer=0,_.PowerButtonSelector.inst.isPowerSelected("follow_unit")&&_.PowerButtonSelector.inst.unselectAll()},e.prototype.lateUpdate=function(){h.default.isPaused||(this.targetZoom!=this.camera.zoomRatio&&this.zoomToBounds(),p.default.spectatorMode()&&this.followFocusUnit())},e.prototype.zoomToBounds=function(){this.targetZoom=c.default.clamp(this.targetZoom,10,this.maxZoomRatio),this.camera.zoomRatio!=this.targetZoom&&(this.targetZoom>this.camera.zoomRatio?(this.camera.zoomRatio+=cc.director.getDeltaTime()*this.cameraZoomSpeed*(Math.abs(this.camera.zoomRatio-this.targetZoom)+5),this.camera.zoomRatio>this.targetZoom&&(this.camera.zoomRatio=c.default.clamp(this.targetZoom,10,this.maxZoomRatio))):this.targetZoom<this.camera.zoomRatio&&(this.camera.zoomRatio-=cc.director.getDeltaTime()*this.cameraZoomSpeed*(Math.abs(this.camera.zoomRatio-this.targetZoom)+5),this.camera.zoomRatio<this.targetZoom&&(this.camera.zoomRatio=c.default.clamp(this.targetZoom,10,this.maxZoomRatio))),l.default.inst.zoomUpdated(this.camera.zoomRatio,this.maxZoomRatio))},e.prototype.cameraToBounds=function(){if(this.halfBounds_){var t=this.halfBounds_.x,e=this.halfBounds_.y;this.camera.node.x>t?this.camera.node.x=t:this.camera.node.x<-t&&(this.camera.node.x=-t),this.camera.node.y>e?this.camera.node.y=e:this.camera.node.y<-e&&(this.camera.node.y=-e)}},e.inst=null,e.focusUnit=null,s([w({type:cc.Camera,tooltip:"\u8981\u88ab\u64cd\u4f5c\u7684Camera\u8282\u70b9"})],e.prototype,"camera",void 0),s([w({tooltip:"\u63a7\u5236\u7f29\u5c0f\u5f97\u65f6\u5019\uff0c\u80fd\u7f29\u5230\u591a\u5c0f\uff0c\u6570\u503c\u8d8a\u5c0f\uff0c\u7f29\u5f97\u8d8a\u5c0f"})],e.prototype,"minZoomRatio",void 0),s([w({tooltip:"\u63a7\u5236\u653e\u5927\u7684\u65f6\u5019\uff0c\u80fd\u653e\u5927\u5230\u591a\u5927\uff0c\u6570\u503c\u8d8a\u5927\uff0c\u76f8\u673a\u80fd\u62c9\u5f97\u8d8a\u8fd1"})],e.prototype,"maxZoomRatio",void 0),s([w({displayName:"\u53cc\u6307\u7f29\u653e\u901f\u7387",max:10,min:.001,tooltip:"\u53cc\u6307\u7f29\u653e\u901f\u7387"})],e.prototype,"fingerIncreaseRate",void 0),s([w({tooltip:"\u5355\u70b9\u89e6\u6478\u5bb9\u5fcd\u8bef\u5dee"})],e.prototype,"moveOffset",void 0),s([w({tooltip:"zoomDelta"})],e.prototype,"zoomDelta",void 0),i=s([b],e)}(cc.Component);n.MoveCamera=T,cc._RF.pop()},{}],MysteryButton:[function(t,e,i){"use strict";cc._RF.push(e,"ca6b8JUusFIZotihI3HbHez","MysteryButton");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameTdd"),c=a("GameUtils"),d=a("GuideController"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn=null,e._move=!1,e}var i;return r(e,t),i=e,Object.defineProperty(e.prototype,"move",{set:function(t){this._move=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){i.inst=this},e.prototype.start=function(){this.reset()},e.prototype.reset=function(t){var e=this;void 0===t&&(t=!1),t||this.hide();var i=l.default.success?l.default.getData("p6",l.v_type.Number):30;cc.sys.platform==cc.sys.WECHAT_GAME&&(i=l.default.success?l.default.getData("p11",l.v_type.NumberList)[0]:120),setTimeout(function(){c.default.allowPopUi()?e.move=!0:e.reset(!0)},1e3*(t?5:i))},e.prototype.hide=function(){this._move=!1,this.node.x=-cc.winSize.width/2-this.node.width,this.node.y=cc.winSize.height/2*.6},e.prototype.update=function(){var t=this._move&&c.default.allowPopUi();this.btn.interactable=t||d.default.inst.in(d.GUIDE_TYPE.mystery,0),this.node.opacity=t||d.default.inst.in(d.GUIDE_TYPE.mystery,0)?255:0,t&&(this.node.x+=.5,this.node.x>cc.winSize.width/2+this.node.width&&(this.move=!1,this.reset()))},e.inst=null,s([p(cc.Button)],e.prototype,"btn",void 0),i=s([h],e)}(cc.Component);n.default=f,cc._RF.pop()},{}],MysteryReward:[function(t,e,i){"use strict";cc._RF.push(e,"ae5a4A6NQVJLrHQWSk3ePzE","MysteryReward");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Constants"),c=a("AdsManager"),d=a("RewardData"),u=a("UserData"),h=a("GamePopBase"),p=a("MsgCache"),f=a("AssetManager"),_=a("TextureLoader"),m=a("MysteryButton"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardID=3,e.btnText=null,e.video=null,e.rewards=[],e.cumulative=null,e.data=[],e}return r(e,t),e.prototype.onLoad=function(){1==u.default.member.mysteryNum?this.video.active=!1:this.video.active=!!QQ_GAME||Math.random()<.8,this.cumulative.active=QQ_GAME,this.video.active||(this.btnText.x=0),this.rewards.forEach(function(t){t.active=!1})},e.prototype.clickClose=function(t){this.close(t)},e.prototype.start=function(){this.showReward()},e.prototype.onDestroy=function(){m.default.inst.reset()},e.prototype.showReward=function(){this.data=d.default.getRewards(this.rewardID);for(var t=0;t<this.data.length;t++){this.rewards[t].active=!0,this.rewards[t].getChildByName("name").getComponent(cc.Label).string=this.data[t].propName;var e=this.rewards[t].getChildByName("rare");e.active=this.data[t].rare>=0;var i=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"reward/rare_"+this.data[t].rare);i&&(e.getComponent(cc.Sprite).spriteFrame=i);var o=this.rewards[t].getChildByName("icon"),a="propIcon/"+f.default.powers.dict.get(this.data[t].propID).icon,n=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,a);n&&(o.getComponent(cc.Sprite).spriteFrame=n),this.rewards[t].getChildByName("num").getComponent(cc.Label).string=this.data[t].reward.toString()}},e.prototype.geteReward=function(t){var e=this,i=t.getCurrentTarget().getComponent(cc.Button);this.video.active?(l.default.REPORT_ID="mystery",c.default.showVideoAds(function(t){if(1==t)e.doReward(i);else{var o=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";p.default.pushToast(o)}})):this.doReward(i)},e.prototype.doReward=function(t){for(var e=0;e<this.data.length;e++){var i=u.default.getPropByID(this.data[e].propID);i&&(i.number+=this.data[e].reward)}u.default.member.mysteryNum++,u.default.save(),t.interactable=!1,p.default.pushToast("\u606d\u559c\u4f60\uff0c\u9886\u53d6\u5956\u52b1\u6210\u529f\uff01")},s([v],e.prototype,"rewardID",void 0),s([v(cc.Node)],e.prototype,"btnText",void 0),s([v(cc.Node)],e.prototype,"video",void 0),s([v([cc.Node])],e.prototype,"rewards",void 0),s([v(cc.Node)],e.prototype,"cumulative",void 0),s([y],e)}(h.GamePopBase);n.default=b,cc._RF.pop()},{}],NameGeneratorLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"96d5cVI/StM64mSoB0KSGWj","NameGeneratorLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.NameGeneratorAsset=void 0;var s=a("Tools"),l=a("AssetLibrary"),c=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.special1=[],i.special2=[],i.vowels=e.vowels_all,i.consonants=["b","c","d","f","g","h","ph","ch","k","l","m","n","p","r","s","t","v","w","sh"],i.parts=[],i.addition_start=[],i.addition_ending=[],i.part_groups=[],i.part_groups2=[],i.part_groups3=[],i.motto_parts=new Map,i.motto_generator=!1,i.templates=[],i.max_vowels_in_row=1,i.max_consonanats_in_row=1,i.add_addition_chance=.5,i}return r(e,t),e.vowels_all=["a","e","i","o","u","y"],e.consonants_all=["b","c","d","f","g","h","j","k","l","m","n","p","q","r","s","t","v","w","x","z"],e}(l.Asset);n.NameGeneratorAsset=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c;e.id="kingdom_mottos",e.motto_generator=!0,this.add(e),this.addMottoPart("all_hail","we follow ,all hail ,we believe in ,one and only ,our life for ,swords for ,all for ,blood for ,we fight for "),this.addMottoPart("names","Mastef,Hugo,Maxim,Jupe,Xiphos,Orange,Glonk,Nikon,Quicklast,Andrey,Sonja,Julia,Poncho,Faris,Cody,Jim,Steeam,Chicky,Chad,Luk,Midnight Blade,Luk,Half Chest,mountain,Airod,Astral,Little Glonk"),this.addMottoPart("concept","life,death,sorrow,hope,awesome,tears,eternal,one,best"),this.addMottoPart("word_something","nothing,love,spirits,death,life,truth,glory,wealth,roots"),this.addMottoPart("event","victory,death,forgiveness,salvation,redemption,happiness,life"),this.addMottoPart("words_good","updog,hope,power,pride,honor,strength,wisdom,skill,health,virtue,unity,valor,motherland,truth,peace,progress,prosperity,passion,compassion,duty,destiny,freedom,balance,pride,nature,justice,dignity,safety,vigilance,honesty,integrity,prosperity"),this.addMottoPart("words_bad","fear,doubt,anger,frustration,failure,depression,contempt,pain,regrets,sadness,remorse"),this.addMottoPart("body_parts","arm,leg,head,finger,body,heart,blood,tail,hell,neck,wings"),this.addMottoPart("weapon","sword,axe,spear,bow"),this.addMottoPart("guided_by","guided by "),this.addMottoPart("forged_by","forged by "),this.addMottoPart("armor","boots,shield,helmet,armor"),this.addMottoPart("items","gold,coins,rock,stone"),this.addMottoPart("addition","amazing,beatiful"),this.addMottoPart("foods","food,fish,tea,beer,bread"),this.addMottoPart("elements","fire,water,earth,air,magic,crystal,steel,poison,lightning,curse"),this.addMottoPart("we","We"),this.addMottoPart("brings"," brings "),this.addMottoPart("are"," are "),this.addMottoPart("somewhere"," in Hell, in the Darkness, in the Shadows, in the Light, in the Sea, in the Land, in the Dreams, in the History, in the Heavens"),this.addMottoPart("ending_concept","life,death,war,battle,sea,kingdom"),this.addMottoPart("bound","bound,determined"),this.addMottoPart("this_is_ending","fine,good"),this.addMottoPart("no","no ,forget ,abandon ,destroy ,exterminate ,burn "),this.addMottoPart("life","love,life,death"),this.addMottoPart("we_ending"," we trust!, we believe!, we shine!"),this.addMottoPart("we_desire"," we desire, we believe, we want"),this.addMottoPart("is_the"," is the way, is the truth, is the destiny"),this.addMottoPart("we_like","we like ,we love "),this.addMottoPart("is"," is "),this.addMottoPart("and"," and "),this.addMottoPart("with","With "),this.addMottoPart("in","In "),this.addMottoPart("by"," by "),this.addMottoPart("or"," or "),this.addMottoPart("hold_our","hold our ,hold my "),this.addMottoPart("we_use_our","we use our "),this.addMottoPart("in_end"," in "),this.addMottoPart("we_something"," we live, we go, we attack"),this.addMottoPart("through"," through "),this.addMottoPart("only","only ,always ,forever "),this.addMottoPart("the"," the ");var i="foods;weapon;armor;items;words_good;body_parts;elements";this.t.templates.push("forged_by,names;foods;event;elements;words_good;words_bad"),this.t.templates.push("all_hail,names;foods;event"),this.t.templates.push("we_like,foods"),this.t.templates.push("event,through,"+i),this.t.templates.push("hold_our,foods;weapon;armor;items;words_good"),this.t.templates.push("words_good;foods;names,is,this_is_ending"),this.t.templates.push("in,words_good,we_ending"),this.t.templates.push("life,is,words_good"),this.t.templates.push("hold_our,weapon;armor;items"),this.t.templates.push("foods;weapon;armor;items;words_good,is_the"),this.t.templates.push("with,"+i+",somewhere"),this.t.templates.push("with,"+i+",we_something"),this.t.templates.push("with,"+i+",and,"+i),this.t.templates.push("with,"+i+",and,"+i+",we_something"),this.t.templates.push("we,are,concept"),this.t.templates.push("we,are,concept,somewhere"),this.t.templates.push("we,are,concept,somewhere"),this.t.templates.push("bound,by,word_something"),this.t.templates.push("no,words_bad,comma,no,words_bad,comma,only,words_good"),this.t.templates.push("words_good,comma,words_good,comma,words_good"),this.t.templates.push("words_good,and,words_good"),this.t.templates.push("in,word_something,we_ending"),this.t.templates.push("with,words_good,and,words_good"),this.t.templates.push("words_good;body_parts,somewhere"),this.t.templates.push("with,words_good;body_parts,and,words_good;body_parts"),this.t.templates.push("guided_by,words_good"),this.t.templates.push("words_good,brings,words_good"),this.t.templates.push("we_use_our,weapon;body_parts,in_end,ending_concept"),this.t.templates.push(i+",or,words_bad");var o=new c;o.id="human_culture",this.add(o),this.t.part_groups.push("ne,wa,gi,ca,fo,two,ado,ja,ste,sho,klo,e,a,ka,ri,wu,to"),this.t.part_groups.push("ru,ni,too,vo,phu,te,ku,ve,su,me,du,pe,to,ste,o,e,a,u,oo"),this.t.part_groups.push("rab,dab,pab,ian"),this.t.templates.push("Part_group");var a=new c;a.id="elf_culture",this.add(a),this.t.part_groups.push("A',E',O',Yda,Ifa,Yaa,Ia,Oya,Yra,Na,Ma,Ya"),this.t.part_groups.push("dre,dra,de,du,te,tre,tra,tro,ti,to,tri,na,ma,sa,da,pa"),this.t.part_groups.push("o,e,y,a,yo,oi,,"),this.t.templates.push("part_group");var n=new c;n.id="dwarf_culture",this.add(n),this.t.part_groups.push("X,Th,Tr,Gl,H,Dh,Dum,Dor,Gor,Ther,Thor,Gah,Geh,Ger,Dur,Der,Dar,Dig,Deg,Dag,Ger,Dhan,Don,Dan"),this.t.part_groups.push("i,o,a,e,odi,adi,edi,ada,idi,uru,udu,igi,egi,oki,oko"),this.t.part_groups.push("d,ded,dad,dum,gah,geh,h,d,b,c,gh,th,gh,gagh,digh,dig,dag,dog,,,"),this.t.templates.push("part_group");var r=new c;r.id="orc_culture",this.add(r),this.t.part_groups.push("Dek,Kek,Kak,Dak,Zeg,Zog,Zag,Bak,Dak,Rak,Dek,Mek,Mak"),this.t.part_groups.push(" "),this.t.part_groups.push("Dek,Kek,Kak,Dak,Zeg,Zog,Zag,Bak,Dak,Rak,Dek,Mek,Mak,Bah,Wah,Waah"),this.t.templates.push("part_group");var s=new c;s.id="human_name",s.vowels=["a","e","i","o","u","y"],s.consonants=["b","c","d","g","h","ph","ch","k","l","m","n","p","r","s","t","v","w","sh"],this.add(s),this.t.templates.push("Letters#3-8"),this.clone("human_city","human_name"),this.t.parts=["ork","ah","ois","nsin","ona","ina","insk","ovo","va","od","irsk","wa","owo","irk","ow","es","go","on","owa","dran","drun","be","ka","ama","kyo","ro","poro","to"],this.t.templates.push("Letters#2-5,part"),this.clone("human_kingdom","human_name"),this.t.add_addition_chance=.5,this.t.addition_start=["Great","Holy","Realm of the","The"],this.t.addition_ending=["Empire","Hegemony","Kingdom","Imperium","of Sun","of Moon","Dynasty"],this.t.templates.push("addition_start,Letters#2-7,addition_ending");var l=new c;l.id="orc_name",l.vowels=["a","e","o"],l.consonants=["d","g","k","n","p","r","t","z"],l.parts=["igh","ord","uz","duz","rid","ogh","agh","okh","uh","dzz","ez","az","oz","top","urg"],this.add(l),this.t.templates.push("Letters#3-7"),this.t.templates.push("Part"),this.t.templates.push("Part,part"),this.t.templates.push("Part,space,Part"),this.clone("orc_city","orc_name"),this.t.templates.push("Part,space,Part"),this.t.templates.push("consonant,letters#3-5"),this.t.templates.push("consonant,letters#3-5,part"),this.t.templates.push("consonant,letters#1-3,space,CONSONANT,letters#2-3"),this.clone("orc_kingdom","orc_name"),this.t.add_addition_chance=.5,this.t.addition_start=["Bloody","Clan of","Axe of","The","Blood of","Bad","Strong","Tall","Red","Green"],this.t.addition_ending=["Fighters","Gang","Band","of Death","Axes","Clan","Brothers","Warriors","Boyz","Horde"],this.t.templates.push("addition_start,CONSONANT,letters#3-5,part,addition_ending"),this.t.templates.push("addition_start,Part,addition_ending"),this.t.templates.push("addition_start,Part,part,addition_ending"),this.t.templates.push("addition_start,Part,space,Part,addition_ending"),this.t.templates.push("addition_start,CONSONANT,letters#1-3,space,CONSONANT,letters#2-3,addition_ending");var d=new c;d.id="dwarf_name",d.vowels=["a","e","o"],d.special1=["Dhun","Dum","Gor","Ber","Ger","Kog","Gul","Ther","Thor","Von","Gil","Ver","Vagh","Gigh","Deg","Dig","Bam","Von","Han","Dhir","Mugh","Mul","Gorn","Gan","Bol","Gal"],d.consonants=["b","d","g","h","k","m","n","p","r","s","t"],d.parts=["ahl","uhm","ril","til","rim","dum","al","or","uhr","ihr","or"],d.max_consonanats_in_row=1,d.max_vowels_in_row=1,this.add(d),this.t.templates.push("special1,space,Letters#2-4,part"),this.t.templates.push("special1,space,Letters#2-4,part"),this.t.templates.push("Letters#1-4,part"),this.t.templates.push("Letters#1-4,part"),this.clone("dwarf_city","dwarf_name"),this.t.templates.push("special1,space,Letters#2-4,part"),this.t.templates.push("letters#2-4,part"),this.t.templates.push("letters#2-4,part"),this.clone("dwarf_kingdom","dwarf_name"),this.t.add_addition_chance=.5,this.t.addition_start=["Miners of","Great","Rocky","Spears of","Ancient"],this.t.addition_ending=["Stones","Rocks","Boulders","Mountain","Mountains","Miners","Kingdom","Shields","Picks","Drunks"],this.t.templates.push("addition_start,special1,space,Letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,Letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,Letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,Letters#1-4,part,addition_ending");var u=new c;u.id="elf_name",u.vowels=["a","e","o"],u.consonants=["c","d","f","h","l","m","n","r","s","t"],u.special1=["Ylh","Emy","Ny","Ly","If","Se","Am","Yaa","Omy","Na","Yg","Yd","Eo","Yo","O","A"],u.special2=["A'","E'","O'"],u.parts=["ua","ra","on","ad","nor","ne","hel","on","hil","ore","ora","ona","era","eas","ari","adi","ona"],u.max_consonanats_in_row=1,u.max_vowels_in_row=1,this.add(u),this.t.templates.push("special1,letters#1-4,part"),this.t.templates.push("special2,Letters#1-4,part"),this.t.templates.push("letters#1-4,part"),this.t.templates.push("letters#1-4,part"),this.clone("elf_city","elf_name"),this.t.templates.push("special1,letters#1-4,part"),this.t.templates.push("special2,Letters#1-4,part"),this.t.templates.push("special1,letters#1-4,space,Letters#1-3,part"),this.t.templates.push("letters#1-4,part"),this.t.templates.push("letters#1-4,part"),this.clone("elf_kingdom","elf_name"),this.t.add_addition_chance=.5,this.t.addition_start=["Great","Green","Arrows of","Spears of","Ancient","Royal"],this.t.addition_ending=["Keepers","Forest","Children","Brothers","of Fire","of Rain","of Earth","Kingdom","Lands"],this.t.templates.push("addition_start,special1,letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,special2,Letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,special1,letters#1-4,space,Letters#1-3,part,addition_ending"),this.t.templates.push("addition_start,Letters#1-4,part,addition_ending"),this.t.templates.push("addition_start,Letters#1-4,part,addition_ending");var h=new c;h.id="sheep_name",this.add(h),this.t.part_groups.push("b"),this.t.part_groups.push("a,aa,aaa,o,oo,ooo,y,yy,yyy"),this.t.part_groups.push("h"),this.t.templates.push("part_group");var p=new c;p.id="penguin_name",this.add(p),this.t.part_groups.push("h,w,d,t"),this.t.part_groups.push("u,uu,uuu,a,aa,aaa"),this.t.part_groups.push("g,gg,d,r,z"),this.t.part_groups.push("o,oo,ooo,a,aa,aaa"),this.t.templates.push("part_group");var f=new c;f.id="turtle_name",this.add(f),this.t.part_groups.push("l,t,g,z"),this.t.part_groups.push("u,uu,a,aa,o,oo"),this.t.part_groups.push("k,kk"),this.t.templates.push("part_group");var _=new c;_.id="wolf_name",this.add(_),this.t.part_groups.push("w"),this.t.part_groups.push("o,oo,oo,a,aa,aaa"),this.t.part_groups.push("f"),this.t.templates.push("part_group");var m=new c;m.id="greg_name",this.add(m),this.t.part_groups.push("Greg,Gregis,Gregim,Greges,Gregef,Gregonk,Gregos,Gregaz"),this.t.templates.push("part_group");var g=new c;g.id="chicken_name",this.add(g),this.t.part_groups.push("k,g,d,b,ka,ko,go,keke,koko"),this.t.part_groups.push("o,a,a"),this.t.templates.push("part_group"),this.t.templates.push("part_group,part_group"),this.t.templates.push("part_group,space,Part_group"),this.t.templates.push("part_group,part_group"),this.t.templates.push("part_group,space,Part_group,space,Part_group"),this.t.templates.push("part_group,space,Part_group");var y=new c;y.id="alien_name",this.add(y),this.t.part_groups.push("ze,zo,zo,ze,zog,zag,xag,xeg,xo,xe"),this.t.part_groups.push("o,oo,oo,a,aa,a,y,u,,,"),this.t.part_groups.push("r,d,z,ze,tze,tza,n"),this.t.templates.push("part_group");var v=new c;v.id="ufo_name",this.add(v),this.t.part_groups.push("TK-,XX-,YT-,Z-,RT-,PP-,KL-,QR-"),this.t.part_groups.push("0,1,2,3,4,5,6,7,8,9,404"),this.t.part_groups.push("0,1,2,3,4,5,6,7,8,9,404"),this.t.part_groups.push("0,1,2,3,4,5,6,7,8,9,404"),this.t.templates.push("part_group");var b=new c;b.id="cold_one_name",this.add(b),this.t.part_groups.push("ice,icy,co,colo"),this.t.part_groups.push("m,n,mem,non"),this.t.part_groups.push("e,a,o,y"),this.t.part_groups.push("n,c,k,brr,b"),this.t.templates.push("part_group");var w=new c;w.id="bug_name",this.add(w),this.t.part_groups.push("e,ee,eee,eeee"),this.t.part_groups.push("w,ww,www"),this.t.templates.push("part_group");var T=new c;T.id="ant_name",this.add(T),this.t.part_groups.push("an,ant,ano"),this.t.part_groups.push(",n,o,on"),this.t.templates.push("part_group");var k=new c;k.id="demon_name",this.add(k),this.t.part_groups.push("a'n,e'r,'o'r,o'h,an,am,akan,al,bal,fur,d,dev,gar,kra,val"),this.t.part_groups.push("a,i,e"),this.t.part_groups.push("r,vel,v,s,on,mon,al"),this.t.templates.push("part_group");var B=new c;B.id="fairy_name",this.add(B),this.t.part_groups.push("ar,er,or,ir"),this.t.part_groups.push("i,a,e"),this.t.part_groups.push("a,e"),this.t.templates.push("part_group");var S=new c;S.id="crab_name",this.add(S),this.t.part_groups.push("c,cr"),this.t.part_groups.push("a,aa,aaa,o,o,o"),this.t.part_groups.push("b,be,ba,bo"),this.t.templates.push("part_group");var C=new c;C.id="cow_name",C.parts=["moo","oom","mi"],this.add(C),this.t.part_groups.push("m,l,d,b,mad,daa,moo"),this.t.part_groups.push("i,o,a,y"),this.t.part_groups.push("d,m"),this.t.templates.push("part_group"),this.t.templates.push("Part,space,Part_group"),this.t.templates.push("part_group,space,Part"),this.t.templates.push("part_group,space,Part_group"),this.t.templates.push("part_group,part_group"),this.t.templates.push("part,part_group");var x=new c;x.id="default_name",x.vowels=["a","e","i","o","u","y","oo"],this.add(x),this.t.part_groups.push("Pl,P,S,L,D,B"),this.t.part_groups2.push("mp,rp,rt,b"),this.t.part_groups3.push("kin,tin,le,ee"),this.t.templates.push("part_group,vowel,part_group2,part_group3");var A=new c;A.id="evil_mage_name",A.vowels=["a","e","i","o","u","y"],A.consonants=["b","c","d","g","h","ph","ch","k","l","m","n","p","r","s","t","v","w","sh"],A.parts=["fez","soh","doroz","uru","hazah","drah","wazah","mah"],this.add(A),this.t.addition_start=["Great","Awe","Bro","Lo","Le","Blo","Mago","Evol","Fir","Smol","Dro"],this.t.templates.push("addition_start,Letters#2-6,part");var P=new c;P.id="rhino_name",this.add(P),this.t.part_groups.push("Sharp,Dull,Broken,Jagged,Long,Short,Soft,Thick,Flat,Serrated,Smooth"),this.t.part_groups.push("-Horn,-Nose,-Tip,-Snout"),this.t.templates.push("part_group,space,CONSONANT,vowel,consonant,vowel"),this.t.templates.push("part_group,space,CONSONANT,vowel,consonant,vowel,consonant"),this.t.templates.push("part_group,space,CONSONANT,vowel,consonant,vowel,consonant,vowel"),this.t.templates.push("part_group,space,CONSONANT,vowel,consonant,consonant,vowel,consonant"),this.t.templates.push("part_group,space,CONSONANT,vowel,consonant,consonant,vowel,consonant,vowel"),this.t.templates.push("CONSONANT,vowel,consonant,vowel"),this.t.templates.push("CONSONANT,vowel,consonant,vowel,consonant"),this.t.templates.push("CONSONANT,vowel,consonant,vowel,consonant,vowel"),this.t.templates.push("CONSONANT,vowel,consonant,consonant,vowel,consonant"),this.t.templates.push("CONSONANT,vowel,consonant,consonant,vowel,consonant,vowel");var O=new c;O.id="monkey_name",O.consonants=["b","c","d","f","h","j","ch","k","l","m","n","p","r","s","t","v","w","sh"],O.vowels=["a","e","i","o","u","y","ee","oo","aa"],this.add(O),this.t.templates.push("VOWEL,consonant,vowel"),this.t.templates.push("VOWEL,consonant,vowel,vowel"),this.t.templates.push("CONSONANT,vowel,vowel,consonant,vowel"),this.t.templates.push("CONSONANT,vowel,consonant,vowel");var R=new c;R.id="buffalo_name",R.parts=["Br","F","D","T"],this.add(R),this.t.part_groups.push("B"),this.t.part_groups.push("uff,eef,ill"),this.t.part_groups.push("y,ee,"),this.t.part_groups2.push("Tau"),this.t.part_groups2.push("ris,rus,ry,ro"),this.t.part_groups3.push("an"),this.t.part_groups3.push("ger,gy,gys,gus"),this.t.templates.push("Part,part_group3"),this.t.templates.push("part_group,space,part_group2"),this.t.templates.push("part_group,space,Part,part_group3");var F=new c;F.id="fox_name",this.add(F),this.t.part_groups.push("F,Ph,V"),this.t.part_groups.push("o,i,u,a"),this.t.part_groups.push("x,xx,xz"),this.t.part_groups.push(",,y,in,en"),this.t.templates.push("part_group");var L=new c;L.id="hyena_name",this.add(L),this.t.part_groups.push("G,B,Sn,W"),this.t.part_groups.push("iggl,abbl"),this.t.part_groups.push("e,ee,eee,y,yy,yyy"),this.t.part_groups2.push("H,F,Wh,B,D"),this.t.part_groups2.push("i,y,ai"),this.t.part_groups2.push("en,een,eeen"),this.t.part_groups2.push("a,er,uh,aa,eer,uuh"),this.t.part_groups3.push("C,K"),this.t.part_groups3.push("a,aa,aaa,e,ee,eee,i,ii,iii,o,oo,ooo,y,yy,yyy"),this.t.part_groups3.push("ch,kh,ck,kc"),this.t.part_groups3.push("le,lee,ler,leer,ling,liing,lin,liin"),this.t.templates.push("part_group"),this.t.templates.push("part_group2"),this.t.templates.push("part_group3");var D=new c;D.id="crocodile_name",D.vowels=["o","a","i"],D.special1=["o","ah","i"],this.add(D),this.t.parts=["Cr","Kr"],this.t.part_groups.push("c,k,ck"),this.t.part_groups2.push("ill,eel,ile,yl"),this.t.templates.push("part,special1,part_group"),this.t.templates.push("part,special1,part_group,special1"),this.t.templates.push("part,special1,part_group,special1,consonant,part_group2"),this.t.templates.push("part,special1,part_group,special1,consonant,part_group2,vowel");var M=new c;M.id="snake_name",this.add(M),this.t.part_groups.push("S,Ss,Sss,Sch,Sh"),this.t.part_groups.push("n,m"),this.t.part_groups2.push("c,k,ck,ch,kh"),this.t.templates.push("part_group,vowel,part_group2"),this.t.templates.push("part_group,vowel,part_group2,vowel"),this.t.templates.push("part_group,vowel,vowel,part_group2,vowel"),this.t.part_groups3.push("azz,ooz,eez,zher"),this.t.part_groups3.push("ra,ka,er,erm,ez"),this.t.templates.push("part_group,part_group3,vowel"),this.t.templates.push("part_group,part_group3");var I=new c;I.id="frog_name",this.add(I),this.t.part_groups.push("R"),this.t.part_groups.push("i,y"),this.t.part_groups.push("b,bb"),this.t.part_groups.push("i,y,o"),this.t.part_groups.push("t"),this.t.part_groups.push(",er,ing"),this.t.part_groups2.push("J,W,Y"),this.t.part_groups2.push("i,o,u"),this.t.part_groups2.push("mp"),this.t.part_groups2.push("y,er,ing"),this.t.part_groups3.push("K,C"),this.t.part_groups3.push("r"),this.t.part_groups3.push("o,e"),this.t.part_groups3.push("a,e"),this.t.part_groups3.push("q,k,c"),this.t.part_groups3.push(",i,y,er,ing"),this.t.templates.push("part_group"),this.t.templates.push("part_group2"),this.t.templates.push("part_group3");var j=new c;j.id="bioblob_name",this.add(j),this.t.part_groups.push("Seeing ,Seeking ,Peeking ,Staring ,Watchful ,"),this.t.part_groups.push("Eye ,Eyes ,Sight ,Syght "),this.t.part_groups.push("of ,"),this.t.part_groups2.push("K,C"),this.t.part_groups2.push("t,th,sh,ch,v,"),this.t.part_groups2.push("a,e,i,o,u,y"),this.t.part_groups2.push("l,w,v,b,sh"),this.t.part_groups2.push("a,e,i,o,u,y"),this.t.part_groups3.push("Watch,Peek,Seek,Gaz,See"),this.t.part_groups3.push("ing,yng,er,r"),this.t.templates.push("part_group,part_group2"),this.t.templates.push("part_group3,space,part_group2");var E=new c;E.id="assimilator_name",E.special1=["-",""],this.add(E),this.t.part_groups.push("TK-,XX-,YT-,Z-,RT-,PP-,KL-,QR-,ER-"),this.t.templates.push("part_group,number,special1,number,special1,number");var N=new c;N.id="fire_skull_name",this.add(N),this.t.part_groups.push("Reap,Bone,Bones,Minion,Doll,Disciple,Zealot,Apostle,Spirit,Skull,Braincase,Vertex,Scalp,Crown,Mind"),this.t.templates.push("part_group,vowelchance"),this.t.templates.push("part_group,removalchance,vowelchance");var z=new c;z.id="acid_blob_name",this.add(z),this.t.part_groups.push("Bl,Gl,Dr,Sl"),this.t.part_groups.push("a,e,er,i,o,oo,u,y"),this.t.part_groups.push("b,p,m"),this.t.part_groups.push(",er,ir,y,i,ster"),this.t.templates.push("part_group");var G=new c;G.id="wraith_name",this.add(G),this.t.part_groups.push("Unholy,Dark,Knavish,Odious,Shameful,Disgraced,Abominable,Appalling,Abhorrent,Monstrous,Fiendish,Bouncy,Rubber"),this.t.part_groups2.push("Reap,Reaper,Bone,Bones,Minion,Doll,Disciple,Zealot,Apostle,Spirit,Skull,Braincase,Vertex,Scalp,Crown,Mind"),this.t.templates.push("part_group2"),this.t.templates.push("part_group,space,part_group2");var U=new c;U.id="lil_pumpkin_name",this.add(U),this.t.part_groups.push("M,N,X"),this.t.part_groups.push("a,aa,o,oo,y"),this.t.part_groups.push("x,d,z"),this.t.part_groups.push("i,o,a,u"),this.t.part_groups.push("m,n,x,z"),this.t.templates.push("part_group");var W=new c;W.id="rat_name",this.add(W),this.t.part_groups.push("ma,ar,a,e,i,b,c"),this.t.part_groups.push("v,m,n,k,rk,x,rt"),this.t.part_groups.push("o,s,a,y,e,i"),this.t.part_groups.push("m,n,a,d"),this.t.templates.push("part_group");var q=new c;q.id="cat_name",this.add(q),this.t.part_groups.push("M"),this.t.part_groups.push("e,ee,ee"),this.t.part_groups.push("o,oo,oo,"),this.t.part_groups.push("w,ww,ww"),this.t.templates.push("part_group"),this.t.templates.push("part_group,space,part_group");var H=new c;H.id="rabbit_name",this.add(H),this.t.part_groups.push("J,Dj"),this.t.part_groups.push("a,e,o,ae,oe"),this.t.part_groups.push("t,p,m"),this.t.part_groups.push("o,a,y,eke"),this.t.templates.push("part_group");var V=new c;V.id="piranha_name",this.add(V),this.t.part_groups.push("C"),this.t.part_groups.push("h"),this.t.part_groups.push("o,a,oe,ae"),this.t.part_groups.push("p,d,b"),this.t.templates.push("part_group,space,part_group"),this.t.templates.push("part_group");var Z=new c;Z.id="snowman_name",this.add(Z),this.t.part_groups.push("S,Z,Ss,Zz"),this.t.part_groups.push("o,a,o,"),this.t.part_groups.push("s,zz,ss,zzz"),this.t.part_groups.push("y,e,o"),this.t.templates.push("part_group");var K=new c;K.id="bear_name",this.add(K),this.t.part_groups.push("H"),this.t.part_groups.push("h,"),this.t.part_groups.push("o,a,e"),this.t.part_groups.push("n"),this.t.part_groups.push("y,e,o,"),this.t.part_groups.push("y,e,o,"),this.t.part_groups.push("a,"),this.t.templates.push("part_group");var J=new c;J.id="skeleton_name",this.add(J),this.t.part_groups.push("B"),this.t.part_groups.push("o,a,e"),this.t.part_groups.push("n"),this.t.part_groups.push("y,e,o,"),this.t.part_groups.push("y,e,o,"),this.t.part_groups.push("s"),this.t.templates.push("part_group");var Y=new c;Y.id="homie_name",this.add(Y),this.t.part_groups.push("H"),this.t.part_groups.push("o,a,e"),this.t.part_groups.push("m"),this.t.part_groups.push("i,y,e,o,"),this.t.part_groups.push("y,e,o,"),this.t.templates.push("part_group");var Q=new c;Q.id="living_plant_name",this.add(Q),this.t.part_groups.push("Pl"),this.t.part_groups.push("o,a,e"),this.t.part_groups.push("n"),this.t.part_groups.push("t,"),this.t.part_groups.push("i,y,e,o,"),this.t.part_groups.push("y,e,o,"),this.t.templates.push("part_group")},e.prototype.addMottoPart=function(t,e){this.t.motto_parts.set(t,e)},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=s.default.fromJson(i,new c);return o.id=t,this.add(o),o},e}(l.default);n.default=d,cc._RF.pop()},{}],NameGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"59237GTu9tF7oGyLHpDGX6P","NameGenerator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("Constants"),r=o("ResMgr"),s=o("ActorAsset"),l=o("AssetManager"),c=o("ToolBox"),d=o("ChineseNameGenerator"),u=function(){function t(){}return t.init=function(){t.initiated||(t.initiated=!0,t.loadProfanityFilter())},t.loadProfanityFilter=function(){t.profanity&&t.profanity.size>0||r.default.loadRes("res/config/blacklisted_names").then(function(t){for(var e=t.json.list,i=0;i<e.length;i++)e[i].toLocaleLowerCase()})},t.getName=function(e,i){void 0===i&&(i=s.ActorGender.Male);var o="";switch(n.default.LANGUAGE){case n.LANGUAGE_TYPE.EN:t.init();var a=l.default.nameGenerator.get(e);if(t.curConsonants=0,t.curVowels=0,o=t.generateNameFromTemplate(a),i==s.ActorGender.Female){for(var r=o.substring(o.length-1,1),u=!1,h=a.vowels,p=0;p<h.length;p++)if(h[p]==r){u=!0;break}u||(o+=c.Toolbox.getRandom(a.vowels))}break;case n.LANGUAGE_TYPE.ZH:if(o=d.default.getChineseName(e))break;var f=4,_=c.Toolbox.randomInt(0,100);_<30?f=2:_<70&&(f=3);for(var m=Array.from(t.nameWords),g=0;g<f;g++){for(var y=m.getRandom();o.indexOf(y)>0;)y=m.getRandom();o+=y}}return o},t.checkBlackList=function(t){return t.toLocaleLowerCase(),!1},t.cleanString=function(t){for(var e=t[0].toString(),i=0;i<t.length-1;i++)t[i].equals(t[i+1])||(e+=t[i+1]);return e},t.firstToUpper=function(t){return t.substring(0,1).toUpperCase()+t.substring(1,t.length-1)},t.addVowel=function(e,i){return void 0===i&&(i=!1),t.curConsonants=0,t.curVowels++,i?t.firstToUpper(c.Toolbox.getRandom(e)):c.Toolbox.getRandom(e)},t.addEnding=function(e,i){var o=c.Toolbox.getRandom(e.parts);return t.isConsonant(o.substring(0,1))&&t.isConsonant(i.substring(i.length-1,1))?o=t.addVowel(e.vowels)+o:t.isConsonant(o.substring(0,1))||t.isConsonant(i.substring(i.length-1,1))||(o=t.addConsonant(e.consonants)+o),o},t.addConsonant=function(e,i){return void 0===i&&(i=!1),t.curConsonants++,t.curVowels=0,i?t.firstToUpper(c.Toolbox.getRandom(e)):c.Toolbox.getRandom(e)},t.addPart=function(e,i){void 0===i&&(i=!1);var o=c.Toolbox.getRandom(e);return t.isConsonant(o.substring(o.length-1,1))?(t.curConsonants++,t.curVowels=0):(t.curConsonants=0,t.curVowels++),i&&(o=t.firstToUpper(o)),o},t.isConsonant=function(e){return t.consonants_all.includes(e)},t.generateNameFromTemplate=function(e){t.dict_splitted_items.clear(),t.curConsonants=0,t.curVowels=0;for(var i="",o=!1,a=!1,n=e.templates.getRandom().split(","),r=0;r<n.length;r++){var s=n[r].split("#"),l=s[0];if(e.motto_generator){if("comma"==l){i+=", ";continue}if(l.includes(";")&&(l=l.split(";").getRandom()),!t.dict_splitted_items.has(l)){var d=e.motto_parts.get(l).split(",");t.dict_splitted_items.set(l,d)}var u=t.dict_splitted_items.get(l);u.shuffle(),i+=u.shift()}else switch(l){case"RANDOM_LETTER":i=c.Toolbox.randomBool()?i+t.addVowel(e.vowels,!0):i+t.addConsonant(e.consonants,!0);break;case"space":i+=" ";break;case"letters":var h=s[1].split("-");i+=t.addWord(e,parseInt(h[0]),parseInt(h[1]));break;case"Letters":var p=s[1].split("-");i+=t.addWord(e,parseInt(p[0]),parseInt(p[1]),!0);break;case"part":i+=e.parts.getRandom();break;case"consonant":i+=t.addConsonant(e.consonants);break;case"CONSONANT":i+=t.addConsonant(e.consonants,!0);break;case"vowel":i+=t.addVowel(e.vowels);break;case"vowelchance":c.Toolbox.randomBool()&&(i+=t.addVowel(e.vowels));break;case"removalchance":c.Toolbox.randomBool()&&i.remove(i.length-1);break;case"VOWEL":i+=t.addVowel(e.vowels,!0);break;case"special1":i+=e.special1.getRandom();break;case"special2":i+=e.special2.getRandom();break;case"Part":var f=e.parts.getRandom();i+=f=t.firstToUpper(f);break;case"number":i+=c.Toolbox.randomInt(0,10);break;case"addition_start":!a&&c.Toolbox.randomChance(e.add_addition_chance)&&(i=i+e.addition_start.getRandom()+" ",a=!0);break;case"addition_ending":!a&&c.Toolbox.randomChance(e.add_addition_chance)&&(i=i+" "+e.addition_ending.getRandom(),a=!0);break;case"part_group":for(var _=0;_<e.part_groups.length;_++)i+=e.part_groups[_].split(",").getRandom();break;case"part_group2":for(var m=0;m<e.part_groups2.length;m++)i+=e.part_groups2[m].split(",").getRandom();break;case"part_group3":for(var g=0;g<e.part_groups3.length;g++)i+=e.part_groups3[g].split(",").getRandom();break;case"Part_group":o=!0;for(var y=0;y<e.part_groups.length;y++){var v=e.part_groups[y].split(",");o?(i+=t.firstToUpper(v.getRandom()),o=!1):i+=v.getRandom()}break;case"Part_group2":o=!0;for(var b=0;b<e.part_groups2.length;b++){var w=e.part_groups2[b].split(",");o?(i+=t.firstToUpper(w.getRandom()),o=!1):i+=w.getRandom()}break;case"Part_group3":o=!0;for(var T=0;T<e.part_groups3.length;T++){var k=e.part_groups3[T].split(",");o?(i+=t.firstToUpper(k.getRandom()),o=!1):i+=k.getRandom()}}}return t.checkBlackList(i)&&(i=t.generateNameFromTemplate(e)),t.firstToUpper(i)},t.addWord=function(e,i,o,a){void 0===a&&(a=!1);for(var n="",r=c.Toolbox.randomInt(i,o),s=0;s<r;s++)t.curConsonants>=e.max_consonanats_in_row?(n+=t.addVowel(e.vowels,a),a=!1):t.curVowels>=e.max_vowels_in_row?(n+=t.addConsonant(e.consonants,a),a=!1):c.Toolbox.randomBool()?(n+=t.addVowel(e.vowels,a),a=!1):(n+=t.addConsonant(e.consonants,a),a=!1);return n},t.nameWords="\u739b\u594e\u5854\u57c3\u8fea\u5362\u514b\u96f7\u8482\u5a05\u5409\u798f\u6731\u8389\u5b89\u8c22\u83f2\u5c14\u5fb7\u8fbe\u897f\u5c3c\u4e9a\u6069\u65af\u7279\u51ef\u6587\u59ae\u6d1b\u857e\u54c8\u5a1c\u9a6c\u83ab\u5361\u8d39\u5229\u8bfa\u57fa\u7c73\u827e\u5947\u4fc4\u8428\u5e03\u7f57\u4e8e\u91cc\u4e4c\u7a46\u529b\u5c71\u5927\u76ae\u5e15\u53ef\u8587\u745e\u7eb3\u62c9\u5df4\u4f26\u9c81\u6770\u831c\u5384\u8fc8\u83b1\u82e5\u52d2\u67e5\u591a\u56e0\u4f0a\u7d22\u8d1d\u5217\u5a03\u5f53\u7126\u4e07\u4e3d\u4e1d\u7231\u5965\u6851\u838e\u4f2f\u5170\u82cf\u5450\u674e\u52a0\u73ca\u59d7\u8d6b\u66fc\u8299\u592b\u7433\u4f11\u7eee\u7f55\u9ed8\u6234\u7ef4\u82ad\u767d\u74a7\u59c6\u6863\u535a\u963f\u6cfd\u8499\u79d1\u6cf0\u6258\u8d5e\u660e\u6208\u6b27\u5185\u9edb\u8d56\u6e29\u8ba9\u7fe0\u9f50\u4fee\u7b80\u68ee\u7acb\u666e\u8d5b\u8d3e\u96ea\u513f\u4e50\u5f17\u6797\u624e\u6c49\u5357\u74e6\u63d0\u96c5\u59ff\u654f\u5e0c\u4f55\u6d77\u7ebd\u683c\u5ea6\u8335\u585e\u4e39\u67d4\u4f9d\u5370\u7b2c\u73e5\u767b\u9732\u5339\u67ef\u5546\u6c83\u4e54\u53e4\u84bd\u623f\u7f8e\u6b4c\u6c40\u4f69\u601d\u5355\u6ce2\u8f9b\u91d1\u6d01\u5eb7\u5766\u4e01\u4ed1\u5f25\u8fe6\u582a\u76d6\u6885\u5178\u5e2d\u68a6\u6717\u743c\u6c99\u8331\u970d\u6da6\u7f07\u6cbb\u6492\u975e\u5587\u5e93\u66ff\u7ea6\u7ff0\u7fc1\u90a6\u745f\u73c0\u6d85\u8010\u6843\u78a7\u6bd4\u80e1\u6cca\u854a\u65e5\u820d\u590f\u971e\u5a01\u6839\u6735\u5948\u95e8\u5179\u5bdf\u90a3\u5c24\u592a\u841d\u6469\u672c\u871c\u73cd\u7eaa\u8983\u5207\u5386\u8bd7\u4ee3\u84dd\u8521\u8d44\u5b81\u52b3\u82ac\u4ee5\u8a79\u9016\u5e1d\u88d8\u82f1\u9ea6\u8c2c\u671b\u65b9\u8096\u72c4\u4ea6\u679c\u552f\u8033\u5fd2\u9ad8\u987f\u6734\u793c\u4f5b\u9ed1\u5d14\u4f50\u9053\u8303\u6682\u65e0\u8354\u5ec9\u8c2d\u91c7\u90fd\u53f2\u989d\u574e\u59ec\u51e1\u5a55\u900a\u829d\u4ea8\u7406\u5723\u5404\u6cd5\u6240\u53f8\u65fa\u9686\u5415\u6bcd\u8def\u6613\u4ece\u5f7c\u5f97\u70c8\u62dc\u7f2a\u5510\u742a\u6f58\u4e1c\u6c64\u6dc7\u4ec0\u7518\u9e43\u534e\u68c9\u7538\u8fed\u73c2\u5218\u73ed\u5f6c\u6fb3\u6d3e\u73bb\u9f99\u500d",t.curConsonants=0,t.curVowels=0,t.vowels_all=["a","e","i","o","u","y"],t.consonants_all=["b","c","d","f","g","h","j","k","l","m","n","p","q","r","s","t","v","w","x","z"],t.profanity=new Map,t.initiated=!1,t.dict_splitted_items=new Map,t}();a.default=u,cc._RF.pop()},{}],NapalmFlash:[function(t,e,i){"use strict";cc._RF.push(e,"6b177YV5ENH4LRkUnDlmp8V","NapalmFlash");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AssetManager"),c=a("BaseEffect"),d=a("Brush"),u=a("MapBox"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killing=!1,e.bombSpawned=!1,e.bomb="",e.godPower=null,e}var i;return r(e,t),i=e,e.prototype.spawnFlash=function(t,e){this.tile=t,this.godPower=l.default.powers.get(e),this.bombSpawned=!1,this.bomb=e,this.killing=!1,this.prepare(t,.1)},e.napalmEffect=function(t){return t.setFire(!0),!0},e.prototype.logicUpdate=function(){if(this.node.scaleX<1&&!this.killing){var t=this.node.scale;(t+=.7*u.default.inst.elapsed)>=.6&&!this.bombSpawned&&(this.bombSpawned=!0,u.default.inst.loopWithBrush(this.tile,d.default.getBrushBySize(12),i.napalmEffect,"napalm")),t>=.7&&(t=.7,this.killing=!0),this.node.scale=t}else if(this.killing){var e=this.node.scaleX;(e-=1.5*u.default.inst.elapsed)<=0&&(e=0,this.kill()),this.node.scaleX=e}},i=s([p],e)}(c.default));n.default=f,cc._RF.pop()},{}],NukeFlash:[function(t,e,i){"use strict";cc._RF.push(e,"29dc9ub16dDbqjILcbishvv","NukeFlash");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MapAction"),c=a("AssetManager"),d=a("TerraformLibrary"),u=a("BaseEffect"),h=a("Config"),p=a("MapBox"),f=a("ExplosionChecker"),_=cc._decorator,m=_.ccclass,g=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.killing=!1,e.bombSpawned=!1,e.bomb="",e.godPower=null,e}return r(e,t),e.prototype.spawnFlash=function(t,e){this.tile=t,this.godPower=c.default.powers.get(e),this.bombSpawned=!1,this.bomb=e,this.killing=!1,this.prepare(t,.1)},e.prototype.logicUpdate=function(){if(this.node.scaleX<1&&!this.killing){h.default.greyGooDamaged=!1;var t=this.node.scale;(t+=2.5*p.default.inst.elapsed)>=.8&&!this.bombSpawned&&(this.bombSpawned=!0,this.bombAction()),t>=1&&(t=1,this.killing=!0),this.node.scale=t}else if(this.killing){var e=this.node.scaleX;(e-=2.5*p.default.inst.elapsed)<=0&&(e=0,this.kill()),this.node.scaleX=e}},e.prototype.bombAction=function(){"atomicBomb"==this.bomb?this.atomicBombAction():"czarBomba"==this.bomb&&this.czarBombaAction()},e.prototype.atomicBombAction=function(){p.default.inst.stackEffects.get("explosionNuke").spawnAtRandomScale(this.tile,.8,.9),f.default.inst.checkNearby(this.tile,30)||l.default.damageWorld(this.tile,30,d.default.atomicBomb)},e.prototype.czarBombaAction=function(){p.default.inst.stackEffects.get("explosionNuke").spawnAtRandomScale(this.tile,1.4,1.6),f.default.inst.checkNearby(this.tile,70)||l.default.damageWorld(this.tile,70,d.default.czarBomba)},s([m],e)}(u.default));n.default=g,cc._RF.pop()},{}],OceanHelper:[function(t,e,i){"use strict";cc._RF.push(e,"96b1bG/j5tIjZPwB42+KKLB","OceanHelper");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("TileTypeBase"),s=o("MapBox"),l=function(){function t(){}return t.goodForNewDock=function(e){var i;return!(!e.type.ocean||null===(i=e.region)||void 0===i||!i.island||e.region.island.getTileCount()<2500||t._ocean_pools_with_docks.includes(e.region.island))},t.saveOceanPoolsWithDocks=function(e){e.haveBuildingType("docks")&&e.buildings_dict_type.get("docks").forEach(function(e){e.tiles.forEach(function(e){t.addOceanPool(e)})})},t.clearOceanPools=function(){t._ocean_pools_with_docks=[]},t.addOceanPool=function(e){e.region.island&&e.region.type==r.TileLayerType.Ocean&&t._ocean_pools_with_docks.push(e.region.island)},t.findTileForBoat=function(e,i){var o=i.region.island,a=t.findTileInRegion(i.region,e);if(!a){var n=o.regions.getSimpleList();n.shuffle();for(var r=0;r<n.length&&r<=10&&!(a=t.findTileInRegion(n[r],e));r++);}if(!a)return null;for(var l=0;l<a.neighboursAll.length;l++){var c=a.neighboursAll[l];if(c.isSameIsland(e)&&c.isGoodForBoat()){a=c;break}}return s.default.inst.flashEffects.flashPixel(a),a},t.findTileInRegion=function(t,e){var i,o,a=t.getTileCorners();if(0==a.length)return null;a.shuffle();try{for(var r=n(a),s=r.next();!s.done;s=r.next()){var l=s.value;if(l.isSameIsland(e))return l}}catch(c){i={error:c}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return null},t._ocean_pools_with_docks=[],t}();a.default=l,cc._RF.pop()},{}],OnlineReward:[function(t,e,i){"use strict";cc._RF.push(e,"13263RNItdNhLEqmwJd4nul","OnlineReward");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ShuFenReport"),c=a("UserData"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.dot=null,e.rewardID=2,e}return r(e,t),e.prototype.start=function(){var t=c.default.member.onlineTime>0&&cc.sys.now()-c.default.member.onlineTime>18e5;this.setText(t)},e.prototype.setText=function(t){var e=this;if(this.node.stopAllActions(),t)this.label.string="\u53ef\u9886\u53d6";else{var i=200;this.label.string="\u5269\u4f59"+i+"\u79d2",cc.tween(this.node).sequence(cc.delayTime(1),cc.callFunc(function(){i--,e.label.string="\u5269\u4f59"+i+"\u79d2"})).repeat(200).call(function(){e.setText(!0)}).start()}this.setEnable(t)},e.prototype.setEnable=function(t){this.node.getComponent(cc.Button).interactable=t,this.node.getChildByName("icon").getComponent(cc.Sprite).setMaterial(0,this.node.getComponent(cc.Sprite).getMaterial(0))},e.prototype.getReward=function(){c.default.member.onlineTime=cc.sys.now(),c.default.save(),this.setText(!1),l.default.reportCustom("online")},s([h(cc.Label)],e.prototype,"label",void 0),s([h(cc.Node)],e.prototype,"dot",void 0),s([h],e.prototype,"rewardID",void 0),s([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],PathFindingVisualiser:[function(t,e,i){"use strict";cc._RF.push(e,"f682fmohARJdLTI8gBzm4gi","PathFindingVisualiser");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("DebugConfig"),c=a("MapBox"),d=a("MapLayer"),u=cc._decorator,h=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.default_color=cc.color(255,.46*255,48.45,255),e.tiles=[],e}return r(e,t),e.prototype.create=function(){this.colorValues=this.default_color,t.prototype.create.call(this)},e.prototype.updateDirty=function(){l.default.LastPath?this.node.active||(this.node.active=!0):this.node.active&&(this.node.active=!1)},e.prototype.clear=function(){for(var t=0;t<this.tiles.length;t++){var e=this.tiles[t];this.updateSinglePixel(e.data.tile_id,cc.Color.TRANSPARENT)}this.tiles=[]},e.prototype.showPath=function(t,e){if(l.default.LastPath){if(this.clear(),t)for(var i=0;i<c.default.inst.tilesList.length;i++){var o=c.default.inst.tilesList[i];this.tiles.push(o);var a=t.getNodeAt(o.pos.x,o.pos.y);a.isClosed?this.updateSinglePixel(o.data.tile_id,cc.Color.RED):a.isOpened?this.updateSinglePixel(o.data.tile_id,cc.Color.GREEN):this.updateSinglePixel(o.data.tile_id,cc.Color.TRANSPARENT)}for(i=0;i<e.length;i++){var n=e[i];this.updateSinglePixel(n.data.tile_id,cc.Color.BLUE),this.tiles.push(n)}this.updatePixels()}},s([h],e)}(d.default));n.default=p,cc._RF.pop()},{}],PathfinderTools:[function(t,e,i){"use strict";cc._RF.push(e,"2a10f+4t7xPP5n3Mmlh4cP+","PathfinderTools");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MathUtils"),r=o("MapBox"),s=o("ToolBox"),l=function(){function t(){}return t.raycast=function(e,i){t.raycastResult=[];var o=.99*s.Toolbox.distTile(e,i);t.a.set(cc.v3(e.posV3.x,e.posV3.y,0)),t.b.set(cc.v3(i.posV3.x,i.posV3.y,0));for(var a=null,l=0;l<=o;l++){var c=cc.Vec3.ZERO;cc.Vec3.lerp(c,t.a,t.b,l/o);var d=n.default.intCast(c.x),u=n.default.intCast(c.y),h=r.default.inst.getTile(d,u);!h||a&&h==a||(t.raycastResult.push(h),a=h)}return a!=i&&t.raycastResult.push(i),t.raycastResult},t.tryToGetSimplePath=function(e,i,o,a,n){t.raycastResult=[];for(var r=e,l=0,c=0,d=null;;){for(var u=0;u<r.neighboursAll.length;u++){var h=r.neighboursAll[u];l=s.Toolbox.distTile(h,i),(!d||l<c)&&(d=h,c=l)}if(!d||d==r)break;if(r=d,!n.block&&r.type.block)return!1;if(!n.lava&&r.type.lava)return!1;if(!n.ocean&&r.type.ocean)return!1;if(!n.swamp&&r.type.swamp)return!1;if(!n.ground&&r.type.ground)return!1;if(n.boat&&!r.isGoodForBoat())return!1;if(t.raycastResult.push(d),d==i)break;d=null}return o.addRange(t.raycastResult),!0},t.raycastTileForUnitToEmbark=function(e,i){for(var o=t.raycast(i,e),a=e.region.island,n=0;n<o.length;n++){var r=o[n];if(r.region.island==a)return r}return null},t.raycastTileForUnitLandingFromOcean=function(e,i){for(var o=t.raycast(e,i),a=i.region.island,n=0;n<o.length;n++){var r=o[n];if(r.region.island==a)return r}return null},t.raycastResult=[],t.a=cc.Vec3.ZERO,t.b=cc.Vec3.ZERO,t}();a.default=l,cc._RF.pop()},{}],PersonalityLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"18bd6bP+lhBOZYI51P1tOID","PersonalityLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.PersonalityAsset=void 0;var s=a("BaseStats"),l=a("AssetLibrary"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.baseStats=new s.default,e.icon="",e.sprite=null,e}return r(e,t),e.prototype.getSprite=function(){return this.sprite,this.sprite},e}(l.Asset);n.PersonalityAsset=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c;e.id="administrator",this.add(e),this.t.baseStats.personality_diplomatic=.1,this.t.baseStats.personality_administration=.5,this.t.baseStats.personality_aggression=.1;var i=new c;i.id="militarist",this.add(i),this.t.baseStats.personality_diplomatic=.05,this.t.baseStats.personality_administration=.1,this.t.baseStats.personality_aggression=.5;var o=new c;o.id="diplomat",this.add(o),this.t.baseStats.personality_diplomatic=.5,this.t.baseStats.personality_aggression=.05,this.t.baseStats.personality_administration=.2;var a=new c;a.id="balanced",this.add(a),this.t.baseStats.personality_administration=.1,this.t.baseStats.personality_diplomatic=.1,this.t.baseStats.personality_aggression=.1;var n=new c;n.id="wildcard",this.add(n),this.t.baseStats.personality_rationality=-1},e}(l.default);n.default=d,cc._RF.pop()},{}],PixelFlashEffects:[function(t,e,i){"use strict";cc._RF.push(e,"d0f1dsAU3lCs6T594g9f8Wt","PixelFlashEffects");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(n,"__esModule",{value:!0}),n.ColorType=void 0;var d,u=a("SmoothLoader"),h=a("ToolBox"),p=a("ConwayLife"),f=a("MapLayer"),_=a("WorldTile"),m=a("MapBox");(function(t){t[t.White=0]="White",t[t.Purple=1]="Purple",t[t.Blue=2]="Blue"})(d=n.ColorType||(n.ColorType={}));var g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toRemove=[],e.colorWhite=null,e.colorPurple=null,e.colorBlue=null,e._timer=0,e}return r(e,t),e.prototype.onLoad=function(){this.colors_amount=30,this.colorValues=cc.color(255,255,255),this.colorWhite=new _.ColorArray(cc.Color.WHITE,30,.5),this.colorPurple=new _.ColorArray(p.default.colorEater,30),this.colorBlue=new _.ColorArray(h.Toolbox.makeColor("#3BCC55"),30),t.prototype.create.call(this),this.enabled=!0},e.prototype.flashPixel=function(t,e,i){if(void 0===e&&(e=-1),void 0===i&&(i=d.White),!u.default.isLoading()&&(-1==e&&(e=this.colors_amount-1),this.enabled)){switch(i){case d.White:t.colorArray=this.colorWhite;break;case d.Purple:t.colorArray=this.colorPurple;break;case d.Blue:t.colorArray=this.colorBlue}t.flash_state<=0&&this.pixels_to_update.add(t),t.flash_state<e&&(t.flash_state=e)}},e.prototype.clear=function(){t.prototype.clear.call(this),this.pixels_to_update.clear()},e.prototype.updateDirty=function(){var t,e;if(this._timer>0)this._timer-=m.default.inst.elapsed;else if(this._timer=.01,!(this.pixels_to_update.length()<=0)){this.toRemove=[];try{for(var i=l(this.pixels_to_update.dict),o=i.next();!o.done;o=i.next()){var a=c(o.value,2),n=a[0];a[1],n.flash_state<0?this.toRemove.push(n):(this.updateSinglePixel(n.data.tile_id,n.colorArray.colors[n.flash_state]),n.flash_state--)}}catch(h){t={error:h}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var r=0;r<this.toRemove.length;r++){var s=this.toRemove[r];this.pixels_to_update.remove(s)}this.updatePixels()}},s([y],e)}(f.default));n.default=v,cc._RF.pop()},{}],PlayerConfig:[function(t,e,i){"use strict";cc._RF.push(e,"42152AflEBCebcqZEjaH9vn","PlayerConfig");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.PlayerConfigData=a.PlayerOptionData=a.OptionType=void 0;var r,s=o("Tools");(function(t){t[t.Bool=0]="Bool",t[t.String=1]="String",t[t.Int=2]="Int"})(r=a.OptionType||(a.OptionType={}));var l=function(t,e){this.name="OPTION",this.boolVal=!0,this.stringVal="zh",this.intVal=0,this.name=t,this.boolVal=e};a.PlayerOptionData=l;var c=function(){function t(){this.nextReward=5,this.powerReward="",this.lastReward="",this.nextAdTimestamp=-1,this.list=[],this.premium=!1,this.valCheck=!1,this.magicCheck=!1,this.fireworksCheck=!1,this.saveVersion=1,this.lastRateID=0,this.tutorialFinished=!1,this.pPossible=!0}return t.prototype.initData=function(){d.dict.clear(),this.add(new l("map_names",!0)),this.add(new l("map_city_zones",!0)),this.add(new l("map_culture_zones",!1)),this.add(new l("map_kingdom_zones",!1)),this.add(new l("map_kings_leaders",!1)),this.add(new l("history_log",!0)),this.add(new l("marks_boats",!1)),this.add(new l("portrait",!0)),this.add(new l("sound",!0)),this.add(new l("sound_ambient",!0)),this.add(new l("vignette",!0)),this.add(new l("bloom",!0)),this.add(new l("fire",!0)),this.add(new l("smoke",!0)),this.add(new l("vsync",!1)),this.add(new l("experimental",!1)),this.add(new l("language",!1)),this.add(new l("shadows",!1)),this.add(new l("tooltips",!1))},t.prototype.get=function(t){var e,i;try{for(var o=n(this.list),a=o.next();!a.done;a=o.next()){var r=a.value;if(t==r.name)return r}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return null},t.prototype.add=function(t){var e,i;try{for(var o=n(this.list),a=o.next();!a.done;a=o.next()){var r=a.value;if(t.name==r.name)return d.dict.set(r.name,r),r}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return this.list.push(t),d.dict.set(t.name,t),t},t}();a.PlayerConfigData=c;var d=function(){function t(){this.isSave=!1,this.data=null}return t.init=function(){t.inst||(t.inst=new t,t.inst.create())},t.prototype.create=function(){if(this.isSave)try{this.loadData()}catch(t){this.initNewSave()}else this.initNewSave()},t.prototype.initNewSave=function(){this.data=new c,this.data.initData(),this.saveData()},t.prototype.saveData=function(){cc.sys.localStorage.setItem("N_WB3_Config",JSON.stringify(this.data))},t.prototype.loadData=function(){if(this.isSave){var t=cc.sys.localStorage.getItem("N_WB3_Config");t.includes("list")?(this.data=s.default.fromJson(t,new c),this.data.initData()):this.initNewSave()}},t.optionEnabled=function(e,i){var o,a;try{for(var s=n(t.inst.data.list),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.name==e&&i==r.Bool)return c.boolVal}}catch(d){o={error:d}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}return!1},t.optionBoolEnabled=function(e){return t.dict.get(e).boolVal},t.switchOption=function(e,i){var o,a;try{for(var s=n(t.inst.data.list),l=s.next();!l.done;l=s.next()){var c=l.value;c.name==e&&i==r.Bool&&(c.boolVal=!c.boolVal)}}catch(d){o={error:d}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}},t.inst=null,t.dict=new Map,t}();a.default=d,cc._RF.pop()},{}],PowerActionsModule:[function(t,e,i){"use strict";cc._RF.push(e,"07dbeyMlTBGbrr0wc7dElh6","PowerActionsModule");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("Boat"),s=o("Brush"),l=o("ToolBox"),c=o("Config"),d=o("MapBox"),u=function(){function t(){this.magnetState=0,this.magnetLastPos=null,this.units=[],this.isPickup=!1}return t.prototype.magnetAction=function(t,e){var i,o;if(void 0===e&&(e=null),!t||1==this.magnetState||3==this.magnetState){if(e&&(this.magnetLastPos=e),this.updatePickedUnits(),e){d.default.inst.flashEffects.flashPixel(e,10);try{for(var a=n(s.default.getBrushByID(c.default.currentBrush).pos),r=a.next();!r.done;r=a.next()){var l=r.value,u=this.magnetLastPos.x+l.x,h=this.magnetLastPos.y+l.y;if(!(u<0||u>=d.default.width||h<0||h>=d.default.height)){var p=d.default.inst.getTileSimple(u,h);d.default.inst.flashEffects.flashPixel(p,10)}}}catch(f){i={error:f}}finally{try{r&&!r.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}switch(this.magnetState){case 0:0==d.default.inst.isKeyDownCode&&(this.magnetState=1,this.isPickup=!1);break;case 1:t||this.isPickup||(this.pickupUnits(e),this.isPickup=!0,console.log("pickupUnits")),-1==d.default.inst.isKeyDownCode&&(this.magnetState=2,this.dropPickedUnits(),console.log("dropPickedUnits 1"));break;case 2:t||0!=d.default.inst.isKeyDownCode||(this.dropPickedUnits(),console.log("dropPickedUnits 2"),this.magnetState=0)}}},t.prototype.dropPickedUnits=function(){var t,e;try{for(var i=n(this.units),o=i.next();!o.done;o=i.next()){var a=o.value;d.default.inst.units.add(a),a.currentPosition=a.node.position,a.currentPosition.y-=a.zPosition.y,a.lastShadowPos.x=-1,a._currentTileDirty=!0,a.findCurrentTile(),a.spawnOn(a.currentTile,a.zPosition.y)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.units=[]},t.prototype.updatePickedUnits=function(){var t,e,i;if(this.magnetLastPos)try{for(var o=n(this.units),a=o.next();!a.done;a=o.next()){var r=a.value;if(null===(i=null==r?void 0:r.data)||void 0===i?void 0:i.alive){var s=l.Toolbox.randomFloat(7,14),c=cc.v2(l.Toolbox.randomFloat(0,2.1),l.Toolbox.randomFloat(0,2.1)),d=this.magnetLastPos.posV3.clone();d.x+=c.x,d.y=d.y+c.y+s,r.zPosition.y=s,r.currentPosition=cc.v3(d.x,d.y-r.zPosition.y),r.node.position=d}}}catch(u){t={error:u}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.pickupUnits=function(t){var e,i,o,a,l,u,h,p;try{for(var f=n(s.default.getBrushByID(c.default.currentBrush).pos),_=f.next();!_.done;_=f.next()){var m=_.value,g=d.default.inst.getTile(m.x+t.x,m.y+t.y);if(g)try{for(var y=(o=void 0,n(g.units)),v=y.next();!v.done;v=y.next()){var b=v.value;(null===(l=b.stats)||void 0===l?void 0:l.canBeMovedByPowers)&&(null===(u=b.data)||void 0===u?void 0:u.alive)&&!b.isInsideSomething()&&((null===(h=b.stats)||void 0===h?void 0:h.isBoat)&&b.getComponent(r.default).updateBoatAnim(),-1==this.units.indexOf(b)&&(b.cancelAllBeh(),d.default.inst.units.remove(b),this.units.push(b),(null===(p=b.actorAnimationData)||void 0===p?void 0:p.walking)&&(b.spriteAnimation.setFrames(b.actorAnimationData.walking.frames),b.updateAnimation(.3,!0))))}}catch(w){o={error:w}}finally{try{v&&!v.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}}}catch(T){e={error:T}}finally{try{_&&!_.done&&(i=f.return)&&i.call(f)}finally{if(e)throw e.error}}},t}();a.default=u,cc._RF.pop()},{}],PowerButtonSelector:[function(t,e,i){"use strict";cc._RF.push(e,"5f60a3GSRZNrb5oCaxehnQF","PowerButtonSelector");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.PowerButtonSelector=void 0;var n=o("LocalizedTextManager"),r=o("Config"),s=o("SelectedPowerNameTip"),l=o("MoveCamera"),c=o("UiController"),d=function(){function t(){this.selectedButton=null}return t.prototype.setPower=function(t){this.selectedButton=t,(null==t?void 0:t.godPower)&&(t.selected=!0,l.MoveCamera.inst.lockDrag=t.godPower.holdAction)},t.prototype.unselectAll=function(){l.MoveCamera.inst.lockDrag=!1,this.selectedButton&&(this.selectedButton.unselectActivePower(),this.setPower(null)),r.default.controllableUnit&&r.default.controllableUnit.killHimself(!0),l.MoveCamera.focusUnit&&(l.MoveCamera.focusUnit=null)},t.prototype.isPowerSelected=function(t){return void 0===t&&(t=""),!(!this.selectedButton||t&&this.selectedButton.godPower.id!=t)},t.prototype.clickPowerButton=function(t){if(this.selectedButton==t)return this.unselectAll(),void c.default.inst.closeSelectTip();this.selectedButton&&this.selectedButton.unselectActivePower(),this.setPower(t),t&&(c.default.inst.showSelectTip(t),n.LocalizedTextManager.contains(t.godPower.name)&&s.SelectedPowerNameTip.inst.setText(t.godPower.name))},t.inst=new t,t}();a.PowerButtonSelector=d,cc._RF.pop()},{}],PowerButton:[function(t,e,i){"use strict";cc._RF.push(e,"52effFbNhlHY7O1uT790k/G","PowerButton");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.PowerButton=n.PowerButtonType=void 0;var l,c=a("AchievData"),d=a("AssetManager"),u=a("Config"),h=a("PlayerConfig"),p=a("UiController"),f=a("GodPower"),_=a("PowerButtonSelector"),m=a("SelectedPowerNameTip");(function(t){t[t.Library=0]="Library",t[t.Options=1]="Options",t[t.Active=2]="Active",t[t.TimeScale=3]="TimeScale",t[t.Shop=4]="Shop",t[t.Special=5]="Special"})(l=n.PowerButtonType||(n.PowerButtonType={}));var g=cc._decorator,y=g.ccclass,v=g.property,b=g.executionOrder,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.powerId="",e.selected=!1,e.type=l.Active,e.godPower=null,e}return r(e,t),e.prototype.onLoad=function(){this.powerId=this.node.name.substring(4)},e.prototype.start=function(){this.godPower=d.default.powers.dict.get(this.powerId),(this.type==l.Special||this.type==l.Library||this.type==l.Active&&this.godPower)&&f.default.addPower(this.godPower,this)},e.prototype.click=function(){this.type==l.Active&&this.clickActivePower(),this.type==l.Special&&this.clickSpecial(),this.type==l.Options&&this.clickOptions()},e.prototype.clickSpecial=function(){this.godPower&&("mapNames"==this.godPower.id?(h.default.switchOption("map_names",h.OptionType.Bool),this.node.getChildByName("dot").getComponent(cc.Button).interactable=!h.default.optionBoolEnabled("map_names"),h.default.optionBoolEnabled("map_names")&&(m.SelectedPowerNameTip.inst.setText(this.godPower.name),h.default.optionBoolEnabled("map_city_zones")&&c.default.update(14))):"kingsAndLeaders"==this.godPower.id?(u.default.showkingsAndLeadersInfo=!u.default.showkingsAndLeadersInfo,this.node.getChildByName("dot").getComponent(cc.Button).interactable=!u.default.showkingsAndLeadersInfo,u.default.showkingsAndLeadersInfo&&m.SelectedPowerNameTip.inst.setText(this.godPower.name)):"marks_boats"==this.godPower.id?(u.default.showmarks_boatsInfo=!u.default.showmarks_boatsInfo,this.node.getChildByName("dot").getComponent(cc.Button).interactable=!u.default.showmarks_boatsInfo,u.default.showmarks_boatsInfo&&m.SelectedPowerNameTip.inst.setText(this.godPower.name)):"historyLog"==this.godPower.id&&(h.default.switchOption("history_log",h.OptionType.Bool),this.node.getChildByName("dot").getComponent(cc.Button).interactable=!h.default.optionBoolEnabled("history_log"),h.default.optionBoolEnabled("history_log")&&(m.SelectedPowerNameTip.inst.setText(this.godPower.name),c.default.update(15))))},e.prototype.clickOptions=function(){},e.prototype.unselectActivePower=function(){this.selected=!1},e.prototype.clickActivePower=function(){_.PowerButtonSelector.inst.clickPowerButton(this)},e.prototype.update=function(){var t=this.node.getChildByName("icon");this.selected?(t.angle=15,this.getComponent(cc.Sprite).spriteFrame=p.default.inst.propSprite[1]):(t.angle=0,this.getComponent(cc.Sprite).spriteFrame=p.default.inst.propSprite[0])},s([v({type:cc.Enum(l)})],e.prototype,"type",void 0),s([y,b(3)],e)}(cc.Component);n.PowerButton=w,cc._RF.pop()},{}],PowerLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"f0f5fDTpMdN+JiAazaQL+p9","PowerLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Log"),l=a("Tools"),c=a("AchievData"),d=a("MapAction"),u=a("VortexAction"),h=a("WorldAction"),p=a("ActionLibrary"),f=a("Ant"),_=a("BaseBuilding"),m=a("WorldBehaviourUnitTemperatures"),g=a("Brush"),y=a("ToolBox"),v=a("Config"),b=a("GameAudio"),w=a("MapLayer"),T=a("MapBox"),k=a("GodPower"),B=a("AssetLibrary"),S=a("AssetManager"),C=a("TerraformLibrary"),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var i=new k.default;i.id="citySelect",i.name="Select City",i.force_map_text=w.MapMode.Villages,i.icon="iconCityInspect",this.add(i),this.t.tester_enabled=!1,this.t.click_action.add(p.default.inspectCity);var o=new k.default;o.id="relations",o.name="Relations",o.force_map_text=w.MapMode.Villages,o.icon="iconDiplomacy",this.add(o),this.t.tester_enabled=!1;var a=new k.default;a.id="inspect",a.name="Inspect",this.add(a),this.t.icon="iconInspect",this.t.tester_enabled=!1,this.t.click_action.add(p.default.inspectUnit),this.t.allow_unit_selection=!0;var n=new k.default;n.id="infinityCoin",n.name="Infinity Coin",this.add(n),this.t.icon="iconInfinityCoin",this.t.click_action.add(this.spawnInfinityCoin.bind(this));var r=new k.default;r.id="mapNames",r.name="Map Names",r.unselectWhenWindow=!0,this.add(r),this.t.icon="iconCityName",this.t.tester_enabled=!1,this.t.toggle_name="map_names",this.t.toggle_action=this.toggleOption.bind(this);var s=new k.default;s.id="city_zones",s.name="Village Layer",s.unselectWhenWindow=!0,this.add(s),this.t.icon="iconCityZones",this.t.tester_enabled=!1,this.t.map_modes_switch=!0,this.t.toggle_name="map_city_zones",this.t.toggle_action=this.toggleOption.bind(this);var l=new k.default;l.id="culture_zones",l.name="Culture Layer",l.unselectWhenWindow=!0,this.add(l),this.t.icon="iconCultureZones",this.t.tester_enabled=!1,this.t.map_modes_switch=!0,this.t.toggle_name="map_culture_zones",this.t.toggle_action=this.toggleOption.bind(this);var c=new k.default;c.id="kingdom_zones",c.name="Kingdom Layer",c.unselectWhenWindow=!0,this.add(c),this.t.icon="iconKingdomZones",this.t.tester_enabled=!1,this.t.map_modes_switch=!0,this.t.toggle_name="map_kingdom_zones",this.t.toggle_action=this.toggleOption.bind(this);var d=new k.default;d.id="kingsAndLeaders",d.name="Kings and Leaders",d.unselectWhenWindow=!0,this.add(d),this.t.icon="iconKings",this.t.tester_enabled=!1,this.t.toggle_name="map_kings_leaders",this.t.toggle_action=this.toggleOption.bind(this);var u=new k.default;u.id="marks_boats",u.name="Boats",u.unselectWhenWindow=!0,this.add(u),this.t.icon="iconBoat",this.t.tester_enabled=!1,this.t.toggle_name="marks_boats",this.t.toggle_action=this.toggleOption.bind(this);var h=new k.default;h.id="historyLog",h.name="History Log",h.unselectWhenWindow=!0,this.add(h),this.t.icon="iconWorldLog",this.t.tester_enabled=!1,this.t.toggle_name="history_log",this.t.toggle_action=this.toggleOption.bind(this);var f=new k.default;f.id="pause",f.name="Pause",f.unselectWhenWindow=!0,this.add(f),this.t.icon="iconPause",this.t.tester_enabled=!1;var _=new k.default;_.id="clock",_.name="Clock",_.unselectWhenWindow=!0,_.requiresPremium=!0,_.rank=k.PowerRank.Rank0_free,this.add(_),this.t.icon="iconClock",this.t.tester_enabled=!1,this.t.allow_unit_selection=!0;var m=new k.default;m.id="follow_unit",m.name="Follow Unit",m.unselectWhenWindow=!0,this.add(m),this.t.icon="iconSpectate",this.t.tester_enabled=!1;var g=new k.default;g.id="_terraformTiles",g.drawLines=!0,g.type=k.PowerActionType.Tile,g.rank=k.PowerRank.Rank0_free,g.showToolSizes=!0,g.unselectWhenWindow=!0,g.holdAction=!0,g.amountPerClick=1,g.clickInterval=0,this.add(g),this.clone("fuse","_terraformTiles"),this.t.name="Fuse",this.t.icon="iconFuse",this.t.topTileType="fuse",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileDeepOcean","_terraformTiles"),this.t.name="Deep Ocean",this.t.tileType="pit_deep_ocean",this.t.icon="iconTileDeepOcean",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileCloseOcean","_terraformTiles"),this.t.name="Close Ocean",this.t.tileType="pit_close_ocean",this.t.icon="iconTileCloseOcean",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileShallowWaters","_terraformTiles"),this.t.name="Shallow Waters",this.t.tileType="pit_shallow_waters",this.t.icon="iconTileShallowWater",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileSand","_terraformTiles"),this.t.name="Sand",this.t.tileType="sand",this.t.icon="iconTileSand",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileSoil","_terraformTiles"),this.t.name="Soil",this.t.tileType="soil_low",this.t.icon="iconTileSoil",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileHighSoil","_terraformTiles"),this.t.name="Soil High",this.t.tileType="soil_high",this.t.icon="iconTileHighSoil",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileHills","_terraformTiles"),this.t.name="Hills",this.t.tileType="hills",this.t.icon="iconTileHills",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("tileMountains","_terraformTiles"),this.t.name="Mountains",this.t.tileType="mountains",this.t.icon="iconTileMountains",this.t.click_action.add(this.drawTiles.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("showelPlus","_terraformTiles"),this.t.name="Shovel Plus",this.t.icon="iconShowelPlus",this.t.click_action.add(this.drawShowelPlus.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.amountPerClick=4,this.t.clickInterval=.1,this.clone("showelMinus","showelPlus"),this.t.name="Shovel Minus",this.t.icon="iconShowelMinuss",this.t.click_action.add(this.drawShowelMinus.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("vortex","_terraformTiles"),this.t.name="Vortex",this.t.icon="iconVertex2",this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.useVortex.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.clone("_drawOnTile","_terraformTiles"),this.clone("greyGoo","_drawOnTile"),this.t.name="Grey Goo",this.t.icon="iconGreygoo",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_action.add(this.drawGreyGoo.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("conway","_drawOnTile"),this.t.name="Conway game of Life1",this.t.icon="iconConwayLife",this.t.click_action.add(this.drawConway.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("conwayInverse","conway"),this.t.name="Conway game of Life2",this.t.icon="iconConwayLife2",this.t.click_action.add(this.drawConwayInverse.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("finger","_drawOnTile"),this.t.name="Finger",this.t.icon="iconTileFinger",this.t.click_action.add(this.drawFinger.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.destroyBuildings.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.clone("lifeEraser","_drawOnTile"),this.t.icon="iconEraser",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawLifeEraser.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Life Eraser",this.clone("demolish","_drawOnTile"),this.t.icon="iconDemolish",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawDemolish.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Demolish",this.clone("sponge","_drawOnTile"),this.t.icon="iconSponge",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawSponge.bind(this)),this.t.click_action.add(this.removeRuins.bind(this)),this.t.click_action.add(this.cleanBurnedTile.bind(this)),this.t.click_action.add(this.stopFire.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Sponge",this.clone("sickle","sponge"),this.t.icon="iconSickle",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawSickle.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Sickle",this.clone("axe","sponge"),this.t.icon="iconAxe",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawAxe.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Axe",this.clone("bucket","sponge"),this.t.icon="iconBucket",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawBucket.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Bucket",this.clone("pickaxe","sponge"),this.t.icon="iconPickaxe",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawPickaxe.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.t.name="Pickaxe",this.clone("divineLight","sponge"),this.t.icon="iconDivineLight",this.t.click_brush_action.add(this.divineLightFX.bind(this)),this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawDivineLight.bind(this)),this.t.name="Divine Light",this.t.showToolSizes=!0;var y=new k.default;y.id="_spawnActor",y.type=k.PowerActionType.SpawnActor,y.rank=k.PowerRank.Rank0_free,y.unselectWhenWindow=!0,y.showSpawnEffect="spawn",y.actorSpawnHeight=3,this.add(y),this.clone("humans","_spawnActor"),this.t.name="Humans",this.t.icon="iconHumans",this.t.isRace=!0,this.t.spawnSound="spawnHuman",this.t.actorStatsId="unit_human",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("orcs","_spawnActor"),this.t.icon="iconOrcs",this.t.rank=k.PowerRank.Rank4_awesome,this.t.requiresPremium=!0,this.t.isRace=!0,this.t.name="Orcs",this.t.spawnSound="spawnOrc",this.t.actorStatsId="unit_orc",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("elves","_spawnActor"),this.t.icon="iconElves",this.t.rank=k.PowerRank.Rank4_awesome,this.t.requiresPremium=!0,this.t.isRace=!0,this.t.name="Elves",this.t.spawnSound="spawnElf",this.t.actorStatsId="unit_elf",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("dwarfs","_spawnActor"),this.t.icon="iconDwarf",this.t.rank=k.PowerRank.Rank4_awesome,this.t.requiresPremium=!0,this.t.isRace=!0,this.t.name="Dwarves",this.t.spawnSound="spawnDwarf",this.t.actorStatsId="unit_dwarf",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("coldOnes","_spawnActor"),this.t.icon="iconWalker",this.t.name="Cold Ones",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnColdOne",this.t.actorStatsId="walker",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("demons","_spawnActor"),this.t.name="Demon",this.t.icon="iconDemon",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnDemon",this.t.actorStatsId="demon",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("necromancer","_spawnActor"),this.t.icon="iconNecromancer",this.t.name="Necromancer",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnNecromancer",this.t.actorStatsId="necromancer",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("druid","_spawnActor"),this.t.name="Druid",this.t.icon="iconDruid",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnDruid",this.t.actorStatsId="druid",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("plagueDoctor","_spawnActor"),this.t.name="Plague Doctor",this.t.icon="iconPlagueDoctor",this.t.spawnSound="spawnPlagueDoctor",this.t.actorStatsId="plagueDoctor",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("evilMage","_spawnActor"),this.t.name="Evil Mage",this.t.icon="iconEvilMage",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnEvilMage",this.t.actorStatsId="evilMage",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("whiteMage","_spawnActor"),this.t.name="White Mage",this.t.icon="iconWhiteMage",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnWhiteMage",this.t.actorStatsId="whiteMage",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("bandits","_spawnActor"),this.t.name="Bandits",this.t.icon="iconBandit",this.t.spawnSound="spawnBandit",this.t.actorStatsId="bandit",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("snowman","_spawnActor"),this.t.name="Snowman",this.t.icon="iconSnowMan",this.t.actorStatsId="snowman",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("zombies","_spawnActor"),this.t.name="Zombie",this.t.icon="iconZombie",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.spawnSound="spawnZombie",this.t.actorStatsId="zombie,zombie_orc,zombie_dwarf,zombie_elf",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("skeleton","_spawnActor"),this.t.name="Skeleton",this.t.icon="iconSkeleton",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="skeleton",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("wraith","_spawnActor"),this.t.name="Wraith",this.t.icon="iconWraith",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="wraith",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("ghost","_spawnActor"),this.t.name="Ghost",this.t.icon="iconGhost",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="ghost",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("pirates","_spawnActor"),this.t.name="Pirates",this.t.icon="iconPirates",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="pirates",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("mermen","_spawnActor"),this.t.name="Mermen",this.t.icon="iconMermen",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="mermen",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("goblin","_spawnActor"),this.t.name="Goblin",this.t.icon="iconGoblin",this.t.rank=k.PowerRank.Rank0_free,this.t.actorStatsId="goblin",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("sheep","_spawnActor"),this.t.name="Sheeps",this.t.icon="iconSheep",this.t.spawnSound="sheep spawn",this.t.actorStatsId="sheep",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("rhino","_spawnActor"),this.t.name="Rhino",this.t.icon="iconRhino",this.t.spawnSound="rhino spawn",this.t.actorStatsId="rhino",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("monkey","_spawnActor"),this.t.name="Monkey",this.t.icon="iconMonkey",this.t.spawnSound="monkey spawn",this.t.actorStatsId="monkey",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("buffalo","_spawnActor"),this.t.name="Buffalo",this.t.icon="iconBuffalo",this.t.spawnSound="buffalo spawn",this.t.actorStatsId="buffalo",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("fox","_spawnActor"),this.t.name="Fox",this.t.icon="iconFox",this.t.spawnSound="fox spawn",this.t.actorStatsId="fox",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("hyena","_spawnActor"),this.t.name="Hyena",this.t.icon="iconHyena",this.t.spawnSound="hyena spawn",this.t.actorStatsId="hyena",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("dog","_spawnActor"),this.t.name="Dog",this.t.icon="iconDog",this.t.spawnSound="dog spawn",this.t.actorStatsId="dog",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("cow","_spawnActor"),this.t.name="Cow",this.t.icon="iconCow",this.t.spawnSound="cow spawn",this.t.actorStatsId="cow",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("frog","_spawnActor"),this.t.name="Frog",this.t.icon="iconFrog",this.t.spawnSound="frog spawn",this.t.actorStatsId="frog",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("crocodile","_spawnActor"),this.t.name="Crocodile",this.t.icon="iconCrocodile",this.t.spawnSound="frog spawn",this.t.actorStatsId="crocodile",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("snake","_spawnActor"),this.t.name="Snake",this.t.icon="iconSnake",this.t.spawnSound="snake spawn",this.t.actorStatsId="snake",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("turtle","_spawnActor"),this.t.name="Turtle",this.t.icon="iconTurtle",this.t.spawnSound="turtle spawn",this.t.actorStatsId="turtle",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("penguin","_spawnActor"),this.t.name="Penguin",this.t.icon="iconPenguin",this.t.spawnSound="penguin spawn",this.t.actorStatsId="penguin",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("crab","_spawnActor"),this.t.name="Crab",this.t.icon="iconCrab",this.t.spawnSound="crab spawn",this.t.actorStatsId="crab",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("ratKing","_spawnActor"),this.t.name="Rat King",this.t.icon="iconRatKing",this.t.actorStatsId="ratKing",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("rabbit","_spawnActor"),this.t.name="Rabbit",this.t.icon="iconRabbit",this.t.spawnSound="rabbit spawn",this.t.actorStatsId="rabbit",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("cat","_spawnActor"),this.t.name="Cat",this.t.icon="iconCat",this.t.spawnSound="cat spawn",this.t.actorStatsId="cat",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("chicken","_spawnActor"),this.t.name="Chicken",this.t.icon="iconChicken",this.t.spawnSound="chicken spawn",this.t.actorStatsId="chicken",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("wolf","_spawnActor"),this.t.name="Wolfs",this.t.icon="iconWolf",this.t.spawnSound="spawnWolf",this.t.actorStatsId="wolf",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("bear","_spawnActor"),this.t.name="Bear",this.t.icon="iconBear",this.t.spawnSound="spawnBear",this.t.actorStatsId="bear",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("piranha","_spawnActor"),this.t.name="Piranha",this.t.icon="iconPiranha",this.t.spawnSound="spawnPiranha",this.t.actorStatsId="piranha",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("worm","_spawnActor"),this.t.name="Worm",this.t.icon="iconWorm",this.t.spawnSound="spawnWorm",this.t.actorStatsId="worm",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("sandSpider","_spawnActor"),this.t.name="Sand Spider",this.t.icon="iconSandSpider",this.t.spawnSound="spawnAnt",this.t.actorStatsId="sandSpider",this.t.holdAction=!0,this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("robotSanta","_spawnActor"),this.t.name="Robot Santa",this.t.icon="iconSanta",this.t.spawnSound="spawnSanta",this.t.actorStatsId="santa",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("godFinger","_spawnActor"),this.t.icon="iconGodFinger",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.name="God Finger",this.t.spawnSound="spawnGodFinger",this.t.actorStatsId="godFinger",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("ufo","_spawnActor"),this.t.icon="iconUfo",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank4_awesome,this.t.name="UFO",this.t.spawnSound="spawnUFO",this.t.actorStatsId="UFO",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("dragon","_spawnActor"),this.t.icon="iconDragon",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank4_awesome,this.t.name="Dragon",this.t.spawnSound="spawnDragon",this.t.actorStatsId="dragon",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("fairy","_spawnActor"),this.t.icon="iconFairy",this.t.rank=k.PowerRank.Rank2_normal,this.t.name="Fairy",this.t.actorStatsId="fairy",this.t.requiresPremium=!0,this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("butterfly","_spawnActor"),this.t.icon="iconButterfly",this.t.rank=k.PowerRank.Rank1_common,this.t.name="Butterfly",this.t.actorStatsId="butterfly",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("grasshopper","_spawnActor"),this.t.icon="iconGrasshopper",this.t.rank=k.PowerRank.Rank1_common,this.t.name="Grasshopper",this.t.actorStatsId="grasshopper",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("fly","_spawnActor"),this.t.icon="iconFly",this.t.rank=k.PowerRank.Rank1_common,this.t.name="Fly",this.t.actorStatsId="fly",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("beetle","_spawnActor"),this.t.icon="iconBeetle",this.t.rank=k.PowerRank.Rank1_common,this.t.name="Beetle",this.t.actorStatsId="beetle",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("rat","_spawnActor"),this.t.icon="iconRat",this.t.rank=k.PowerRank.Rank1_common,this.t.name="Rat",this.t.actorStatsId="rat",this.t.requiresPremium=!0,this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("antBlue","_spawnActor"),this.t.icon="iconAntBlue",this.t.name="Blue Ant",this.t.spawnSound="spawnAnt",this.t.actorStatsId="antBlue",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("antGreen","_spawnActor"),this.t.icon="iconAntGreen",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.name="Green Ant",this.t.spawnSound="spawnAnt",this.t.actorStatsId="antGreen",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("antBlack","_spawnActor"),this.t.icon="iconAntBlack",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.name="Black Ant",this.t.spawnSound="spawnAnt",this.t.actorStatsId="antBlack",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("antRed","_spawnActor"),this.t.icon="iconAntRed",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.name="Red Ant",this.t.spawnSound="spawnAnt",this.t.actorStatsId="antRed",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("bowlingBall","_spawnActor"),this.t.icon="iconBoulder",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.name="Bowling Ball",this.t.actorStatsId="boulder",this.t.actorSpawnHeight=30,this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("tornado","_spawnActor"),this.t.icon="iconTornado",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.name="Tornado",this.t.actorStatsId="tornado",this.t.actorSpawnHeight=0,this.t.spawnSound="tornado",this.t.click_action.add(this.spawnUnit.bind(this)),this.clone("crabzilla","_spawnActor"),this.t.icon="iconCrabzilla",this.t.name="Crabzilla",this.t.rank=k.PowerRank.Rank4_awesome,this.t.requiresPremium=!0,this.t.actorStatsId="crabzilla",this.t.actorSpawnHeight=0,this.t.ignoreFastSpawn=!0,this.t.tester_enabled=!1,this.t.click_action.add(this.spawnCrabzilla.bind(this));var v=new k.default;v.id="heatray",v.name="Heatray",v.requiresPremium=!0,v.rank=k.PowerRank.Rank2_normal,v.unselectWhenWindow=!0,v.holdAction=!0,this.add(v),this.t.icon="iconHeatRay",this.t.click_brush_action.add(this.heatrayFX.bind(this)),this.t.click_action.add(this.drawHeatray.bind(this)),this.t.click_action.add(this.flashPixel.bind(this));var b=new k.default;b.id="meteorite",b.name="Meteorite",b.requiresPremium=!0,b.rank=k.PowerRank.Rank3_good,b.unselectWhenWindow=!0,b.showSpawnEffect="spawn",this.add(b),this.t.icon="iconMeteorite",this.t.click_action.add(this.spawnMeteorite.bind(this));var T=new k.default;T.id="lightning",T.name="Lightning",T.unselectWhenWindow=!0,this.add(T),this.t.icon="iconLightning",this.t.click_action.add(this.spawnLightning.bind(this));var B=new k.default;B.id="earthquake",B.name="Earthquake",B.unselectWhenWindow=!0,this.add(B),this.t.icon="iconEarthquake",this.t.click_action.add(this.spawnEarthquake.bind(this));var S=new k.default;S.id="magnet",S.name="Magnet",S.showToolSizes=!0,S.holdAction=!0,S.highlight=!0,S.unselectWhenWindow=!0,this.add(S),this.t.icon="iconMagnet",this.t.click_action.add(this.useMagnet.bind(this));var C=new k.default;C.id="_spawnSpecial",C.name="_spawnSpecial",C.unselectWhenWindow=!0,this.add(C),this.clone("force","_spawnSpecial"),this.t.name="Force",this.t.icon="iconPulse",this.t.click_action.add(this.spawnForce.bind(this)),this.clone("cloudRain","_spawnSpecial"),this.t.name="Rain Cloud",this.t.icon="iconCloudRain",this.t.click_action.add(this.spawnCloudRain.bind(this)),this.clone("cloudAcid","_spawnSpecial"),this.t.name="Acid Cloud",this.t.icon="iconCloudAcid",this.t.click_action.add(this.spawnCloudAcid.bind(this)),this.clone("cloudLava","_spawnSpecial"),this.t.name="Lava Cloud",this.t.icon="iconCloudLava",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.click_action.add(this.spawnCloudLava.bind(this)),this.clone("cloudSnow","_spawnSpecial"),this.t.name="Snow Cloud",this.t.icon="iconCloudSnow",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.click_action.add(this.spawnCloudSnow.bind(this));var x=new k.default;x.id="_printer",x.unselectWhenWindow=!0,x.actorSpawnHeight=3,x.showSpawnEffect="spawn",this.add(x),this.clone("printer_hexagon","_printer"),this.t.icon="iconPrinterHexagon",this.t.name="Printer - Hexagon",this.t.printersPrint="print_hexagon",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_skull","_printer"),this.t.icon="iconPrinterSkull",this.t.name="Printer - Skull",this.t.printersPrint="print_skull",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_squares","_printer"),this.t.icon="iconPrinterSquares",this.t.name="Printer - Squares",this.t.printersPrint="print_squares",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_yinyang","_printer"),this.t.icon="iconPrinterYinyang",this.t.name="Printer - Yin Yang",this.t.printersPrint="print_yin_yang",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_island1","_printer"),this.t.icon="iconPrinterIsland",this.t.name="Printer - Island",this.t.printersPrint="print_island1",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_star","_printer"),this.t.icon="iconPrinterStar",this.t.name="Printer - Star",this.t.printersPrint="print_star",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_heart","_printer"),this.t.icon="iconPrinterHeart",this.t.name="Printer - Heart",this.t.printersPrint="print_heart",this.t.click_action.add(this.spawnPrinter.bind(this)),this.clone("printer_diamond","_printer"),this.t.icon="iconPrinterDiamond",this.t.name="Printer - Diamond",this.t.printersPrint="print_diamond",this.t.click_action.add(this.spawnPrinter.bind(this));var A=new k.default;A.id="_drops",A.holdAction=!0,A.showToolSizes=!0,A.unselectWhenWindow=!0,A.fallingChance=.05,this.add(A),this.clone("tnt","_drops"),this.t.name="TNT",this.t.icon="iconTnt",this.t.dropID="tnt",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("tnt_timed","_drops"),this.t.name="Timed TNT",this.t.icon="iconTntTimed",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.dropID="tnt_timed",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("water_bomb","_drops"),this.t.icon="iconWaterBomb",this.t.name="Water Bomb",this.t.dropID="water_bomb",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("landmine","_drops"),this.t.icon="iconLandmine",this.t.name="Landmine",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.dropID="landmine",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("fireworks","_drops"),this.t.icon="iconFireworks",this.t.name="Fireworks",this.t.dropID="fireworks",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("inspiration","_drops"),this.t.name="Inspiration",this.t.dropID="inspiration",this.t.icon="iconInspiration",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("friendship","_drops"),this.t.name="Friendship",this.t.icon="iconFriendship",this.t.dropID="friendship",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("spite","_drops"),this.t.name="Spite",this.t.icon="iconSprite",this.t.dropID="spite",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("madness","_drops"),this.t.icon="iconMadness",this.t.name="Madness",this.t.fallingChance=.01,this.t.dropID="madness",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("blessing","_drops"),this.t.icon="iconBlessing",this.t.name="Blessing",this.t.dropID="blessing",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("shield","_drops"),this.t.icon="iconShield",this.t.name="Shield",this.t.dropID="shield",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("curse","_drops"),this.t.icon="iconCurse",this.t.name="Curse",this.t.rank=k.PowerRank.Rank0_free,this.t.dropID="curse",this.t.fallingChance=.01,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("zombieInfection","_drops"),this.t.icon="iconInfected",this.t.name="Zombie Infection",this.t.fallingChance=.01,this.t.rank=k.PowerRank.Rank3_good,this.t.dropID="zombieInfection",this.t.requiresPremium=!0,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("mushSpores","_drops"),this.t.icon="iconMushSpores",this.t.name="Mush Spores",this.t.fallingChance=.01,this.t.rank=k.PowerRank.Rank2_normal,this.t.dropID="mushSpores",this.t.requiresPremium=!0,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("coffee","_drops"),this.t.icon="iconCoffee",this.t.name="Coffee",this.t.fallingChance=.01,this.t.rank=k.PowerRank.Rank1_common,this.t.dropID="coffee",this.t.requiresPremium=!0,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("powerup","_drops"),this.t.icon="iconPowerup",this.t.name="Powerup",this.t.fallingChance=.01,this.t.rank=k.PowerRank.Rank1_common,this.t.dropID="powerup",this.t.requiresPremium=!0,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("plague","_drops"),this.t.icon="iconPlague",this.t.name="Plague",this.t.dropID="plague",this.t.fallingChance=.01,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("livingPlants","_drops"),this.t.icon="iconLivingPlants",this.t.name="Living Plants",this.t.dropID="livingPlants",this.t.fallingChance=.01,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("livingHouse","_drops"),this.t.icon="iconLivingHouse",this.t.name="Living Houses",this.t.dropID="livingHouse",this.t.fallingChance=.01,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("bomb","_drops"),this.t.icon="iconBomb",this.t.name="Bomb",this.t.dropID="bomb",this.t.fallingChance=.005,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("grenade","bomb"),this.t.icon="iconGrenade",this.t.name="Grenade",this.t.dropID="grenade",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("napalmBomb","bomb"),this.t.icon="iconNapalmBomb",this.t.name="Napalm Bomb",this.t.dropID="napalmBomb",this.t.fallingChance=.003,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("antimatterBomb","_spawnSpecial"),this.t.icon="iconAntimatterBomb",this.t.name="Antimatter Bomb",this.t.dropID="antimatterBomb",this.t.fallingChance=.002,this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("atomicBomb","_spawnSpecial"),this.t.icon="iconAtomicBomb",this.t.name="Atomic Bomb",this.t.dropID="atomicBomb",this.t.fallingChance=.001,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("czarBomba","_spawnSpecial"),this.t.icon="iconCzarBomba",this.t.name="Tsar Bomba",this.t.dropID="czarBomba",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank4_awesome,this.t.fallingChance=.001,this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("rain","_drops"),this.t.icon="iconRain",this.t.dropID="rain",this.t.name="Rain",this.t.fallingChance=.02,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("bloodRain","_drops"),this.t.icon="iconBloodRain",this.t.dropID="bloodRain",this.t.name="Blood Rain",this.t.fallingChance=.02,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("fire","_drops"),this.t.icon="iconFire",this.t.dropID="fire",this.t.name="Fire",this.t.fallingChance=.01,this.t.particleInterval=.3,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("snow","_drops"),this.t.dropID="snow",this.t.name="Snow",this.t.icon="iconSnow",this.t.fallingChance=.03,this.t.particleInterval=.15,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("acid","_drops"),this.t.icon="iconAcid",this.t.dropID="acid",this.t.name="Acid",this.t.fallingChance=.02,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("lava","_drops"),this.t.icon="iconLava",this.t.dropID="lava",this.t.name="Lava",this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank2_normal,this.t.fallingChance=.03,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsGrass","_drops"),this.t.icon="iconSeedGrass",this.t.dropID="seedsGrass",this.t.name="Grass Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsSavanna","_drops"),this.t.icon="iconSeedSavanna",this.t.dropID="seedsSavanna",this.t.name="Savanna Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsEnchanted","_drops"),this.t.icon="iconSeedEnchanted",this.t.dropID="seedsEnchanted",this.t.name="Enchanted Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsCorrupted","_drops"),this.t.icon="iconSeedCorrupted",this.t.dropID="seedsCorrupted",this.t.name="Corrupted Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsMushroom","_drops"),this.t.icon="iconSeedMushroom",this.t.dropID="seedsMushroom",this.t.name="Mushroom Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsSwamp","_drops"),this.t.icon="iconSeedSwamp",this.t.dropID="seedsSwamp",this.t.name="Swamp Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsInfernal","_drops"),this.t.icon="iconSeedInfernal",this.t.dropID="seedsInfernal",this.t.name="Infernal Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsJungle","_drops"),this.t.icon="iconSeedJungle",this.t.dropID="seedsJungle",this.t.name="Jungle Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsSnowfield","_drops"),this.t.icon="iconSeedSnow",this.t.dropID="seedsSnowfield",this.t.name="Snowfield Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("seedsWasteland","_drops"),this.t.icon="iconSeedWasteland",this.t.dropID="seedsWasteland",this.t.name="Wasteland Seeds",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("fruitBush","_spawnSpecial"),this.t.icon="iconBush",this.t.dropID="fruitBush",this.t.name="Fruit Bush",this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("fertilizerPlants","seedsGrass"),this.t.icon="iconFertilizerPlants",this.t.dropID="fertilizerPlants",this.t.name="Plants Fertilizer",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("fertilizerTrees","seedsGrass"),this.t.icon="iconFertilizerTrees",this.t.dropID="fertilizerTrees",this.t.name="Trees Fertilizer",this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("_dropBuilding","_drops"),this.t.showToolSizes=!1,this.t.forceBrush="circ_1",this.t.fallingChance=.03,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.t.click_power_brush_action.add(this.loopWithCurrentBrushPower.bind(this)),this.clone("stone","_spawnSpecial"),this.t.icon="iconStone",this.t.dropID=this.t.id,this.t.name="Stone",this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("ore_deposit","_spawnSpecial"),this.t.icon="iconOreDeposit",this.t.dropID=this.t.id,this.t.name="Ore Deposit",this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("gold","_spawnSpecial"),this.t.icon="iconGold",this.t.dropID=this.t.id,this.t.name="Gold",this.t.click_power_action.add(this.signleDrop.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("tumor","_dropBuilding"),this.t.icon="iconTumor",this.t.name="Tumor",this.t.dropID=this.t.id,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("biomass","_dropBuilding"),this.t.icon="iconBiomass",this.t.name="Biomass",this.t.dropID=this.t.id,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("superPumpkin","_dropBuilding"),this.t.icon="iconSuperPumpkin",this.t.name="Super Pumpkin",this.t.dropID=this.t.id,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("cybercore","_dropBuilding"),this.t.name="Cybercore",this.t.icon="iconCybercore",this.t.dropID=this.t.id,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("geyser","_dropBuilding"),this.t.name="Geyser",this.t.icon="iconGeyser",this.t.dropID=this.t.id,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("geyserAcid","_dropBuilding"),this.t.name="Acid Geyser",this.t.icon="iconAcidGeyser",this.t.dropID=this.t.id,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("volcano","_dropBuilding"),this.t.name="Volcano",this.t.icon="iconVolcano",this.t.dropID=this.t.id,this.t.requiresPremium=!0,this.t.rank=k.PowerRank.Rank1_common,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("goldenBrain","_dropBuilding"),this.t.name="Golden Brain",this.t.icon="iconGoldBrain",this.t.requiresPremium=!0,this.t.dropID=this.t.id,this.t.rank=k.PowerRank.Rank1_common,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("corruptedBrain","_dropBuilding"),this.t.name="Corrupted Brain",this.t.icon="iconCorruptedBrain",this.t.requiresPremium=!0,this.t.dropID=this.t.id,this.t.rank=k.PowerRank.Rank1_common,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("iceTower","_dropBuilding"),this.t.name="Ice Tower",this.t.icon="iconIceTower",this.t.requiresPremium=!0,this.t.dropID=this.t.id,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("beehive","_dropBuilding"),this.t.name="Beehive",this.t.icon="iconBeehive",this.t.dropID=this.t.id,this.t.rank=k.PowerRank.Rank1_common,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this)),this.clone("flameTower","_dropBuilding"),this.t.name="Flame Tower",this.t.icon="iconFlameTower",this.t.requiresPremium=!0,this.t.dropID=this.t.id,this.t.rank=k.PowerRank.Rank3_good,this.t.click_power_action.add(this.spawnDrops.bind(this)),this.t.click_power_action.add(this.flashPixel.bind(this));var P=new k.default;P.id="temperaturePlus",P.name="Temperature Plus",P.holdAction=!0,P.showToolSizes=!0,P.unselectWhenWindow=!0,this.add(P),this.t.icon="iconTemperaturePlus",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(this.drawTemperaturePlus.bind(this)),this.t.click_action.add(this.temperaturePlusFX.bind(this)),this.t.click_action.add(this.flashPixel.bind(this)),this.clone("temperatureMinus","temperaturePlus"),this.t.icon="iconTemperatureMinus",this.t.name="Temperature Minus",this.t.click_brush_action.add(this.loopWithCurrentBrush.bind(this)),this.t.click_action.add(e.drawTemperatureMinus.bind(this)),this.t.click_action.add(this.temperaturePlusFX.bind(this)),this.t.click_action.add(this.flashPixel.bind(this));var O=new k.default;O.id="coins",O.name="coins",O.icon="iconCoins",this.add(O)},e.prototype.checkCache=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];e.dropID?e.cached_drop_asset=S.default.drops.get(e.dropID):e.tileType?e.cached_tile_type_asset=S.default.tiles.get(e.tileType):e.topTileType&&(e.cached_top_tile_type_asset=S.default.topTiles.get(e.topTileType))}},e.prototype.traceRanks=function(){for(var t="",e="",i="",o="",a="",n=0;n<this.list.length;n++){var r=this.list[n];switch(r.rank){case k.PowerRank.Rank0_free:t=t+r.name+", ";break;case k.PowerRank.Rank1_common:e=e+r.name+", ";break;case k.PowerRank.Rank2_normal:i=i+r.name+", ";break;case k.PowerRank.Rank3_good:o=o+r.name+", ";break;case k.PowerRank.Rank4_awesome:a=a+r.name+", "}}s.default.d("rank 0: "+t),s.default.d("rank 1: "+e),s.default.d("rank 2: "+i),s.default.d("rank 3: "+o),s.default.d("rank 4: "+a)},e.prototype.signleDrop=function(t,e){return v.default.propUseCount++,T.default.inst.dropManager.spawn(t,e.dropID).soundOn=!0,!0},e.prototype.spawnDrops=function(t,e){var i=g.default.getBrushByID(v.default.currentBrush),o=!1;return 0==i.size?T.default.inst.timerSpawnPixels<=0&&(T.default.inst.timerSpawnPixels=.5,o=!0):2==i.size&&y.Toolbox.randomBool()?T.default.inst.timerSpawnPixels>0&&(T.default.inst.timerSpawnPixels=.3,o=!0):o=y.Toolbox.randomChance(e.fallingChance),T.default.inst.firstClick&&(T.default.inst.firstClick=!1,v.default.propUseCount=0,o=!0),o&&(v.default.propUseCount++,T.default.inst.dropManager.spawn(t,e.dropID).soundOn=!0),!0},e.prototype.spawnPrinter=function(t,e){var i=this.get(e);return T.default.inst.stackEffects.startSpawnEffect(t),T.default.inst.spawnNewUnit("printer",t,"print").getComponent(f.default).setPrintTemplate(T.default.inst.printLibrary.dict.get(i.printersPrint)),!0},e.prototype.spawnCloudSnow=function(t,e){return T.default.inst.cloudController.spawnCloud(t.posV3,e),!0},e.prototype.spawnCloudLava=function(t,e){return T.default.inst.cloudController.spawnCloud(t.posV3,e),!0},e.prototype.spawnCloudAcid=function(t,e){return T.default.inst.cloudController.spawnCloud(t.posV3,e),!0},e.prototype.useMagnet=function(t){return T.default.inst.actions.magnetAction(!1,t),!0},e.prototype.spawnCloudRain=function(t,e){return T.default.inst.cloudController.spawnCloud(t.posV3,e),!0},e.prototype.spawnCrabzilla=function(t){return T.default.inst.alreadyUsedPower=!1,T.default.inst.stackEffects.startBigSpawn(t).setEvent("crabzilla",t),!0},e.prototype.spawnLightning=function(t){return T.default.spawnLightning(t),!0},e.prototype.spawnForce=function(t){return b.default.playForce(),T.default.inst.applyForce(t,10,1.5,!0,!0),T.default.inst.spawnFlash(t,10),!0},e.prototype.spawnInfinityCoin=function(t){return T.default.inst.stackEffects.get("infinityCoin").spawnAt(cc.v3(t.posV3.x,t.posV3.y-1),.25),!0},e.prototype.spawnEarthquake=function(t){return T.default.inst.earthquakeManager.startQuake(t),!0},e.prototype.spawnMeteorite=function(t){return T.default.inst.spawnMeteorite(t),!0},e.prototype.toggleOption=function(t){S.default.powers.get(t)},e.prototype.disableAllOtherMapModes=function(){for(var t=0;t<S.default.powers.list.length;t++){var e=S.default.powers.list[t];e.map_modes_switch&&e.id}},e.prototype.useVortex=function(t){return b.default.playVortex(),u.default.moveTiles(t,g.default.getBrushByID(v.default.currentBrush)),!0},e.prototype.drawTiles=function(t,e){var i=this.get(e),o=i.cached_tile_type_asset,a=i.cached_top_tile_type_asset;return T.default.inst.flashEffects.flashPixel(t,25),d.default.terraformTile(t,o,a,C.default.draw),!0},e.prototype.flashPixel=function(t,e){return void 0===e&&(e=null),T.default.inst.flashEffects.flashPixel(t,10),!0},e.prototype.drawTemperaturePlus=function(t){return t.type.frozen&&y.Toolbox.randomBool()&&(t.health>0?(t.health--,t.grassTicksBeforeGrowth=5):d.default.unfreezeTile(t)),m.default.checkTile(t,5),t.type.lava&&T.default.inst.lavaLayer.increaseLava(t),t.building&&t.building.stats.spawnPixel&&(t.building.data.spawnPixelActive=!0),!0},e.prototype.temperatureMinusFX=function(){return!0},e.prototype.temperaturePlusFX=function(){return!0},e.drawTemperatureMinus=function(t){return t.type.lava&&T.default.inst.lavaLayer.decreaseLava(t),t.data.fire&&t.stopFire(),!t.type.frozen&&y.Toolbox.randomBool()&&(t.health>0?(t.health--,t.grassTicksBeforeGrowth=5):(d.default.freezeTile(t),c.default.update(18))),m.default.checkTile(t,-5),t.building&&p.default.addFrozenEffectOnTarget(t.building),!0},e.prototype.drawShowelPlus=function(t){return t.health>0?t.health--:d.default.increaseTile(t,"destroy"),!1},e.prototype.drawShowelMinus=function(t){return t.health>0?t.health--:d.default.decreaseTile(t,"destroy"),!1},e.prototype.drawGreyGoo=function(t){return T.default.inst.greyGooLayer.add(t),!1},e.prototype.drawConway=function(t){return Math.random()>.5&&T.default.inst.conwayLayer.add(t,"conway"),!1},e.prototype.drawConwayInverse=function(t){return Math.random()>.5&&T.default.inst.conwayLayer.add(t,"conwayInverse"),!1},e.prototype.drawFinger=function(t){var e=T.default.inst.firstPressedType,i=T.default.inst.firstPressedTopType;return d.default.terraformTile(t,e,i,C.default.destroy_no_flash),t.type.lava&&T.default.inst.lavaLayer.loadLavaTile(t),t.type.greyGoo&&T.default.inst.greyGooLayer.add(t),!1},e.prototype.spawnUnit=function(t,e){var i=this.get(e);b.default.playSpawn(),i.spawnSound&&b.default.play(i.spawnSound),"sheep"==i.id&&(t.type.lava&&c.default.update(51),c.default.update(6)),c.default.update(66),i.showSpawnEffect&&T.default.inst.stackEffects.startSpawnEffect(t,i.showSpawnEffect);var o=i.actorStatsId.includes(",")?y.Toolbox.getRandom(i.actorStatsId.split(",")):i.actorStatsId;return T.default.inst.spawnNewUnit(o,t,"",i.actorSpawnHeight),!0},e.prototype.divineLightFX=function(t){return T.default.inst.fxDivineLight.playOn(t),!0},e.prototype.drawDivineLight=function(t){for(var e=0;e<t.units.length;e++){var i=t.units[e];!i.data.alive||!i.node.active||y.Toolbox.distTile(t,i.currentTile)>4||(i.removeTrait("infected"),i.removeTrait("plague"),i.removeTrait("mushSpores"),i.removeTrait("tumorInfection"),"undead"==i.race.id||"demon"==i.race.id?i.getHit(.4*i.curStats.health):i.startColorEffect("white"),i.haveTrait("crippled")&&i.removeTrait("crippled"),i.haveTrait("eyepatch")&&i.removeTrait("eyepatch"),i.haveTrait("skin_burns")&&i.removeTrait("skin_burns"),i.haveTrait("madness")&&(i.removeTrait("madness"),i.stats.unit?i.setKingdom(T.default.inst.kingdoms.dict_hidden["nomads_"+i.stats.race]):i.stats.kingdom&&i.setKingdom(T.default.inst.kingdoms.dict_hidden[i.stats.kingdom])),i.isInLiquid()||i.cancelAllBeh())}return!0},e.prototype.cleanBurnedTile=function(t){return t.removeBurn(),!0},e.prototype.drawSponge=function(t){return d.default.tryRemoveTornadoFromTile(t),t.type.wasteland&&d.default.decreaseTile(t),!0},e.prototype.drawPickaxe=function(t){return!t.building||t.building.stats.buildingType!=_.BuildingType.Ore&&t.building.stats.buildingType!=_.BuildingType.Stone&&t.building.stats.buildingType!=_.BuildingType.Gold||t.building.startDestroyBuilding(!0),!0},e.prototype.drawBucket=function(t){return d.default.removeLiquid(t),t.type.lava&&d.default.decreaseTile(t),t.type.canBeRemovedWithBucket&&d.default.decreaseTile(t),!0},e.prototype.drawAxe=function(t){t.building&&(t.building.stats.buildingType==_.BuildingType.Tree&&t.building.haveResources&&t.building.chopTree(),"tree_dead"==t.building.stats.id&&t.building.chopTree());for(var e=0;e<t.chunk.k_list_objects.length;e++){var i=t.chunk.k_list_objects[e];if("living_plants"==i.data.name)for(var o=t.chunk.k_dict_objects.get(i),a=0;a<o.length;a++){var n=o[a];n.base_data.alive&&n.objectType==w.MapObjectType.Actor&&n.a.killHimself()}}return!0},e.prototype.drawSickle=function(t){return t.type.canBeRemovedWithSickle&&d.default.removeGreens(t),t.building&&t.building.stats.buildingType-5<=2&&t.building.startRemove(!1),!0},e.prototype.drawDemolish=function(t){t.building&&!t.building.stats.ignoreDemolish&&t.building.stats.buildingType==_.BuildingType.None&&t.building.startDestroyBuilding(!0),t.zone.city&&t.zone.city.removeZone(t.zone,!0),t.type.canBeRemovedWithDemolish&&d.default.decreaseTile(t);for(var e=0;e<t.chunk.k_list_objects.length;e++){var i=t.chunk.k_list_objects[e];if("living_houses"==i.data.name)for(var o=t.chunk.k_dict_objects.get(i),a=0;a<o.length;a++){var n=o[a];n.data.alive&&n.killHimself()}}return!0},e.prototype.drawLifeEraser=function(t){return d.default.removeLifeFromTile(t),d.default.tryRemoveTornadoFromTile(t),!0},e.prototype.drawHeatray=function(t){return T.default.inst.heatRayFx.isReady()&&y.Toolbox.randomBool()&&T.default.inst.heat.addTile(t,y.Toolbox.randomInt(1,3)),!0},e.prototype.heatrayFX=function(t,e){return T.default.inst.heatRayFx.play(t.pos,10),this.loopWithBrush(t,e,g.default.getBrushBySize(10)),!0},e.prototype.loopWithCurrentBrush=function(t,e){return this.loopWithBrush(t,e,g.default.getBrushByID(v.default.currentBrush)),!0},e.prototype.loopWithCurrentBrushPower=function(t,e){return this.loopWithBrushPower(t,e,g.default.getBrushByID(v.default.currentBrush)),!0},e.prototype.loopWithBrushPower=function(t,e,i){return T.default.inst.waveController.checkTile(t,i.size),T.default.inst.cloudController.checkTile(t,i.size),T.default.inst.loopWithBrush(t,i,e.click_power_action,e),!0},e.prototype.loopWithBrush=function(t,e,i){var o=this.get(e);return T.default.inst.waveController.checkTile(t,i.size),T.default.inst.cloudController.checkTile(t,i.size),T.default.inst.loopWithBrush(t,i,o.click_action,e),!0},e.prototype.stopFire=function(t){return t.stopFire(),!0},e.prototype.destroyBuildings=function(t){return!!t.building&&(t.building.startDestroyBuilding(!0),!0)},e.prototype.removeRuins=function(t){return null!=t.building&&t.building.isNonUsable()&&t.building.startDestroyBuilding(!0),!0},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e)));return this.t=l.default.fromJson(i,new k.default),this.t.id=t,this.t.click_action=new h.default,this.t.click_brush_action=new h.default,this.t.click_power_action=new h.default,this.t.click_power_brush_action=new h.default,this.add(this.t)},e}(B.default);n.default=x,cc._RF.pop()},{}],PrefabLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"ff61aU09ltNeawQnrqkOihN","PrefabLibrary");var o,a=i,n=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(a,"__esModule",{value:!0});var s=cc._decorator,l=s.ccclass,c=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.guide=null,e.building=null,e.unit=null,e.shadow=null,e}var i;return n(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.inst=null,r([c({type:cc.Prefab,tooltip:"\u5b9e\u4f8b\u5316\u65b0\u624b\u5f15\u5bfc\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"guide",void 0),r([c({type:cc.Prefab,tooltip:"\u5b9e\u4f8b\u5316building\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"building",void 0),r([c({type:cc.Prefab,tooltip:"\u5b9e\u4f8b\u5316unit\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"unit",void 0),r([c({type:cc.Prefab,tooltip:"\u5b9e\u4f8b\u5316shadow\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"shadow",void 0),i=r([l],e)}(cc.Component);a.default=d,cc._RF.pop()},{}],PrintLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"41496pY39tCNoneDoDe1dP5","PrintLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.PrintTemplate=void 0;var c=a("MathUtils"),d=a("ToolBox"),u=a("TextureLoader"),h=a("TextureRotator"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(){function t(){this.name="",this.graphics=null,this.steps=[]}return s([_(cc.String)],t.prototype,"name",void 0),s([f("PrintTemplate")],t)}();n.PrintTemplate=m;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.color0=cc.Color.TRANSPARENT,e.color2=cc.Color.TRANSPARENT,e.color3=cc.Color.TRANSPARENT,e.list=[],e.dict=null,e.listQuakes=[],e}return r(e,t),e.prototype.onLoad=function(){var t,e;this.color0=d.Toolbox.makeColor("#FFFFFF"),this.color2=d.Toolbox.makeColor("#7F7F7F"),this.color3=d.Toolbox.makeColor("#000000"),this.dict=new Map;try{for(var i=l(this.list),o=i.next();!o.done;o=i.next()){var a=o.value;a.graphics=u.TextureLoader.inst.getTexture(u.BIN_TYPE.prints,a.name),this.calcSteps(a),this.dict.set(a.name,a),a.name.includes("quake")&&(this.listQuakes.push(a),this.addRotatedQuake(a,90),this.addRotatedQuake(a,180),this.addRotatedQuake(a,360),this.addRotatedQuake(a,-360),this.addRotatedQuake(a,-90),this.addRotatedQuake(a,-180),this.addRotatedQuake(a,-270))}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.list=[]},e.prototype.addRotatedQuake=function(t,e){var i=new m;i.name=t.name+"_"+e;var o=t.graphics.clone();i.graphics=h.TextureRotator.rotate(o,e),this.calcSteps(i),this.listQuakes.push(i)},e.prototype.calcSteps=function(t){if(t.graphics){t.steps=[];for(var e=t.graphics.width,i=t.graphics.height,o=1;o<e-1;o++)for(var a=1;a<i-1;a++){var n=t.graphics.getPixel(o,a);if(n.r!=this.color0.r){var r=cc.v2(o-1-c.default.intCast(e/2),a-1-c.default.intCast(i/2));t.steps.push(r),n.r==this.color2.r?t.steps.push(r):n.r==this.color3.r&&(t.steps.push(r),t.steps.push(r))}}t.stepsPerTick=c.default.intCast(.005*t.steps.length+1)}},s([_([m])],e.prototype,"list",void 0),s([f],e)}(cc.Component);n.default=g,cc._RF.pop()},{}],ProfessionLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"4bafeOIcZZOaqzYz1Bhy64F","ProfessionLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ProfessionAsset=void 0;var s=a("ActorAsset"),l=a("AssetLibrary"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.profession_id=s.UnitProfession.Null,e.can_capture=!1,e.is_civilian=!1,e.special_skin_path="",e.use_skin_culture=!1,e}return r(e,t),e}(l.Asset);n.ProfessionAsset=c;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dict_profeesion_id=new Map,e}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c;e.id="null",e.profession_id=s.UnitProfession.Null,this.add(e);var i=new c;i.id="baby",i.profession_id=s.UnitProfession.Baby,i.special_skin_path="unit_child",i.is_civilian=!0,this.add(i);var o=new c;o.id="unit",o.profession_id=s.UnitProfession.Unit,o.is_civilian=!0,o.use_skin_culture=!0,this.add(o);var a=new c;a.id="warrior",a.profession_id=s.UnitProfession.Warrior,a.can_capture=!0,a.special_skin_path="unit_warrior",a.use_skin_culture=!0,this.add(a);var n=new c;n.id="king",n.profession_id=s.UnitProfession.King,n.can_capture=!0,n.special_skin_path="unit_king",this.add(n);var r=new c;r.id="leader",r.profession_id=s.UnitProfession.Leader,r.can_capture=!0,r.special_skin_path="unit_leader",this.add(r)},e.prototype.add=function(e){return this.dict_profeesion_id.set(e.profession_id,e),t.prototype.add.call(this,e)},e.prototype.getAsset=function(t){return this.dict_profeesion_id.get(t)},e}(l.default);n.default=d,cc._RF.pop()},{}],ProjectileLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"e8afaYtKAZCyIg+uOsc9PF/","ProjectileLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ProjectileAsset=void 0;var s=a("Tools"),l=a("WorldAction"),c=a("ActionLibrary"),d=a("AssetLibrary"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.texture="",e.animated=!1,e.animation_speed=.1,e.looped=!0,e.stayInGround=!1,e.speed=10,e.speed_random=10,e.terraformOption="",e.terraformRange=0,e.endEffect="",e.playImpactSound=!1,e.impactSoundID="",e.rotate=!1,e.look_at_target=!1,e.trailEffect_enabled=!1,e.trailEffect_texture="fireSmoke",e.trailEffect_scale=.25,e.trailEffect_timer=.2,e.hitFreeze=!1,e.hitShake=!1,e._frames=[],e.startScale=.1,e.targetScale=.1,e.parabolic=!1,e.texture_shadow="",e.world_actions=l.default.create(),e}return r(e,t),e}(d.Asset);n.ProjectileAsset=u;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new u;e.id="arrow",e.speed=18,e.texture="arrow",e.parabolic=!0,e.texture_shadow="shadow_arrow",this.add(e);var i=new u;i.id="snowball",i.texture="snowball",i.texture_shadow="shadow_snowball",i.speed=15,i.parabolic=!0,i.hitFreeze=!0,this.add(i);var o=new u;o.id="firebomb",o.speed=5,o.texture="firebomb",o.parabolic=!0,o.texture_shadow="shadow_ball",o.terraformOption="demon_fireball",o.endEffect="fireballExplosion",o.hitShake=!0,o.startScale=.075,o.targetScale=.075,o.playImpactSound=!0,o.impactSoundID="explosion medium",o.terraformRange=2,this.add(o);var a=new u;a.id="torch",a.speed=5,a.texture="pr_torch",a.parabolic=!0,a.texture_shadow="shadow_ball",a.terraformOption="torch",a.startScale=.075,a.targetScale=.075,a.terraformRange=1,a.playImpactSound=!1,this.add(a);var n=new u;n.id="dark_orb",n.speed=10,n.texture="dark_orb",n.texture_shadow="shadow_ball",n.parabolic=!0,n.startScale=.035,n.targetScale=.1,this.add(n);var r=new u;r.id="red_orb",r.speed=12,r.speed_random=5,r.texture="pr_red_orb",r.startScale=.035,r.targetScale=.2,this.add(r),this.t.world_actions.add(c.default.action_fire);var s=new u;s.id="freeze_orb",s.speed=12,s.texture="pr_freeze_orb",s.startScale=.035,s.targetScale=.2,this.add(s);var l=new u;l.id="green_orb",l.speed=20,l.texture="pr_green_orb",l.startScale=.035,l.targetScale=.2,this.add(l);var d=new u;d.id="blue_orb_small",d.speed=6,d.texture="pr_freeze_orb",d.startScale=.035,d.targetScale=.1,d.terraformOption="demon_fireball",this.add(d);var h=new u;h.id="bone",h.speed=10,h.texture="pr_bone",h.texture_shadow="shadow_ball",h.parabolic=!0,h.startScale=.035,h.targetScale=.05,this.add(h);var p=new u;p.id="plasma_ball",p.speed=20,p.texture="pr_plasma_ball",p.trailEffect_enabled=!0,p.trailEffect_texture="fx_plasma_trail",p.trailEffect_scale=.1,p.trailEffect_timer=.1,p.look_at_target=!0,p.terraformOption="plasma_ball",p.endEffect="fireballExplosion",p.terraformRange=2,p.startScale=.035,p.targetScale=.2,this.add(p);var f=new u;f.id="fireball",f.speed=15,f.texture="fireball",f.trailEffect_enabled=!0,f.texture_shadow="shadow_ball",f.terraformOption="demon_fireball",f.endEffect="fireballExplosion",f.terraformRange=3,f.startScale=.035,f.targetScale=.2,f.parabolic=!0,this.add(f);var _=new u;_.id="madness",_.speed=30,_.texture="madness_ball",_.terraformOption="madness_ball",_.texture_shadow="shadow_ball",_.terraformRange=3,_.startScale=.035,_.targetScale=.2,_.parabolic=!0,this.add(_),this.clone("rock","arrow"),this.t.texture="rock",this.t.texture_shadow="shadow_snowball",this.t.startScale=.05,this.t.targetScale=.09,this.t.parabolic=!0,this.t.speed=15;var m=new u;m.id="shotgun_bullet",m.speed=20,m.speed_random=7,m.texture="shotgun_bullet",m.look_at_target=!0,m.looped=!1,m.animation_speed=.1,m.terraformOption="assimilator_bullet",m.startScale=.035,m.targetScale=.08,this.add(m)},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e)));return this.t=s.default.fromJson(i,new u),this.t.id=t,this.t.world_actions=new l.default,this.add(this.t)},e}(d.default);n.default=h,cc._RF.pop()},{}],Projectile:[function(t,e,i){"use strict";cc._RF.push(e,"8def3BwBGFBnbav5eZWorFE","Projectile");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("MapAction"),d=a("SpriteAnimation"),u=a("AssetManager"),h=a("BaseEffect"),p=a("BaseStats"),f=a("ToolBox"),_=a("GameAudio"),m=a("MapBox"),g=a("TextureLoader"),y=cc._decorator,v=y.ccclass,b=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curStats=new p.default,e.byWho=null,e.targetObject=null,e.speed=0,e.vecStart=cc.Vec3.ZERO,e.vecTarget=cc.Vec3.ZERO,e.vecTargetZ=cc.Vec3.ZERO,e.curScale=0,e.targetScale=0,e.asset=null,e.timeToTarget=0,e.timeInAir=0,e.target_reached=!1,e.targetZ=0,e.halfHitChecked=!1,e.t_rotation=0,e.timer_smoke=0,e}var i;return r(e,t),i=e,e.prototype.begin=function(t,e,i,o){if(void 0===o&&(o=0),this.created||this.create(),this.byWho=null,this.asset=u.default.projectiles.get(i),this.spriteAnimation=this.getComponent(d.SpriteAnimation),!this.asset._frames||0==this.asset._frames.length){var a=g.TextureLoader.inst.getSpriteFrames(g.ATLAS_TYPE.WORLDATLAS,"effects/projectiles/"+this.asset.texture);this.asset._frames=Array.from(a.values())}this.spriteAnimation.setFrames(this.asset._frames),this.spriteAnimation.setFrameIndex(0),this.spriteAnimation.enabled=this.asset.animated,this.spriteAnimation.looped=this.asset.looped,this.spriteAnimation.timeBetweenFrames=this.asset.animation_speed;var n=cc.v3(t.x,t.y);if(this.curScale=this.asset.startScale,this.targetScale=this.asset.targetScale,this.node.scale=this.curScale,this.currentPosition=n,this.node.position=cc.v3(n),this.speed=this.asset.speed+f.Toolbox.randomFloat(0,this.asset.speed_random),this.vecStart=cc.v3(t.x,t.y),this.vecTarget=cc.v3(e.x,e.y),this.targetZ=o,this.target_reached=!1,this.halfHitChecked=!1,this.t_rotation=0,0!=o){o<5&&(o=20),this.vecTargetZ=cc.v3(this.vecTarget.x,this.vecTarget.y+o);var r=f.Toolbox.dist(this.vecStart.x,this.vecStart.y,this.vecTarget.x,this.vecTarget.y);this.vecTarget=f.Toolbox.getNewPoint(this.vecStart.x,this.vecStart.y,this.vecTarget.x,this.vecTarget.y,2*r,!1)}this.timeInAir=0,this.timeToTarget=(f.Toolbox.distVec3(this.vecStart,this.vecTarget)+o)/this.speed,o>0&&this.timeToTarget<.7&&(this.timeToTarget=.7)},e.prototype.setStats=function(t){this.curStats.clear(),this.curStats.addStats(t)},e.prototype.updateShadow=function(){if(this.asset.texture_shadow){this.shadow||(this.shadow=m.default.inst.createShadow(this,this.asset.texture_shadow),this.resetShadow());var t=cc.Vec3.ZERO;cc.Vec3.lerp(t,this.vecStart,this.vecTarget,this.timeInAir/this.timeToTarget),this.checkShadowPosition(t),this.shadow.node.angle=f.Toolbox.lookAt2D(t,this.vecTarget)}},e.prototype.getAngle=function(){var t=4*this.timeToTarget;0!=this.targetZ&&(t=this.targetZ);var e=i.parabola(this.vecStart,this.vecTarget,t,0),o=i.parabola(this.vecStart,this.vecTarget,t,.1);return f.Toolbox.lookAt2D(e,o)},e.prototype.logicUpdate=function(e){if(3!=this.state&&this.node.active&&(t.prototype.logicUpdate.call(this,e),!this.target_reached)){if(this.timeInAir+=e,this.curScale<this.targetScale&&(this.curScale+=.2*e,this.curScale>this.targetScale&&(this.curScale=this.targetScale),this.node.scale=this.curScale),this.asset.rotate&&(this.t_rotation+=f.Toolbox.randomFloat(10,50),this.node.angle=this.t_rotation),this.asset.look_at_target){var o=57.29578*f.Toolbox.getAngle(this.node.x,this.node.y,this.vecTarget.x,this.vecTarget.y);this.node.angle=o}if(this.asset.trailEffect_enabled)if(this.timer_smoke>0)this.timer_smoke-=e;else{var a=m.default.inst.stackEffects.get(this.asset.trailEffect_texture).spawnAt(this.node.position,this.asset.trailEffect_scale);this.asset.look_at_target&&null!=a&&(a.node.angle=this.node.angle),this.timer_smoke=this.asset.trailEffect_timer}var n=this.timeInAir/this.timeToTarget;if(cc.Vec2.lerp(this.currentPosition,this.vecStart,this.vecTarget,n),this.asset.parabolic){var r=4*this.timeToTarget;0!=this.targetZ&&(r=this.targetZ),this.currentPosition=i.parabola(this.vecStart,this.vecTarget,r,n);var s=i.parabola(this.vecStart,this.vecTarget,r,(this.timeInAir+e)/this.timeToTarget);this.node.angle=f.Toolbox.lookAt2D(this.currentPosition,s)}this.node.position=cc.v3(this.currentPosition),this.updateShadow(),!this.halfHitChecked&&n>=.5&&(this.halfHitChecked=!0,this.checkHit(this.vecTargetZ))?this.targetReached():this.timeInAir>this.timeToTarget&&(this.checkHit(this.vecTarget)||m.default.inst.stackEffects.get("miss").spawnAt(this.currentPosition,.1),this.targetReached())}},e.parabola=function(t,e,i,o){var a,n=cc.v3();return cc.Vec3.lerp(n,t,e,o),cc.v3(n.x,-4*i*(a=o)*a+4*i*a+l.default.lerp(t.y,e.y,o),n.z)},e.prototype.checkHit=function(t){var e,i,o=!1;return(null===(i=null===(e=this.byWho)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive)&&(o=m.default.inst.newAttack(this.byWho,t,m.default.inst.getTile(l.default.intCast(this.currentPosition.x),l.default.intCast(this.currentPosition.y)),this.targetObject)),o},e.prototype.targetReached=function(){this.target_reached=!0,this.asset.endEffect&&m.default.inst.stackEffects.get(this.asset.endEffect).spawnAt(this.vecTarget,.25);var t=m.default.inst.getTile(l.default.intCast(this.vecTarget.x),l.default.intCast(this.vecTarget.y));if(this.asset.playImpactSound&&_.default.play(this.asset.impactSoundID),t){if(this.asset.world_actions.isEmpty||this.asset.world_actions.do(null,t),this.asset.hitFreeze){c.default.freezeTile(t);for(var e=0;e<t.neighbours.length;e++){var i=t.neighbours[e];f.Toolbox.randomBool()&&c.default.freezeTile(i)}}this.asset.hitShake&&m.default.inst.startShake(.01,.01,.25),this.asset.terraformOption&&c.default.damageWorld(t,this.asset.terraformRange,u.default.terraform.get(this.asset.terraformOption))}this.kill(),this.shadow&&(this.shadow.node.destroy(),this.shadow=null)},i=s([v],e)}(h.default));n.default=b,cc._RF.pop()},{}],QQLimitedGifts:[function(t,e,i){"use strict";cc._RF.push(e,"a7186aqM7VPIKjrI1Cgmxxe","QQLimitedGifts");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("DateUtils"),c=a("DataReport"),d=a("AdsManager"),u=a("RewardData"),h=a("UserData"),p=a("GamePopBase"),f=a("MsgCache"),_=a("AssetManager"),m=a("TextureLoader"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggle=null,e.iconReward=[],e.rewardID=3,e.data=[],e}return r(e,t),e.prototype.start=function(){this.data=u.default.getRewards(this.rewardID),this.showReward(this.data)},e.prototype.showReward=function(t){for(var e=0;e<t.length;e++)if(this.iconReward[e]){this.iconReward[e].active=!0,this.iconReward[e].getChildByName("name").getComponent(cc.Label).string=t[e].propName;var i=h.default.getPropConfigByID(t[e].propID);if(i){var o=this.iconReward[e].getChildByName("rare");o.active=i.rare>=0;var a=m.TextureLoader.inst.getSpriteFrame(m.ATLAS_TYPE.UIATLAS,"reward/rare_"+this.data[e].rare);a&&(o.getComponent(cc.Sprite).spriteFrame=a);var n=this.iconReward[e].getChildByName("icon"),r="propIcon/"+_.default.powers.dict.get(this.data[e].propID).icon,s=m.TextureLoader.inst.getSpriteFrame(m.ATLAS_TYPE.UIATLAS,r);s&&(n.getComponent(cc.Sprite).spriteFrame=s),this.iconReward[e].getChildByName("num").getComponent(cc.Label).string=t[e].number.toString()}}},e.prototype.click=function(t){var e=this,i=t.getCurrentTarget().getComponent(cc.Button);i.interactable=!1,this.toggle.isChecked?d.default.showVideoAds(function(t){if(1==t)e.reward(!0);else{i.interactable=!0;var o=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";f.default.pushToast(o),c.DataReport.wxReportUserBehaviorBranch("BCBgAAoXHx5d0zwaLcsFZg",c.wxEventType.Show)}}):this.reward(!1)},e.prototype.reward=function(t){this.data.forEach(function(e){var i=h.default.getPropByID(e.propID);i&&(i.number+=t?2*e.reward:e.reward)}),f.default.pushToast(t?"\u83b7\u5f97\u53cc\u500d\u5956\u52b1\uff01":"\u9886\u53d6\u5956\u52b1\u6210\u529f\uff01");var e=(new Date).getTime()+216e5,i=l.default.formatDayTime(e/1e3);h.default.member.qqGift[i]=!0,h.default.save(),this.close()},s([v(cc.Toggle)],e.prototype,"toggle",void 0),s([v([cc.Node])],e.prototype,"iconReward",void 0),s([v],e.prototype,"rewardID",void 0),s([y],e)}(p.GamePopBase);n.default=b,cc._RF.pop()},{}],QualityChanger:[function(t,e,i){"use strict";cc._RF.push(e,"e08186FU4pM8pb8iPjsGQh4","QualityChanger");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("iTween"),c=a("MapBox"),d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lowRes=!1,e.changeMod=0,e.changeModTween=0,e._tweenBuildings=0,e.colorAlpha=1,e.renderBuildings=!1,e.currentZoom=0,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.reset=function(){this.lowRes=!0,this.changeMod=1,this.changeModTween=1,c.default.inst.worldLayer.setRendererEnabled(!0)},e.prototype.getTweenBuildings=function(t){return this._tweenBuildings=t*(1-this.changeModTween)},e.prototype.logicUpdate=function(t){this.renderBuildings=!this.isFullLowRes()&&0!=this._tweenBuildings,(this.colorAlpha!=this.changeMod||0!=this.changeMod&&1!=this.changeMod)&&(this.colorAlpha=this.changeMod,c.default.inst.worldLayer.node.opacity=255*this.colorAlpha,c.default.inst.unitLayer.node.opacity=255*this.colorAlpha,this.lowRes?this.changeModTween=l.default.easeInOutCubic(0,1,this.changeMod):this.changeModTween=l.default.easeInBack(0,1,this.changeMod)),this.lowRes&&this.changeMod<1?(this.changeMod+=3*t,this.changeMod>1&&(this.changeMod=1)):!this.lowRes&&this.changeMod>0&&(this.changeMod-=3*t,this.changeMod<0&&(this.changeMod=0)),this.lowRes?1==this.changeMod&&(c.default.inst.tilemap.enableTiles(!1),c.default.inst.transformShadows.active&&(c.default.inst.transformShadows.active=!1,c.default.inst.transformParents.scale=0)):0==this.changeMod&&c.default.inst.worldLayer.setRendererEnabled(!1)},e.prototype.isFullLowRes=function(){return!!this.lowRes&&1==this.changeMod},e.prototype.renderShadowsUnits=function(){return!this.lowRes&&this.currentZoom<50},e.prototype.zoomUpdated=function(t){this.currentZoom=t;var e=t<11;e!=this.lowRes&&(this.lowRes=e,this.lowRes||(this.forceBuildings(),this.forceUnits()),c.default.inst.transformParents.scale=1,c.default.inst.transformShadows.active=!0,c.default.inst.worldLayer.setRendererEnabled(!0),c.default.inst.tilemap.enableTiles(!0))},e.prototype.forceBuildings=function(){c.default.inst.buildings.checkAddRemove();for(var t=c.default.inst.buildings.getSimpleList(),e=0;e<t.length;e++)t[e].forceScale(0)},e.prototype.forceUnits=function(){c.default.inst.units.checkAddRemove();for(var t=c.default.inst.units.getSimpleList(),e=0;e<t.length;e++)t[e].forceAnimation()},e.inst=null,i=s([u],e)}(cc.Component));n.default=h,cc._RF.pop()},{}],RaceLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"1aa77yxn7tOHKShtbOxOAnG","RaceLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("Tools"),l=a("ActorBase"),c=a("Race"),d=a("BaseBuilding"),u=a("ToolBox"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new c.default;e.id="nature",e.nature=!0,this.add(e),this.t=e;var i=new c.default;i.id="human",i.color=u.Toolbox.makeColor("#00C0FF"),i.color_abandoned=u.Toolbox.makeColor("#697382"),i.icon="iconHumans",i.civilization=!0,i.nameLocale="Humans",i.bannerId="human",i.production=["metals","bread","pie"],i.civ_baseCities=3,i.civ_baseArmy=10,i.civ_baseZones=5,i.name_template_city="human_city",i.name_template_kingdom="human_kingdom",i.name_template_culture="human_culture",this.add(i),this.t.culture_knowledge_gain_per_intelligence=2.5,this.t.culture_rate_tech_limit=6,this.t.stats.culture_spread_speed.value=5,this.t.stats.culture_spread_convert_chance.value=.1,this.t.skin_citizen_male=["unit_male_1","unit_male_2","unit_male_3","unit_male_4","unit_male_5"],this.t.skin_citizen_female=["unit_female_1","unit_female_2","unit_female_3","unit_female_4","unit_female_5"],this.t.skin_warrior=["unit_warrior_1","unit_warrior_2","unit_warrior_3","unit_warrior_4","unit_warrior_5"],this.t.culture_elements=["cultures/culture_element_0","cultures/culture_element_1","cultures/culture_element_2","cultures/culture_element_3","cultures/culture_element_4","cultures/culture_element_5","cultures/culture_element_6","cultures/culture_element_7"],this.t.culture_decors=["cultures/culture_decor_0","cultures/culture_decor_1","cultures/culture_decor_2","cultures/culture_decor_3","cultures/culture_decor_4","cultures/culture_decor_5","cultures/culture_decor_6","cultures/culture_decor_7","cultures/culture_decor_8"],this.t.culture_colors=["#FF695B","#596CFF","#AD3AFF","#FF4FC4","#FF423F","#A6FF47","#2BFFA3","#28F7FF","#66CEFF","#1D5B44","#594555","#2B313D"],this.setPreferredStatPool("diplomacy#5,warfare#5,stewardship#5,intelligence#5"),this.setPreferredFoodPool("berries#5,bread#5,fish#5,meat#2,sushi#2,jam#1,cider#1,ale#2,burger#1,pie#1,tea#2"),this.addPreferredWeapon("stick",5),this.addPreferredWeapon("sword",5),this.addPreferredWeapon("axe",2),this.addPreferredWeapon("spear",2),this.addPreferredWeapon("bow",5),this.clone("orc","human"),this.t.culture_rate_tech_limit=3,this.t.culture_knowledge_gain_per_intelligence=.9,this.t.civ_baseCities=2,this.t.civ_baseArmy=15,this.t.civ_baseZones=7,this.t.color=u.Toolbox.makeColor("#DD2D2D"),this.t.color_abandoned=u.Toolbox.makeColor("#8E7C62"),this.t.icon="iconOrcs",this.t.nameLocale="Orcs",this.t.bannerId="orc",this.t.hateRaces="human,elf,dwarf",this.t.preferred_weapons=[],this.t.production=["metals","bread","burger","tea"],this.t.name_template_city="orc_city",this.t.name_template_kingdom="orc_kingdom",this.t.name_template_culture="orc_culture",this.t.culture_forbidden_tech.push("building_roads"),this.setPreferredStatPool("diplomacy#2,warfare#5,stewardship#3,intelligence#2"),this.setPreferredFoodPool("berries#2,bread#5,fish#5,meat#10,sushi#2,cider#1,ale#5,burger#5,pie#1,tea#10"),this.addPreferredWeapon("stick",5),this.addPreferredWeapon("axe",10),this.addPreferredWeapon("spear",3),this.addPreferredWeapon("bow",5),this.clone("elf","human"),this.t.culture_rate_tech_limit=5,this.t.culture_knowledge_gain_per_intelligence=1.5,this.t.civ_baseCities=1,this.t.civ_baseArmy=8,this.t.civ_baseZones=12,this.t.color=u.Toolbox.makeColor("#94E032"),this.t.color_abandoned=u.Toolbox.makeColor("#556E4F"),this.t.icon="iconElves",this.t.nameLocale="Elves",this.t.bannerId="elf",this.t.hateRaces="orc,dwarf",this.t.preferred_weapons=[],this.t.production=["metals","bread","jam","sushi","cider"],this.t.name_template_city="elf_city",this.t.name_template_kingdom="elf_kingdom",this.t.name_template_culture="elf_culture",this.t.culture_forbidden_tech.push("building_roads"),this.setPreferredStatPool("diplomacy#5,warfare#2,stewardship#2,intelligence#6"),this.setPreferredFoodPool("berries#5,bread#5,fish#1,sushi#10,cider#10,tea#1"),this.addPreferredWeapon("stick",5),this.addPreferredWeapon("spear",5),this.addPreferredWeapon("bow",10),this.addPreferredWeapon("sword",2),this.clone("dwarf","human"),this.t.culture_rate_tech_limit=5,this.t.culture_knowledge_gain_per_intelligence=1.7,this.t.civ_baseCities=1,this.t.civ_baseArmy=12,this.t.civ_baseZones=3,this.t.color=u.Toolbox.makeColor("#BC00B6"),this.t.color_abandoned=u.Toolbox.makeColor("#7F585A"),this.t.icon="iconDwarf",this.t.nameLocale="Dwarves",this.t.bannerId="dwarf",this.t.hateRaces="orc,elf",this.t.preferred_weapons=[],this.t.buildingPlacements=d.BuildingPlacements.Center,this.t.production=["metals","bread","ale"],this.t.name_template_city="dwarf_city",this.t.name_template_kingdom="dwarf_kingdom",this.t.name_template_culture="dwarf_culture",this.setPreferredStatPool("diplomacy#2,warfare#3,stewardship#5,intelligence#2"),this.setPreferredFoodPool("berries#1,bread#5,fish#5,meat#5,sushi#1,jam#1,cider#1,ale#10,burger#2,pie#2,tea#1"),this.addPreferredWeapon("stick",5),this.addPreferredWeapon("hammer",10),this.addPreferredWeapon("bow",3),this.addPreferredWeapon("sword",2),this.list.forEach(function(t){t.colorBorder=cc.color(t.color.r,t.color.g,t.color.b,153),t.colorBorderOut=cc.color(t.color.r,t.color.g,t.color.b,255)})},e.prototype.setPreferredStatPool=function(t){for(var e=(t=t.replace(" ","")).split(","),i=0;i<e.length;i++)for(var o=e[i].split("#"),a=parseInt(o[1]),n=o[0],r=0;r<a;r++)this.t.preferred_attribute.push(n)},e.prototype.setPreferredFoodPool=function(t){for(var e=(t=t.replace(" ","")).split(","),i=0;i<e.length;i++)for(var o=e[i].split("#"),a=parseInt(o[1]),n=o[0],r=0;r<a;r++)this.t.preferred_food.push(n)},e.prototype.get=function(e){if(!this.dict.has(e)){var i=new c.default;i.id=e,this.add(i)}return t.prototype.get.call(this,e)},e.prototype.addPreferredWeapon=function(t,e){for(var i=0;i<e;i++)this.t.preferred_weapons.push(t)},e.prototype.logicUpdate=function(){for(var t=0;t<this.list.length;t++)this.list[t].units.checkAddRemove()},e.prototype.clear=function(){this.list.forEach(function(t){t.units.clear()})},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=s.default.fromJson(i,new c.default);return o.units=new l.ActorContainer,o.id=t,this.add(o),o},e}(a("AssetLibrary").default);n.default=h,cc._RF.pop()},{}],Race:[function(t,e,i){"use strict";cc._RF.push(e,"3e11cg7jnhPCoQ9HQdu/31o","Race");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("AssetLibrary"),l=a("BaseBuilding"),c=a("KingdomStats"),d=a("ActorBase"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLocale="",e.icon="",e.production=[],e.color=cc.Color.BLACK,e.color_abandoned=cc.Color.BLACK,e.colorBorder=cc.Color.BLACK,e.colorBorderOut=cc.Color.BLACK,e.name_template_kingdom="",e.name_template_city="",e.name_template_culture="",e.culture_elements=[],e.culture_decors=[],e.culture_colors=[],e.stats=new c.default,e.culture_knowledge_gain_base=1,e.culture_knowledge_gain_per_intelligence=1,e.culture_knowledge_gain_rate=.1,e.skin_citizen_male=[],e.skin_citizen_female=[],e.skin_warrior=[],e.skin_civ_default_male="unit_male_1",e.skin_civ_default_female="unit_female_1",e.nature=!1,e.civilization=!1,e.civ_buildRoads=!1,e.civ_baseCities=1,e.civ_baseZones=5,e.civ_baseArmy=1,e.buildingPlacements=l.BuildingPlacements.Random,e.preferred_weapons=[],e.preferred_food=[],e.preferred_attribute=[],e.culture_forbidden_tech=[],e.culture_rate_tech_limit=5,e.hateRaces="",e.bannerId="",e.units=new d.ActorContainer,e}return r(e,t),e}(s.Asset);n.default=u,cc._RF.pop()},{}],RankListLayer:[function(t,e,i){"use strict";cc._RF.push(e,"ab8b8BXT8VLybjaDE9hg96z","RankListLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.RankList=void 0;var l=a("AdsManager"),c=a("UserData"),d=a("GamePopBase"),u=function(){function t(){}return t.prototype.setScore=function(t,e,i,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=null),QQ_GAME&&qq.setUserCloudStorage({KVDataList:[{key:"score",value:t.toString()}],success:e,fail:i,complete:o})},t.prototype.showGroupList=function(t){QQ_GAME&&qq.getOpenDataContext().postMessage({shareTicket:t,rankType:0})},t.prototype.showFriendList=function(){QQ_GAME&&qq.getOpenDataContext().postMessage({rankType:1,openid:c.default.member.openid})},t.inst=new t,t}();n.RankList=u;var h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankLayer=null,e}return r(e,t),e.prototype.close=function(){t.prototype.close.call(this),this.rankLayer.active=!1},e.prototype.open=function(){t.prototype.open.call(this,function(){u.inst.showFriendList()})},e.prototype.setBgSize=function(){QQ_GAME&&(this.bg.height=765,this.bg.position=cc.v3(0,-40,0),this.rankLayer.position=cc.v3(0,40,0),this.bg.getChildByName("rank_panel").position=cc.v3(0,40,0))},e.prototype.shareCallback=function(){l.default.shareAppMessage({success:function(){},fail:function(){}})},s([f(cc.Node)],e.prototype,"rankLayer",void 0),s([p],e)}(d.GamePopBase);n.default=_,cc._RF.pop()},{}],RecordShare:[function(t,e,i){"use strict";cc._RF.push(e,"87217aUPONN3L3j/iUeHXFz","RecordShare");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("AdsManager"),d=a("RewardData"),u=a("UserData"),h=a("GamePopBase"),p=a("MsgCache"),f=a("AssetManager"),_=a("TextureLoader"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItem=[],e.clickText=null,e.rewardID=18,e.data=[],e}return r(e,t),e.prototype.start=function(){var t,e;try{for(var i=l(this.rewardItem),o=i.next();!o.done;o=i.next())o.value.active=!1}catch(r){t={error:r}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this.clickText.string=""!=c.default.getRecordedVideoPath()?"\u5206\u4eab\u6211\u7684\u4e16\u754c":"\u9080\u8bf7\u670b\u53cb\u4e00\u8d77\u73a9",this.data=d.default.getRewards(this.rewardID),this.showReward(this.data)},e.prototype.showReward=function(t){for(var e=0;e<t.length;e++)if(this.rewardItem[e]){this.rewardItem[e].active=!0,this.rewardItem[e].getChildByName("name").getComponent(cc.Label).string=t[e].propName;var i=this.rewardItem[e].getChildByName("rare");i.active=t[e].rare>=0;var o=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"reward/rare_"+t[e].rare);o&&(i.getComponent(cc.Sprite).spriteFrame=o);var a=this.rewardItem[e].getChildByName("icon"),n="propIcon/"+f.default.powers.dict.get(t[e].propID).icon,r=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,n);r&&(a.getComponent(cc.Sprite).spriteFrame=r);var s=this.rewardItem[e].getChildByName("num");if(s.getComponent(cc.Label).string=t[e].number.toString(),s.active=!0,!u.default.getPropByID(t[e].propID))return}},e.prototype.share=function(){var t=this;""!=c.default.getRecordedVideoPath()?c.default.shareVideo({success:function(){t.reward(!0)},fail:function(){t.reward(!1)}}):c.default.shareAppMessage({success:function(){t.reward(!0)},fail:function(){t.reward(!1)}})},e.prototype.reward=function(t){if(t){for(var e=0;e<this.data.length;e++){var i=u.default.getPropByID(this.data[e].propID);i&&(i.number+=this.data[e].number)}u.default.save(),p.default.pushToast("\u83b7\u5f97\u5206\u4eab\u5956\u52b1\u6210\u529f\uff01"),this.close()}else p.default.pushToast("\u5206\u4eab\u5931\u8d25\uff01")},s([y([cc.Node])],e.prototype,"rewardItem",void 0),s([y(cc.Label)],e.prototype,"clickText",void 0),s([y],e.prototype,"rewardID",void 0),s([g],e)}(h.GamePopBase);n.default=v,cc._RF.pop()},{}],RegionLinkHashes:[function(t,e,i){"use strict";cc._RF.push(e,"98515J2i2NASII3zc43hC6n","RegionLinkHashes");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.TempLinkStruct=o.RegionLink=void 0;var a=function(){function t(){this.id=0,this.regions=new Set}return t.prototype.getHashCode=function(){return this.id},t.prototype.equals=function(t){return this.id==t.id},t}();o.RegionLink=a,o.TempLinkStruct=function(){this.region=null,this.hash=0};var n=function(){function t(){}return t.addHash=function(e,i){var o=t.dict.get(e);o||((o=new a).id=e,t.dict.set(o.id,o)),o.regions.has(i)||(o.regions.add(i),i.links.push(o))},t.getCount=function(){return t.dict.size},t.clear=function(){t.dict.clear()},t.getHash=function(e){return t.dict.get(e)},t.remove=function(e,i){e.regions.delete(i),0==e.regions.size&&t.dict.delete(e.id)},t.debug=function(t){t.setText("hashes",this.dict.size)},t.dict=new Map,t}();o.default=n,cc._RF.pop()},{}],RegionPathFinder:[function(t,e,i){"use strict";cc._RF.push(e,"d6f78MS88NA1IzlPDqcgk9V","RegionPathFinder");var o=t,a=i,n=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r},r=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var l=o("ActorMove"),c=o("DebugConfig"),d=function(){function t(){this.cachedPaths=new Map,this._temp_regions_cur_wave=[],this._temp_regions_next_wave=[],this._temp_regions_checked=[],this.last_globalPath=[],this.currentWave=0,this.tileStart=null,this.tileTarget=null}return t.prototype.getGlobalPath=function(t,e,i){if(void 0===i&&(i=!1),this.last_globalPath=null,t==e)return l.PathFinderResult.SamePlace;if(t.region==e.region&&(64==t.region.tiles.length||0==t.region.tiles.length))return l.PathFinderResult.SamePlace;if(t.region==e.region)return l.PathFinderResult.PathFound;if(t.region.island!=e.region.island)return l.PathFinderResult.DifferentIslands;this.tileStart=t,this.tileTarget=e;var o=t.region.id+"_"+e.region.id;return c.default.UseCacheForRegionPath&&this.cachedPaths.has(o)?(this.last_globalPath=this.cachedPaths.get(o),l.PathFinderResult.PathFound):(this.last_globalPath=[],this.startWave(this.tileTarget.region),c.default.UseCacheForRegionPath&&this.addToCache(o,this.last_globalPath),l.PathFinderResult.PathFound)},t.prototype.addToCache=function(t,e){this.cachedPaths.size>1e3&&this.cachedPaths.clear(),this.cachedPaths.set(t,e)},t.prototype.clearCache=function(){this.cachedPaths.clear()},t.prototype.startWave=function(t){this.clearRegions(),this.currentWave=0,this._temp_regions_cur_wave=[],this._temp_regions_next_wave=[],this.addToNext(t),this.newWave()},t.prototype.addToNext=function(t){t.isCheckedPath=!0,this._temp_regions_next_wave.push(t),this._temp_regions_checked.push(t),t.path_wave_id=this.currentWave},t.prototype.newWave=function(){var t,e,i,o;this.currentWave++,this._temp_regions_cur_wave=r(this._temp_regions_next_wave),this._temp_regions_next_wave=[];try{for(var a=s(this._temp_regions_cur_wave),n=a.next();!n.done;n=a.next()){var l=n.value;try{for(var c=(i=void 0,s(l.neighbours)),d=c.next();!d.done;d=c.next()){var u=d.value;if(!u.isCheckedPath&&(this.addToNext(u),u==this.tileStart.region))return void this.finalPath(this.tileStart.region)}}catch(h){i={error:h}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}}catch(p){t={error:p}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}this._temp_regions_next_wave.length>0&&this.newWave()},t.prototype.finalPath=function(t){var e,i;if(this.last_globalPath.push(t),t.regionPath=!0,t!=this.tileTarget.region){t.neighbours.shuffle();try{for(var o=s(t.neighbours),a=o.next();!a.done;a=o.next()){var n=a.value;if(-1!=n.path_wave_id&&n.path_wave_id<t.path_wave_id){this.finalPath(n);break}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}}},t.prototype.clearRegions=function(){this._temp_regions_checked.forEach(function(t){t.isCheckedPath=!1,t.path_wave_id=-1,t.regionPath=!1}),this._temp_regions_checked=[]},t.prototype.debug=function(){return this.cachedPaths.size.toString()},t}();a.default=d,cc._RF.pop()},{}],ResourceLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"17e939LECtDOI1ZQEofMnvi","ResourceLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.ResourceAsset=n.ResType=void 0;var s,l=a("TextureLoader"),c=a("AssetLibrary");(function(t){t[t.Currency=0]="Currency",t[t.Strategic=1]="Strategic",t[t.Ingredient=2]="Ingredient",t[t.Food=3]="Food"})(s=n.ResType||(n.ResType={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=s.Ingredient,e.icon="",e.mineRate=0,e.maximum=999,e.sprite=null,e.restoreHunger=0,e.restoreHealth=0,e.ingredientsAmount=1,e.ingredients=[],e.supplyBoundGive=30,e.supplyBoundTake=10,e.supplyGive=10,e.tradeBound=40,e.tradeGive=10,e.tradeCost=1,e}return r(e,t),e.prototype.getSprite=function(){return null==this.sprite&&(this.sprite=l.TextureLoader.inst.getSpriteFrame(l.ATLAS_TYPE.UIATLAS,"icons/"+this.icon)),this.sprite},e}(c.Asset);n.ResourceAsset=d;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.poolMine=[],e}return r(e,t),e.prototype.init=function(){var e=this;t.prototype.init.call(this);var i=new d;i.id="gold",i.icon="iconResGold",i.maximum=9999,i.supplyBoundGive=600,i.supplyBoundTake=10,i.supplyGive=100,i.type=s.Currency,this.add(i);var o=new d;o.id="berries",o.type=s.Food,o.icon="iconResBerries",o.restoreHunger=30,o.restoreHealth=.05,o.tradeBound=50,o.tradeGive=5,this.add(o);var a=new d;a.id="bread",a.type=s.Food,a.icon="iconResBread",a.restoreHunger=60,a.ingredientsAmount=1,a.restoreHealth=.1,a.ingredients=["wheat"],a.tradeBound=50,a.tradeGive=5,this.add(a);var n=new d;n.id="fish",n.type=s.Food,n.restoreHunger=50,n.icon="iconResFish",n.restoreHealth=.15,n.tradeBound=50,n.tradeGive=5,this.add(n);var r=new d;r.id="meat",r.type=s.Food,r.restoreHunger=60,r.icon="iconResMeat",r.restoreHealth=.15,r.tradeBound=50,r.tradeGive=5,this.add(r);var l=new d;l.id="sushi",l.type=s.Food,l.icon="iconResSushi",l.restoreHunger=70,l.restoreHealth=.2,l.ingredientsAmount=1,l.ingredients=["fish"],l.tradeBound=50,l.tradeGive=5,this.add(l);var c=new d;c.id="jam",c.type=s.Food,c.icon="iconResJam",c.restoreHunger=70,c.ingredientsAmount=2,c.restoreHealth=.3,c.ingredients=["berries"],c.tradeBound=50,c.tradeGive=5,this.add(c);var u=new d;u.id="cider",u.type=s.Food,u.icon="iconResCider",u.restoreHunger=100,u.ingredientsAmount=3,u.restoreHealth=.4,u.ingredients=["berries"],u.tradeBound=50,u.tradeGive=5,this.add(u);var h=new d;h.id="ale",h.type=s.Food,h.icon="iconResAle",h.restoreHunger=100,h.ingredientsAmount=3,h.restoreHealth=.3,h.ingredients=["wheat"],h.tradeBound=50,h.tradeGive=5,this.add(h);var p=new d;p.id="burger",p.type=s.Food,p.icon="iconResBurger",p.restoreHunger=100,p.ingredientsAmount=1,p.restoreHealth=.5,p.ingredients=["meat","wheat"],p.tradeBound=50,p.tradeGive=5,this.add(p);var f=new d;f.id="pie",f.type=s.Food,f.icon="iconResPie",f.restoreHunger=100,f.ingredientsAmount=1,f.restoreHealth=.5,f.ingredients=["meat","wheat"],f.tradeBound=50,f.tradeGive=5,this.add(f);var _=new d;_.id="tea",_.type=s.Food,_.restoreHunger=100,_.restoreHealth=.25,_.icon="iconResTea",_.tradeBound=50,_.tradeGive=5,_.ingredients=["wheat"],this.add(_);var m=new d;m.id="honey",m.type=s.Food,m.restoreHealth=.8,m.restoreHunger=100,m.icon="iconResHoney",this.add(m);var g=new d;g.id="wheat",g.type=s.Ingredient,g.icon="iconResWheat",g.supplyBoundGive=100,g.supplyBoundTake=20,this.add(g);var y=new d;y.id="wood",y.icon="iconResWood",y.type=s.Strategic,this.add(y);var v=new d;v.id="stone",v.icon="iconResStone",v.mineRate=25,v.type=s.Strategic,this.add(v);var b=new d;b.id="ore",b.icon="iconResOre",b.mineRate=5,b.type=s.Ingredient,this.add(b);var w=new d;w.id="metals",w.icon="iconResMetals",w.ingredients=["ore"],w.type=s.Strategic,this.add(w);var T=new d;T.id="bones",T.icon="iconResBones",T.type=s.Strategic,this.add(T);var k=new d;k.id="leather",k.icon="iconResLeather",k.type=s.Strategic,this.add(k);var B=new d;B.id="gems",B.icon="iconResGems",B.mineRate=1,B.type=s.Strategic,this.add(B),this.list.forEach(function(t){if(0!=t.mineRate)for(var i=0;i<t.mineRate;i++)e.poolMine.push(t)})},e}(c.default);n.default=u,cc._RF.pop()},{}],RoadsCalculator:[function(t,e,i){"use strict";cc._RF.push(e,"97edbs168lMNJvWoRAVdqVl","RoadsCalculator");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseObjectData"),c=a("TileDictionary"),d=a("TileIsland"),u=cc._decorator,h=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.islands=[],e.current_island=0,e.dirty=!0,e}return r(e,t),e.prototype.onLoad=function(){this.islands=[],this.tileDictionary=new c.TileDictionary,t.prototype.create.call(this)},e.prototype.setDirty=function(t){t.roadIsland&&(t.roadIsland.dirty=!0),t.type.road?this.tileDictionary.add(t):(this.tileDictionary.remove(t),t.roadIsland=null),this.dirty=!0},e.prototype.clear=function(){t.prototype.clear.call(this),this.tileDictionary.clear(),this.islands=[]},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.dirty&&(this.dirty=!1,this.recalculateIslands())},e.prototype.recalculateIslands=function(){for(var t=this,e=0;e<this.islands.length;){var i=this.islands[e];i.dirty?(this.islands.splice(e,1),i.tiles_roads.dict.forEach(function(t,e){e.roadIsland=null})):e++}this.tileDictionary.dict.forEach(function(e,i){if(!i.roadIsland){var o=new d.default(t.current_island++);t.islands.push(o),t.calcIsland(i,o)}})},e.prototype.calcIsland=function(t,e){for(var i=[t];i.length>0;){var o=i.shift();o.roadIsland=e,e.tiles_roads.add(o);for(var a=0;a<o.neighboursAll.length;a++){var n=o.neighboursAll[a];!n.roadIsland&&n.type.road&&(n.roadIsland=e,i.push(n))}}},s([h],e)}(l.BaseModule));n.default=p,cc._RF.pop()},{}],SantaAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"28613myefBJy5yA63SQPogz","SantaAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GameCommon"),c=a("BaseMapObject"),d=a("ToolBox"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shakeX=2,e.shakeY=.3,e.shakeTween=null,e.originalX=0,e.originalY=0,e}return r(e,t),e.prototype.start=function(){this.originalX=this.node.position.x,this.originalY=this.node.position.y,this.doTween()},e.prototype.logicUpdate=function(){l.default.isPaused||this.shakeTween||this.doTween()},e.prototype.doTween=function(){var t=this.shakeX*d.Toolbox.randomRange(.3,1),e=this.shakeY*d.Toolbox.randomRange(.3,1);this.shakeTween=cc.tween(this.node).to(.1,{position:cc.v3(this.originalX+t,this.originalY+e,0)}).to(.1,{position:cc.v3(this.originalX,this.originalY,0)}).to(.1,{position:cc.v3(this.originalX-t,this.originalY-e,0)}).to(.1,{position:cc.v3(this.originalX,this.originalY,0)}).call(this.tweenFinished.bind(this)).start()},e.prototype.tweenFinished=function(){this.shakeTween=null},s([p()],e.prototype,"shakeX",void 0),s([p()],e.prototype,"shakeY",void 0),s([h],e)}(c.default);n.default=f,cc._RF.pop()},{}],Santa:[function(t,e,i){"use strict";cc._RF.push(e,"0640eWA9GhPjZ2tymNAmNAC","Santa");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("GameCommon"),d=a("MapAction"),u=a("AssetManager"),h=a("ToolBox"),p=a("GameAudio"),f=a("MapBox"),_=a("Actor"),m=a("ActorAsset"),g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=1,e.timer_smoke=0,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.timer=2+h.Toolbox.randomFloat(0,2)},e.prototype.logicUpdate=function(e){var i;if(this.colorEffect-=e,this.colorEffect<0&&(this.colorEffect=0),this.data.health>0?t.prototype.logicUpdate.call(this,e):(this.updateFall(e),this.updatePos()),this.node.x>2*f.default.width)this.killHimself(!0,m.AttackType.None,!1);else if(this.data.health>0?(this.nextStepPosition.x=3*f.default.width,this.nextStepPosition.y=this.currentPosition.y,this.is_moving=!0,c.default.isPaused||(this.currentPosition.addSelf(cc.v3(.1*this.curStats.speed,h.Toolbox.randomFloat(-1,1)).mul(f.default.inst.elapsed)),this._positionDirty=!0)):(this.timer_smoke>0?this.timer_smoke-=f.default.inst.elapsed:(this.timer_smoke=.1,f.default.inst.stackEffects.get("fireSmoke").spawnAt(this.node.position,1)),this.currentPosition.addSelf(cc.v3(4,h.Toolbox.randomFloat(-1,1)).mul(f.default.inst.elapsed)),this._positionDirty=!0),0==this.zPosition.y){p.default.playExplosionMedium();var o=f.default.inst.getTile(l.default.intCast(this.currentPosition.x),l.default.intCast(this.currentPosition.y));if(!o)return void this.killHimself(!0);this.killHimself(!0),d.default.damageWorld(o,5,u.default.terraform.get("grenade")),f.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(o,.45,.6)}else{if(!(null===(i=this.data)||void 0===i?void 0:i.alive)||c.default.isPaused)return;if(this.timer-=f.default.inst.elapsed,this.timer>0)return;if(this.timer=2+h.Toolbox.randomFloat(0,2),this.data.health>0){var a=f.default.inst.getTile(l.default.intCast(this.currentPosition.x),l.default.intCast(this.currentPosition.y));a&&(f.default.inst.dropManager.spawn(a,"santa_bomb",this.zPosition.y).soundOn=!0)}}},e.ignoredKingdom=["santa"],s([y],e)}(_.default));n.default=v,cc._RF.pop()},{}],SaveItem:[function(t,e,i){"use strict";cc._RF.push(e,"6d913Hp+LZPX4meQRWKvWlO","SaveItem");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Config"),c=cc._decorator,d=c.ccclass,u=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtName=null,e.icon=null,e.slotId=0,e.callback=null,e}return r(e,t),e.prototype.init=function(t,e,i,o,a){void 0===a&&(a=null),this.slotId=t,this.callback=a,this.loadTexture(e,i,o),this.txtName&&(this.txtName.active=t==l.default.quickSaveSlotId)},e.prototype.click=function(){l.default.currentSlot=this.slotId,this.callback&&this.callback()},e.prototype.loadTexture=function(t,e,i){if(t){var o=new cc.Texture2D;o.initWithData(t,cc.Texture2D.PixelFormat.RGBA8888,e,i),o.setFilters(cc.Texture2D.Filter.NEAREST,cc.Texture2D.Filter.NEAREST);var a=new cc.SpriteFrame;a.setTexture(o),this.icon.spriteFrame=a}},s([u(cc.Node)],e.prototype,"txtName",void 0),s([u(cc.Sprite)],e.prototype,"icon",void 0),s([d],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],SaveList:[function(t,e,i){"use strict";cc._RF.push(e,"a4169BHJnVKEpA0hNNJ8oRf","SaveList");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Base64"),c=a("GamePopBase"),d=a("Config"),u=a("GameAudio"),h=a("GuideController"),p=a("MapBox"),f=a("SaveItem"),_=a("SaveManager"),m=a("SavePopup"),g=cc._decorator,y=g.ccclass,v=g.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listContentNode=null,e.slotItem=null,e.slotNodes=[],e.clicked=!1,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,this.subBg.x=cc.winSize.width,this.build()},e.prototype.open=function(){t.prototype.open.call(this,function(){h.default.inst.in(h.GUIDE_TYPE.save,2)&&h.default.inst.do(h.GUIDE_TYPE.save)})},e.prototype.back=function(){u.default.playClick(),this.clicked=!1,this.listContentNode.destroyAllChildren(),this.build(),this.move(!1)},e.prototype.build=function(){for(var t=0;t<d.default.maxSlotCount;t++){var e=this.buildItem(t);e&&(e.parent=this.listContentNode,this.slotNodes.push(e))}},e.prototype.buildItem=function(t){var e=cc.instantiate(this.slotItem);if(!e)return null;e.name="\u5b58\u6863"+t;var i=0,o=0,a=null;if(t==d.default.quickSaveSlotId)a=p.default.inst.worldLayer.getTextureData(),i=p.default.width,o=p.default.height;else if(_.default.slotExists(t)){var n=_.default.getPreview(t);n&&(a=l.default.decodeToUnit8Array(n.textureDataBase64),i=n.width,o=n.height)}return e.getComponent(f.default).init(t,a,i,o,this.onSlotNodeClicked.bind(this)),e},e.prototype.onSlotNodeClicked=function(){this.clicked||(this.clicked=!0,this.subBg.getComponent(m.default).init(d.default.currentSlot,this.back.bind(this)),this.move(!0,function(){h.default.inst.in(h.GUIDE_TYPE.save,3)&&h.default.inst.do(h.GUIDE_TYPE.save)}))},e.inst=null,s([v({type:cc.Node,tooltip:""})],e.prototype,"listContentNode",void 0),s([v({type:cc.Prefab,tooltip:"\u5217\u8868\u7684\u5143\u7d20"})],e.prototype,"slotItem",void 0),i=s([y],e)}(c.GamePopBase);n.default=b,cc._RF.pop()},{}],SaveManager:[function(t,e,i){"use strict";cc._RF.push(e,"34ccc7TKWhPi5dNfkKX9TPR","SaveManager");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("Base64"),d=a("Log"),u=a("SaveUtils"),h=a("Tools"),p=a("ActorAsset"),f=a("ActorStatus"),_=a("Boat"),m=a("AssetManager"),g=a("Docks"),y=a("UnitSpawner"),v=a("CityStorage"),b=a("SmoothLoader"),w=a("ToolBox"),T=a("Config"),k=a("Culture"),B=a("GuideController"),S=a("Kingdom"),C=a("ConwayLife"),x=a("MapStats"),A=a("MapBox"),P=a("ModModule"),O=a("WorldLaws"),R=a("SavedMap"),F=cc._decorator,L=F.ccclass,D=(F.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e._tile_id_main="",e._tile_id_top="",e}var i;return r(e,t),i=e,e.prototype.start=function(){},e.prototype.saveSlot=function(){this.saveMapData(),this.savePreview()},e.prototype.currentWorldToSavedMap=function(){var t=new R.default;return t.create(),t},e.deleteSave=function(){u.default.remove(i.getMetaPath()),u.default.remove(i.getDataPath()),u.default.remove(i.getPreviewPath())},e.prototype.saveMapData=function(){var t=this.currentWorldToSavedMap();i.saveMetaData(t.getMeta()),u.default.set(i.getDataPath(),t.toZip())},e.saveMetaData=function(t,e){void 0===e&&(e=-1),u.default.set(i.getMetaPath(e),t.toJson())},e.slotMeta=function(t){if(void 0===t&&(t=-1),i.slotMetaExists(t)){var e=u.default.get(i.getMetaPath(t));return h.default.fromJson(JSON.parse(e),new R.MapMetaData)}return i.slotExists(t)&&(i.saveMetaData(i.getMapForSlot(t).getMeta(),t),i.slotMetaExists(t))?i.slotMeta(t):null},e.slotExists=function(t){return void 0===t&&(t=-1),!!u.default.get(i.getDataPath(t))},e.slotMetaExists=function(t){return void 0===t&&(t=-1),!!u.default.get(i.getMetaPath(t))},e.prototype.savePreview=function(){var t=c.default.encodeFromUint8Array(A.default.inst.worldLayer.getTextureData()),e=new R.SavedPreview(i.getSlot(),A.default.width,A.default.height,t),o=i.dataToZippedBase64(e);u.default.set(i.getPreviewPath(),o)},e.getPreview=function(t){var e=null,o=u.default.get(i.getPreviewPath(t));if(o){var a=i.decodeZippedBase64(o);e=JSON.parse(a)}return e},e.getSlot=function(t){return void 0===t&&(t=-1),-1==t?T.default.currentSlot:t},e.getDirPath=function(t){return void 0===t&&(t=-1),t=i.getSlot(t),i.getSaveDirPath()+"save"+t},e.getSaveDirPath=function(){return i.persistentDataPath+i.folder_base},e.getDataPath=function(t){return void 0===t&&(t=-1),i.getDirPath(t)+i.dataName},e.getMetaPath=function(t){return void 0===t&&(t=-1),i.getDirPath(t)+i.metaDataName},e.getPreviewPath=function(t){return void 0===t&&(t=-1),i.getDirPath(t)+i.previewName},e.prototype.loadSlot=function(t){void 0===t&&(t=-1);try{var e=i.getMapForSlot(t);this.loadData(e)}catch(o){d.default.d("Error during loading of slot "+t);try{i.slotMetaExists(t)?d.default.d(JSON.stringify(i.slotMeta(t))):d.default.d("No meta data")}catch(o){d.default.d("Failed to load meta data")}d.default.e(o)}},e.loadString=function(t){var e=i.decodeZippedBase64(t),o=h.default.fromJson(JSON.parse(e),new R.default);A.default.inst.saveManager.loadData(o)},e.loadMapFromResources=function(t){i.loadString(u.default.get(t))},e.getMapForSlot=function(t){void 0===t&&(t=-1);var e=i.getDataPath(t);if(u.default.get(e)){var o=u.default.get(e),a=i.decodeZippedBase64(o);return h.default.fromJson(JSON.parse(a),new R.default)}return null},e.prototype.startLoadSlot=function(t){void 0===t&&(t=-1)},e.prototype.loadTiles=function(t){var e,i,o=t.split(","),a=T.default.ZONE_AMOUNT_X;if(this.data.saveVersion<7){for(var n=[],r=0,s=0,c=0;c<A.default.inst.tilesList.length;c++){s>=50*a&&(s=0,r+=14*a);var d=c+r;d<=A.default.inst.tilesList.length&&(n[d]=o[c],s++)}o=n}try{for(var u=l(A.default.inst.tilesList),h=u.next();!h.done;h=u.next()){var p=h.value;if(p.data.tile_id>=o.length||!o[p.data.tile_id])p.setTileType("deep_ocean");else{var f=o[p.data.tile_id].split(":"),_=2==f.length?f[1]:null;this._tile_id_main=f[0],this._tile_id_top="",this.convertOldTilesToNewOnes(),p.setTileType(this._tile_id_main),this._tile_id_top&&p.setTopTileType(m.default.topTiles.get(this._tile_id_top)),p.height=p.type.heightMin,p.type.lava&&A.default.inst.lavaLayer.loadLavaTile(p),"grey_goo"==this._tile_id_main&&A.default.inst.greyGooLayer.add(p),_&&(_.includes("fire")&&(p.data.fire=!0),_.includes("conv0")&&(p.data.conwayType=C.ConwayType.Eater,A.default.inst.conwayLayer.add(p,"conway")),_.includes("conv1")&&(p.data.conwayType=C.ConwayType.Creator,A.default.inst.conwayLayer.add(p,"conwayInverse")))}}}catch(v){e={error:v}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}},e.prototype.convertOldTilesToNewOnes=function(){switch(this._tile_id_main.includes("road")&&(this._tile_id_main="soil_low",this._tile_id_top="road"),this._tile_id_main){case"shallow_waters_frozen":this._tile_id_main="shallow_waters",this._tile_id_top="ice";break;case"field":this._tile_id_main="soil_low",this._tile_id_top="field";break;case"fuse":this._tile_id_main="soil_low",this._tile_id_top="fuse";break;case"grass_flowers":case"grass":this._tile_id_main="soil_low",this._tile_id_top="grass_low";break;case"forest_flowers":case"forest":this._tile_id_main="soil_high",this._tile_id_top="grass_high";break;case"forest_soil":this._tile_id_main="soil_high";break;case"mountains_frozen":this._tile_id_main="mountains",this._tile_id_top="snow_block";break;case"hills_frozen":this._tile_id_main="mountains",this._tile_id_top="snow_hills";break;case"sand":this._tile_id_main="sand";break;case"forest_soil_frozen":this._tile_id_main="soil_high",this._tile_id_top="snow_high";break;case"soil_frozen":this._tile_id_main="soil_low",this._tile_id_top="snow_low";break;case"sand_frozen":this._tile_id_main="sand",this._tile_id_top="snow_sand";break;case"soil":this._tile_id_main="soil_low";break;case"soil_creep":this._tile_id_main="soil_low",this._tile_id_top="tumor_low";break;case"sand_creep":this._tile_id_main="sand",this._tile_id_top="tumor_low";break;default:this._tile_id_main="soil_low";break;case"hills":case"mountains":case"lava0":case"lava1":case"lava2":case"lava3":case"deep_ocean":case"close_ocean":case"shallow_waters":}},e.prototype.loadTileArray=function(t){var e;if(0!=t.tileAmounts.length){for(var i=t.width*t.height*4096,o=0,a=0;a<t.tileArray.length;a++)for(var n=0;n<t.tileArray[a].length;n++){if(this._tile_id_top="",this._tile_id_main=null!==(e=t.tileMap[t.tileArray[a][n]])&&void 0!==e?e:"deep_ocean",this._tile_id_main.includes(":")){var r=this._tile_id_main.split(":");this._tile_id_main=r[0],this._tile_id_top=r[1]}t.saveVersion<9&&this.convertOldTilesToNewOnes();for(var s=0;s<t.tileAmounts[a][n];s++){var l=A.default.inst.tilesList[o++];l.setTileType(this._tile_id_main),this._tile_id_top&&l.setTopTileType(m.default.topTiles.get(this._tile_id_top)),l.height=l.type.heightMin,l.type.lava&&A.default.inst.lavaLayer.loadLavaTile(l),l.type.greyGoo&&A.default.inst.greyGooLayer.add(l)}}for(;o+1<i;)d.default.d("deep ocean "+o),A.default.inst.tilesList[o++].setTileType("deep_ocean")}},e.prototype.loadConway=function(t,e){if(0!=t.length||0!=e.length){for(var i=0;i<t.length;i++)A.default.inst.tilesList[t[i]].data.conwayType=C.ConwayType.Eater,A.default.inst.conwayLayer.add(A.default.inst.tilesList[t[i]],"conway");for(var o=0;o<e.length;o++)A.default.inst.tilesList[e[o]].data.conwayType=C.ConwayType.Creator,A.default.inst.conwayLayer.add(A.default.inst.tilesList[e[o]],"conwayInverse")}},e.prototype.loadFire=function(t){if(0!=t.length)for(var e=0;e<t.length;e++)A.default.inst.tilesList[t[e]].data.fire=!0},e.prototype.loadData=function(t){var e=this;this.data=t,b.default.prepare(),b.default.add(function(){A.default.inst.clearWorld()},"clearWorld"),b.default.add(function(){A.default.inst.setMapSize(t.width,t.height),A.default.inst.mapStats=h.default.fromJson(t.mapStats,new x.default),A.default.inst.worldLaws=h.default.fromJson(t.worldLaws,new O.default),A.default.inst.worldLaws.check()},"setMapSize"),t.saveVersion>0&&t.saveVersion<8?b.default.add(function(){e.loadTiles(t.tileString)},"loadTiles"):t.saveVersion>7?(b.default.add(function(){e.loadTileArray(t)},"loadTileArray"),b.default.add(function(){e.loadFire(t.fire)},"loadFire"),b.default.add(function(){e.loadConway(t.conwayEater,t.conwayCreator)},"loadConway")):b.default.add(this.loadOldTiles.bind(this),"loadOldTiles"),b.default.add(this.loadCultures.bind(this),"loadCultures"),b.default.add(this.loadKingdoms.bind(this),"loadKingdoms"),b.default.add(this.loadCities.bind(this),"loadCities");for(var i=Math.ceil(this.data.actors.length/500),o=0,a=function(){var t=Math.min(n.data.actors.length-o,500),i=o;o+=t,b.default.add(function(){e.loadActors(i,t)},"loadActors ("+o+"/"+n.data.actors.length+")",!0)},n=this,r=0;r<i;r++)a();b.default.add(function(){A.default.inst.units.checkAddRemove()},"Finish Loading Actors"),b.default.add(this.checkOldCityZones.bind(this),"checkOldCityZones"),b.default.add(this.loadBuildings.bind(this),"loadBuildings"),b.default.add(this.setHomeBuildings.bind(this),"setHomeBuildings"),b.default.add(this.loadCivs02.bind(this),"loadCivs02"),b.default.add(this.loadLeaders.bind(this),"loadLeaders"),b.default.add(this.loadDiplomacy.bind(this),"loadDiplomacy"),b.default.add(this.loadBoatStates.bind(this),"loadBoatStates"),b.default.add(function(){A.default.inst.finishMakingWorld(),T.default.mode_sandBox&&FIRST_PLAY&&e.scheduleOnce(function(){B.default.inst.do(B.GUIDE_TYPE.novice)},.5)},"finishMakingWorld"),T.default.mode_sandBox||(this.data.mod?b.default.add(function(){P.default.inst.loadModData(e.data.mod),FIRST_PLAY&&e.scheduleOnce(function(){B.default.inst.do(B.GUIDE_TYPE.novice)},.5)},"loadMod"):b.default.add(function(){P.default.inst.newRound()},"Mod Start",!0))},e.prototype.loadBoatStates=function(){for(var t=A.default.inst.units.getSimpleList(),e=0;e<t.length;e++){var i=t[e];if(i.data.transportID){var o=A.default.inst.getActorByID(i.data.transportID);o&&(i.embarkInto(o.getComponent(_.default)),i.ai.setTask("sit_inside_boat"),i.ai.logicUpdate(A.default.inst.elapsed))}}},e.prototype.loadDiplomacy=function(){A.default.inst.kingdoms.checkKingdoms(),A.default.inst.kingdoms.diplomacyManager.load(this.data.relations)},e.prototype.loadLeaders=function(){for(var t=0;t<A.default.inst.citiesList.length;t++)A.default.inst.citiesList[t].loadLeader()},e.prototype.loadCivs02=function(){for(var t=0;t<A.default.inst.kingdoms.list_civs.length;t++)A.default.inst.kingdoms.list_civs[t].load2()},e.prototype.setHomeBuildings=function(){for(var t,e,i=A.default.inst.units.getSimpleList(),o=0;o<i.length;o++){var a=i[o];if((null===(t=a.data)||void 0===t?void 0:t.homeBuildingID)&&(a.homeBuilding=A.default.inst.getBuildingByID(a.data.homeBuildingID),a.homeBuilding&&!a.homeBuilding.isNonUsable())){if(null===(e=a.stats)||void 0===e?void 0:e.isBoat){var n=A.default.inst.getBuildingByID(a.data.homeBuildingID);n&&n.getComponent(g.default).addBoatToDock(a)}a.homeBuilding.getComponent(y.default)&&a.homeBuilding.getComponent(y.default).setUnitFromHere(a)}}A.default.inst.buildings.checkAddRemove()},e.prototype.loadBuildings=function(){for(var t=0;t<this.data.buildings.length;t++){var e=this.data.buildings[t];e.templateID.includes("ork")&&(e.templateID=e.templateID.replace("ork","orc")),m.default.buildings.get(e.templateID)&&A.default.inst.loadBuilding(e)}A.default.inst.buildings.checkAddRemove()},e.prototype.checkOldCityZones=function(){if(!(this.data.saveVersion>=7))for(var t=0;t<this.data.buildings.length;t++){var e=this.data.buildings[t],i=A.default.inst.getCityByID(e.cityID);if(i){var o=A.default.inst.getTile(e.mainX,e.mainY);i.addZone(o.zone)}}},e.prototype.loadActors=function(t,e){var i,o,a;void 0===t&&(t=0),void 0===e&&(e=0);var n=this.data.actors.length;e>0&&(n=Math.min(t+e,this.data.actors.length));for(var r=t;r<n;r++){var s=h.default.fromJson(this.data.actors[r],new f.ActorData),c=A.default.inst.getTile(s.x,s.y);if((null===(a=s.status)||void 0===a?void 0:a.alive)&&("food"==s.inventory.resource&&(s.inventory.resource="wheat"),s.status.gender==p.ActorGender.Unknown&&(w.Toolbox.randomBool()?s.status.gender=p.ActorGender.Male:s.status.gender=p.ActorGender.Female),"livingPlants"!=s.status.statsID&&"livingHouse"!=s.status.statsID||s.status.special_graphics)){var d=A.default.inst.spawnAndLoadUnit(s.status.statsID,s,c);if(d&&!(this.data.saveVersion>=6))try{for(var u=(i=void 0,l(d.stats.traits)),_=u.next();!_.done;_=u.next()){var m=_.value;d.addTrait(m)}}catch(v){i={error:v}}finally{try{_&&!_.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}}},e.prototype.loadCities=function(){for(var t=0;t<this.data.cities.length;t++){var e=this.data.cities[t];if(0!=e.zones.length){e.storage&&(e.storage=h.default.fromJson(e.storage,new v.default)),"ork"==e.race&&(e.race="orc");var i=A.default.inst.zoneCalculator.getZone(e.zones[0].x,e.zones[0].y);if(this.data.saveVersion<7&&(i=this.findZoneViaBuilding(e.cityID,this.data.buildings)),i){var o=A.default.inst.buildNewCity(i,e,null,!0);if(o&&!(this.data.saveVersion<7))for(var a=1;a<e.zones.length;a++){var n=e.zones[a],r=A.default.inst.zoneCalculator.getZone(n.x,n.y);r&&o.addZone(r)}}}}},e.prototype.loadKingdoms=function(){for(var t=0;t<this.data.kingdoms.length;t++){var e=S.default.initWithData(this.data.kingdoms[t]);A.default.inst.kingdoms.addKingdom(e,!0),e.data.raceID||this.tryToFixMissingRace(this.data),e.load1()}},e.prototype.loadCultures=function(){for(var t=0;t<this.data.cultures.length;t++){var e=h.default.fromJson(this.data.cultures[t],new k.default);A.default.inst.cultures.loadCulture(e)}},e.prototype.loadOldTiles=function(){for(var t=0;t<this.data.tiles.length;t++){var e=this.data.tiles[t],i=A.default.inst.getTileSimple(e.x,e.y);i.setTileType(e.type),i.data=e,e.conwayType!=C.ConwayType.None&&A.default.inst.conwayLayer.add(i,"conway"),"grey_goo"==e.type&&A.default.inst.greyGooLayer.add(i)}},e.prototype.tryToFixMissingRace=function(t){var e,i,o,a,n=!1;try{for(var r=l(t.kingdoms),s=r.next();!s.done;s=r.next()){var c=s.value;if(!c.raceID)try{for(var d=(o=void 0,l(t.cities)),u=d.next();!u.done;u=d.next()){var h=u.value;if(h.kingdomID==c.id&&h.race){c.raceID=h.race,n=!0;break}}}catch(_){o={error:_}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}}catch(m){e={error:m}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return n},e.prototype.findZoneViaBuilding=function(t,e){var i,o;try{for(var a=l(e),n=a.next();!n.done;n=a.next()){var r=n.value;if(r.cityID==t)return A.default.inst.getTile(r.mainX,r.mainY).zone}}catch(d){i={error:d}}finally{try{n&&!n.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}return null},e.dataToZippedBase64=function(t){var e=JSON.stringify(t),i=pako.deflate(e);return c.default.encodeFromUint8Array(i)},e.decodeZippedBase64=function(t){var e=c.default.decodeToUnit8Array(t);return pako.inflate(e,{to:"string"})},e.folder_base="/saves/",e.dataName="/map.wbox",e.metaDataName="/map.meta",e.previewName="/preview.txt",e.persistentDataPath="KingdomSIM",i=s([L],e)}(cc.Component));n.default=D,cc._RF.pop()},{}],SavePopup:[function(t,e,i){"use strict";cc._RF.push(e,"e0dbeJtqIlLFaVKXeOzXxGj","SavePopup");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Base64"),c=a("Constants"),d=a("AdsManager"),u=a("AchievData"),h=a("UserData"),p=a("LoadLayer"),f=a("MsgCache"),_=a("Config"),m=a("MapBox"),g=a("SaveItem"),y=a("SaveManager"),v=cc._decorator,b=v.ccclass,w=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buttonDelete=null,e.buttonLoad=null,e.buttonSave=null,e.videoNode=null,e.previewItem=null,e.titleLabel=null,e.status=null,e.population=null,e.kingdoms=null,e.cities=null,e.houses=null,e.zones=null,e.slotId=-1,e.callback=null,e.clicked=!1,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.init=function(t,e){this.callback=e,this.clicked=!1;var i=null,o=0,a=0,n=y.default.getPreview(t);n?(i=l.default.decodeToUnit8Array(n.textureDataBase64),o=n.width,a=n.height):(i=m.default.inst.worldLayer.getTextureData(),o=m.default.width,a=m.default.height),this.previewItem.init(t,i,o,a),t==_.default.quickSaveSlotId?this.titleLabel.string="\u81ea\u52a8\u5b58\u6863":this.titleLabel.string="\u5b58\u6863 "+(t+1),this.slotId=t;var r=y.default.slotExists(t);this.videoNode.active=!h.default.member.unLockSave[t],this.buttonDelete.interactable=r&&t!=_.default.quickSaveSlotId,this.buttonDelete.node.active=r&&t!=_.default.quickSaveSlotId,this.buttonLoad.interactable=r,this.buttonSave.interactable=t!=_.default.quickSaveSlotId,this.buttonSave.node.active=t!=_.default.quickSaveSlotId;var s=y.default.slotMeta(_.default.currentSlot);s?(this.status.active=!0,this.population.string=s.population.toString(),this.kingdoms.string=s.kingdoms.toString(),this.cities.string=s.cities.toString(),this.houses.string=s.buildings.toString(),this.zones.string=s.width.toString()):this.status.active=!1},e.prototype.onDeleteClicked=function(){var t=this;this.clicked||(this.clicked=!0,f.default.showMsgBox("\u662f\u5426\u5220\u9664\u6b64\u5b58\u6863\uff1f",function(e){1==e?(y.default.deleteSave(),f.default.showMsgBox("\u5220\u9664\u6210\u529f\uff01",function(){t.callback&&t.callback()},!1)):t.clicked=!1}))},e.prototype.onLoadClicked=function(){var t=this,e=this.slotId;f.default.showMsgBox("\u662f\u5426\u52a0\u8f7d\u6b64\u5b58\u6863\uff1f\n\n\u8b66\u544a\uff1a\u5f53\u524d\u4e16\u754c\u5c06\u4f1a\u6d88\u5931",function(i){1==i&&(t.callback&&t.callback(),p.LoadLayer.openLoading().then(function(){setTimeout(function(){m.default.inst.saveManager.loadSlot(e)},20)}))})},e.prototype.onSaveClicked=function(){var t=this;this.clicked||(this.clicked=!0,y.default.slotExists(this.slotId)?f.default.showMsgBox("\u662f\u5426\u5b58\u50a8\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff1f\n\u6b64\u4f4d\u7f6e\u7684\u5b58\u6863\u5c06\u4f1a\u88ab\u8986\u76d6\uff01",function(e){1==e?t.doSave():t.clicked=!1}):this.videoNode.active?(c.default.REPORT_ID="saveWorld",d.default.showVideoAds(function(e){if(1==e)t.doSave(),h.default.member.unLockSave[t.slotId]=!0,h.default.save();else{t.clicked=!1;var i=0==e?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";f.default.pushToast(i)}})):this.doSave())},e.prototype.doSave=function(){var t=this;h.default.member.saved||(h.default.member.saved=!0,h.default.save()),m.default.inst.saveManager.saveSlot(),u.default.update(11),f.default.showMsgBox("\u5b58\u6863\u6210\u529f\uff01",function(){t.callback&&t.callback()},!1)},e.inst=null,s([w({type:cc.Button,tooltip:"\u5220\u9664\u6309\u94ae"})],e.prototype,"buttonDelete",void 0),s([w({type:cc.Button,tooltip:"\u52a0\u8f7d\u6309\u94ae"})],e.prototype,"buttonLoad",void 0),s([w({type:cc.Button,tooltip:"\u4fdd\u5b58\u6309\u94ae"})],e.prototype,"buttonSave",void 0),s([w({type:cc.Node,tooltip:"\u89c6\u9891\u8282\u70b9"})],e.prototype,"videoNode",void 0),s([w({type:g.default,tooltip:"\u9884\u89c8\u56fe"})],e.prototype,"previewItem",void 0),s([w({type:cc.Label,tooltip:"Title"})],e.prototype,"titleLabel",void 0),s([w({type:cc.Node,tooltip:"\u4e16\u754c\u4fe1\u606f"})],e.prototype,"status",void 0),s([w({type:cc.Label,tooltip:"\u4e16\u754c\u4eba\u53e3"})],e.prototype,"population",void 0),s([w({type:cc.Label,tooltip:"\u738b\u56fd\u6570\u91cf"})],e.prototype,"kingdoms",void 0),s([w({type:cc.Label,tooltip:"\u57ce\u5e02\u6570\u91cf"})],e.prototype,"cities",void 0),s([w({type:cc.Label,tooltip:"\u5efa\u7b51\u6570\u91cf"})],e.prototype,"houses",void 0),s([w({type:cc.Label,tooltip:"\u533a\u57df\u6570\u91cf"})],e.prototype,"zones",void 0),i=s([b],e)}(cc.Component);n.default=T,cc._RF.pop()},{}],SavedMap:[function(t,e,i){"use strict";cc._RF.push(e,"8450f6KgQxPxIW4ezCoWkre","SavedMap");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.SavedPreview=a.MapMetaData=void 0;var r=o("Base64"),s=o("ActorStatus"),l=o("AssetManager"),c=o("Config"),d=o("ConwayLife"),u=o("MapStats"),h=o("TileZone"),p=o("MapBox"),f=o("ModModule"),_=o("WorldLaws"),m=function(){function t(){this.temp_date_string="",this.saveVersion=0,this.width=0,this.height=0,this.mapStats=new u.default,this.cities=0,this.units=0,this.population=0,this.buildings=0,this.structures=0,this.kingdoms=0,this.mobs=0,this.cultures=0,this.modded=!1,this.timestamp=0,this.races=[]}return t.prototype.toJson=function(){return JSON.stringify(this)},t}();a.MapMetaData=m,a.SavedPreview=function(t,e,i,o){this.slotId=0,this.width=0,this.height=0,this.textureDataBase64="",this.slotId=t,this.width=e,this.height=i,this.textureDataBase64=o};var g=function(){function t(){this.saveVersion=0,this.width=0,this.height=0,this.mapStats=new u.default,this.worldLaws=new _.default,this.tileString="",this.tileMap=[],this.tileArray=[],this.tileAmounts=[],this.fire=[],this.conwayEater=[],this.conwayCreator=[],this.tiles=[],this.cities=[],this.actors=[],this.buildings=[],this.kingdoms=[],this.relations=[],this.cultures=[],this.mod=null,this.width=c.default.ZONE_AMOUNT_X_DEFAULT,this.height=c.default.ZONE_AMOUNT_Y_DEFAULT}return t.prototype.getTileMapID=function(t){return this.tileMap.includes(t)||this.tileMap.push(t),this.tileMap.indexOf(t)},t.prototype.create=function(){var t,e,i,o,a,r,l,u,_;this.width=c.default.ZONE_AMOUNT_X,this.height=c.default.ZONE_AMOUNT_Y,this.saveVersion=c.default.WORLD_SAVE_VERSION,this.mapStats=p.default.inst.mapStats,this.worldLaws=p.default.inst.worldLaws,this.mapStats.population=p.default.inst.units.length,this.kingdoms=p.default.inst.kingdoms.save(),this.relations=p.default.inst.kingdoms.diplomacyManager.save(),this.cultures=p.default.inst.cultures.save(),this.mod=f.default.inst.save();try{for(var m=n(p.default.inst.citiesList),g=m.next();!g.done;g=m.next()){var y=g.value,v=y.data;v.storage.save(),v.zones=[];try{for(var b=(i=void 0,n(y.zones)),w=b.next();!w.done;w=b.next()){var T=w.value,k=new h.ZoneData;k.x=T.x,k.y=T.y,v.zones.push(k)}}catch(G){i={error:G}}finally{try{w&&!w.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}this.cities.push(v)}}catch(U){t={error:U}}finally{try{g&&!g.done&&(e=m.return)&&e.call(m)}finally{if(t)throw t.error}}this.tileMap=[],this.fire=[],this.conwayEater=[],this.conwayCreator=[];var B=[],S=[],C="",x=0,A=0;B.push([]),S.push([]);for(var P=0,O=0;O<p.default.inst.tilesList.length;O++){var R=p.default.inst.tilesList[O],F=this.getWholeTileIDForSave(R);F==C&&A==R.pos.y||(x>0&&(S[A][P]=x,B[A][P++]=this.getTileMapID(C),x=0),C=F,A!=R.pos.y&&(A=R.pos.y,B.push([]),S.push([]),P=0)),x++,R.data.fire&&this.fire.push(R.data.tile_id),R.data.conwayType==d.ConwayType.Eater&&this.conwayEater.push(R.data.tile_id),R.data.conwayType==d.ConwayType.Creator&&this.conwayCreator.push(R.data.tile_id)}x>0&&(S[A][P]=x,B[A][P++]=this.getTileMapID(C)),this.tileArray=Array.from(B),this.tileAmounts=Array.from(S),B=[],S=[];try{for(var L=n(p.default.inst.units.list),D=L.next();!D.done;D=L.next()){var M=D.value;if((null===(l=M.data)||void 0===l?void 0:l.alive)&&(null===(u=M.stats)||void 0===u||!u.skipSave)){var I=new s.ActorData;if(I.status=M.data,I.x=M.currentTile.pos.x,I.y=M.currentTile.pos.y,I.inventory=M.inventory,M.equipment){var j=M.equipment.getDataForSave();j.length>0&&(I.items=j)}(null===(_=M.city)||void 0===_?void 0:_.data)&&(I.cityID=M.city.data.cityID),this.actors.push(I)}}}catch(W){a={error:W}}finally{try{D&&!D.done&&(r=L.return)&&r.call(L)}finally{if(a)throw a.error}}for(var E=p.default.inst.buildings.getSimpleList(),N=0;N<E.length;N++){var z=E[N];z.prepareForSave(),this.buildings.push(z.data)}},t.prototype.getWholeTileIDForSave=function(t){var e=t.main_type.id;return t.top_type&&(e=e+":"+t.top_type.id),e},t.prototype.toJson=function(){return this.worldLaws||this.create(),JSON.stringify(this)},t.prototype.toZip=function(){var t=this.toJson(),e=pako.deflate(t);return r.default.encodeFromUint8Array(e)},t.prototype.getMeta=function(){for(var t=new m,e=[],i=0,o=0,a=0;a<this.actors.length;a++){var n=this.actors[a],r=l.default.unitStats.get(n.status.statsID);r.unit?(i++,e.includes(r.race)||e.push(r.race)):o++}for(a=0;a<this.cities.length;a++)i+=this.cities[a].popPoints.length;t.saveVersion=this.saveVersion,t.width=this.width,t.height=this.height,t.mapStats=this.mapStats,t.cities=this.cities.length,t.units=this.actors.length,t.population=i,t.cultures=this.cultures.length,t.mobs=o;var s=0;for(a=0;a<this.buildings.length;a++)this.buildings[a].cityID&&o++,s++;return t.buildings=o,t.structures=s,t.kingdoms=this.kingdoms.length,t.races=e,t},t}();a.default=g,cc._RF.pop()},{}],SelectedPowerNameTip:[function(t,e,i){"use strict";cc._RF.push(e,"7a553PKRApIvoDW4TUQBIvC","SelectedPowerNameTip");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectedPowerNameTip=void 0;var l=a("LocalizedTextManager"),c=cc._decorator,d=c.ccclass,u=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.setText=function(t){this.text.string=l.LocalizedTextManager.getGodPowerName(t)+"\n"+l.LocalizedTextManager.getGodPowerDesc(t),this.startShow()},e.prototype.startShow=function(){cc.Tween.stopAllByTarget(this.text.node),cc.tween(this.text.node).to(.2,{opacity:255}).delay(3).to(.2,{opacity:0}).start()},e.inst=null,s([u(cc.Label)],e.prototype,"text",void 0),i=s([d],e)}(cc.Component);n.SelectedPowerNameTip=h,cc._RF.pop()},{}],Setting:[function(t,e,i){"use strict";cc._RF.push(e,"082b9KonWtGp78fkLEbocxU","Setting");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Constants"),c=a("AudioMgr"),d=a("Agreement"),u=a("GamePopBase"),h=a("GameAudio"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.music=null,e.sound=null,e.prefab=null,e.ndBtn=null,e.ndMail=null,e}return r(e,t),e.prototype.onLoad=function(){this.music.isChecked=c.default.getSoundValue().isBgmOpen,this.sound.isChecked=c.default.getSoundValue().isEffectOpen,this.ndBtn.active=OPPO_GAME||VIVO_GAME||JSB_OPPO||JSB_VIVO||QQ_GAME||JSB_233||XIAOMI_GAME||JSB_IOS,this.ndMail.active=OPPO_GAME||VIVO_GAME||JSB_OPPO||JSB_VIVO||QQ_GAME||JSB_233||JSB_IOS,this.ndMail.getComponent(cc.Label).string=l.default.CHANNEL==l.CHANNEL_TYPE.\u666e\u901a?"\u5ba2\u670d\u53cd\u9988\u90ae\u7bb1\uff1a591085663@qq.com":"\u5ba2\u670d\u53cd\u9988\u90ae\u7bb1\uff1a397182874@qq.com"},e.prototype.close=function(){c.default.saveSoundData(),t.prototype.close.call(this)},e.prototype.onClickToggle=function(t){h.default.playClick(),"musicToggle"==t.node.name&&c.default.setMusicIsOpen(t.isChecked),"soundToggle"==t.node.name&&c.default.setEffectIsOpen(t.isChecked)},e.prototype.onClickPrivacy=function(t,e){var i=cc.instantiate(this.prefab);i.parent=cc.director.getScene(),i.position=cc.v3(cc.winSize.width/2,cc.winSize.height/2),i.getComponent(d.default).init(function(){},e)},s([_(cc.Toggle)],e.prototype,"music",void 0),s([_(cc.Toggle)],e.prototype,"sound",void 0),s([_(cc.Prefab)],e.prototype,"prefab",void 0),s([_(cc.Node)],e.prototype,"ndBtn",void 0),s([_(cc.Node)],e.prototype,"ndMail",void 0),s([f],e)}(u.GamePopBase);n.default=m,cc._RF.pop()},{}],SignInSystem:[function(t,e,i){"use strict";cc._RF.push(e,"389d6W5j3tKhadgCO+MVyyj","SignInSystem");var o=t,a=i,n=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var s=o("AchievData"),l=o("UserData"),c=cc._decorator,d=c.ccclass,u=(c.property,function(){function t(){this.index=0,this.signInStatus=[l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin]}var e;return e=t,t.prototype.initFromUserData=function(){this.initSystem(l.default.member.firstPlayTime,l.default.member.lastSignInTime,l.default.member.signInStatus)},t.prototype.getCurrentSignIndex=function(){return this.index},t.prototype.getTodaySignStatus=function(){return this.signInStatus[this.index]},t.prototype.getSignStatus=function(t){return this.signInStatus[t]},t.prototype.signNormal=function(t){this.signInStatus[t]<l.SignInStatus.Normal&&(this.signInStatus[t]=l.SignInStatus.Normal,l.default.member.lastSignInTime=cc.sys.now(),l.default.member.signInStatus=this.signInStatus,l.default.member.signInDays++,s.default.update(64,l.default.member.signInDays,!0),l.default.save())},t.prototype.signVideo=function(t){this.signInStatus[t]<l.SignInStatus.Video&&(this.signInStatus[t]<l.SignInStatus.Normal&&(l.default.member.signInDays++,s.default.update(64,l.default.member.signInDays,!0)),this.signInStatus[t]=l.SignInStatus.Video,l.default.member.lastSignInTime=cc.sys.now(),l.default.member.signInStatus=this.signInStatus,l.default.save())},t.prototype.gmOffsetFirstPlayDay=function(t){var e=l.default.member.firstPlayTime;if(e>0){var i=e+864e5*t;if(i<=cc.sys.now())return l.default.member.firstPlayTime=i,l.default.save(),!0}return!1},t.prototype.gmOffsetLastSignInDay=function(t){var e=l.default.member.lastSignInTime;if(e>0){var i=e+864e5*t;if(i<=cc.sys.now()&&i>=l.default.member.firstPlayTime)return l.default.member.lastSignInTime=i,l.default.save(),!0}return!1},t.prototype.initSystem=function(t,e,i){this.signInStatus=[l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin,l.SignInStatus.NotLogin];var o=t>0?new Date(t):new Date,a=e>0?new Date(e):new Date,n=new Date(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0,0),r=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0).getTime()-n.getTime(),s=Math.floor(r/864e5),c=(new Date).getTime()-n.getTime(),d=Math.floor(c/864e5);if(this.index=d%7,Math.floor(s/7)==Math.floor(d/7))for(var u=0;u<7;u++)this.signInStatus[u]=i[u];return this.signInStatus},t.prototype.getRewards=function(t,e){var i,o;void 0===e&&(e=1);var a=[];try{for(var n=r(t),s=n.next();!s.done;s=n.next()){var c=s.value,d=new l.PropConfig;d.reward=c.reward*("clock"==c.propID?1:e),d.propID=c.propID,d.propName=c.propName,a.push(d)}}catch(u){i={error:u}}finally{try{s&&!s.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return a},t.inst=new e,n([d],t)}());a.default=u,cc._RF.pop()},{}],SignInView:[function(t,e,i){"use strict";cc._RF.push(e,"4a281ipKqNFPZYhOUMLvnMO","SignInView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Constants"),c=a("UiUtil"),d=a("ShuFenReport"),u=a("AdsManager"),h=a("RewardData"),p=a("UserData"),f=a("GamePopBase"),_=a("MsgCache"),m=a("AssetManager"),g=a("ViewController"),y=a("TextureLoader"),v=a("AwardView"),b=a("SignInSystem"),w=cc._decorator,T=w.ccclass,k=w.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dayNodes=[],e.btnNormal=null,e.btnVideo=null,e.cumulative=null,e.rewardIdx=10,e.curIdx=0,e.rewards=[],e.lockIdx=[1,1,1,2,1,1,3],e}return r(e,t),e.prototype.onLoad=function(){this.btnVideo.node.active=!0,this.cumulative.active=QQ_GAME},e.prototype.start=function(){b.default.inst.initFromUserData();for(var t=0;t<7;t++)this.rewards[t]=h.default.getRewards(this.rewardIdx+t);this.updateAllUi()},e.prototype.updateAllUi=function(){this.curIdx=b.default.inst.getCurrentSignIndex();for(var t=0;t<this.dayNodes.length;t++){var e=this.dayNodes[t],i=b.default.inst.getSignStatus(t);this.fillRewards(this.rewards[t],e.getChildByName("layout")),e.getChildByName("highlight").active=t==this.curIdx,e.getChildByName("btnGet").active=t<this.curIdx&&i<p.SignInStatus.Normal,e.getChildByName("mask").active=t<=this.curIdx&&i>=p.SignInStatus.Normal}var o=b.default.inst.getSignStatus(this.curIdx);this.btnNormal.node.getChildByName("mask").active=o>=p.SignInStatus.Normal,this.btnVideo.node.getChildByName("mask").active=o>=p.SignInStatus.Video;var a=o<p.SignInStatus.Normal?"\u4e09\u500d\u9886\u53d6":"\u83b7\u53d6\u53cc\u500d";this.btnVideo.node.getChildByName("label").getComponent(cc.Label).string=a,cc.sys.platform==cc.sys.WECHAT_GAME&&this.updateBtnState()},e.prototype.fillRewards=function(t,e){for(var i=0;i<3;i++){var o=e.getChildByName("item"+i);if(o)if(i>=t.length)o.active=!1;else{o.active=!0;var a=o.getChildByName("rare");if(a.active=t[i].rare>=0,a.active){var n=y.TextureLoader.inst.getSpriteFrame(y.ATLAS_TYPE.UIATLAS,"reward/rare_"+t[i].rare);n&&(a.getComponent(cc.Sprite).spriteFrame=n)}var r=o.getChildByName("icon"),s="propIcon/"+m.default.powers.dict.get(t[i].propID).icon,l=y.TextureLoader.inst.getSpriteFrame(y.ATLAS_TYPE.UIATLAS,s);l&&(r.getComponent(cc.Sprite).spriteFrame=l),o.getChildByName("num").getComponent(cc.Label).string="X"+t[i].reward}}},e.prototype.updateBtnState=function(){var t=b.default.inst.getTodaySignStatus();this.btnNormal.node.active=t<p.SignInStatus.Normal,this.btnVideo.node.active=!this.btnNormal.node.active},e.prototype.onClickGetBack=function(t,e){c.UiUtil.btnEnabel(t),this.showVideoAndSign(parseInt(e),!1)},e.prototype.onClickSignInNormal=function(t){c.UiUtil.btnEnabel(t),b.default.inst.signNormal(this.curIdx),this.getRewards(this.curIdx,1),d.default.reportCustom("signInNormal")},e.prototype.onClickSignInVideo=function(t){c.UiUtil.btnEnabel(t),this.showVideoAndSign(this.curIdx,!0)},e.prototype.getRewards=function(t,e){void 0===e&&(e=1),this.updateAllUi();var i=b.default.inst.getRewards(this.rewards[t],e);g.default.open(g.view_type.AwardView,null,null,!0,function(t){t.getComponent(v.default).init(v.Reward_type.sign,i)})},e.prototype.showVideoAndSign=function(t,e){var i=this;l.default.REPORT_ID="signInVideo",u.default.showVideoAds(function(o){if(1==o){var a=b.default.inst.getTodaySignStatus()<p.SignInStatus.Normal?3:2;e?b.default.inst.signVideo(t):b.default.inst.signNormal(t),i.getRewards(t,e?a:1)}else{var n=0==o?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";_.default.pushToast(n)}})},s([k({type:[cc.Node],tooltip:"1-7\u5929\u7684\u8282\u70b9"})],e.prototype,"dayNodes",void 0),s([k({type:cc.Button,tooltip:"\u666e\u901a\u7b7e\u5230"})],e.prototype,"btnNormal",void 0),s([k({type:cc.Button,tooltip:"\u89c6\u9891\u7b7e\u5230"})],e.prototype,"btnVideo",void 0),s([k(cc.Node)],e.prototype,"cumulative",void 0),s([T],e)}(f.GamePopBase);n.default=B,cc._RF.pop()},{}],Smoke:[function(t,e,i){"use strict";cc._RF.push(e,"11632At5CFKCpUnOrPk16iY","Smoke");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseEffect"),c=a("MapBox"),d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer_scale=0,e}return r(e,t),e.prototype.logicUpdate=function(){this.timer_scale>0?this.timer_scale-=c.default.inst.elapsed:(this.timer_scale=.01,this.setAlpha(this.alpha-.01),this.alpha<=0?this.controller.killObject(this):(this.node.scaleX<4&&(this.node.scale+=.03),this.node.position=cc.v3(this.node.x+.5*c.default.inst.wind_direction.x,this.node.y+.5*c.default.inst.wind_direction.y)))},s([u],e)}(l.default));n.default=h,cc._RF.pop()},{}],SmoothLoader:[function(t,e,i){"use strict";cc._RF.push(e,"fe069pTja1K8JhspnFhPA88","SmoothLoader");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.MapLoaderContainer=void 0;var a=function(t,e,i){void 0===i&&(i=!0),this.action=null,this.id="",this.debug_log=!0,this.action=t,this.id=e,this.debug_log=i};o.MapLoaderContainer=a;var n=function(){function t(){}return t.prepare=function(){t._actions=[],t._index=0,t._started=!1,t._have_actions=!1,t.latest_called_id="",t.latest_time=""},t.add=function(e,i,o){void 0===o&&(o=!1),t._have_actions=!0,t._started?(o&&t._actions.splice(t._index+1+t._added++,0,new a(t.skipFrame,"skipFrame",!1)),t._actions.splice(t._index+1+t._added++,0,new a(e,i))):(o&&t._actions.push(new a(t.skipFrame,"skipFrame",!1)),t._actions.push(new a(e,i)))},t.setTimerTo01=function(){t._current_timer=.001},t.skipFrame=function(){t._skip_frame=!0},t.isLoading=function(){return t._have_actions},t.logicUpdate=function(e){if(t._have_actions)if(0!=t._actions.length)if(t._current_timer>0)t._current_timer-=e;else{t._skip_frame=!1;var i=cc.sys.now()/1e3;for(t.doActions();cc.sys.now()/1e3-i<.1&&!t._skip_frame&&0!=t._actions.length;)t.doActions();t.setTimerTo01()}else t._have_actions=!1},t.doActions=function(){t._started=!0,t._added=0,t._actions[t._index].action(),t._index++,t._index>t._actions.length-1&&t.prepare()},t._index=0,t._current_timer=0,t._skip_frame=!1,t._added=0,t._started=!1,t._have_actions=!1,t._actions=[],t.latest_called_id="",t.latest_time="",t}();o.default=n,cc._RF.pop()},{}],SpawnEffect:[function(t,e,i){"use strict";cc._RF.push(e,"66f1d6ld81CVZAV7F4CHeU9","SpawnEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SpriteAnimation"),c=a("AssetManager"),d=a("BaseEffect"),u=a("MapBox"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._event="",e._animation=null,e._eventUsed=!1,e._tile=null,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this._animation=this.getComponent(l.SpriteAnimation)},e.prototype.logicUpdate=function(e){if(t.prototype.logicUpdate.call(this,e),!this._eventUsed&&14==this._animation.currentFrameIndex&&(this._eventUsed=!0,"crabzilla"==this._event)){var i=c.default.powers.get("crabzilla");u.default.inst.createNewUnit(i.actorStatsId,this._tile,"",i.actorSpawnHeight)}},e.prototype.setEvent=function(t,e){this._tile=e,this._eventUsed=!1,this._event=t},s([p],e)}(d.default));n.default=f,cc._RF.pop()},{}],SpellLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"a7ee9T+awBO3KQEwkoCvxjY","SpellLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.Spell=n.CastEntity=n.CastTarget=void 0;var s,l,c=a("WorldAction"),d=a("ActionLibrary"),u=a("AssetLibrary");(function(t){t[t.Enemy=0]="Enemy",t[t.Himself=1]="Himself",t[t.Region=2]="Region",t[t.Friendly=3]="Friendly"})(s=n.CastTarget||(n.CastTarget={})),function(t){t[t.UnitsOnly=0]="UnitsOnly",t[t.BuildingsOnly=1]="BuildingsOnly",t[t.Both=2]="Both",t[t.Tile=3]="Tile"}(l=n.CastEntity||(n.CastEntity={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.healthPercent=0,e.chance=1,e.min_distance=0,e.castEntity=l.Both,e.action=c.default.create(),e}return r(e,t),e}(u.Asset);n.Spell=h;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new h;e.id="teleportRandom",e.chance=.7,e.castTarget=s.Himself,e.healthPercent=.6,this.add(e),this.t.action.add(d.default.teleportRandom);var i=new h;i.id="lightning",i.chance=.3,i.min_distance=6,this.add(i),this.t.action.add(d.default.castLightning);var o=new h;o.id="tornado",o.chance=.02,o.min_distance=9,this.add(o),this.t.action.add(d.default.castTornado);var a=new h;a.id="curse",a.chance=.2,a.min_distance=4,a.castEntity=l.UnitsOnly,this.add(a),this.t.action.add(d.default.castCurses);var n=new h;n.id="fire",n.chance=.2,n.min_distance=3,n.castEntity=l.Both,this.add(n),this.t.action.add(d.default.castFire);var r=new h;r.id="bloodRain",r.chance=.5,r.min_distance=0,r.healthPercent=.9,r.castTarget=s.Himself,r.castEntity=l.UnitsOnly,this.add(r),this.t.action.add(d.default.castBloodRain);var c=new h;c.id="spawnGrassSeeds",c.chance=1,c.min_distance=0,c.castTarget=s.Region,c.castEntity=l.Tile,this.add(c),this.t.action.add(d.default.castSpawnGrassSeeds);var u=new h;u.id="spawnSkeleton",u.chance=.6,u.min_distance=0,u.castTarget=s.Himself,this.add(u),this.t.action.add(d.default.castSpawnSkeleton);var p=new h;p.id="shield",p.chance=.2,p.castTarget=s.Himself,this.add(p),this.t.action.add(d.default.castShieldOnHimself);var f=new h;f.id="cure",f.chance=1,f.min_distance=0,f.castTarget=s.Friendly,f.castEntity=l.UnitsOnly,this.add(f),this.t.action.add(d.default.castCure)},e}(u.default);n.default=p,cc._RF.pop()},{}],SpriteAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"66280Z5cStPlZzS9AgYFCHW","SpriteAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.SpriteAnimation=n.AnimPlayType=void 0;var l,c=a("GameCommon"),d=a("ToolBox");(function(t){t[t.Forward=0]="Forward",t[t.Backward=1]="Backward"})(l=n.AnimPlayType||(n.AnimPlayType={}));var u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ignorePause=!0,e.isOn=!0,e.timeBetweenFrames=.1,e.nextFrameTime=0,e.playType=l.Forward,e.currentFrameIndex=0,e.looped=!0,e.returnToPool=!1,e.frames=[],e.dirty=!1,e.frameCount=0,e.spriteRenderer=null,e.stopFrameTrigger=!1,e.currentSpriteGraphic=null,e.inited=!1,e}return r(e,t),e.prototype.onLoad=function(){this.create()},e.prototype.create=function(){this.inited||(this.frameCount=this.frames.length,this.spriteRenderer=this.getComponent(cc.Sprite),this.nextFrameTime=this.timeBetweenFrames,this.inited=!0)},e.prototype.stopAnimations=function(){this.isOn=!1},e.prototype.setFrames=function(t){this.frames!=t&&(this.frames=t,this.frameCount=t.length,this.currentFrameIndex>=this.frameCount&&(this.currentFrameIndex=0),this.updateFrame())},e.prototype.isLastFrame=function(){return this.currentFrameIndex>=this.frames.length-1},e.prototype.isFirstFrame=function(){return 0==this.currentFrameIndex},e.prototype.logicUpdate=function(t){if(this.dirty)this.dirty=!1,this.forceUpdateFrame();else if(this.isOn){if(c.default.isPaused&&!this.ignorePause)return;if(this.nextFrameTime>0)return void(this.nextFrameTime-=t);if(this.nextFrameTime=this.timeBetweenFrames,this.playType==l.Forward)if(this.currentFrameIndex+1>=this.frameCount){if(this.returnToPool&&(e=this.getComponent("BaseEffect")))return void e.kill();if(!this.looped)return;this.currentFrameIndex=0}else this.currentFrameIndex++;else if(this.currentFrameIndex-1<0){var e;if(this.returnToPool&&(e=this.getComponent("BaseEffect")))return void e.kill();if(!this.looped)return;this.currentFrameIndex=this.frames.length-1}else this.currentFrameIndex--;this.updateFrame()}else this.stopFrameTrigger&&(this.stopFrameTrigger=!1,this.updateFrame())},e.prototype.stopAt=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),this.isOn=!1,this.currentFrameIndex=t,e?this.updateFrame():this.stopFrameTrigger=!0},e.prototype.forceUpdateFrame=function(){this.updateFrame()},e.prototype.setRandomFrame=function(){this.currentFrameIndex=d.Toolbox.randomInt(0,this.frames.length),this.updateFrame()},e.prototype.setFrameIndex=function(t){this.currentFrameIndex=t,this.updateFrame()},e.prototype.updateFrame=function(){var t=this.frames[this.currentFrameIndex];t&&this.currentSpriteGraphic!=t&&(this.currentSpriteGraphic=t,this.applyCurrentSpriteGraphics(t))},e.prototype.applyCurrentSpriteGraphics=function(t){this.spriteRenderer&&(this.spriteRenderer.spriteFrame=t)},e.prototype.getCurrentGraphics=function(){return this.currentSpriteGraphic},e.prototype.resetAnim=function(){this.nextFrameTime=this.timeBetweenFrames,this.currentFrameIndex=0,this.updateFrame()},s([p({tooltip:"\u9ed8\u8ba4true"})],e.prototype,"ignorePause",void 0),s([p({tooltip:"\u9ed8\u8ba4true"})],e.prototype,"isOn",void 0),s([p({tooltip:"\u9ed8\u8ba40.1"})],e.prototype,"timeBetweenFrames",void 0),s([p({tooltip:"\u9ed8\u8ba40"})],e.prototype,"nextFrameTime",void 0),s([p({type:cc.Enum(l)})],e.prototype,"playType",void 0),s([p({tooltip:"\u9ed8\u8ba40"})],e.prototype,"currentFrameIndex",void 0),s([p({tooltip:"\u9ed8\u8ba4true"})],e.prototype,"looped",void 0),s([p({tooltip:"\u9ed8\u8ba4false"})],e.prototype,"returnToPool",void 0),s([p({type:[cc.SpriteFrame],tooltip:""})],e.prototype,"frames",void 0),s([p({tooltip:"\u9ed8\u8ba4false"})],e.prototype,"dirty",void 0),s([h],e)}(cc.Component);n.SpriteAnimation=f,cc._RF.pop()},{}],StackEffects:[function(t,e,i){"use strict";cc._RF.push(e,"6ce38TUWhBKipkj2aDcaPwk","StackEffects");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SpriteAnimation"),c=a("BaseEffect"),d=a("BaseMapObject"),u=a("ToolBox"),h=a("GameAudio"),p=a("MapBox"),f=a("TextureLoader"),_=a("AntimatterBombEffect"),m=a("BaseEffectController"),g=a("NapalmFlash"),y=a("NukeFlash"),v=a("Projectile"),b=a("SpawnEffect"),w=a("StatusParticle"),T=cc._decorator,k=T.ccclass,B=T.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prefabBasic=null,e.prefabFireballExplosion=null,e.prefabLightning=null,e.prefabSpawn=null,e.prefabSpawnBig=null,e.prefabExplosionSmall=null,e.prefabExplosionNuke=null,e.prefabExplosionWave=null,e.prefabFireworks1=null,e.prefabFireworks2=null,e.prefabNukeFlash=null,e.prefabBoulderImpact=null,e.prefabBoulderImpactWater=null,e.prefabAntimatter=null,e.prefabFireSmoke=null,e.prefabNapalmFlash=null,e.prefabEffectInfinityCoin=null,e.prefabStatusParticle=null,e.prefabSlashEffect=null,e.prefabProjectile=null,e.prefabMiss=null,e.prefabHit=null,e.prefabHitCritical=null,e.boatExplosion=null,e.fx_fishnet=null,e.dictionary=new Map,e.list=[],e.timeOutFireworks=0,e}return r(e,t),e.prototype.onLoad=function(){this.dictionary=new Map,this.list=[],this.loadEffect("fx_cast_ground_blue",!0,.1,"EffectsBack"),this.loadEffect("fx_cast_top_blue"),this.loadEffect("fx_cast_ground_red",!0,.1,"EffectsBack"),this.loadEffect("fx_cast_top_red"),this.loadEffect("fx_cast_ground_green",!0,.1,"EffectsBack"),this.loadEffect("fx_cast_top_green"),this.loadEffect("fx_create_skeleton",!0,.1,"EffectsTop",0),this.loadEffect("fx_teleport_blue",!0,.1,"EffectsTop",0),this.loadEffect("fx_teleport_red",!0,.1,"EffectsTop",0),this.loadEffect("fx_shield_hit",!0,.1,"EffectsTop",200),this.loadEffect("fx_bad_place",!0,.1,"EffectsBack",10),this.loadEffect("fx_plasma_trail",!0,.1,"EffectsTop",15),this.loadEffect("fx_enchanted_sparkle",!0,.1,"EffectsBack",15),this.add(this.prefabFireSmoke,"fireSmoke"),this.add(this.prefabLightning,"lightning",100),this.add(this.prefabSpawn,"spawn"),this.add(this.prefabSpawnBig,"spawn_big"),this.add(this.prefabExplosionSmall,"explosionSmall"),this.add(this.prefabExplosionNuke,"explosionNuke"),this.add(this.prefabExplosionWave,"explosionWave"),this.add(this.prefabFireworks1,"fireworks1"),this.add(this.prefabFireworks2,"fireworks2"),this.add(this.prefabNukeFlash,"nukeFlash"),this.add(this.prefabNapalmFlash,"napalmFlash"),this.add(this.prefabBoulderImpact,"boulderImpact"),this.add(this.prefabBoulderImpactWater,"boulderImpactWater"),this.add(this.prefabAntimatter,"antimatterEffect"),this.add(this.prefabEffectInfinityCoin,"infinityCoin"),this.add(this.prefabStatusParticle,"statusParticle",10),this.add(this.prefabProjectile,"projectile"),this.add(this.prefabFireballExplosion,"fireballExplosion"),this.add(this.prefabSlashEffect,"slash",20),this.add(this.prefabMiss,"miss",20),this.add(this.prefabHit,"hit",10),this.add(this.prefabHitCritical,"hitCritical",10),this.add(this.boatExplosion,"boatExplosion",20),this.add(this.fx_fishnet,"fx_fishnet",20)},e.prototype.isLocked=function(){return this.get("spawn_big").list.length>0},e.prototype.get=function(t){return this.dictionary.get(t)},e.prototype.loadEffect=function(t,e,i,o,a){void 0===e&&(e=!0),void 0===i&&(i=.1),void 0===o&&(o="EffectsTop"),void 0===a&&(a=60);var n=cc.instantiate(this.prefabBasic);if(n.parent=this.node,n.name=t,n.active=!1,e){var r=n.getComponent(l.SpriteAnimation);r.timeBetweenFrames=i,r.frames=Array.from(f.TextureLoader.inst.getSpriteFrames(f.ATLAS_TYPE.WORLDATLAS,"effects/"+t+"_t").values())}var s=this.add(this.prefabBasic,t,a);s.addNewObject(n.getComponent(c.default)),s.node.parent=this.node,s.node.active=!0},e.prototype.add=function(t,e,i){void 0===i&&(i=0);var o=(new cc.Node).addComponent(m.default);return o.create(),o.node.parent=this.node,o.node.name=e,o.prefab=t,o.objectLimit=i,this.dictionary.set(e,o),this.list.push(o),o},e.prototype.clear=function(){for(var t=0;t<this.list.length;t++)this.list[t].clear()},e.prototype.spawnEffect=function(){},e.prototype.logicUpdate=function(){for(var t=0;t<this.list.length;t++)this.list[t].logicUpdate(p.default.inst.elapsed);this.timeOutFireworks>0&&(this.timeOutFireworks-=cc.director.getDeltaTime())},e.prototype.startSpawnEffect=function(t,e){return void 0===e&&(e="spawn"),this.get(e).spawnAt(t,.25)},e.prototype.startBigSpawn=function(t){var e;return null===(e=this.get("spawn_big").spawnAt(t))||void 0===e?void 0:e.getComponent(b.default)},e.prototype.slash=function(t,e,i){if(!p.default.inst.qualityChanger.lowRes){var o=this.get("slash").spawnAt(t,.098);o&&(o.getComponent(l.SpriteAnimation).setFrames(Array.from(f.TextureLoader.inst.getSpriteFrames(f.ATLAS_TYPE.WORLDATLAS,"effects/slashes/slash_"+e).values())),o.node.angle=i)}},e.prototype.startProjectile=function(t,e,i,o){void 0===o&&(o=0);var a=this.get("projectile").spawnNew();if(!a)return null;var n=a.getComponent(v.default);return n.begin(t,e,i,o),n},e.prototype.spawnAntimatterEffect=function(t){var e;null===(e=this.get("antimatterEffect").spawnNew())||void 0===e||e.getComponent(_.default).spawn(t)},e.prototype.spawnNukeFlash=function(t,e){var i;null===(i=this.get("nukeFlash").spawnNew())||void 0===i||i.getComponent(y.default).spawnFlash(t,e)},e.prototype.spawnNapalmFlash=function(t,e){var i;null===(i=this.get("napalmFlash").spawnNew())||void 0===i||i.getComponent(g.default).spawnFlash(t,e)},e.prototype.spawnStatusParticle=function(t,e){var i;null===(i=this.get("statusParticle").spawnNew())||void 0===i||i.getComponent(w.default).spawnParticle(t,e)},e.prototype.spawnFireworks=function(t,e){if(void 0===e&&(e=.05),!(this.timeOutFireworks>0)){this.timeOutFireworks=e;var i=(u.Toolbox.randomBool()?this.get("fireworks1"):this.get("fireworks2")).spawnAtRandomScale(t,.3),o=u.Toolbox.randomBool()?1:-1;i.sprRenderer.node.scaleX*=o;var a=cc.color(u.Toolbox.randomFloat(0,255),u.Toolbox.randomFloat(0,255),u.Toolbox.randomFloat(0,255),255);i.sprRenderer.node.color=a,i.node.angle=u.Toolbox.randomFloat(-15,15),h.default.playFireworks()}},s([B(cc.Prefab)],e.prototype,"prefabBasic",void 0),s([B(cc.Prefab)],e.prototype,"prefabFireballExplosion",void 0),s([B(cc.Prefab)],e.prototype,"prefabLightning",void 0),s([B(cc.Prefab)],e.prototype,"prefabSpawn",void 0),s([B(cc.Prefab)],e.prototype,"prefabSpawnBig",void 0),s([B(cc.Prefab)],e.prototype,"prefabExplosionSmall",void 0),s([B(cc.Prefab)],e.prototype,"prefabExplosionNuke",void 0),s([B(cc.Prefab)],e.prototype,"prefabExplosionWave",void 0),s([B(cc.Prefab)],e.prototype,"prefabFireworks1",void 0),s([B(cc.Prefab)],e.prototype,"prefabFireworks2",void 0),s([B(cc.Prefab)],e.prototype,"prefabNukeFlash",void 0),s([B(cc.Prefab)],e.prototype,"prefabBoulderImpact",void 0),s([B(cc.Prefab)],e.prototype,"prefabBoulderImpactWater",void 0),s([B(cc.Prefab)],e.prototype,"prefabAntimatter",void 0),s([B(cc.Prefab)],e.prototype,"prefabFireSmoke",void 0),s([B(cc.Prefab)],e.prototype,"prefabNapalmFlash",void 0),s([B(cc.Prefab)],e.prototype,"prefabEffectInfinityCoin",void 0),s([B(cc.Prefab)],e.prototype,"prefabStatusParticle",void 0),s([B(cc.Prefab)],e.prototype,"prefabSlashEffect",void 0),s([B(cc.Prefab)],e.prototype,"prefabProjectile",void 0),s([B(cc.Prefab)],e.prototype,"prefabMiss",void 0),s([B(cc.Prefab)],e.prototype,"prefabHit",void 0),s([B(cc.Prefab)],e.prototype,"prefabHitCritical",void 0),s([B(cc.Prefab)],e.prototype,"boatExplosion",void 0),s([B(cc.Prefab)],e.prototype,"fx_fishnet",void 0),s([k],e)}(d.default);n.default=S,cc._RF.pop()},{}],StaticGrid:[function(t,e,i){"use strict";cc._RF.push(e,"26f26dTQnFMBK9CfO1uvca1","StaticGrid");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.ASNode=o.DiagonalMovement=void 0,function(t){t[t.Always=0]="Always",t[t.Never=1]="Never",t[t.IfAtLeastOneWalkable=2]="IfAtLeastOneWalkable",t[t.OnlyWhenNoObstacles=3]="OnlyWhenNoObstacles"}(o.DiagonalMovement||(o.DiagonalMovement={}));var a=function(){function t(t,e,i){void 0===i&&(i=!1),this.tile=null,this.x=0,this.y=0,this.walkable=!1,this.cost=0,this.heuristicStartToEndLen=0,this.startToCurNodeLen=0,this.heuristicCurNodeToEndLen=0,this.isOpened=!1,this.isClosed=!1,this.parent=null,this.x=t,this.y=e,this.walkable=i,this.heuristicStartToEndLen=0,this.startToCurNodeLen=0,this.heuristicCurNodeToEndLen=null,this.isOpened=!1,this.isClosed=!1,this.parent=null,this.cost=1}return t.prototype.reset=function(t){void 0===t&&(t=!1),this.walkable=t,this.heuristicStartToEndLen=0,this.startToCurNodeLen=0,this.heuristicCurNodeToEndLen=null,this.isOpened=!1,this.isClosed=!1,this.parent=null,this.cost=1},t.prototype.compareTo=function(t){var e=this.heuristicStartToEndLen-t.heuristicStartToEndLen;return e>0?1:0==e?0:-1},t.prototype.equals=function(t){return!!t&&this.x==t.x&&this.y==t.y},t}();o.ASNode=a;var n=function(){function t(e,i,o){void 0===o&&(o=[]),this.m_nodes=[],this.closedList=[],this.closed_list_count=0,this.CLOSED_LIST_MINIMUM_ELEMENTS=10,this.m_gridRect=new cc.Rect,this._width=0,this._height=0,this.width=e,this.height=i,this.m_gridRect.xMin=0,this.m_gridRect.yMin=0,this.m_gridRect.xMax=e-1,this.m_gridRect.yMax=i-1,this.m_nodes=t.buildNodes(e,i,o)}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),t.buildNodes=function(t,e,i){for(var o=[],n=0;n<t;n++){o[n]=[];for(var r=0;r<e;r++)o[n][r]=new a(n,r)}if(null==i||0==i.length)return o;if(i.length!=t||i[0].length!=e)throw new Error("Matrix size does not fit!");for(var s=0;s<t;s++)for(var l=0;l<e;l++)o[s][l].walkable=i[s][l];return o},t.prototype.getNodeAt=function(t,e){return this.m_nodes[t][e]},t.prototype.isWalkableAt=function(t,e){return!!this.isInside(t,e)&&this.m_nodes[t][e].walkable},t.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},t.prototype.setWalkableAt=function(t,e,i,o){return void 0===o&&(o=1),this.m_nodes[t][e].walkable=i,this.m_nodes[t][e].cost=o,!0},t.prototype.setTileNode=function(t,e,i){this.m_nodes[t][e].tile=i},t.prototype.addToClosed=function(t){this.closedList.push(t),this.closed_list_count++},t.prototype.reset=function(){for(var t=0;t<this.closedList.length;t++)this.closedList[t].reset();this.closedList=[],this.closed_list_count=0},t}();o.default=n,cc._RF.pop()},{}],StatsData:[function(t,e,i){"use strict";cc._RF.push(e,"f2d87MYJpJBZ7NuMHV9Gf8o","StatsData");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.GameStatsData=void 0,o.GameStatsData=function(){this.gameTime=0,this.treesGrown=0,this.treesDeath=0,this.meteoritesLaunched=0,this.pixelsExploded=0,this.creaturesBorn=0,this.creaturesCreated=0,this.creaturesDied=0,this.gameLaunches=0,this.bombsDropped=0,this.infectedZombie=0},cc._RF.pop()},{}],StatsHelper:[function(t,e,i){"use strict";cc._RF.push(e,"33eca8bWiZOMp/9BRZU/shQ","StatsHelper");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("Log"),r=o("LocalizedTextManager"),s=o("AssetManager"),l=o("BaseBuilding"),c=o("MapBox"),d=o("ToolBox"),u=function(){function t(){}return t.getStatistic=function(e){var i,o=0,a="",u=c.default.inst,h=c.default.inst.gameStats;switch(e){case"world_name":a=null!==(i=u.mapStats.name)&&void 0!==i?i:"";break;case"world_statistics_infected":u.units.list.forEach(function(t){t.isInfectedWithAnything()&&o++}),a+=o;break;case"world_statistics_time":a="y:"+(u.mapStats.year+1)+", m:"+(u.mapStats.month+1);break;case"world_statistics_population":a+=u.getCivWorldPopulation();break;case"world_statistics_beasts":u.units.list.forEach(function(t){t.stats.unit||o++}),a+=o;break;case"world_statistics_deaths_total":a+=u.mapStats.deaths;break;case"world_statistics_deaths_natural":a+=u.mapStats.deaths_age;break;case"world_statistics_deaths_hunger":a+=u.mapStats.deaths_hunger;break;case"world_statistics_deaths_eaten":a+=u.mapStats.deaths_eaten;break;case"world_statistics_deaths_plague":a+=u.mapStats.deaths_plague;break;case"world_statistics_deaths_other":a+=u.mapStats.deaths_other;break;case"world_statistics_trees":var p=0;u.buildings.list.forEach(function(t){var e;(null===(e=t.stats)||void 0===e?void 0:e.buildingType)==l.BuildingType.Tree&&p++}),a+=p;break;case"houses":return"0"==t.getStatistic("world_statistics_houses")?"":(a=(a=r.LocalizedTextManager.getText("world_statistics_houses_all")).replace("$houses$",t.getStatistic("world_statistics_houses"))).replace("$destroyed$",t.getStatistic("world_statistics_houses_destroyed"));case"world_statistics_houses":var f=0;u.buildings.list.forEach(function(t){var e;(null===(e=t.stats)||void 0===e?void 0:e.cityBuilding)&&f++}),a+=f;break;case"world_statistics_houses_destroyed":a+=u.mapStats.housesDestroyed;break;case"most_popular_race":var _=0,m=null;if(s.default.raceLibrary.list.forEach(function(t){t.units.count>_&&(m=t,_=t.units.count)}),0==_||!m)return"";a=r.LocalizedTextManager.getText("world_statistics_most_popular_race");var g=m.nameLocale;return g||(g=m.units.list.getRandom().stats.nameLocale),g?(a=a.replace("$race$",r.LocalizedTextManager.getText(g))).replace("$units$",""+_):(n.default.d("no name found for "+m),"");case"kingdoms_villages":return"0"==t.getStatistic("kingdoms")&&"0"==t.getStatistic("villages")?"":r.LocalizedTextManager.getText("kingdoms")+": "+t.getStatistic("kingdoms")+"/"+r.LocalizedTextManager.getText("villages")+": "+t.getStatistic("villages");case"villages":return""+u.citiesList.length;case"kingdoms":return""+u.kingdoms.list_civs.length;case"races":var y=0,v=0,b=0,w=0;return u.units.list.forEach(function(t){"human"==t.race.id&&y++,"elf"==t.race.id&&v++,"orc"==t.race.id&&b++,"dwarf"==t.race.id&&w++}),"H:"+y+" E:"+v+" O:"+b+" D:"+w;case"world_statistics_biggest_village":var T=null;u.citiesList.forEach(function(t){(null==T||t.zones.length>T.zones.length)&&(T=t)}),a=null!=T?T.data.cityName+" ["+T.zones.length+"]":"?";break;case"world_statistics_most_populated_village":var k=null;u.citiesList.forEach(function(t){(null==k||t.getPopulationTotal()>k.getPopulationTotal())&&(k=t)}),a=null!=k?k.data.cityName+" ["+k.getPopulationTotal()+"]":"?";break;case"world_statistics_islands":a+=u.islandsCalculator.countLandIslands();break;case"statistics_total_playtime":a=d.Toolbox.formatTimer(h.gameTime);break;case"statistics_trees_grown":a+=h.treesGrown;break;case"statistics_meteorites_launched":a+=h.meteoritesLaunched;break;case"statistics_pixels_exploded":a+=h.pixelsExploded;break;case"statistics_creatures_created":a+=h.creaturesCreated;break;case"statistics_creatures_died":a+=h.creaturesDied;break;case"statistics_bombs_dropped":a+=h.bombsDropped}return a},t}();a.default=u,cc._RF.pop()},{}],StatusLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"fe0c6atW/5E87Xy8aQL8bPc","StatusLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("ActorAsset"),l=a("ToolBox"),c=a("ActiveStatusEffect"),d=a("MapBox"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this);var i=new c.StatusEffect;i.id="powerup",i.duration=300,i.animated=!0,this.add(i),this.t.baseStats.size=3,this.t.baseStats.armor=5,this.t.baseStats.damage=5,this.t.baseStats.attackSpeed=5,this.t.baseStats.mod_damage=50,this.t.baseStats.mod_armor=50,this.t.baseStats.mod_attackSpeed=50,this.t.baseStats.mod_crit=50,this.t.baseStats.scale=.1,this.t.baseStats.size=2;var o=new c.StatusEffect;o.id="slowness",o.texture="fx_status_slowness_t",o.duration=30,o.animated=!0,this.add(o),this.t.baseStats.speed-=100,this.t.baseStats.attackSpeed=-50,this.t.removeStatus.push("caffeinated");var a=new c.StatusEffect;a.id="caffeinated",a.texture="fx_status_caffeinated_t",a.duration=60,a.animated=!0,this.add(a),this.t.baseStats.intelligence=222,this.t.baseStats.speed=200,this.t.baseStats.mod_attackSpeed=569,this.t.removeStatus.push("frozen");var n=new c.StatusEffect;n.id="frozen",n.texture="fx_status_frozen_t",n.duration=7,n.random_frame=!0,this.add(n),this.t.baseStats.knockbackReduction=100,this.t.baseStats.armor=-20,this.t.baseStats.speed=-1e7,this.t.baseStats.attackSpeed=-1e7,this.t.removeStatus.push("burning"),this.t.oppositeStatus.push("shield"),this.t.oppositeTraits.push("freeze_proof"),this.t.oppositeTraits.push("ancestor");var r=new c.StatusEffect;r.id="shield",r.texture="fx_status_shield_t",r.duration=60,r.animated=!0,this.add(r),this.t.baseStats.knockbackReduction=100,this.t.baseStats.armor=90,this.t.removeStatus.push("burning"),this.t.oppositeStatus.push("frozen"),this.t.actionOnHit.add(e.spawnShieldHitEffect);var s=new c.StatusEffect;s.id="burning",s.texture="fx_status_burning_t",s.duration=60,s.action.add(e.burningEffect),s.actionInterval=2,s.animated=!0,s.animation_speed=.1,s.animation_speed_random=.08,s.random_frame=!0,s.random_flip=!0,s.cancelActorJob=!0,this.add(s),this.t.oppositeStatus.push("shield"),this.t.oppositeTraits.push("ancestor"),this.t.oppositeTraits.push("fire_proof"),this.t.removeStatus.push("frozen");var l=new c.StatusEffect;l.id="poisoned",l.duration=90,l.action.add(e.poisonedEffect),l.actionInterval=1,this.add(l),this.t.oppositeTraits.push("immune_poison"),this.t.oppositeTraits.push("ancestor");var d=new c.StatusEffect;d.id="ancestor",d.texture="fx_status_shield_t",d.duration=1e4,d.animated=!0,this.add(d),this.t.baseStats.knockbackReduction=100,this.t.baseStats.armor=100,this.t.removeStatus.push("burning"),this.t.removeStatus.push("frozen"),this.t.removeStatus.push("poisoned"),this.t.actionOnHit.add(e.spawnShieldHitEffect)},e.burningEffect=function(t,e){void 0===e&&(e=null),t.isActor()&&t.a.stats.have_skin&&l.Toolbox.randomBool()&&t.a.addTrait("skin_burns");var i=.1*t.curStats.health+1;return t.getHit(i,!0,s.AttackType.Fire),!d.default.inst.qualityChanger.lowRes&&l.Toolbox.randomChance(.1)&&d.default.inst.particlesFire.spawn(t.currentPosition.x,t.currentPosition.y,!0),!0},e.spawnShieldHitEffect=function(t,e){if(void 0===e&&(e=null),d.default.inst.qualityChanger.lowRes)return!1;var i=d.default.inst.stackEffects.get("fx_shield_hit").spawnAt(t.currentPosition,t.curStats.scale);return!!i&&(i.node.parent=t.a.node,i.node.position=cc.Vec3.ZERO,!0)},e.poisonedEffect=function(t,e){return void 0===e&&(e=null),l.Toolbox.randomBool()&&t.a.data.health>1&&t.getHit(1,!0,s.AttackType.Poison),t.a.spawnParticle(l.Toolbox.color_infected),t.a.startShake(.4,.2,!0,!1),!0},e}(a("AssetLibrary").default);n.default=u,cc._RF.pop()},{}],StatusParticle:[function(t,e,i){"use strict";cc._RF.push(e,"6110aF89itPupKDWywKGdX4","StatusParticle");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseEffect"),c=cc._decorator,d=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.spawnParticle=function(e,i,o){void 0===o&&(o=.25),t.prototype.prepare.call(this,e,o),this.node.color=i},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.setScale(this.scale-.2*e),this.scale<=0&&this.kill()},s([d],e)}(l.default));n.default=u,cc._RF.pop()},{}],StoreView:[function(t,e,i){"use strict";cc._RF.push(e,"678afj9/b9BC6rcPfCBQNiM","StoreView");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("UserData"),d=a("GamePopBase"),u=a("MsgCache"),h=a("AssetManager"),p=a("TextureLoader"),f=cc._decorator,_=f.ccclass,m=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jsonData=null,e.pbItem=null,e.btnUnAll=null,e.saleNode=[],e.coinNums=[],e.pageview=null,e.giftName=null,e.btnGift=null,e.btnPrevious=null,e.btnNext=null,e.giftSet=new Set,e}return r(e,t),e.prototype.onLoad=function(){this.btnUnAll.interactable=!c.default.member.unLockAll,this.initSale(),this.initGift(),this.updateCoin(),cc.director.on("updateProp",this.updateCoin,this)},e.prototype.onDestroy=function(){cc.director.off("updateProp")},e.prototype.updateCoin=function(){this.coinNums.forEach(function(t){t.string=c.default.getPropByID("coins").number.toString()})},e.prototype.initSale=function(){var t=(new Date).toLocaleDateString();null==c.default.member.daySales[t]&&(c.default.member.daySales={},c.default.member.daySales[t]=c.default.getUnLockProp(6));for(var e=0;e<6;e++){var i=this.saleNode[e],o=c.default.member.daySales[t][e],a=c.default.getPropConfigByID(o.propID),n=i.getChildByName("icon"),r="propIcon/"+h.default.powers.dict.get(o.propID).icon,s=p.TextureLoader.inst.getSpriteFrame(p.ATLAS_TYPE.UIATLAS,r);s&&(n.getComponent(cc.Sprite).spriteFrame=s),i.getChildByName("num").getComponent(cc.Label).string="X"+a.reward,i.getChildByName("name").getComponent(cc.Label).string=a.propName,i.getChildByName("price").getComponent(cc.Label).string=a.coin+"",i.getChildByName("price_sale").getComponent(cc.Label).string=a.coin/2+""}},e.prototype.initGift=function(){var t,e,i=this;this.giftSet.clear(),this.pageview.removeAllPages();var o=this.jsonData.json["\u793c\u5305"];o.forEach(function(t){c.default.member.storeGift[t.name]||i.giftSet.add(t)}),o.forEach(function(t){i.giftSet.add(t)});try{for(var a=l(this.giftSet),n=a.next();!n.done;n=a.next()){for(var r=n.value,s=cc.instantiate(this.pbItem),d=0;d<r.goods.length;d++){var u=cc.find("node/item"+d,s);u.active=!0;var f=c.default.getPropConfigByID(r.goods[d].id),_=u.getChildByName("icon"),m="propIcon/"+h.default.powers.dict.get(f.propID).icon,g=p.TextureLoader.inst.getSpriteFrame(p.ATLAS_TYPE.UIATLAS,m);g&&(_.getComponent(cc.Sprite).spriteFrame=g),u.getChildByName("name").getComponent(cc.Label).string=f.propName}this.pageview.addPage(s)}}catch(y){t={error:y}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}this.updateGiftInfo()},e.prototype.pay=function(t,e){e.getCurrentTarget().getComponent(cc.Button).interactable=!1},e.prototype.updateGiftInfo=function(){var t=this.pageview.getCurrentPageIndex(),e=Array.from(this.giftSet)[t];this.giftName.string=e.name,this.btnGift.getChildByName("price").getComponent(cc.Label).string="\uffe5 "+e.price,this.btnGift.getComponent(cc.Button).interactable=!c.default.member.storeGift[e.name]},e.prototype.onClickToggle=function(t,e){"\u793c\u5305"==e&&this.initGift()},e.prototype.onClickArrow=function(t,e){var i=this.pageview.getCurrentPageIndex();"\u4e0b\u4e00\u9875"==e?this.pageview.scrollToPage(++i,.4):this.pageview.scrollToPage(--i,.4)},e.prototype.onClickSaleGoods=function(t,e){var i=(new Date).toLocaleDateString(),o=c.default.member.daySales[i][e],a=c.default.getPropConfigByID(o.propID),n=c.default.getPropByID("coins");n.number>=a.coin/2?(n.number-=a.coin/2,o.number+=a.reward,c.default.save(),u.default.pushToast("\u8865\u5145\u9053\u5177<"+o.propName+">+"+a.reward+"\u6210\u529f")):u.default.pushToast("\u4e16\u754c\u5e01\u4e0d\u8db3\uff0c\u8bf7\u5145\u503c")},e.prototype.onClickGift=function(t){var e=this.pageview.getCurrentPageIndex(),i=Array.from(this.giftSet)[e];this.pay(i,t,function(){c.default.member.storeGift[i.name]=!0,i.goods.forEach(function(t){var e=c.default.getPropByID(t.id);e.lock=!1,e.number+=t.num}),c.default.save(),u.default.pushToast("\u606d\u559c\u4f60\uff0c\u8d2d\u4e70<"+i.name+">\u6210\u529f\uff01")})},e.prototype.buyGoods=function(t,e){this.pay(t,e,function(){t.goods.forEach(function(e){var i=c.default.getPropByID(e.id);i.lock=!1,i.number+=e.num,c.default.save,u.default.pushToast("\u606d\u559c\u4f60\uff0c\u8d2d\u4e70<"+t.name+">\u6210\u529f\uff01")})})},e.prototype.onUnLockAll=function(t){this.pay({price:128,id:"10000",name:"\u5168\u90e8\u89e3\u9501"},t,function(){c.default.member.unLockAll=!0,c.default.getAllVideoProp().forEach(function(t){var e=c.default.getPropConfigByID(t.propID);t.number+=t.lock?1.5*e.reward:3*e.reward,t.lock=!1}),c.default.save(),u.default.pushToast("\u606d\u559c\u4f60\uff0c\u5df2\u89e3\u9501\u5168\u90e8\u9053\u5177\uff0c\u5c3d\u60c5\u7545\u73a9\u6e38\u620f\u5427\uff01")})},e.prototype.onClickCoin=function(t,e){var i=t.getCurrentTarget().getComponent(cc.Button),o=this.jsonData.json["\u5145\u503c"][e];this.pay(o,t,function(){c.default.getPropByID(o.id).number+=o.num,c.default.save,u.default.pushToast("\u606d\u559c\u4f60\uff0c\u5145\u503c"+o.num+"\u4e16\u754c\u5e01\u6210\u529f\uff01"),i.interactable=!0})},e.prototype.update=function(){this.btnPrevious.interactable=this.pageview.getCurrentPageIndex()>0,this.btnNext.interactable=this.pageview.getCurrentPageIndex()<this.pageview.getPages().length-1},s([m(cc.JsonAsset)],e.prototype,"jsonData",void 0),s([m(cc.Prefab)],e.prototype,"pbItem",void 0),s([m(cc.Button)],e.prototype,"btnUnAll",void 0),s([m([cc.Node])],e.prototype,"saleNode",void 0),s([m([cc.Label])],e.prototype,"coinNums",void 0),s([m(cc.PageView)],e.prototype,"pageview",void 0),s([m(cc.Label)],e.prototype,"giftName",void 0),s([m(cc.Node)],e.prototype,"btnGift",void 0),s([m(cc.Button)],e.prototype,"btnPrevious",void 0),s([m(cc.Button)],e.prototype,"btnNext",void 0),s([_],e)}(d.GamePopBase);n.default=g,cc._RF.pop()},{}],TaxiManager:[function(t,e,i){"use strict";cc._RF.push(e,"8fabfPnTY5Agbv+y0Wl3cuK","TaxiManager");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("TaxiRequest"),s=function(){function t(){}return t.newRequest=function(e,i){var o,a,s=null;try{for(var l=n(t.list),c=l.next();!c.done;c=l.next()){var d=c.value;if(d.target.isSameIsland(i)&&d.requestTile.isSameIsland(e.currentTile)){s=d;break}}}catch(u){o={error:u}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}s?s.actors.includes(e)||s.actors.push(e):((s=new r.default).kingdom=e.kingdom,s.setState(r.TaxiRequestState.Pending),s.actors.push(e),s.requestTile=e.currentTile,s.target=i,t.list.push(s))},t.cancelRequest=function(e){e.cancel(),t.list.remove(e)},t.getRequestForActor=function(e){for(var i=0;i<t.list.length;i++){var o=t.list[i];if(o.actors.includes(e))return o}return null},t.getNewRequestForBoat=function(e){var i,o,a=null;try{for(var s=n(t.list),l=s.next();!l.done;l=s.next()){var c=l.value;if(c.isState(r.TaxiRequestState.Assigned)&&c.isStillLegit()&&c.taxi.actor==e)return c;c.isState(r.TaxiRequestState.Pending)&&c.isStillLegit()&&c.kingdom==e.kingdom&&(!a||a.actors.length<c.actors.length)&&(a=c)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return a},t.clear=function(){t.list=[]},t.finish=function(e){e.finish(),t.list.remove(e)},t.cancelTaxiRequestForActor=function(e){var i=t.getRequestForActor(e);i&&t.cancelRequest(i)},t.logicUpdate=function(e){if(t.timer_check>0)t.timer_check-=e;else{t.timer_check=5;for(var i=0;t.list.length>i;){var o=t.list[i];o.isStillLegit()?i++:(o.finish(),t.list.splice(i,1))}}},t.list=[],t.timer_check=0,t}();a.default=s,cc._RF.pop()},{}],TaxiRequest:[function(t,e,i){"use strict";cc._RF.push(e,"54677WIRKJD+qpf71/QYNjO","TaxiRequest");var o,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.TaxiRequestState=a.TaxiRequestType=void 0,function(t){t[t.Settlers=0]="Settlers",t[t.ArmyAttack=1]="ArmyAttack",t[t.ReturnHome=2]="ReturnHome"}(a.TaxiRequestType||(a.TaxiRequestType={})),function(t){t[t.Pending=0]="Pending",t[t.Assigned=1]="Assigned",t[t.Loading=2]="Loading",t[t.Transporting=3]="Transporting",t[t.Finished=4]="Finished"}(o=a.TaxiRequestState||(a.TaxiRequestState={}));var r=function(){function t(){this.target=null,this.requestTile=null,this.actors=[],this.taxi=null,this.kingdom=null}return t.prototype.cancel=function(){this.setState(o.Finished)},t.prototype.finish=function(){this.setState(o.Finished)},t.prototype.checkList=function(){for(var t,e,i,o=0,a=!1;this.actors.length>o;){a=!1;var n=this.actors[o];(null===(t=n.data)||void 0===t?void 0:t.alive)&&(null===(e=n.currentTile)||void 0===e?void 0:e.isSameIsland(this.requestTile))?(null===(i=n.currentTile)||void 0===i?void 0:i.isSameIsland(this.target))&&(a=!0):a=!0,a?this.actors.splice(o,1):o++}},t.prototype.isStillLegit=function(){var t,e,i;return!!(this.isState(o.Pending)||(null===(i=null===(e=null===(t=this.taxi)||void 0===t?void 0:t.actor)||void 0===e?void 0:e.data)||void 0===i?void 0:i.alive))&&(this.checkList(),0!=this.actors.length&&!this.isState(o.Finished))},t.prototype.assign=function(t){this.taxi=t,this.setState(o.Assigned)},t.prototype.setState=function(t){this.state=t},t.prototype.cancelForLatePassengers=function(){for(var t=0;t<this.actors.length;)this.actors[t].insideBoat==this.taxi?t++:this.actors.splice(t,1)},t.prototype.everyoneEmbarked=function(){var t,e;this.checkList();try{for(var i=n(this.actors),o=i.next();!o.done;o=i.next()){var a=o.value;if(!this.taxi.unitsInside.has(a))return!1}}catch(r){t={error:r}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return!0},t.prototype.isState=function(t){return this.state==t},t}();a.default=r,cc._RF.pop()},{}],TechElement:[function(t,e,i){"use strict";cc._RF.push(e,"1250d4q4KVNI59gnQme8eoE","TechElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("LocalizedTextManager"),c=a("AssetManager"),d=a("Culture"),u=a("TextureLoader"),h=a("ToolTip"),p=cc._decorator,f=p.ccclass,_=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.asset=null,e}return r(e,t),e.prototype.load=function(t){if(this.asset=t instanceof d.CultureTechAsset?t:c.default.culture_tech.get(t),this.asset){var e=u.TextureLoader.inst.getSpriteFrame(u.ATLAS_TYPE.UIATLAS,"icons/"+this.asset.icon);this.getComponent(cc.Sprite).spriteFrame=e}},e.prototype.showTooltip=function(){var t="tech_"+this.asset.id,e="tech_info_"+this.asset.id;l.LocalizedTextManager.contains(e)||(e=null),h.default.inst.show(this.node,"normal",t,e)},s([f],e)}(cc.Component));n.default=_,cc._RF.pop()},{}],TerraformLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"b5dcboTwxlE6JltSnPybcLy","TerraformLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.TerraformOptions=void 0;var s=a("Tools"),l=a("AssetLibrary"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spawnPixels=!1,e.removeTreesFully=!1,e.destroyBuildings=!1,e.removeBurned=!1,e.removeTornado=!1,e.addBurned=!1,e.addHeat=0,e.flash=!1,e.removeBorders=!1,e.removeBuilding=!1,e.removeTopTile=!1,e.removeRoads=!1,e.removeFrozen=!1,e.removeWater=!1,e.removeRuins=!1,e.lightningEffect=!1,e.removeLava=!1,e.damageBuildings=!1,e.damage=0,e.setFire=!1,e.transformToWasteland=!1,e.applyForce=!1,e.force_power=1.5,e.explode_tile=!1,e.explosion_pixel_effect=!0,e.explode_and_set_random_fire=!1,e.explode_strength=0,e.applies_to_high_flyers=!1,e.shake=!1,e.shake_duration=.3,e.shake_interval=.01,e.shake_intensity=2,e.addTrait="",e.ignoreKingdoms=[],e.destroyOnly=[],e.ignoreBuildings=[],e}return r(e,t),e}(l.Asset);n.TerraformOptions=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),e.tumor_attack=new c,e.tumor_attack.id="tumor_attack",e.tumor_attack.flash=!0,e.tumor_attack.destroyBuildings=!0,e.tumor_attack.ignoreKingdoms=["tumor"],this.add(e.tumor_attack),e.destroy=new c,e.destroy.id="destroy",e.destroy.flash=!0,e.destroy.destroyBuildings=!0,e.destroy.removeBorders=!0,this.add(e.destroy),e.destroy_life=new c,e.destroy_life.id="destroy_life",e.destroy_life.destroyOnly=["tumor","super_pumpkins","biomass"],e.destroy_life.destroyBuildings=!0,e.destroy_life.removeBuilding=!0,e.destroy_life.flash=!0,e.destroy_life.removeBorders=!0,e.destroy_life.removeTornado=!0,this.add(e.destroy_life),e.earthquake=new c,e.earthquake.id="earthquake",e.earthquake.removeLava=!0,e.earthquake.destroyBuildings=!0,e.earthquake.removeBuilding=!0,this.add(e.earthquake);var i=new c;i.id="earthquakeDisaster",i.removeLava=!0,i.destroyBuildings=!0,i.removeTopTile=!0,i.removeRoads=!0,i.removeFrozen=!0,i.removeWater=!0,this.add(i),e.road=new c,e.road.id="road",e.road.flash=!0,e.road.removeBuilding=!0,e.road.destroyBuildings=!0,e.road.destroyOnly=["nature"],this.add(e.road),e.flash=new c,e.flash.id="flash",e.flash.flash=!0,this.add(e.flash),e.grey_goo=new c,e.grey_goo.id="grey_goo",e.grey_goo.destroyBuildings=!0,e.grey_goo.removeBuilding=!0,e.grey_goo.flash=!0,e.grey_goo.removeBorders=!0,this.add(e.grey_goo),e.remove=new c,e.remove.id="remove",e.remove.flash=!0,e.remove.removeBuilding=!0,e.remove.destroyBuildings=!0,this.add(e.remove),e.draw=new c,e.draw.id="draw",e.draw.flash=!0,this.add(e.draw),e.remove=new c,e.remove.id="water_fill",e.remove.flash=!0,e.remove.removeBuilding=!0,e.remove.destroyBuildings=!0,this.add(e.remove),this.t.ignoreBuildings=["geyser","volcano","geyserAcid"],e.destroy_no_flash=new c,e.destroy_no_flash.id="destroy_no_flash",e.destroy_no_flash.removeBurned=!0,e.destroy_no_flash.destroyBuildings=!0,this.add(e.destroy_no_flash),e.nothing=new c,e.nothing.id="nothing",this.add(e.nothing),e.removeLava=new c,e.removeLava.id="removeLava",e.removeLava.removeLava=!0,this.add(e.removeLava),e.lavaDamage=new c,e.lavaDamage.id="lavaDamage",e.lavaDamage.flash=!0,e.lavaDamage.damageBuildings=!0,e.lavaDamage.damage=10,this.add(e.lavaDamage);var o=new c;o.id="grenade",o.flash=!0,o.damageBuildings=!0,o.damage=50,o.applyForce=!0,o.spawnPixels=!0,o.explode_and_set_random_fire=!0,o.explode_tile=!0,o.explosion_pixel_effect=!0,o.explode_strength=1,o.shake=!0,o.removeTornado=!0,this.add(o);var a=new c;a.id="lightning",a.flash=!0,a.lightningEffect=!0,a.addBurned=!0,a.addHeat=9,a.damage=77,a.setFire=!0,a.applyForce=!0,a.shake=!0,this.add(a),this.t.shake_intensity=.1;var n=new c;n.id="madness_ball",n.applyForce=!0,n.force_power=.2,n.addTrait="madness",n.flash=!0,this.add(n);var r=new c;r.id="ufo_attack",r.flash=!0,r.addBurned=!0,r.addHeat=3,r.damage=50,r.setFire=!0,r.applyForce=!0,r.shake=!0,this.add(r),this.t.ignoreKingdoms=["aliens"],this.t.shake_intensity=.1,this.clone("ufo_explosion","grenade"),this.t.ignoreKingdoms=["aliens"],this.clone("bomb","grenade"),this.t.damage=100,this.t.explode_strength=3,this.t.spawnPixels=!0,e.atomicBomb=this.clone("atomicBomb","bomb"),this.t.damage=1e4,this.t.explode_strength=1,this.t.transformToWasteland=!0,this.t.applies_to_high_flyers=!0,e.czarBomba=this.clone("czarBomba","bomb"),this.t.damage=1e4,this.t.transformToWasteland=!0,this.t.explode_strength=4,this.t.applies_to_high_flyers=!0;var s=new c;s.id="crab",s.flash=!0,s.damageBuildings=!0,s.damage=10,s.applyForce=!0,s.explode_tile=!0,s.explosion_pixel_effect=!1,s.explode_strength=1,s.shake=!0,s.shake_intensity=.1,this.add(s),this.clone("crab_laser","bomb"),this.t.damage=200,this.t.shake_intensity=1,this.clone("santa_bomb","bomb"),this.t.ignoreKingdoms=["santa"],this.clone("demon_fireball","grenade"),this.t.ignoreKingdoms=["demons"],this.t.shake=!1,this.t.damageBuildings=!0,this.t.damage=30,this.t.setFire=!0,this.t.spawnPixels=!1,this.clone("plasma_ball","grenade"),this.t.shake=!1,this.t.damageBuildings=!0,this.t.damage=30,this.t.spawnPixels=!1,this.clone("torch","grenade"),this.t.ignoreKingdoms=["demons"],this.t.shake=!1,this.t.damageBuildings=!0,this.t.damage=25,this.t.setFire=!0,this.t.spawnPixels=!1,this.clone("assimilator_bullet","flash"),this.t.ignoreKingdoms=["assimilators"]},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.get(e))),o=s.default.fromJson(i,new c);return o.id=t,this.add(o),o},e.nothing=null,e.removeLava=null,e.lavaDamage=null,e.destroy_no_flash=null,e.remove=null,e.draw=null,e.water_fill=null,e.grey_goo=null,e.flash=null,e.road=null,e.tumor_attack=null,e.destroy=null,e.destroy_life=null,e.earthquake=null,e.atomicBomb=null,e.czarBomba=null,e}(l.default);n.default=d,cc._RF.pop()},{}],TextureBuffer:[function(t,e,i){"use strict";cc._RF.push(e,"33ce9MDAmFFE6n+RoZHsWlN","TextureBuffer");var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.TextureBuffer=void 0;var a=function(){function t(t,e,i,o,a){void 0===a&&(a=!0),this.name="",this.width_=0,this.height_=0,this.onlyAlpha_=!0,this.dataArray_=null,this.name=t,this.width_=i,this.height_=o,this.dataArray_=e,this.onlyAlpha_=a}return t.prototype.clone=function(){return new t(this.name,this.dataArray_,this.width_,this.height_,this.onlyAlpha_)},Object.defineProperty(t.prototype,"width",{get:function(){return this.width_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.height_},enumerable:!1,configurable:!0}),t.prototype.getPixel=function(t,e){var i=cc.color(0,0,0,0),o=e*this.width_+t;return this.onlyAlpha_?(i.r=this.dataArray_[o],i.g=this.dataArray_[o],i.b=this.dataArray_[o],i.a=this.dataArray_[o]):(i.r=this.dataArray_[4*o+0],i.g=this.dataArray_[4*o+1],i.b=this.dataArray_[4*o+2],i.a=this.dataArray_[4*o+3]),i},t.prototype.getPixels=function(){for(var t=[],e=0;e<this.height*this.width;e++){var i=cc.color(0,0,0,0);this.onlyAlpha_?i.a=this.dataArray_[e]:(i.r=this.dataArray_[4*e+0],i.g=this.dataArray_[4*e+1],i.b=this.dataArray_[4*e+2],i.a=this.dataArray_[4*e+3]),t.push(i)}return t},t.prototype.setPixels=function(t,e,i){this.width_=e,this.height_=i,this.dataArray_=this.onlyAlpha_?new Uint8Array(e*i):new Uint8Array(e*i*4);for(var o=0;o<e*i;o++){var a=t[o];this.onlyAlpha_?this.dataArray_[o]=a.a:(this.dataArray_[4*o+0]=a.r,this.dataArray_[4*o+1]=a.g,this.dataArray_[4*o+2]=a.b,this.dataArray_[4*o+3]=a.a)}return this},t}();o.TextureBuffer=a,cc._RF.pop()},{}],TextureLoader:[function(t,e,i){"use strict";cc._RF.push(e,"26baaopLeRK34fJFH7BH472","TextureLoader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureLoader=n.UnitTextureAtlasID=n.ATLAS_TYPE=n.BIN_TYPE=void 0;var l,c,d=a("TextureBuffer");(function(t){t.gen_shapes="gen_shapes",t.edges="edges",t.prints="prints",t.tilemap="tilemap",t.brushes="brushes"})(l=n.BIN_TYPE||(n.BIN_TYPE={})),function(t){t.WORLDATLAS="worldAtlas",t.UIATLAS="uiAtlas"}(c=n.ATLAS_TYPE||(n.ATLAS_TYPE={})),function(t){t[t.Units=0]="Units",t[t.UnitsSmall=1]="UnitsSmall",t[t.Boats=2]="Boats",t[t.Buildings=3]="Buildings",t[t.Ui=4]="Ui"}(n.UnitTextureAtlasID||(n.UnitTextureAtlasID={}));var u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.worldAtlas=null,e.uiAtlas=null,e.gen_shapes=[],e.edges=[],e.prints=[],e.buildingsmini=[],e.tilemap=[],e.brushes=[],e.textures=new Map,e.binInfo={gen_shapes:{onlyAlpha:!0,default:[60,60]},edges:{onlyAlpha:!0,default:[50,50]},prints:{onlyAlpha:!0,print_dbutt:[42,59],print_diamond:[100,100],print_heart:[100,100],print_hexagon:[100,100],print_island1:[100,100],print_skull:[13,13],print_squares:[100,100],print_star:[100,100],print_yin_yang:[18,18],quake1:[120,120],quake2:[120,120],quake3:[120,120]},tilemap:{onlyAlpha:!1,path:"tilemap"},brushes:{onlyAlpha:!0,brush_diamond_1:[11,11],brush_diamond_2:[14,14],brush_diamond_4:[24,24],brush_diamond_5:[40,40],brush_diamond_7:[50,50],brush_special_1:[4,4],brush_special_2:[8,8],brush_special_3:[14,14],brush_special_4:[22,22],brush_special_5:[33,33],brush_special_6:[45,45],brush_special_7:[70,70]}},e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){for(var t in i.inst=this,l)this.loadTextureBuffer(t)},e.prototype.loadTextureBuffer=function(t){var e=this.binInfo[t],i=e.onlyAlpha?null:this.getSpriteFrames(c.WORLDATLAS,e.path),o=this[t],a=new Map;this.textures.set(t,a);for(var n=0;n<o.length;n++){var r=o[n],s=new Uint8Array(r._buffer),l=i?i.get(r.name).getOriginalSize().width:null!=e.default?e.default[0]:e[r.name][0],u=i?i.get(r.name).getOriginalSize().height:null!=e.default?e.default[1]:e[r.name][1],h=new d.TextureBuffer(r.name,s,l,u,e.onlyAlpha);a.set(r.name,h)}},e.prototype.getBuildIcon=function(t){for(var e=0;e<this.buildingsmini.length;e++){var i=this.buildingsmini[e];if(i.name==t)return i}return null},e.prototype.getTexture=function(t,e){return this.textures.get(t).get(e)},e.prototype.getTextures=function(t){return this.textures.get(t)},e.prototype.getSpriteAtlas=function(t){switch(t){case c.WORLDATLAS:return this.worldAtlas;case c.UIATLAS:return this.uiAtlas;default:return null}},e.prototype.getSpriteFrame=function(t,e){var i=this.getSpriteAtlas(t);return e=e.replace(/\//g,"-"),i.getSpriteFrame(e)},e.prototype.getSpriteFrames=function(t,e){var i=new Map,o=this.getSpriteAtlas(t);return e=(e=e.replace(/\//g,"-")).lastIndexOf("-")==e.length-1?e:e+"-",o.getSpriteFrames().forEach(function(t){if(t.name.includes(e)){var o=t.name.substring(e.length);i.set(o,t)}}),i},e.inst=null,s([p(cc.SpriteAtlas)],e.prototype,"worldAtlas",void 0),s([p(cc.SpriteAtlas)],e.prototype,"uiAtlas",void 0),s([p([cc.BufferAsset])],e.prototype,"gen_shapes",void 0),s([p([cc.BufferAsset])],e.prototype,"edges",void 0),s([p([cc.BufferAsset])],e.prototype,"prints",void 0),s([p([cc.BufferAsset])],e.prototype,"buildingsmini",void 0),s([p([cc.BufferAsset])],e.prototype,"tilemap",void 0),s([p([cc.BufferAsset])],e.prototype,"brushes",void 0),i=s([h],e)}(cc.Component);n.TextureLoader=f,cc._RF.pop()},{}],TextureRotator:[function(t,e,i){"use strict";cc._RF.push(e,"0bd85/qyeVPwpfnTi0kN/zG","TextureRotator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.TextureRotator=void 0;var n=o("MathUtils"),r=function(){function t(){}return t.rotate=function(e,i){var o=t.rotateSquare(e.getPixels(),Math.PI/180*i,e);return e.setPixels(o,e.width,e.height)},t.rotateSquare=function(t,e,i){for(var o=Math.sin(e),a=Math.cos(e),r=i.getPixels(),s=i.width,l=i.height,c=n.default.intCast(s/2),d=n.default.intCast(l/2),u=0;u<l;u++)for(var h=0;h<s;h++){r[u*s+h]=cc.Color.TRANSPARENT;var p=n.default.intCast(a*(h-c)+o*(u-d)+c),f=n.default.intCast((0-o)*(h-c)+a*(u-d)+d);p>-1&&p<s&&f>-1&&f<l&&(r[u*s+h]=t[f*s+p])}return r},t}();a.TextureRotator=r,cc._RF.pop()},{}],TextureScale:[function(t,e,i){"use strict";cc._RF.push(e,"36359fUMFdEmbhldRbFwj3f","TextureScale");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.TextureScale=a.ThreadData=void 0;var n=o("MathUtils"),r=function(t,e){this.start=0,this.end=0,this.start=t,this.end=e};a.ThreadData=r;var s=function(){function t(){}return t.point=function(e,i,o){t.threadedScale(e,i,o,!1)},t.bilinear=function(e,i,o){t.threadedScale(e,i,o,!0)},t.threadedScale=function(e,i,o,a){t.texColors=e.getPixels(),t.newColors=[],a?(t.ratioX=1/(i/(e.width-1)),t.ratioY=1/(o/(e.height-1))):(t.ratioX=e.width/i,t.ratioY=e.height/o),t.w=e.width,t.w2=i;var n=Math.min(6,o);if(n>1){var s;s=new r(o/n*0,o),a?t.bilinearScale(s):t.pointScale(s)}else{var l=new r(0,o);a?t.bilinearScale(l):t.pointScale(l)}e.setPixels(t.newColors,i,o),t.texColors=null,t.newColors=null},t.bilinearScale=function(e){for(var i=e.start;i<e.end;i++)for(var o=Math.floor(i*t.ratioY),a=o*t.w,n=(o+1)*t.w,r=i*t.w2,s=0;s<t.w2;s++){var l=Math.floor(s*t.ratioX),c=s*t.ratioX-l;t.newColors[r+s]=t.colorLerpUnclamped(t.colorLerpUnclamped(t.texColors[a+l],t.texColors[a+l+1],c),t.colorLerpUnclamped(t.texColors[n+l],t.texColors[n+l+1],c),i*t.ratioY-o)}},t.pointScale=function(e){for(var i=e.start;i<e.end;i++)for(var o=n.default.intCast(t.ratioY*i*t.w),a=i*t.w2,r=0;r<t.w2;r++)t.newColors[a+r]=t.texColors[n.default.intCast(o+t.ratioX*r)]},t.colorLerpUnclamped=function(t,e,i){return cc.color(t.r+(e.r-t.r)*i,t.g+(e.g-t.g)*i,t.b+(e.b-t.b)*i,t.a+(e.a-t.a)*i)},t.texColors=[],t.newColors=[],t.w=0,t.ratioX=0,t.ratioY=0,t.w2=0,t}();a.TextureScale=s,cc._RF.pop()},{}],TileActionLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"d92257+n9hEE5OETLwXFhAN","TileActionLibrary");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("AssetManager"),r=o("ToolBox"),s=o("MapBox"),l=function(){function t(){}return t.landmine=function(t){return s.default.inst.explosionLayer.explodeBomb(t),!0},t.setUnitOnFire=function(t,e){return!e.haveTrait("burning_feet")&&(e.addStatusEffect("burning"),t.setFire(!0),!0)},t.giveTumorTrait=function(t,e){return!e.stats.immune_to_tumor&&!!e.stats.canTurnIntoTumorMonster&&(e.addTrait("tumorInfection"),!0)},t.giveSlownessStatus=function(t,e){return!e.stats.immune_to_slowness&&(e.addStatusEffect("slowness"),!0)},t.giveMadnessTrait=function(t,e){return!e.stats.immune_to_tumor&&!!e.stats.canTurnIntoTumorMonster&&(e.addTrait("madness"),!0)},t.getGrowTypeRandomTrees=function(t){if(!t.type.grow_types_list_trees||0==t.type.grow_types_list_trees.length)return null;var e=t.type.grow_types_list_trees.getRandom();return n.default.buildings.get(e)},t.getGrowTypeRandomPlants=function(t){if(!t.type.grow_types_list_plants||0==t.type.grow_types_list_plants.length)return null;var e=t.type.grow_types_list_plants.getRandom();return n.default.buildings.get(e)},t.getGrowTypeSand=function(t){if(t.zone.tilesWithLiquid>0)return r.Toolbox.randomChance(.7)?null:n.default.buildings.get("palm");for(var e=!1,i=0;i<t.zone.neighboursAll.length;i++)if(t.zone.neighboursAll[i].tilesWithLiquid>0){e=!0;break}return e?null:r.Toolbox.randomChance(.7)?null:n.default.buildings.get("cacti")},t}();a.default=l,cc._RF.pop()},{}],TileDictionary:[function(t,e,i){"use strict";cc._RF.push(e,"1e0bb9+8tpOD77pLcEC+uyQ","TileDictionary");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.TileDictionary=void 0;var n=o("MathUtils"),r=function(){function t(t){void 0===t&&(t=!1),this.dict=null,this.array=null,this.dict=new Map,t&&(this.array=[])}return t.prototype.clear=function(){this.dict.clear(),this.array&&(this.array=[])},t.prototype.contains=function(t){return this.dict.has(t)},t.prototype.add=function(t){this.contains(t)||(this.dict.set(t,!0),this.array&&this.array.push(t))},t.prototype.remove=function(t,e){if(void 0===e&&(e=!0),this.dict.delete(t)&&this.array){var i=this.array[this.array.length-1];if(t==i)this.array.pop();else{var o=this.array.indexOf(t);this.array[o]=i,this.array.pop()}}},t.prototype.count=function(){return this.dict.size},t.prototype.length=function(){return this.dict.size},t.prototype.getRandomTileAndRemove=function(){if(this.array){var t=n.default.getRandom(this.array);return this.remove(t),t}throw new Error("need enable random in constructor")},t.prototype.getRandomTile=function(){if(this.array)return n.default.getRandom(this.array);throw new Error("need enable random in constructor")},t.prototype.getArray=function(){if(this.array)return this.array;throw new Error("need enable random in constructor")},t}();a.TileDictionary=r,cc._RF.pop()},{}],TileIsland:[function(t,e,i){"use strict";cc._RF.push(e,"588f4dUMmFNq5m7hjrvn/fV","TileIsland");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("ToolBox"),s=o("MapRegion"),l=o("TileDictionary"),c=o("TileTypeBase"),d=function(){function t(t){this.calc_temp_city_here=!1,this.regions=new s.RegionsContainer,this.regionsCorners=[],this.created=0,this.haveCity=!1,this.type=c.TileLayerType.Ocean,this.dirty=!1,this.id=0,this.debug_hash_code=0,this.tiles_roads=null,this.removed=!1,this.actors=[],this.docks=[],this._tileCount=0,this.cached_connectedIslandsCheck=new Map,this.id=t,this.debug_hash_code=t,this.tiles_roads=new l.TileDictionary,this.created=cc.sys.now()}return t.prototype.addRegion=function(t){this.regions.add(t)},t.prototype.removeRegion=function(t){this.regions.remove(t),t.island=null,this.dirty=!0},t.prototype.clearRegionsFromIsland=function(){if(!this.removed){this.removed=!0;for(var t=this.regions.getSimpleList(),e=0;e<t.length;e++)t[e].island=null;this.regions.clear()}},t.prototype.getTileCount=function(){return this._tileCount},t.prototype.countTiles=function(){this._tileCount=0;for(var t=this.regions.getSimpleList(),e=0;e<t.length;e++){var i=t[e];this._tileCount+=i.tiles.length}},t.prototype.getRandomTile=function(){return this.regions.getRandom().tiles.getRandom()},t.prototype.connectedWith=function(t){if(this.cached_connectedIslandsCheck.has(t))return this.cached_connectedIslandsCheck.get(t);var e=null,i=null;t.getTileCount()<this.getTileCount()?(e=t,i=this):(e=this,i=t);for(var o=0;o<e.regions.length;o++){var a=e.regions.getSimpleList()[o];if(!a.centerRegion)for(var n=a.getTileCorners(),r=0;r<n.length;r++)if(n[r].region.island==i)return e.cached_connectedIslandsCheck.set(i,!0),i.cached_connectedIslandsCheck.set(e,!0),!0}return e.cached_connectedIslandsCheck.set(i,!1),i.cached_connectedIslandsCheck.set(e,!1),!1},t.prototype.getTileForCity=function(t){var e,i;try{for(var o=n(this.regions.getSimpleList()),a=o.next();!a.done;a=o.next()){var s=a.value;if(!s.tiles.includes(t)&&s.zone.goodForNewCity&&r.Toolbox.distTile(t,s.zone.centerTile)>=48)return s.zone.centerTile}}catch(d){e={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return null},t}();a.default=d,cc._RF.pop()},{}],TileLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"2d8951KgkFKtbOHEn5/50nB","TileLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(n,"__esModule",{value:!0}),n.TileType=void 0;var c=a("Constants"),d=a("Tools"),u=a("ToolBox"),h=a("TileActionLibrary"),p=a("TileTypeBase"),f=a("TextureLoader"),_=a("AssetLibrary"),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(p.TileTypeBase);n.TileType=m;var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._depth_list=[],e._depth_list_generator=[],e._depth_list_gameplay=[],e}return r(e,t),e.prototype.init=function(){var i,o,a,n;t.prototype.init.call(this),this.setListTo("generator");var r=new m;r.id="deep_ocean",r.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#3370CC":"#25ABBC"),r.liquid=!0,r.ocean=!0,r.heightMin=0,r.decreaseToID="pit_deep_ocean",r.increaseToID="pit_close_ocean",r.walkMod=.1,r.strength=0,r.layerType=p.TileLayerType.Ocean,r.used_in_generator=!0,r.render_z=0,r.setDrawLayer(p.TileZIndexes.deep_ocean),e.deep_ocean=r,this.add(r);var l=this.clone("close_ocean","deep_ocean");l.used_in_generator=!0,l.setDrawLayer(p.TileZIndexes.close_ocean),l.drawPixel=!0,l.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#4084E2":"#54C9D1"),l.heightMin=30,l.decreaseToID="pit_close_ocean",l.increaseToID="pit_shallow_waters",l.strength=0,l.layerType=p.TileLayerType.Ocean,e.close_ocean=l;var d=new m;d.id="shallow_waters",d.drawPixel=!0,d.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#55AEF0":"#7BDFE1"),d.edge_color=u.Toolbox.makeColor("#3F90EA"),d.liquid=!0,d.ocean=!0,d.heightMin=70,d.freezeToID="ice",d.decreaseToID="pit_shallow_waters",d.increaseToID="sand",d.walkMod=.1,d.strength=0,d.layerType=p.TileLayerType.Ocean,this.add(d),d.used_in_generator=!0,d.setDrawLayer(p.TileZIndexes.shallow_waters),e.shallow_waters=d;var f=this.clone("pit_deep_ocean","deep_ocean");f.setDrawLayer(p.TileZIndexes.pit_deep_ocean),f.drawPixel=!0,f.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#898989":"#929292"),f.liquid=!1,f.ocean=!1,f.walkMod=1,f.canBeFilledWithOcean=!0,f.fillToOcean="deep_ocean",f.decreaseToID="",f.increaseToID="pit_close_ocean",f.canBeSetOnFire=!0,f.layerType=p.TileLayerType.Ground,f.strength=2,e.pit_deep_ocean=f;var _=this.clone("pit_close_ocean","close_ocean");_.setDrawLayer(p.TileZIndexes.pit_close_ocean),_.drawPixel=!0,_.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#A0A0A0":"#B7B7B7"),_.liquid=!1,_.ocean=!1,_.walkMod=1,_.canBeFilledWithOcean=!0,_.fillToOcean="close_ocean",_.decreaseToID="pit_deep_ocean",_.increaseToID="pit_shallow_waters",_.canBeSetOnFire=!0,_.layerType=p.TileLayerType.Ground,_.strength=2,e.pit_close_ocean=_;var g=this.clone("pit_shallow_waters","shallow_waters");g.setDrawLayer(p.TileZIndexes.pit_shallow_waters),g.drawPixel=!0,g.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#C1C1C1":"#CDCDCD"),g.liquid=!1,g.ocean=!1,g.walkMod=1,g.canBeFilledWithOcean=!0,g.fillToOcean="shallow_waters",g.decreaseToID="pit_close_ocean",g.increaseToID="sand",g.freezeToID="",g.canBeSetOnFire=!0,g.layerType=p.TileLayerType.Ground,g.strength=2,e.pit_shallow_waters=g;var y=new m;y.id="border_pit",y.layerType=p.TileLayerType.Ground,this.add(y),y.setDrawLayer(p.TileZIndexes.border_pit),e.border_pit=y;var v=new m;v.id="border_water",v.layerType=p.TileLayerType.Ground,this.add(v),v.setDrawLayer(p.TileZIndexes.border_water),e.border_water=v;var b=new m;b.cost=116,b.id="sand",b.sand=!0,b.drawPixel=!0,b.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#F7E898":"#FFF9AE"),b.edge_color=u.Toolbox.makeColor("#D8C08C"),b.heightMin=98,b.additional_height=[6,5],b.decreaseToID="pit_shallow_waters",b.increaseToID="soil_low",b.ground=!0,b.walkMod=.7,b.freezeToID="snow_sand",b.creepRankType=p.TileRank.Low,b.canBeSetOnFire=!0,b.canBuildOn=!0,b.addUnitsToSpawn(["crab"]),b.setAutoGrowTrees(h.default.getGrowTypeSand),b.used_in_generator=!0,this.add(b),b.setDrawLayer(p.TileZIndexes.sand),e.sand=b;var w=new m;w.cost=115,w.drawPixel=!0,w.id="soil_low",w.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#E2934B":"#D49F2C"),w.heightMin=108,w.decreaseToID="sand",w.increaseToID="soil_high",w.ground=!0,w.walkMod=1,w.canGrowBiomeGrass=!0,w.soil=!0,w.freezeToID="snow_low",w.rankType=p.TileRank.Low,w.creepRankType=p.TileRank.Low,w.canBeFarmField=!0,w.canBuildOn=!0,w.canBeSetOnFire=!0,w.used_in_generator=!0,this.add(w),w.setDrawLayer(p.TileZIndexes.soil_low),e.soil_low=w;var T=new m;T.cost=120,T.drawPixel=!0,T.id="soil_high",T.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#B66F3A":"#AB7D1B"),T.heightMin=128,T.additional_height=[15,16,17,14,13,12,11,10],T.decreaseToID="soil_low",T.increaseToID="hills",T.ground=!0,T.walkMod=1,T.rankType=p.TileRank.High,T.creepRankType=p.TileRank.High,T.canGrowBiomeGrass=!0,T.soil=!0,T.freezeToID="snow_high",T.canBeFarmField=!0,T.canBuildOn=!0,T.canBeSetOnFire=!0,T.used_in_generator=!0,this.add(T),T.setDrawLayer(p.TileZIndexes.soil_high),e.soil_high=T;var k=new m;k.cost=100,k.drawPixel=!0,k.id="lava0",k.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#F62D14":"#F42C13"),k.decreaseToID="sand",k.increaseToID="hills",k.liquid=!0,k.walkMod=.2,k.damageUnits=!0,k.damage=150,k.lava=!0,k.lavaLevel=0,k.strength=0,k.layerType=p.TileLayerType.Lava,k.stepAction=h.default.setUnitOnFire,k.stepActionChance=.9,this.add(k),k.setDrawLayer(p.TileZIndexes.lava0),e.lava0=k;var B=this.clone("lava1","lava0");B.setDrawLayer(p.TileZIndexes.lava1),B.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#FF6700":"#FBCE06"),B.stepAction=h.default.setUnitOnFire,B.stepActionChance=.9,B.lavaLevel=1,e.lava1=B;var S=this.clone("lava2","lava0");S.setDrawLayer(p.TileZIndexes.lava2),S.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#FFAC00":"#FA6908"),S.stepAction=h.default.setUnitOnFire,S.stepActionChance=.9,S.lavaLevel=2,e.lava2=S;var C=this.clone("lava3","lava0");C.setDrawLayer(p.TileZIndexes.lava3),C.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#FFDE00":"#FFD021"),C.stepAction=h.default.setUnitOnFire,C.stepActionChance=.9,C.lavaLevel=3,e.lava3=C;var x=new m;x.cost=140,x.drawPixel=!0,x.id="hills",x.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#5B5E5C":"#747472"),x.heightMin=199,x.rocks=!0,x.ground=!0,x.edge_hills=!0,x.additional_height=[2,-6],x.decreaseToID="soil_high",x.increaseToID="mountains",x.walkMod=.4,x.freezeToID="snow_hills",x.canBeSetOnFire=!0,x.used_in_generator=!0,this.add(x),x.setDrawLayer(p.TileZIndexes.hills),e.hills=x;var A=new m;A.cost=160,A.drawPixel=!0,A.id="mountains",A.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#414545":"#434343"),A.heightMin=210,A.rocks=!0,A.edge_mountains=!0,A.additional_height=[2,4],A.decreaseToID="hills",A.walkMod=.1,A.freezeToID="snow_block",A.canBeSetOnFire=!0,A.layerType=p.TileLayerType.Block,A.block=!0,A.force_edge_variation=!0,A.force_edge_variation_frame=2,A.used_in_generator=!0,this.add(A),A.setDrawLayer(p.TileZIndexes.mountains),e.mountains=A;var P=new m;P.cost=10,P.drawPixel=!0,P.greyGoo=!0,P.id="grey_goo",P.color=u.Toolbox.makeColor(c.default.OLD_SKIN?"#5D6191":"#566EA8"),P.decreaseToID="pit_deep_ocean",P.burnable=!0,P.ground=!1,P.walkMod=.1,P.damageUnits=!0,P.damage=50,P.strength=0,P.life=!0,P.layerType=p.TileLayerType.Goo,this.add(P),P.setDrawLayer(p.TileZIndexes.grey_goo),e.grey_goo=P;try{for(var O=s(this.list),R=O.next();!R.done;R=O.next()){var F=R.value;F.used_in_generator&&e.list_generator.push(F)}}catch(E){i={error:E}}finally{try{R&&!R.done&&(o=O.return)&&o.call(O)}finally{if(i)throw i.error}}this.setListTo("generator");for(var L=0;L<256;L++)this._depth_list_generator[L]=this.getTypeByDepth(L,e.list_generator);this.setListTo("gameplay");for(var D=0;D<256;D++)this._depth_list_gameplay[D]=this.getTypeByDepth(D,this.list);this.setListTo("generator");try{for(var M=s(this.list),I=M.next();!I.done;I=M.next()){var j=I.value;j.decreaseTo=this.getGen(j.decreaseToID),j.increaseTo=this.getGen(j.increaseToID)}}catch(N){a={error:N}}finally{try{I&&!I.done&&(n=M.return)&&n.call(M)}finally{if(a)throw a.error}}this.loadTileSprites()},e.prototype.loadTileSprites=function(){for(var t,e,i=f.TextureLoader.inst.getSpriteFrames(f.ATLAS_TYPE.WORLDATLAS,"tilemap"),o=0;o<this.list.length;o++){var a=this.list[o],n=0;try{for(var r=(t=void 0,s(i)),c=r.next();!c.done;c=r.next()){var d=l(c.value,2),u=d[0];d[1],(u=u.substring(0,u.length-2))==a.id&&n++}}catch(g){t={error:g}}finally{try{c&&!c.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}0==n&&(n=1),a.sprites=new p.TileSprites;for(var h=0;h<n;h++)a.sprites.addVariation(a.id+"_"+h,a.render_z)}},e.prototype.getGen=function(t){return this.dict.has(t)?this.dict.get(t):null},e.prototype.add=function(e){return e.indexID=p.TileTypeBase.last_indexID++,t.prototype.add.call(this,e)},e.prototype.setListTo=function(t){"generator"==t?this._depth_list=this._depth_list_generator:"gameplay"==t&&(this._depth_list=this._depth_list_gameplay)},e.prototype.getTypeByDepth=function(t,e){for(var i=null,o=0;o<e.length;o++){var a=e[o];-1!=a.heightMin&&(null==i?i=a:t>=a.heightMin&&(i=a))}return i},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.dict.get(e)));return this.t=d.default.fromJson(i,new m),this.t.id=t,this.t.canBeFarmField=!1,this.t.used_in_generator=!1,this.t.unitDeathAction=null,this.add(this.t)},e.prototype.getTypeByWorldTile=function(t){return this._depth_list[t.height]},e.getRandomTileType=function(t){return void 0===t&&(t=null),this._temp_list=[],this._temp_list.push("deep_ocean"),this._temp_list.push("close_ocean"),this._temp_list.push("shallow_waters"),this._temp_list.push("sand"),this._temp_list.push("soil_low"),this._temp_list.push("soil_high"),this._temp_list.push("soil_low"),this._temp_list.push("hills"),this._temp_list.push("mountains"),null!=t&&this._temp_list.remove(t),u.Toolbox.getRandom(this._temp_list)},e.list_generator=[],e.mountains=null,e.hills=null,e.grey_goo=null,e.deep_ocean=null,e.close_ocean=null,e.shallow_waters=null,e.sand=null,e.soil_low=null,e.soil_high=null,e.lava0=null,e.lava1=null,e.lava2=null,e.lava3=null,e.pit_deep_ocean=null,e.pit_close_ocean=null,e.pit_shallow_waters=null,e.border_pit=null,e.border_water=null,e._temp_list=[],e}(_.default);n.default=g,cc._RF.pop()},{}],TileMap:[function(t,e,i){"use strict";cc._RF.push(e,"ef5e3kSJhZGbL7e4L0pvlbN","TileMap");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("SmoothLoader"),c=a("MapBox"),d=a("TextureLoader"),u=a("MapLayer"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maplist=[],e.templist=[],e.tilemaplist=[],e.tileborderlist=[],e.drawBorder=!1,e}return r(e,t),e.prototype.setTile=function(t,e,i){void 0===i&&(i=!1),i?(this.tileborderlist[t.x]||(this.tileborderlist[t.x]=[]),this.tileborderlist[t.x][t.y]=e,e&&(this.drawBorder=!0)):(this.maplist[t.x]||(this.maplist[t.x]=[]),this.tilemaplist[t.x]||(this.tilemaplist[t.x]=[]),this.maplist[t.x][t.y]=e,this.tilemaplist[t.x][t.y]=e)},e.prototype.doDraw=function(){var t=this;if(l.default.isLoading())return!1;var e=!1;return l.default.add(function(){for(var i=0;i<t.maplist.length;i++)if(t.maplist[i])for(var o=0;o<t.maplist[i].length;o++){var a=t.maplist[i][o];a&&(e=!0,t.calculatePixel(cc.v2(i,o),a,!1))}t.maplist=[],t.templist=[]},"Draw Tile"),this.drawBorder&&(this.drawBorder=!1,l.default.add(function(){for(var e=0;e<t.tileborderlist.length;e++)if(t.tileborderlist[e])for(var i=0;i<t.tileborderlist[e].length;i++){var o=t.tileborderlist[e][i];o&&t.calculatePixel(cc.v2(e,i),o,!0)}},"Draw Border")),l.default.add(function(){t.updatePixels()},"UpdatePixels "+cc.sys.now()/1e3),e},Object.defineProperty(e.prototype,"count",{get:function(){for(var t=0,e=0;e<this.maplist.length;e++)if(this.maplist[e])for(var i=0;i<this.maplist[e].length;i++)this.maplist[e][i]&&t++;return t},enumerable:!1,configurable:!0}),e.prototype.calculatePixel=function(t,e,i){if(void 0===i&&(i=!1),this.checkTile(t,e,i),!i)for(var o=t.x-1;o<=t.x+1;o++)for(var a=t.y-1;a<=t.y+1;a++)if(!(this.maplist[o]&&this.maplist[o][a]||this.templist[o]&&this.templist[o][a])){var n=this.tilemaplist[o]&&this.tilemaplist[o][a];n&&(!e||n.z>=e.z)&&(this.checkTile(cc.v2(o,a),n),this.templist[o]||(this.templist[o]=[]),this.templist[o][a]=n)}},e.prototype.checkTile=function(t,e,i){if(void 0===i&&(i=!1),e)for(var o=this.getTile(t.x,t.y+1),a=this.getTile(t.x,t.y-1),n=this.getTile(t.x-1,t.y),r=this.getTile(t.x+1,t.y),s=this.getTile(t.x-1,t.y+1),l=this.getTile(t.x+1,t.y+1),u=this.getTile(t.x-1,t.y-1),h=this.getTile(t.x+1,t.y-1),p=d.TextureLoader.inst.getTexture(d.BIN_TYPE.tilemap,e.spriteName),f=this.getDownHeight(a),_=0;_<p.width;_++)for(var m=0;m<p.height;m++){var g=4*t.x+_-1,y=4*t.y+m-1;if(!(g<0||g>=4*c.default.width||y<0||y>=4*c.default.height)){var v=p.getPixel(_,m);if(0!=v.a){if(i){if(m>=4){if(m>4)continue;if(_<1){if(this.skip(n,e)||this.skip(s,e))continue}else if(_>4){if(this.skip(r,e)||this.skip(l,e))continue}else if(this.skip(o,e))continue}else if(_<2){if(this.skip(n,e))continue}else if(_>=4&&this.skip(r,e))continue}else if(m>=4){if(m>=5){if(this.skip(o,e))continue;if(_<2){if(this.skip(s,e))continue}else if(_>=4&&this.skip(l,e))continue}else if(_<1){if(this.skip(n,e,!0)||this.skip(s,e))continue}else if(_<2){if(this.skip(o,e)||this.skip(n,e,!0))continue}else if(_>=5){if(this.skip(r,e)||this.skip(l,e))continue}else if(_>=4){if(this.skip(o,e)||this.skip(r,e))continue}else if(this.skip(o,e))continue}else if(m<2){if(a&&a.z>=e.z&&m<(_<1||_>4?f-1:f))continue;if(m<1){if(_<2){if(this.skip(u,e,!0))continue}else if(_>=4&&this.skip(h,e))continue}else if(_<1){if(this.skip(n,e,!0)||this.skip(u,e,!0))continue}else if(_<2){if(this.skip(n,e,!0))continue}else if(_>=5){if(this.skip(r,e)||this.skip(h,e))continue}else if(_>=4&&this.skip(r,e))continue}else{if(a&&a.z>=e.z&&m<(_<1||_>4?f-1:f))continue;if(_<2){if(this.skip(n,e,!0))continue}else if(_>=4&&this.skip(r,e))continue}this.updateTilePixel(g,y,v)}}}},e.prototype.getTile=function(t,e){return this.tilemaplist[t]&&this.tilemaplist[t][e]},e.prototype.getDownHeight=function(t){var e=6;if(t)switch(t.spriteName){case"hills_0":case"mountains_2":e=7;break;case"mountains_0":e=8;break;case"mountains_1":e=9}return e-4},e.prototype.skip=function(t,e,i){return void 0===i&&(i=!1),t&&t.z>e.z},e.prototype.clear=function(){t.prototype.clear.call(this),this.tilemaplist=[],this.tileborderlist=[]},s([p],e)}(u.default));n.default=f,cc._RF.pop()},{}],TileTypeBase:[function(t,e,i){"use strict";cc._RF.push(e,"fdbedIzpwFOa4vtkgNRiwWC","TileTypeBase");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0}),n.TileTypeBase=n.TileSprites=n.Tile=n.TileZIndexes=n.TileLayerType=n.TileRank=void 0;var s,l,c,d=a("Constants"),u=a("WorldAction"),h=a("AssetLibrary"),p=a("ToolBox");(function(t){t[t.Nothing=0]="Nothing",t[t.Low=1]="Low",t[t.High=2]="High"})(s=n.TileRank||(n.TileRank={})),function(t){t[t.Ground=0]="Ground",t[t.Ocean=1]="Ocean",t[t.Swamp=2]="Swamp",t[t.Lava=3]="Lava",t[t.Block=4]="Block",t[t.Goo=5]="Goo"}(l=n.TileLayerType||(n.TileLayerType={})),function(t){t[t.nothing=0]="nothing",t[t.pit_deep_ocean=1]="pit_deep_ocean",t[t.pit_close_ocean=2]="pit_close_ocean",t[t.pit_shallow_waters=3]="pit_shallow_waters",t[t.deep_ocean=4]="deep_ocean",t[t.close_ocean=5]="close_ocean",t[t.shallow_waters=6]="shallow_waters",t[t.border_pit=7]="border_pit",t[t.border_water=8]="border_water",t[t.swamp_low=9]="swamp_low",t[t.swamp_high=10]="swamp_high",t[t.ice=11]="ice",t[t.road=12]="road",t[t.sand=13]="sand",t[t.snow_sand=14]="snow_sand",t[t.soil_low=15]="soil_low",t[t.soil_high=16]="soil_high",t[t.wasteland_low=17]="wasteland_low",t[t.wasteland_high=18]="wasteland_high",t[t.lava0=19]="lava0",t[t.lava1=20]="lava1",t[t.lava2=21]="lava2",t[t.lava3=22]="lava3",t[t.snow_low=23]="snow_low",t[t.snow_high=24]="snow_high",t[t.tumor_low=25]="tumor_low",t[t.tumor_high=26]="tumor_high",t[t.biomass_low=27]="biomass_low",t[t.biomass_high=28]="biomass_high",t[t.pumpkin_low=29]="pumpkin_low",t[t.pumpkin_high=30]="pumpkin_high",t[t.cybertile_low=31]="cybertile_low",t[t.cybertile_high=32]="cybertile_high",t[t.grass_low=33]="grass_low",t[t.grass_high=34]="grass_high",t[t.corruption_low=35]="corruption_low",t[t.corruption_high=36]="corruption_high",t[t.enchanted_low=37]="enchanted_low",t[t.enchanted_high=38]="enchanted_high",t[t.mushroom_low=39]="mushroom_low",t[t.mushroom_high=40]="mushroom_high",t[t.savanna_low=41]="savanna_low",t[t.savanna_high=42]="savanna_high",t[t.jungle_low=43]="jungle_low",t[t.jungle_high=44]="jungle_high",t[t.infernal_low=45]="infernal_low",t[t.infernal_high=46]="infernal_high",t[t.grass_flowers=47]="grass_flowers",t[t.field=48]="field",t[t.grass_forest_flowers=49]="grass_forest_flowers",t[t.fuse=50]="fuse",t[t.landmine=51]="landmine",t[t.water_bomb=52]="water_bomb",t[t.tnt_timed=53]="tnt_timed",t[t.tnt=54]="tnt",t[t.fireworks=55]="fireworks",t[t.hills=56]="hills",t[t.snow_hills=57]="snow_hills",t[t.mountains=58]="mountains",t[t.snow_block=59]="snow_block",t[t.grey_goo=60]="grey_goo"}(c=n.TileZIndexes||(n.TileZIndexes={}));var f=function(t,e){this.spriteName="",this.z=0,this.spriteName=t,this.z=e};n.Tile=f;var _=function(){function t(){this.tiles=[]}return t.prototype.addVariation=function(t,e){var i=new f(t,e);this.tiles.push(i)},t.prototype.getRandom=function(){return this.tiles.getRandom()},t.prototype.getVariation=function(t){return this.tiles[t]},t}();n.TileSprites=_;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.FIRE_STAGES=30,e.BURNED_STAGES=15,e.EXPLOSION_STAGES=60,e.MAX_HEIGHT=255,e.hashset=new Set,e._hashset_dirty=!1,e._current_tiles=[],e.increaseTo=null,e.decreaseTo=null,e.unitDeathAction=u.default.create(),e.stepAction=null,e.stepActionChance=.05,e.force_edge_variation=!1,e.force_edge_variation_frame=0,e.increaseToID="",e.decreaseToID="",e.freezeToID="",e.forceUnitSkinSet="default",e.creep=!1,e.wasteland=!1,e.indexID=0,e.tileName="",e.walkMod=1,e.rankType=s.Nothing,e.creepRankType=s.Nothing,e.biome="",e.biome_low="",e.biome_high="",e.canBeRemovedWithSickle=!1,e.canBeRemovedWithBucket=!1,e.canBeRemovedWithDemolish=!1,e.growToNearbyTiles=!1,e.grassStrength=0,e.spawn_units_list=[],e.spawn_units_auto=!1,e.block=!1,e.sprites=null,e.layerType=l.Ground,e.render_z=0,e.drawLayerName="",e.canBeSetOnFire=!1,e.burnable=!1,e.canBeFilledWithOcean=!1,e.fillToOcean="",e.liquid=!1,e.swamp=!1,e.ocean=!1,e.ground=!1,e.frozen=!1,e.road=!1,e.life=!1,e.damagedWhenWalked=!1,e.remove_on_heat=!1,e.remove_on_freeze=!1,e.greyGoo=!1,e.grass=!1,e.sand=!1,e.trees=!1,e.rocks=!1,e.soil=!1,e.terraformAfterFire=!1,e.explodable=!1,e.explodableDelayed=!1,e.explodableTimed=!1,e.explodableByOcean=!1,e.ignoreOceanEdgeRendering=!1,e.explodeRange=0,e.damageUnits=!1,e.damage=1,e.lava=!1,e.lavaLevel=-1,e.edge_hills=!1,e.edge_mountains=!1,e.grow_type_selector_trees=null,e.grow_type_selector_plants=null,e.grow_types_list_trees=[],e.grow_types_list_plants=[],e.grow_vegetation_auto=!1,e.canGrowBiomeGrass=!1,e.explodeTimer=0,e.cost=1,e.canBeFarmField=!1,e.canBuildOn=!1,e.fireChance=1,e.color=cc.Color.TRANSPARENT,e.edge_color=cc.Color.TRANSPARENT,e.drawPixel=!1,e.strength=3,e.heightMin=-1,e.additional_height=[],e.used_in_generator=!1,e}return r(e,t),e.prototype.isType=function(t){return this.id==t||this.indexID==t.indexID},e.prototype.setBiome=function(t){null==t?(this.biome="",this.biome_low="",this.biome_high=""):(this.biome=t,this.biome_low=t+"_low",this.biome_high=t+"_high")},e.prototype.setDrawLayer=function(t,i){void 0===i&&(i=""),t==c.nothing?(this.render_z=e.last_z,e.last_z++):this.render_z=t,this.drawLayerName=i||this.id},e.prototype.setAutoGrowPlants=function(t,e){void 0===e&&(e=[]),this.grow_types_list_plants=e,this.grow_type_selector_plants=t,this.grow_vegetation_auto=!0},e.prototype.setAutoGrowTrees=function(t,e){void 0===e&&(e=[]),this.grow_types_list_trees=[];for(var i=e,o=0;o<i.length;o++){var a=i[o];if(a.includes("#"))for(var n=a.split("#"),r=n[0],s=parseInt(n[1]),l=0;l<s;l++)this.grow_types_list_trees.push(r);else this.grow_types_list_trees.push(a)}this.grow_type_selector_trees=t,this.grow_vegetation_auto=!0},e.prototype.copyAutoGrowTrees=function(t){this.grow_types_list_trees=t.grow_types_list_trees,this.grow_type_selector_trees=t.grow_type_selector_trees,this.grow_vegetation_auto=t.grow_vegetation_auto},e.prototype.addUnitsToSpawn=function(t){this.spawn_units_auto=!0;for(var e=0;e<t.length;e++){var i=t[e];this.spawn_units_list.push(i)}},e.prototype.hashsetAdd=function(t){this._hashset_dirty=!0,this.hashset.add(t)},e.prototype.hashsetRemove=function(t){this._hashset_dirty=!0,this.hashset.delete(t)},e.prototype.getCurrentTiles=function(){return this._hashset_dirty&&(this._hashset_dirty=!1,this._current_tiles=Array.from(this.hashset)),this._current_tiles},e.prototype.hashsetClear=function(){this._current_tiles=[],this.hashset.clear(),this._hashset_dirty=!1},e.edge_color_ocean=p.Toolbox.makeColor(d.default.OLD_SKIN?"#2D61AF":"#1E9C9D"),e.edge_color_no_ocean=p.Toolbox.makeColor("#494949"),e.edge_color_hills=p.Toolbox.makeColor(d.default.OLD_SKIN?"#313333":"#344748"),e.edge_color_mountain=p.Toolbox.makeColor(d.default.OLD_SKIN?"#2C3032":"#344748"),e.last_indexID=0,e.last_z=0,e}(h.Asset);n.TileTypeBase=m,cc._RF.pop()},{}],TileZone:[function(t,e,i){"use strict";cc._RF.push(e,"56039nQdzlPDLc6v1uf8M0D","TileZone");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.ZoneData=void 0;var r=o("TileLibrary"),s=o("BaseBuilding"),l=o("TileTypeBase"),c=o("WorldTile");a.ZoneData=function(){this.x=0,this.y=0};var d=function(){function t(t,e,i){this.last_drawn_id=0,this.last_drawn_hashcode=0,this.visible=!1,this.x=0,this.y=0,this.id=0,this.tiles=[],this.debug_zone_color=cc.Color.TRANSPARENT,this.city=null,this.chunk=null,this.neighbours=[],this.neighboursAll=[],this.world_edge=!1,this.centerTile=null,this.tilesOnFire=0,this.tilesWithLiquid=0,this.tilesWithSoil=0,this.tilesWithGround=0,this.buildings_all=new Set,this.buildings=new Set,this.abandoned=new Set,this.trees=new Set,this.ruins=new Set,this.stone=new Set,this.gold=new Set,this.ore=new Set,this.food=new Set,this.wheat=new Set,this.plants=new Set,this.buildingLists=[],this.zone_up=null,this.zone_down=null,this.zone_left=null,this.zone_right=null,this.tileTypes=new Map,this.canBeFarms=[],this.goodForNewCity=!1,this.zoneChecked=!1,this.culture=null,this.x=t,this.y=e,this.id=i,this.buildingLists.push(this.buildings_all),this.buildingLists.push(this.buildings),this.buildingLists.push(this.abandoned),this.buildingLists.push(this.trees),this.buildingLists.push(this.ruins),this.buildingLists.push(this.stone),this.buildingLists.push(this.gold),this.buildingLists.push(this.ore),this.buildingLists.push(this.food),this.buildingLists.push(this.wheat)}return t.prototype.haveBuildingOf=function(t){var e,i;try{for(var o=n(this.buildings),a=o.next();!a.done;a=o.next()){var r=a.value;if(!r.isNonUsable()&&r.city==t)return!0}}catch(c){e={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return!1},t.prototype.addTileType=function(t,e){var i=this.tileTypes.get(t);i||(i=new Set,this.tileTypes.set(t,i),t.canBeFarmField&&this.canBeFarms.push(t)),i.add(e)},t.prototype.removeTileType=function(t,e){var i=this.tileTypes.get(t);null==i||i.delete(e)},t.prototype.getTilesOfType=function(t){return this.tileTypes.has(t)?this.tileTypes.get(t):null},t.prototype.haveTiles=function(t){return!!this.tileTypes.has(t)&&this.tileTypes.get(t).size>0},t.prototype.countCanBeFarms=function(){for(var t=0,e=0;e<this.canBeFarms.length;e++){var i=this.canBeFarms[e];t+=this.tileTypes.get(i).size}return t},t.prototype.addTile=function(t,e,i){switch(this.tiles.push(t),e){case 0:t.worldTileZoneBorder.borderLeft=!0,t.worldTileZoneBorder.border=!0;break;case 7:t.worldTileZoneBorder.borderRight=!0,t.worldTileZoneBorder.border=!0}switch(i){case 0:t.worldTileZoneBorder.borderDown=!0,t.worldTileZoneBorder.border=!0;break;case 7:t.worldTileZoneBorder.border=!0,t.worldTileZoneBorder.borderUp=!0}},t.prototype.setCity=function(t){this.city=t,!this.city&&this.culture&&this.culture.removeZone(this)},t.prototype.setCulture=function(t){this.culture=t},t.prototype.removeCulture=function(){this.culture=null},t.prototype.addBuilding=function(t){var e,i=null;if(t.isRuin())i=this.ruins;else if(t.data.state==s.BuildingState.CivAbandoned)i=this.abandoned;else switch(null===(e=t.stats)||void 0===e?void 0:e.buildingType){case s.BuildingType.Plant:i=this.plants;break;case s.BuildingType.Tree:i=this.trees;break;case s.BuildingType.Stone:i=this.stone;break;case s.BuildingType.Ore:i=this.ore;break;case s.BuildingType.Gold:i=this.gold;break;case s.BuildingType.Fruits:i=this.food;break;case s.BuildingType.Wheat:i=this.wheat;break;default:i=t.isRuin()?this.ruins:this.buildings}i.add(t),this.buildings_all.add(t)},t.prototype.removeBuilding=function(t){var e,i;if(this.buildings_all.delete(t),this.abandoned.delete(t),this.buildings.delete(t),this.ruins.delete(t),0!=(null===(e=t.stats)||void 0===e?void 0:e.buildingType))switch(null===(i=t.stats)||void 0===i?void 0:i.buildingType){case s.BuildingType.Plant:this.plants.delete(t);break;case s.BuildingType.Tree:this.trees.delete(t);break;case s.BuildingType.Stone:this.stone.delete(t);break;case s.BuildingType.Ore:this.ore.delete(t);break;case s.BuildingType.Gold:this.gold.delete(t);break;case s.BuildingType.Fruits:this.food.delete(t);break;case s.BuildingType.Wheat:this.wheat.delete(t)}},t.prototype.addNeighbour=function(t,e,i){if(void 0===i&&(i=!1),t)switch(i||this.neighbours.push(t),this.neighboursAll.push(t),e){case c.TileDirection.Up:this.zone_up=t;break;case c.TileDirection.Down:this.zone_down=t;break;case c.TileDirection.Left:this.zone_left=t;break;case c.TileDirection.Right:this.zone_right=t}else this.world_edge=!0},t.prototype.canPlaceCityHere=function(){return!(this.city||this.tilesWithGround<64)},t.prototype.goodForExpansion=function(){return!(this.haveTiles(r.default.lava0)||this.haveTiles(r.default.lava1)||this.haveTiles(r.default.lava2)||this.haveTiles(r.default.lava3))},t.prototype.isInLimitFor=function(t,e,i){switch(e.buildingType){case s.BuildingType.Tree:if(t.main_type.rankType==l.TileRank.Low&&(i=1),this.trees.size>=i)return!0;break;case s.BuildingType.Plant:if(this.plants.size>=i)return!0;break;case s.BuildingType.Fruits:if(this.food.size>=i)return!0}return!1},t.prototype.clear=function(){this.tileTypes.forEach(function(t){t.clear()}),this.buildingLists.forEach(function(t){t.clear()}),this.city=null,this.culture=null,this.goodForNewCity=!1,this.last_drawn_id=0,this.last_drawn_hashcode=0},t}();a.default=d,cc._RF.pop()},{}],TimeScale:[function(t,e,i){"use strict";cc._RF.push(e,"ebc46cpnJZGhbYirZ1xi7iY","TimeScale");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AdsManager"),c=a("UserData"),d=a("GamePopBase"),u=a("MsgCache"),h=a("GameAudio"),p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=null,e.label=null,e.propID="clock",e}return r(e,t),e.prototype.onLoad=function(){var t=c.default.getPropConfigByID(this.propID);this.label.string="\u52a0\u901f"+t.reward+"\u79d2",this.num.string=t.reward.toString()},e.prototype.click=function(t){var e=this;h.default.playClick();var i=t.getCurrentTarget().getComponent(cc.Button);i.interactable=!1,l.default.showVideoAds(function(t){if(1==t){var o=c.default.getPropByID(e.propID),a=c.default.getPropConfigByID(e.propID);o.number+=a.reward,c.default.save(),e.clickCB&&e.clickCB(),e.close()}else{i.interactable=!0;var n=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";u.default.pushToast(n)}})},s([_(cc.Label)],e.prototype,"num",void 0),s([_(cc.Label)],e.prototype,"label",void 0),s([f],e)}(d.GamePopBase);n.default=m,cc._RF.pop()},{}],ToolBox:[function(t,e,i){"use strict";cc._RF.push(e,"dd548nr6S1EmLcht4Z5jwJk","ToolBox");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},r=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(a,"__esModule",{value:!0}),a.Toolbox=void 0;var s=o("MathUtils"),l=o("LocalizedTextManager"),c=o("ActorAsset"),d=o("MapBox"),u=function(){function t(){}return t.coloredText=function(t,e,i){return void 0===i&&(i=!1),i&&(t=l.LocalizedTextManager.getText(t)),"<color="+e+">"+t+"</color>"},t.areColorsEqual=function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b},t.inBounds=function(t,e,i){return t>e&&t<i},t.init=function(){t.color_plague=t.makeColor("#CE4A9B"),t.color_infected=t.makeColor("#35CC6E")},t.rotatePointAroundPivot=function(t,e,i){return i.multiply(t.sub(e)).add(e)},t.cubeBezier3=function(t,e,i,o,a){var n=1-a,r=n*n*n,s=n*n*a*3,l=n*a*a*3,c=a*a*a;return cc.v3(r*t.x+s*e.x+l*i.x+c*o.x,r*t.y+s*e.y+l*i.y+c*o.y,r*t.z+s*e.z+l*i.z+c*o.z)},t.easeInOutQuart=function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},t.generateID=function(){return t.gid++,t.gid},t.getNewPoint=function(e,i,o,a,n,r){void 0===r&&(r=!0);var s,l=cc.Vec3.ZERO,c=t.dist(e,i,o,a);if(c-n==0)return s=1,l.set(cc.v3(o,a,0)),l;s=n/(c-n),r&&s<0&&(s=0-s);var d=(e+s*o)/(1+s),u=(i+s*a)/(1+s);return l.x=d,l.y=u,l},t.distVec3=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.distVec2=function(t,e){return cc.Vec2.distance(t,e)},t.distVec2Float=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.distTile=function(e,i){return e&&i?t.distVec2(e.pos,i.pos):0},t.dist=function(t,e,i,o){return Math.sqrt((t-i)*(t-i)+(e-o)*(e-o))},t.setRandomSeed=function(e){t.randomSeed=e,s.default.setRandomSeed(e)},t.randomRate=function(t){return Math.random()<t},t.randomChance=function(t){return s.default.randomChance(t)},t.randomBool=function(){return s.default.randomBool()},t.randomRange=function(t,e){return s.default.randomInt(t,e)},t.randomFloat=function(t,e){return s.default.randomRange(t,e)},t.randomPointOnCircle=function(t,e){return cc.Vec2.random(cc.Vec2.ZERO).normalizeSelf().mulSelf(s.default.randomRange(t,e))},t.randomInt=function(t,e){return s.default.randomInt(t,e)},t.getRandom=function(t){return t instanceof Set&&(t=Array.from(t)),s.default.getRandom(t)},t.getRandomColor=function(){return cc.color(s.default.randomInt(0,255),s.default.randomInt(0,255),s.default.randomInt(0,255),255)},t.makeColor=function(t){var e=new cc.Color;return cc.Color.fromHEX(e,t)},t.colorToHex=function(t){return"#"+t.toHEX()},t.coloredString=function(t,e){return e?"<color="+e+">"+t+"</color>":t},t.getAngle=function(t,e,i,o){return Math.atan2(o-e,i-t)},t.makeDarkerColor=function(t,e){return void 0===e&&(e=.4),cc.color(t.r*e,t.g*e,t.b*e,t.a)},t.blendColor=function(t,e,i){var o=t.r*i+e.r*(1-i),a=t.g*i+e.g*(1-i),n=t.b*i+e.b*(1-i);return cc.color(o,a,n)},t.getClosestTile=function(e,i){for(var o=null,a=1e4,n=1e4,r=0;r<e.length;r++){var s=e[r];a=t.dist(i.pos.x,i.pos.y,s.pos.x,s.pos.y),(!o||a<n)&&(n=a,o=s)}return o},t.getRandomTileWithinDistance=function(e,i,o,a){for(var n=[],r=0;r<e.length;r++){var s=e[r],l=t.dist(i.pos.x,i.pos.y,s.pos.x,s.pos.y);l>o&&l<a&&n.push(s)}return t.getRandom(n)},t.getClosestActor=function(e,i){for(var o=null,a=1e4,n=1e4,r=0;r<e.length;r++){var s=e[r],l=s.currentTile;a=t.dist(i.pos.x,i.pos.y,l.pos.x,l.pos.y),(!o||a<n)&&(n=a,o=s)}return o},t.moveTowards=function(t,e,i){var o=cc.v2(t),a=cc.v2(e).sub(o),n=a.mag();if(n<=i||0==n)return e;var r=cc.v2(o);return a.mulSelf(i/n),r.addSelf(a),cc.v3(r)},t.formatTimer=function(t){var e,i=s.default.intCast(t/60),o=s.default.intCast(t-60*i);return e=i>=10?i+":":"0"+i+":",o<10?e+"0"+o:e+o},t.getRandomChunkFromTile=function(e){return t.temp_list_chunks=[],t.temp_list_chunks.push(e.chunk),t.temp_list_chunks.addRange(e.chunk.neighboursAll),t.getRandom(t.temp_list_chunks)},t.getRandomTileAround=function(e){var i=t.getRandomChunkFromTile(e).tiles;return t.getRandom(i)},t.getAllChunksFromTile=function(e){return t.temp_list_chunks=[],t.temp_list_chunks.push(e.chunk),t.temp_list_chunks.addRange(e.chunk.neighboursAll),t.temp_list_chunks},t.findNotSameRaceInChunkAround=function(e,i){var o;t.temp_list_objects=[],t.temp_list_units=[],t.fillChunkWithUnits(e);for(var a=0;a<e.neighboursAll.length;a++){var n=e.neighboursAll[a];t.fillChunkWithUnits(n)}for(a=0;a<t.temp_list_objects.length;a++)for(var r=t.temp_list_objects[a],s=0;s<r.length;s++){var l=r[s];(null==l?void 0:l.isActor())&&!(null===(o=null==l?void 0:l.a)||void 0===o?void 0:o.isRace(i))&&t.temp_list_units.push(l.a)}},t.findSameUnitInChunkAround=function(e,i){var o,a;t.temp_list_objects=[],t.temp_list_units=[],t.fillChunkWithUnits(e);for(var n=0;n<e.neighboursAll.length;n++){var r=e.neighboursAll[n];t.fillChunkWithUnits(r)}for(n=0;n<t.temp_list_objects.length;n++)for(var s=t.temp_list_objects[n],l=0;l<s.length;l++){var c=s[l];(null==c?void 0:c.isActor())&&(null==c?void 0:c.a)&&(null===(a=null===(o=null==c?void 0:c.a)||void 0===o?void 0:o.stats)||void 0===a?void 0:a.id)==i&&t.temp_list_units.push(c.a)}},t.findSameRaceInChunkAround=function(e,i){var o;t.temp_list_objects=[],t.temp_list_units=[],t.fillChunkWithUnits(e);for(var a=0;a<e.neighboursAll.length;a++){var n=e.neighboursAll[a];t.fillChunkWithUnits(n)}for(a=0;a<t.temp_list_objects.length;a++)for(var r=t.temp_list_objects[a],s=0;s<r.length;s++){var l=r[s];(null==l?void 0:l.isActor())&&(null===(o=null==l?void 0:l.a)||void 0===o?void 0:o.isRace(i))&&t.temp_list_units.push(l.a)}},t.fillChunkWithUnits=function(e){if(0!=e.k_list_objects.length)for(var i=0;i<e.k_list_objects.length;i++){var o=e.k_list_objects[i];o&&t.temp_list_objects.push(e.k_dict_objects.get(o))}},t.fillListWithUnitsFromChunk=function(t,e){if(0!=t.k_list_objects.length)for(var i=0;i<t.k_list_objects.length;i++){var o=t.k_list_objects[i];if(o)for(var a=t.k_dict_objects.get(o),n=0;n<a.length;n++){var r=a[n];r&&r.isActor()&&e.push(r.a)}}},t.findEnemiesOfKingdomInChunk=function(e,i){var o,a;if(0!=e.k_list_objects.length&&i)for(var n=0;n<e.k_list_objects.length;n++){var r=e.k_list_objects[n];!r||((null===(o=r.asset)||void 0===o?void 0:o.mobs)||(null===(a=i.asset)||void 0===a?void 0:a.mobs))&&d.default.inst.worldLaws.world_law_peaceful_monsters.boolVal||!i.isEnemy(r)||t.temp_list_objects_enemies.push(e.k_dict_objects.get(r))}},t.addToTempChunksBuildingsType=function(e,i,o){var a,s,l,c,d,u;if(void 0===o&&(o=!1),0!=e.k_dict_objects.size)try{for(var h=n(e.k_dict_objects),p=h.next();!p.done;p=h.next()){var f=r(p.value,2),_=(f[0],f[1]);try{for(var m=(l=void 0,n(_)),g=m.next();!g.done;g=m.next()){var y=g.value;(null==y?void 0:y.isBuilding())&&(null===(u=null===(d=null==y?void 0:y.b)||void 0===d?void 0:d.data)||void 0===u?void 0:u.alive)&&y.b.haveResources&&!y.b.currentTile.targetedBy&&y.b.stats.type==i&&t.temp_list_buildings_2.push(y.b)}}catch(v){l={error:v}}finally{try{g&&!g.done&&(c=m.return)&&c.call(m)}finally{if(l)throw l.error}}}}catch(b){a={error:b}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}},t.lookAt2D=function(t,e){var i=Math.atan2(e.y-t.y,e.x-t.x);return cc.misc.radiansToDegrees(i)},t.lowerCaseFirst=function(t){return 0==t.length?"":t[0].toLowerCase()+(t.length>1?t.substring(1):"")},t.randomSeed=0,t.gid=0,t.directions=[c.ActorDirection.Up,c.ActorDirection.Right,c.ActorDirection.Down,c.ActorDirection.Left],t.directions_all=[c.ActorDirection.Up,c.ActorDirection.UpRight,c.ActorDirection.UpLeft,c.ActorDirection.Right,c.ActorDirection.DownRight,c.ActorDirection.DownLeft,c.ActorDirection.Down,c.ActorDirection.Left],t.EVERYTHING_MAGIC_COLOR32=t.makeColor("#DF7FFF"),t.color_green_0=t.makeColor("#B8FF96"),t.color_green_1=t.makeColor("#00FF00"),t.color_green_2=t.makeColor("#00AF00"),t.color_green_3=t.makeColor("#4A831F"),t.color_magenta_0=t.makeColor("#FF00FF"),t.color_magenta_1=t.makeColor("#DE00DE"),t.color_magenta_2=t.makeColor("#A700A7"),t.color_magenta_3=t.makeColor("#7F007F"),t.color_magenta_4=t.makeColor("#580058"),t.color_clear=cc.Color.TRANSPARENT,t.clear=cc.color(0,0,0,0),t.color_white=cc.Color.WHITE,t.color_white_32=cc.Color.WHITE,t.color_red=cc.Color.RED,t.color_yellow=cc.Color.YELLOW,t.color_abandoned_building=cc.color(178.5,178.5,178.5),t.color_positive="#43FF43",t.color_negative="#FB2C21",t.color_log_good=t.makeColor("#95DD5D"),t.color_log_warning=t.makeColor("#FF8686"),t.color_log_neutral=t.makeColor("#F3961F"),t.color_heal=t.makeColor("#23F3FF"),t.color_plague=t.makeColor("#CE4A9B"),t.color_mushSpores=t.makeColor("#8CFF99"),t.color_infected=t.makeColor("#35CC6E"),t.temp_list_units=[],t.temp_list_tiles=[],t.temp_list_chunks=[],t.temp_list_objects=[],t.temp_list_buildings=[],t.temp_list_buildings_2=[],t.temp_list_objects_enemies=[],t.temp_list_objects_enemies_chunk=null,t.temp_list_objects_enemies_kingdom=null,t}();a.Toolbox=u,cc._RF.pop()},{}],ToolTip:[function(t,e,i){"use strict";cc._RF.push(e,"2d810bzgLpDQplq8eIPFPGr","ToolTip");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.TooltipOpinionInfo=void 0;var l=a("MathUtils"),c=a("GlobalNode"),d=a("LocalizedTextManager"),u=a("ItemTools"),h=a("ToolBox"),p=a("Config"),f=a("MapBox"),_=a("TextureLoader"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(){this.description="",this.value=0};n.TooltipOpinionInfo=v;var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.txtName=null,e.txtDesc=null,e.desc_layout=null,e.value_layout=null,e.debugPosY=0,e.debugPosSizeY=0,e.timeout=0,e.clearTimer=0,e.list=[],e.temp_description="",e.temp_description_stat="",e.temp_value="",e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,this.node.parent.active=!1},e.prototype.checkClear=function(){!this.node.parent.active&&i.lastObject&&(this.clearTimer<.2?this.clearTimer+=cc.director.getDeltaTime():i.lastObject=null)},e.prototype.isShowingFor=function(t){return i.lastObject==t},e.prototype.show=function(t,e,o,a){var n,r,s,l,c,u=this;void 0===o&&(o=""),void 0===a&&(a=""),i.lastObject=t,this.node.parent.active=!0,this.node.scaleY=.1,cc.tween(this.node).to(.2,{scaleY:1},{easing:"backOut"}).start(),this.timeout=.1,this.txtDesc.node.active=!1,this.desc_layout.active=!1,this.value_layout.active=!1,this.list=[],this.temp_description="",this.temp_description_stat="",this.temp_value="";var f=this.value_layout.getChildByName("StatsDescription").getComponent(cc.RichText),_=this.value_layout.getChildByName("StatsValues").getComponent(cc.RichText);switch(e){case"kingdom":this.txtName.string=h.Toolbox.coloredText(null!==(s=null===(r=null===(n=i.info_kingdom)||void 0===n?void 0:n.data)||void 0===r?void 0:r.name)&&void 0!==s?s:"",h.Toolbox.colorToHex(null===(c=null===(l=i.info_kingdom)||void 0===l?void 0:l.kingdomColor)||void 0===c?void 0:c.colorBorderOut)),this.value_layout.active=!0,this.setKingdomOpinion();break;case"normal":o&&(this.txtName.string=d.LocalizedTextManager.getText(o)),a&&(this.temp_description=d.LocalizedTextManager.getText(a));break;case"equipment":this.showEquipment();break;case"resource":this.showResource();break;case"world_law":this.txtName.string=d.LocalizedTextManager.getText(i.info_tip),this.temp_description=d.LocalizedTextManager.getText(a),this.temp_description+="\n\n",this.temp_description+=h.Toolbox.coloredText(d.LocalizedTextManager.getText("world_laws_tip_mobile_tap"),"#999999");break;case"tip":if(d.LocalizedTextManager.contains(i.info_tip)?this.txtName.string=d.LocalizedTextManager.getText(i.info_tip):this.txtName.string=i.info_tip,a&&(this.temp_description=a,this.temp_description=d.LocalizedTextManager.getText(a),this.temp_description.includes("$favorite_food$"))){var m="??";p.default.selectedUnit.data.favoriteFood&&(m=d.LocalizedTextManager.getText(p.default.selectedUnit.data.favoriteFood)),this.temp_description=this.temp_description.replace("$favorite_food$",m)}"loyalty"==i.info_tip&&this.setLoyalty()}if(this.list.length>0){this.list.sort(function(t,e){return t.value-e.value});for(var g=!1,y=!1,v=0;v<this.list.length;v++){var b=this.list[v];b.value>0&&(g=!0),b.value<0&&!y&&v>0&&g&&(y=!0,this.temp_description_stat+="\n---",this.temp_value+="\n---"),v>0&&(this.temp_description_stat+="\n",this.temp_value+="\n"),b.value>0?(this.temp_value+=h.Toolbox.coloredText("+"+b.value,h.Toolbox.color_positive),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText(b.description),"#43FF43")):(this.temp_value+=h.Toolbox.coloredText(""+b.value,h.Toolbox.color_negative),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText(b.description),"#FB2C21"))}f.string=this.temp_description_stat,_.string=this.temp_value}this.temp_description&&("equipment"==e?this.desc_layout.getChildByName("Description").getComponent(cc.RichText).string=this.temp_description:(this.txtDesc.string=this.temp_description,this.txtDesc.node.active=!0));var w=this.txtDesc.node.active||this.desc_layout.active||this.value_layout.active;this.node.getChildByName("top").getComponent(cc.Sprite).enabled=w,this.node.getChildByName("bottom").active=w,this.node.getComponent(cc.Sprite).enabled=!w,this.node.opacity=0,this.scheduleOnce(function(){u.node.opacity=255;var t=i.lastObject.parent.convertToWorldSpaceAR(i.lastObject.position),e=t.clone();t.x<=.4*cc.winSize.width?e.x=t.x+i.lastObject.width/2+u.node.width/2:t.x>=.6*cc.winSize.width&&(e.x=t.x-i.lastObject.width/2-u.node.width/2),t.y<=.3*cc.winSize.height?e.y=t.y+i.lastObject.height/2+u.node.height/2:e.x==t.x&&(e.y=t.y-i.lastObject.height/2-u.node.height/2),u.node.position=u.node.parent.convertToNodeSpaceAR(e)},.02)},e.prototype.showResource=function(){this.txtName.string=d.LocalizedTextManager.getText(i.info_resource.id),this.temp_description_stat+=d.LocalizedTextManager.getText("amount"),this.temp_value+=p.default.selectedCity.data.storage.get(i.info_resource.id),"gold"==i.info_resource.id&&(this.addItemText("yearly_gain",p.default.selectedCity.gold_change),this.temp_description_stat+="\n",this.temp_value+="\n",this.addItemText("tax",p.default.selectedCity.gold_in_tax),this.temp_description_stat+="\n---",this.temp_value+="\n---",0!=p.default.selectedCity.gold_out_army&&this.addItemText("upkeep_army",-p.default.selectedCity.gold_out_army),0!=p.default.selectedCity.gold_out_buildigs&&this.addItemText("upkeep_buildings",-p.default.selectedCity.gold_out_buildigs),0!=p.default.selectedCity.gold_out_homeless&&this.addItemText("upkeep_homeless",-p.default.selectedCity.gold_out_homeless)),this.value_layout.active=!0;var t=this.value_layout.getChildByName("StatsDescription").getComponent(cc.RichText),e=this.value_layout.getChildByName("StatsValues").getComponent(cc.RichText);t.string=this.temp_description_stat,e.string=this.temp_value},e.prototype.showEquipment=function(){var t,e;if(i.info_equipment_slot){var o=i.info_equipment_slot.data;if(o){this.desc_layout.active=!0;var a=this.value_layout.getChildByName("StatsDescription").getComponent(cc.RichText),n=this.value_layout.getChildByName("StatsValues").getComponent(cc.RichText),r="item_"+o.id;"0"!=o.prefix&&(r=r+"_"+o.prefix);var s=d.LocalizedTextManager.getText("item_name_template");s=s.replace("$item_id$",d.LocalizedTextManager.getText(r)),s="0"!=o.suffix?s.replace("$item_suffix$",d.LocalizedTextManager.getText("item_suffix_of_"+o.suffix)):s.replace("$item_suffix$","");var c="icons/items/icon_"+o.id;"base"!=o.material&&(c=c+"_"+o.material),this.icon.spriteFrame=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,c),u.default.calcItemValues(o);var p=u.default.getItemClass(o.type);this.addItemText("damage",u.default.s_stats.damage),this.addItemText("attackSpeed",l.default.intCast(u.default.s_stats.attackSpeed)),this.addItemText("crit",l.default.intCast(u.default.s_stats.crit),!0),this.addItemText("armor",u.default.s_stats.armor,!0),this.addItemText("speed",l.default.intCast(u.default.s_stats.speed)),this.addItemText("diplomacy",u.default.s_stats.diplomacy),this.addItemText("health",u.default.s_stats.health),this.addItemText("damage",l.default.intCast(u.default.s_stats.mod_damage),!0,!0,!0),this.addItemText("attackSpeed",l.default.intCast(u.default.s_stats.mod_attackSpeed),!0,!0,!0),this.addItemText("crit",l.default.intCast(u.default.s_stats.mod_crit),!0,!0,!0),this.addItemText("armor",l.default.intCast(u.default.s_stats.mod_armor),!0,!0,!0),this.addItemText("speed",l.default.intCast(u.default.s_stats.mod_speed),!0,!0,!0),this.addItemText("diplomacy",l.default.intCast(u.default.s_stats.mod_diplomacy),!0,!0,!0),this.addItemText("health",l.default.intCast(u.default.s_stats.mod_health),!0,!0,!0),this.temp_value.length>0&&(this.value_layout.active=!0,a.string=this.temp_description_stat,n.string=this.temp_value);var m="",g="#ffffff";switch(u.default.s_quality){case u.ItemQuality.Junk:g="#9E9E9E",m="";break;case u.ItemQuality.Normal:g="#FFFFFF",m="";break;case u.ItemQuality.Rare:g="#66AFFF",m="_rare";break;case u.ItemQuality.Epic:g="#FFF15E",m="_epic";break;case u.ItemQuality.Legendary:g="#FF7028",m="_legendary"}"base"!=o.material&&(s="("+d.LocalizedTextManager.getText("item_mat_"+o.material)+") "+s),this.txtName.string=h.Toolbox.coloredText(s,g);var y=d.LocalizedTextManager.getText(p+m),v=d.LocalizedTextManager.getText("item_template_description_full"),b=d.LocalizedTextManager.getText("item_template_description_age_only");o.by||(v=b);var w=f.default.inst.mapStats.year-i.info_equipment_slot.data.year+1;v=(v=(v=v.replace("$item_creator_name$",i.info_equipment_slot.data.by)).replace("$item_creator_kingdom$",i.info_equipment_slot.data.from)).replace("$item_creator_years$",""+w),v=w>=1?v.replace("$year_ending$",null!==(t=d.LocalizedTextManager.getText("item_template_description_years"))&&void 0!==t?t:""):v.replace("$year_ending$",null!==(e=d.LocalizedTextManager.getText("item_template_description_year"))&&void 0!==e?e:""),this.temp_description+=h.Toolbox.coloredText(y,g),this.temp_description+="\n",this.temp_description=this.temp_description+"\n"+h.Toolbox.coloredText(v,g)}}},e.prototype.addItemText=function(t,e,i,o,a){if(void 0===i&&(i=!1),void 0===o&&(o=!0),void 0===a&&(a=!1),0!=e){this.temp_description_stat.length>0&&(this.temp_description_stat+="\n",this.temp_value+="\n");var n=""+e;o?e>0?(this.temp_value+=h.Toolbox.coloredText("+"+n+(i?"%":""),"#43FF43"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText(t),"#43FF43")):(this.temp_value+=h.Toolbox.coloredText(n+(i?"%":""),"#FB2C21"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText(t),"#FB2C21")):(this.temp_value+=h.Toolbox.coloredText(n+(i?"%":""),"#ffffff"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText(t),"#ffffff"))}},e.prototype.setKingdomOpinion=function(){var t=f.default.inst.kingdoms.diplomacyManager.getRelation(i.info_kingdom,p.default.selectedKingdom);t.recalculate();var e=t.getOpinion(p.default.selectedKingdom,i.info_kingdom);this.temp_description_stat+=d.LocalizedTextManager.getText("race"),this.temp_value+=d.LocalizedTextManager.getText(i.info_kingdom.race.nameLocale),this.temp_description_stat+="\n",this.temp_value+="\n",this.temp_description_stat+=d.LocalizedTextManager.getText("kingdom_statistics_age"),this.temp_value+=i.info_kingdom.data.age,this.temp_description_stat+="\n",this.temp_value+="\n",this.temp_description_stat+=d.LocalizedTextManager.getText("population"),this.temp_value+=i.info_kingdom.getPopulationTotal(),this.temp_description_stat+="\n",this.temp_value+="\n",this.temp_description_stat+=d.LocalizedTextManager.getText("army"),this.temp_value=this.temp_value+i.info_kingdom.countArmy()+"/"+i.info_kingdom.countArmyMax(),this.temp_description_stat+="\n",this.temp_value+="\n",this.temp_description_stat+="\n",this.temp_value+="\n";var o,a=l.default.intCast(e._opinion_total);if(a>=0?(this.temp_value+=h.Toolbox.coloredText(""+a,"#43FF43"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText("opinion_total"),"#43FF43")):(this.temp_value+=h.Toolbox.coloredText(""+a,"#FB2C21"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText("opinion_total"),"#FB2C21")),this.temp_description_stat+="\n---",this.temp_value+="\n---",this.temp_description_stat+="\n",this.temp_value+="\n",0!=e._opinion_king&&((o=new v).description="opinion_king",o.value=e._opinion_king,this.list.push(o)),0!=e._opinion_kings_mood&&((o=new v).description="opinion_kings_mood",o.value=e._opinion_kings_mood,this.list.push(o)),0!=e._opinion_is_supreme&&((o=new v).description="opinion_is_supreme",o.value=e._opinion_is_supreme,this.list.push(o)),0!=e._opinion_close_borders&&((o=new v).description="opinion_close_borders",o.value=e._opinion_close_borders,this.list.push(o)),0!=e._opinion_far_lands&&((o=new v).description="opinion_far_lands",o.value=e._opinion_far_lands,this.list.push(o)),0!=e._in_war&&((o=new v).description="opinion_in_war",o.value=e._in_war,this.list.push(o)),0!=e._opinion_same_wars&&((o=new v).description="opinion_same_wars",o.value=e._opinion_same_wars,this.list.push(o)),0!=e._opinion_race&&((o=new v).description="race",o.value=e._opinion_race,this.list.push(o)),0!=e._opinion_zones&&((o=new v).description="opinion_zones",o.value=e._opinion_zones,this.list.push(o)),0!=e._opinion_peace_time&&((o=new v).description="opinion_peace_time",o.value=e._opinion_peace_time,this.list.push(o)),0!=e._opinion_power&&((o=new v).description="opinion_power",o.value=e._opinion_power,this.list.push(o)),0!=e._opinion_traits&&((o=new v).description="opinion_loyalty_traits",o.value=e._opinion_traits,this.list.push(o)),0!=e._opinion_culture){var n=e._opinion_culture<=0?"opinion_culture_different":"opinion_culture_same";(o=new v).description=n,o.value=e._opinion_culture,this.list.push(o)}},e.prototype.setLoyalty=function(){this.txtName.string=d.LocalizedTextManager.getText("loyalty"),this.value_layout.active=!0,i.info_city._opinion_total>0?(this.temp_value+=h.Toolbox.coloredText(""+i.info_city._opinion_total,"#43FF43"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText("opinion_total"),"#43FF43")):(this.temp_value+=h.Toolbox.coloredText(""+i.info_city._opinion_total,"#FB2C21"),this.temp_description_stat+=h.Toolbox.coloredText(d.LocalizedTextManager.getText("opinion_total"),"#FB2C21")),this.temp_description_stat+="\n",this.temp_value+="\n",this.temp_description_stat+="\n",this.temp_value+="\n";var t=null;if(0!=i.info_city._opinion_world_law&&((t=new v).description="opinion_world_law",t.value=i.info_city._opinion_world_law,this.list.push(t)),0!=i.info_city._opinion_superior_enemies&&((t=new v).description="opinion_superior_enemies",t.value=i.info_city._opinion_superior_enemies,this.list.push(t)),0!=i.info_city._opinion_close_to_capital&&((t=new v).description="opinion_close_to_capital",t.value=i.info_city._opinion_close_to_capital,this.list.push(t)),0!=i.info_city._opinion_cities&&((t=new v).description="opinion_number_of_cities",t.value=i.info_city._opinion_cities,this.list.push(t)),0!=i.info_city._opinion_king&&((t=new v).description="opinion_king",t.value=i.info_city._opinion_king,this.list.push(t)),0!=i.info_city._opinion_new_city&&((t=new v).description="opinion_new_city",t.value=i.info_city._opinion_new_city,this.list.push(t)),0!=i.info_city._opinion_culture){var e=i.info_city._opinion_culture<=0?"opinion_culture_different":"opinion_culture_same";(t=new v).description=e,t.value=i.info_city._opinion_culture,this.list.push(t)}0!=i.info_city._opinion_new_kingdom&&((t=new v).description="opinion_new_kingdom",t.value=i.info_city._opinion_new_kingdom,this.list.push(t)),0!=i.info_city._opinion_leader&&((t=new v).description="opinion_leader",t.value=i.info_city._opinion_leader,this.list.push(t)),0!=i.info_city._opinion_loyalty_traits&&((t=new v).description="opinion_loyalty_traits",t.value=i.info_city._opinion_loyalty_traits,this.list.push(t)),0!=i.info_city._opinion_loyalty_mood&&((t=new v).description="opinion_leaders_loyalty_mood",t.value=i.info_city._opinion_loyalty_mood,this.list.push(t)),0!=i.info_city._opinion_population&&((t=new v).description="opinion_population",t.value=i.info_city._opinion_population,this.list.push(t)),0!=i.info_city._opinion_zones&&((t=new v).description="opinion_zones",t.value=i.info_city._opinion_zones,this.list.push(t)),0!=i.info_city._opinion_distance&&((t=new v).description="opinion_distance",t.value=i.info_city._opinion_distance,this.list.push(t)),0!=i.info_city._opinion_capital&&((t=new v).description="opinion_capital",t.value=i.info_city._opinion_capital,this.list.push(t))},e.prototype.update=function(){this.timeout>0&&(this.timeout-=cc.director.getDeltaTime()),c.default.inst.touched&&this.node.parent.active&&this.hide()},e.prototype.hide=function(){this.node.position=cc.Vec3.ZERO,this.node.parent.active=!1,this.clearTimer=0},e.hideTooltip=function(){i.inst&&(i.inst.hide(),i.lastObject=null)},e.inst=null,e.info_kingdom=null,e.info_tip="",e.info_tip_description="",e.info_equipment_slot=null,e.info_resource=null,e.info_city=null,e.lastObject=null,s([y(cc.Sprite)],e.prototype,"icon",void 0),s([y(cc.RichText)],e.prototype,"txtName",void 0),s([y(cc.RichText)],e.prototype,"txtDesc",void 0),s([y(cc.Node)],e.prototype,"desc_layout",void 0),s([y(cc.Node)],e.prototype,"value_layout",void 0),i=s([g],e)}(cc.Component);n.default=b,cc._RF.pop()},{}],TopTileLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"1be92JFQ9hO/Y76yyv7Wp2M","TopTileLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(n,"__esModule",{value:!0}),n.BiomeContainer=n.TopTileType=void 0;var c=a("Constants"),d=a("Tools"),u=a("WorldAction"),h=a("ActionLibrary"),p=a("ToolBox"),f=a("Config"),_=a("TileActionLibrary"),m=a("TileTypeBase"),g=a("TextureLoader"),y=a("AssetLibrary"),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(m.TileTypeBase);n.TopTileType=v;var b=function(){this.low=null,this.high=null};n.BiomeContainer=b;var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),e.grass_low=new v,e.grass_low.drawPixel=!0,e.grass_low.id="grass_low",e.grass_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#7EAF46":"#78CD93"),e.grass_low.heightMin=108,e.grass_low.grass=!0,e.grass_low.ground=!0,e.grass_low.walkMod=1,e.grass_low.growToNearbyTiles=!0,e.grass_low.grassStrength=5,e.grass_low.canBeFarmField=!0,e.grass_low.canBuildOn=!0,e.grass_low.canBeSetOnFire=!0,e.grass_low.burnable=!0,e.grass_low.strength=0,e.grass_low.fireChance=.05,e.grass_low.remove_on_freeze=!0,e.grass_low.remove_on_heat=!0,e.grass_low.canGrowBiomeGrass=!0,e.grass_low.creepRankType=m.TileRank.Low,e.grass_low.canBeRemovedWithSickle=!0,e.grass_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["tree"]),e.grass_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["mushroom","green_herb","flower"]),e.grass_low.setBiome("grass"),e.grass_low.setDrawLayer(m.TileZIndexes.grass_low),e.grass_low.addUnitsToSpawn(["sheep","rabbit","bear"]),this.add(e.grass_low),e.grass_high=new v,e.grass_high.cost=120,e.grass_high.drawPixel=!0,e.grass_high.id="grass_high",e.grass_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#5F833C":"#66AE7B"),e.grass_high.heightMin=128,e.grass_high.trees=!0,e.grass_high.grass=!0,e.grass_high.growToNearbyTiles=!0,e.grass_high.grassStrength=5,e.grass_high.canBeSetOnFire=!0,e.grass_high.burnable=!0,e.grass_high.additional_height=[15,16,17,14,13,12,11,10],e.grass_high.ground=!0,e.grass_high.walkMod=1,e.grass_high.canBuildOn=!0,e.grass_high.canBeFarmField=!0,e.grass_high.fireChance=.06,e.grass_high.strength=0,e.grass_high.remove_on_freeze=!0,e.grass_high.remove_on_heat=!0,e.grass_high.canGrowBiomeGrass=!0,e.grass_high.canBeRemovedWithSickle=!0,e.grass_high.creepRankType=m.TileRank.High,e.grass_high.addUnitsToSpawn(["sheep","rabbit","bear"]),e.grass_high.setBiome("grass"),e.grass_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["tree"]),e.grass_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["mushroom","green_herb","flower"]),e.grass_high.used_in_generator=!0,e.grass_high.setDrawLayer(m.TileZIndexes.grass_high),this.add(e.grass_high),e.savanna_low=this.clone("savanna_low","grass_low"),e.savanna_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["savanna_tree#5","savanna_tree_big#1"]),e.savanna_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["savanna_plant"]),e.savanna_low.addUnitsToSpawn(["monkey","buffalo","wolf"]),e.savanna_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#F0B121":"#F69F3B"),e.savanna_low.setBiome("savanna"),e.savanna_low.setDrawLayer(m.TileZIndexes.savanna_low),e.savanna_low.forceUnitSkinSet="savanna",e.savanna_low.fireChance=.06,e.savanna_high=this.clone("savanna_high","grass_high"),e.savanna_high.addUnitsToSpawn(["monkey","buffalo","wolf"]),e.savanna_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["savanna_tree#5","savanna_tree_big#1"]),e.savanna_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["savanna_plant"]),e.savanna_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#CF931B":"#DE8133"),e.savanna_high.setBiome("savanna"),e.savanna_high.setDrawLayer(m.TileZIndexes.savanna_high),e.savanna_high.forceUnitSkinSet="savanna",e.savanna_high.fireChance=.06,e.enchanted_low=this.clone("enchanted_low","grass_low"),e.enchanted_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["enchanted_tree"]),e.enchanted_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flower"]),e.enchanted_low.addUnitsToSpawn(["druid","butterfly","fox","rabbit","fairy"]),e.enchanted_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#8CDC6A":"#CBE868"),e.enchanted_low.setBiome("enchanted"),e.enchanted_low.grassStrength=6,e.enchanted_low.setDrawLayer(m.TileZIndexes.enchanted_low),e.enchanted_low.stepAction=h.default.giveBlessed,e.enchanted_low.forceUnitSkinSet="enchanted",e.enchanted_low.fireChance=.03,e.enchanted_high=this.clone("enchanted_high","grass_high"),e.enchanted_high.addUnitsToSpawn(["druid","butterfly","fox","rabbit","fairy"]),e.enchanted_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["enchanted_tree"]),e.enchanted_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flower"]),e.enchanted_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#76B153":"#B1BE4F"),e.enchanted_high.setBiome("enchanted"),e.enchanted_high.grassStrength=6,e.enchanted_high.setDrawLayer(m.TileZIndexes.enchanted_high),e.enchanted_high.stepAction=h.default.giveBlessed,e.enchanted_high.forceUnitSkinSet="enchanted",e.enchanted_high.fireChance=.04,e.mushroom_low=this.clone("mushroom_low","grass_low"),e.mushroom_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["mushroom_tree"]),e.mushroom_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flower","mushroom"]),e.mushroom_low.addUnitsToSpawn(["frog","sheep"]),e.mushroom_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#677642":"#8C844D"),e.mushroom_low.setBiome("mushroom"),e.mushroom_low.setDrawLayer(m.TileZIndexes.mushroom_low),e.mushroom_low.forceUnitSkinSet="mushroom",e.mushroom_low.fireChance=.03,e.mushroom_high=this.clone("mushroom_high","grass_high"),e.mushroom_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flower","mushroom"]),e.mushroom_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["mushroom_tree"]),e.mushroom_high.addUnitsToSpawn(["frog","sheep"]),e.mushroom_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#556338":"#70693F"),e.mushroom_high.setBiome("mushroom"),e.mushroom_high.setDrawLayer(m.TileZIndexes.mushroom_high),e.mushroom_high.forceUnitSkinSet="mushroom",e.mushroom_high.fireChance=.03,e.corruption_low=this.clone("corrupted_low","grass_low"),e.corruption_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["corrupted_tree","corrupted_tree_big"]),e.corruption_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["corrupted_plant"]),e.corruption_low.addUnitsToSpawn(["wraith_name"]),e.corruption_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#6F556C":"#79668F"),e.corruption_low.setBiome("corrupted"),e.corruption_low.grassStrength=6,e.corruption_low.setDrawLayer(m.TileZIndexes.corruption_low),e.corruption_low.unitDeathAction.add(h.default.spawnGhost),e.corruption_low.stepAction=h.default.giveCursed,e.corruption_low.forceUnitSkinSet="corrupted",e.corruption_low.fireChance=.02,e.corruption_high=this.clone("corrupted_high","grass_high"),e.corruption_high.addUnitsToSpawn(["wraith_name","necromancer"]),e.corruption_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["corrupted_tree","corrupted_tree_big"]),e.corruption_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["corrupted_plant"]),e.corruption_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#533F51":"#6E5F85"),e.corruption_high.setBiome("corrupted"),e.corruption_high.forceUnitSkinSet="corrupted",e.corruption_high.grassStrength=6,e.corruption_high.setDrawLayer(m.TileZIndexes.corruption_high),e.corruption_high.unitDeathAction.add(h.default.spawnGhost),e.corruption_high.stepAction=h.default.giveCursed,e.corruption_high.fireChance=.02,e.infernal_low=this.clone("infernal_low","grass_low"),e.infernal_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["infernal_tree","infernal_tree_big","infernal_tree_small"]),e.infernal_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flame_flower"]),e.infernal_low.addUnitsToSpawn(["fire_skull"]),e.infernal_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#9C3626":"#B42B3F"),e.infernal_low.setBiome("infernal"),e.infernal_low.grassStrength=6,e.infernal_low.burnable=!1,e.infernal_low.setDrawLayer(m.TileZIndexes.infernal_low),e.infernal_high=this.clone("infernal_high","grass_high"),e.infernal_high.addUnitsToSpawn(["fire_skull"]),e.infernal_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["infernal_tree","infernal_tree_big","infernal_tree_small"]),e.infernal_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["flame_flower"]),e.infernal_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#68372D":"#7B363E"),e.infernal_high.setBiome("infernal"),e.infernal_high.grassStrength=6,e.infernal_high.burnable=!1,e.infernal_high.setDrawLayer(m.TileZIndexes.infernal_high),e.jungle_low=this.clone("jungle_low","grass_low"),e.jungle_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["jungle_tree"]),e.jungle_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["jungle_plant","jungle_flower"]),e.jungle_low.addUnitsToSpawn(["snake","cat","monkey","frog"]),e.jungle_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#46A052":"#519D60"),e.jungle_low.setBiome("jungle"),e.jungle_low.setDrawLayer(m.TileZIndexes.jungle_low),e.jungle_low.forceUnitSkinSet="jungle",e.jungle_low.fireChance=.04,e.jungle_high=this.clone("jungle_high","grass_high"),e.jungle_high.addUnitsToSpawn(["snake","cat","monkey","frog"]),e.jungle_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["jungle_tree"]),e.jungle_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["jungle_plant","jungle_flower"]),e.jungle_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#1F7020":"#42844F"),e.jungle_high.setBiome("jungle"),e.jungle_high.setDrawLayer(m.TileZIndexes.jungle_high),e.jungle_high.forceUnitSkinSet="jungle",e.jungle_high.fireChance=.05,e.swamp_low=this.clone("swamp_low","grass_low"),e.swamp_low.layerType=m.TileLayerType.Swamp,e.swamp_low.swamp=!0,e.swamp_low.liquid=!0,e.swamp_low.canBeRemovedWithSickle=!1,e.swamp_low.canBeRemovedWithBucket=!0,e.swamp_low.addUnitsToSpawn(["crocodile","snake"]),e.swamp_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["swamp_tree"]),e.swamp_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["swamp_plant","swamp_plant_big"]),e.swamp_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#50816C":"#647583"),e.swamp_low.setBiome("swamp"),e.swamp_low.setDrawLayer(m.TileZIndexes.swamp_low),e.swamp_low.stepAction=_.default.giveSlownessStatus,e.swamp_low.forceUnitSkinSet="swamp",e.swamp_low.canBeSetOnFire=!1,e.swamp_low.burnable=!1,e.swamp_low.canBuildOn=!1,e.swamp_high=this.clone("swamp_high","grass_high"),e.swamp_high.layerType=m.TileLayerType.Swamp,e.swamp_high.swamp=!0,e.swamp_high.liquid=!0,e.swamp_high.canBeRemovedWithSickle=!1,e.swamp_high.canBeRemovedWithBucket=!0,e.swamp_high.addUnitsToSpawn(["frog","fly"]),e.swamp_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["swamp_tree"]),e.swamp_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#6AA68B":"#8891A4"),e.swamp_high.setBiome("swamp"),e.swamp_high.setDrawLayer(m.TileZIndexes.swamp_high),e.swamp_high.stepAction=_.default.giveSlownessStatus,e.swamp_high.forceUnitSkinSet="swamp",e.swamp_high.canBeSetOnFire=!1,e.swamp_high.burnable=!1,e.swamp_high.canBuildOn=!1,e.wasteland_low=this.clone("wasteland_low","grass_low"),e.wasteland_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["wasteland_tree"]),e.wasteland_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["wasteland_flower"]),e.wasteland_low.addUnitsToSpawn(["rat","acid_blob","frog","zombies"]),e.wasteland_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#849371":"#A29F7A"),e.wasteland_low.setBiome("wasteland"),e.wasteland_low.grass=!1,e.wasteland_low.trees=!1,e.wasteland_low.wasteland=!0,e.wasteland_low.burnable=!1,e.wasteland_low.growToNearbyTiles=!0,e.wasteland_low.canGrowBiomeGrass=!0,e.wasteland_low.grassStrength=111,e.wasteland_low.setDrawLayer(m.TileZIndexes.wasteland_low),e.wasteland_high=this.clone("wasteland_high","grass_high"),e.wasteland_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["wasteland_flower"]),e.wasteland_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["wasteland_tree"]),e.wasteland_high.addUnitsToSpawn(["rat","acid_blob","frog"]),e.wasteland_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#6C7759":"#79755A"),e.wasteland_high.setBiome("wasteland"),e.wasteland_high.grass=!1,e.wasteland_high.trees=!1,e.wasteland_high.wasteland=!0,e.wasteland_high.burnable=!1,e.wasteland_high.growToNearbyTiles=!0,e.wasteland_high.canGrowBiomeGrass=!0,e.wasteland_high.grassStrength=111,e.wasteland_high.setDrawLayer(m.TileZIndexes.wasteland_high),e.water_bomb=new v,e.water_bomb.cost=10,e.water_bomb.drawPixel=!0,e.water_bomb.id="water_bomb",e.water_bomb.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#7A00DE":"#00598D"),e.water_bomb.burnable=!1,e.water_bomb.explodable=!0,e.water_bomb.explodableDelayed=!0,e.water_bomb.explodeRange=9,e.water_bomb.explodableByOcean=!0,e.water_bomb.ignoreOceanEdgeRendering=!0,e.water_bomb.ground=!0,e.water_bomb.walkMod=1,e.water_bomb.canBeFilledWithOcean=!0,e.water_bomb.strength=0,e.water_bomb.canBuildOn=!0,e.water_bomb.setDrawLayer(m.TileZIndexes.water_bomb),e.water_bomb.canBeRemovedWithDemolish=!0,this.add(e.water_bomb),e.tumor_low=new v,e.tumor_low.drawPixel=!0,e.tumor_low.id="tumor_low",e.tumor_low.creep=!0,e.tumor_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#F45193":"#E36F8E"),e.tumor_low.heightMin=108,e.tumor_low.ground=!0,e.tumor_low.walkMod=.5,e.tumor_low.burnable=!0,e.tumor_low.life=!0,e.tumor_low.fireChance=1,e.tumor_low.strength=0,e.tumor_low.canBuildOn=!1,e.tumor_low.remove_on_freeze=!0,e.tumor_low.stepAction=_.default.giveTumorTrait,e.tumor_low.setDrawLayer(m.TileZIndexes.tumor_low),e.tumor_low.setBiome("tumor"),this.add(e.tumor_low),e.tumor_high=this.clone("tumor_high","tumor_low"),e.tumor_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#EF267A":"#EF437D"),e.tumor_high.stepAction=_.default.giveTumorTrait,e.tumor_high.setDrawLayer(m.TileZIndexes.tumor_high),e.tumor_high.setBiome("tumor"),e.biomass_low=this.clone("biomass_low","tumor_low"),e.biomass_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#45C842":"#7ED17F"),e.biomass_low.stepAction=_.default.giveSlownessStatus,e.biomass_low.stepAction=_.default.giveMadnessTrait,e.biomass_low.setDrawLayer(m.TileZIndexes.biomass_low),e.biomass_low.setBiome("biomass"),e.biomass_low.fireChance=.06,e.biomass_high=this.clone("biomass_high","tumor_high"),e.biomass_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#41A840":"#54B255"),e.biomass_high.stepAction=_.default.giveSlownessStatus,e.biomass_high.stepAction=_.default.giveMadnessTrait,e.biomass_high.setDrawLayer(m.TileZIndexes.biomass_high),e.biomass_high.setBiome("biomass"),e.biomass_high.fireChance=.06,e.pumpkin_low=this.clone("pumpkin_low","tumor_low"),e.pumpkin_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#8F9339":"#B56B3B"),e.pumpkin_low.stepAction=_.default.giveSlownessStatus,e.pumpkin_low.stepActionChance=.2,e.pumpkin_low.setDrawLayer(m.TileZIndexes.pumpkin_low),e.pumpkin_low.setBiome("pumpkin"),e.pumpkin_low.fireChance=.06,e.pumpkin_high=this.clone("pumpkin_high","tumor_high"),e.pumpkin_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#696C02":"#8E4E26"),e.pumpkin_high.stepAction=_.default.giveSlownessStatus,e.pumpkin_high.stepActionChance=.2,e.pumpkin_high.setDrawLayer(m.TileZIndexes.pumpkin_high),e.pumpkin_high.setBiome("pumpkin"),e.pumpkin_high.fireChance=.06,e.cybertile_low=this.clone("cybertile_low","tumor_low"),e.cybertile_low.life=!1,e.cybertile_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#9EA6A3":"#6F475B"),e.cybertile_low.setDrawLayer(m.TileZIndexes.cybertile_low),e.cybertile_low.setBiome("cybertile"),e.cybertile_low.burnable=!1,e.cybertile_low.canBeRemovedWithDemolish=!0,e.cybertile_high=this.clone("cybertile_high","tumor_high"),e.cybertile_high.life=!1,e.cybertile_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#858886":"#8C667A"),e.cybertile_high.setDrawLayer(m.TileZIndexes.cybertile_high),e.cybertile_high.setBiome("cybertile"),e.cybertile_high.burnable=!1,e.cybertile_high.canBeRemovedWithDemolish=!0,e.road=new v,e.road.cost=116,e.road.drawPixel=!0,e.road.id="road",e.road.tileName="road",e.road.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#C1997C":"#BA966D"),e.road.road=!0,e.road.ground=!0,e.road.walkMod=1.5,e.road.canBeSetOnFire=!0,e.road.canBuildOn=!0,e.road.strength=0,e.road.setDrawLayer(m.TileZIndexes.road),e.road.canBeRemovedWithDemolish=!0,this.add(e.road),e.fuse=new v,e.fuse.cost=10,e.fuse.drawPixel=!0,e.fuse.id="fuse",e.fuse.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#834C4C":"#865E69"),e.fuse.burnable=!0,e.fuse.terraformAfterFire=!0,e.fuse.ground=!0,e.fuse.walkMod=1,e.fuse.canBuildOn=!0,e.fuse.strength=0,e.fuse.setDrawLayer(m.TileZIndexes.fuse),e.fuse.canBeRemovedWithDemolish=!0,this.add(e.fuse),e.field=new v,e.field.cost=115,e.field.drawPixel=!0,e.field.id="field",e.field.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#A8663A":"#B35A44"),e.field.heightMin=108,e.field.ground=!0,e.field.walkMod=1,e.field.canBeFarmField=!0,e.field.canBuildOn=!1,e.field.canBeSetOnFire=!0,e.field.burnable=!0,e.field.strength=0,e.field.fireChance=.4,e.field.remove_on_freeze=!0,e.field.remove_on_heat=!0,e.field.setDrawLayer(m.TileZIndexes.field),this.add(e.field),e.tnt=new v,e.tnt.cost=10,e.tnt.drawPixel=!0,e.tnt.id="tnt",e.tnt.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#A30000":"#830018"),e.tnt.burnable=!0,e.tnt.explodable=!0,e.tnt.explodableDelayed=!0,e.tnt.explodeRange=10,e.tnt.ground=!0,e.tnt.walkMod=1,e.tnt.canBuildOn=!0,e.tnt.strength=0,e.tnt.setDrawLayer(m.TileZIndexes.tnt),e.tnt.canBeRemovedWithDemolish=!0,this.add(e.tnt),e.fireworks=new v,e.fireworks.cost=10,e.fireworks.drawPixel=!0,e.fireworks.id="fireworks",e.fireworks.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#B43DCC":"#A33E73"),e.fireworks.burnable=!0,e.fireworks.terraformAfterFire=!0,e.fireworks.ground=!0,e.fireworks.walkMod=1,e.fireworks.canBuildOn=!0,e.fireworks.strength=0,e.fireworks.setDrawLayer(m.TileZIndexes.fireworks),e.fireworks.canBeRemovedWithDemolish=!0,this.add(e.fireworks),e.tnt_timed=new v,e.tnt_timed.cost=10,e.tnt_timed.drawPixel=!0,e.tnt_timed.id="tnt_timed",e.tnt_timed.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#7F0000":"#830018"),e.tnt_timed.burnable=!0,e.tnt_timed.explodable=!0,e.tnt_timed.explodableTimed=!0,e.tnt_timed.explodeTimer=5,e.tnt_timed.explodeRange=8,e.tnt_timed.ground=!0,e.tnt_timed.walkMod=1,e.tnt_timed.canBuildOn=!0,e.tnt_timed.strength=0,e.tnt_timed.setDrawLayer(m.TileZIndexes.tnt_timed),e.tnt_timed.canBeRemovedWithDemolish=!0,this.add(e.tnt_timed),e.landmine=new v,e.landmine.cost=10,e.landmine.drawPixel=!0,e.landmine.id="landmine",e.landmine.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#656565":"#74596B"),e.landmine.burnable=!0,e.landmine.explodable=!0,e.landmine.explodeRange=3,e.landmine.ground=!0,e.landmine.walkMod=1,e.landmine.strength=0,e.landmine.stepAction=_.default.landmine,e.landmine.stepActionChance=.9,e.landmine.setDrawLayer(m.TileZIndexes.landmine),e.landmine.canBeRemovedWithDemolish=!0,this.add(e.landmine),e.snow_low=new v,e.snow_low.cost=10,e.snow_low.drawPixel=!0,e.snow_low.id="snow_low",e.snow_low.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#BAD5D3":"#BADDDF"),e.snow_low.edge_color=p.Toolbox.makeColor("#F5F7F6"),e.snow_low.ground=!0,e.snow_low.grass=!0,e.snow_low.walkMod=1,e.snow_low.frozen=!0,e.snow_low.strength=0,e.snow_low.growToNearbyTiles=!0,e.snow_low.grassStrength=5,e.snow_low.forceUnitSkinSet="polar",e.snow_low.canGrowBiomeGrass=!0,e.snow_low.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["snow_plant"]),e.snow_low.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["pine"]),e.snow_low.canBeFarmField=!0,e.snow_low.canBuildOn=!0,e.snow_low.setBiome("snow"),e.snow_low.addUnitsToSpawn(["penguin","chicken","rabbit","fox","bear"]),e.snow_low.setDrawLayer(m.TileZIndexes.snow_low),this.add(e.snow_low),e.snow_sand=this.clone("snow_sand","snow_low"),e.snow_sand.canBuildOn=!0,e.snow_sand.setDrawLayer(m.TileZIndexes.snow_sand),e.snow_sand.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#AFF5F1":"#B0E3F7"),e.snow_sand.frozen=!0,e.snow_sand.ground=!0,e.ice=this.clone("ice","snow_low"),e.ice.setDrawLayer(m.TileZIndexes.ice),e.ice.color=p.Toolbox.makeColor("#A7D6F4"),e.ice.frozen=!0,e.ice.ground=!0,e.ice.damagedWhenWalked=!0,e.snow_high=this.clone("snow_high","snow_low"),e.snow_high.canBuildOn=!0,e.snow_high.setBiome("snow"),e.snow_high.addUnitsToSpawn(["bear","wolf"]),e.snow_high.setAutoGrowPlants(_.default.getGrowTypeRandomPlants,["snow_plant"]),e.snow_high.setAutoGrowTrees(_.default.getGrowTypeRandomTrees,["pine"]),e.snow_high.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#D3E4E3":"#C9E2EA"),e.snow_high.edge_color=p.Toolbox.makeColor("#F5F7F6"),e.snow_high.frozen=!0,e.snow_high.canGrowBiomeGrass=!0,e.snow_high.setDrawLayer(m.TileZIndexes.snow_high),e.snow_hills=this.clone("snow_hills","snow_low"),e.snow_hills.color=p.Toolbox.makeColor(c.default.OLD_SKIN?"#E2EDEC":"#DBF6F5"),e.snow_hills.setDrawLayer(m.TileZIndexes.snow_hills),e.snow_block=this.clone("snow_block","snow_low"),e.snow_block.layerType=m.TileLayerType.Block,e.snow_block.color=p.Toolbox.makeColor("#FFFFFF"),e.snow_block.block=!0,e.snow_block.rocks=!0,e.snow_block.edge_mountains=!0,e.snow_block.ground=!1,e.snow_block.setDrawLayer(m.TileZIndexes.snow_block),this.loadTileSprites(),this.addBiome(e.grass_low,e.grass_high,10),this.addBiome(e.savanna_low,e.savanna_high,5),this.addBiome(e.jungle_low,e.jungle_high,6),this.addBiome(e.enchanted_low,e.enchanted_high,3),f.default.mode_sandBox&&(this.addBiome(e.corruption_low,e.corruption_high,1),this.addBiome(e.infernal_low,e.infernal_high,1),this.addBiome(e.mushroom_low,e.mushroom_high,3))},e.prototype.clone=function(t,e){var i=JSON.parse(JSON.stringify(this.dict.get(e)));return this.t=d.default.fromJson(i,new v),this.t.id=t,this.t.unitDeathAction=new u.default,this.add(this.t)},e.prototype.addBiome=function(t,i,o){var a=new b;a.low=t,a.high=i;for(var n=0;n<o;n++)e.pool_biomes.push(a)},e.prototype.add=function(e){return e.indexID=m.TileTypeBase.last_indexID++,t.prototype.add.call(this,e)},e.prototype.loadTileSprites=function(){for(var t,e,i=g.TextureLoader.inst.getSpriteFrames(g.ATLAS_TYPE.WORLDATLAS,"tilemap"),o=0;o<this.list.length;o++){var a=this.list[o],n=0;try{for(var r=(t=void 0,s(i)),c=r.next();!c.done;c=r.next()){var d=l(c.value,2),u=d[0];d[1],(u=u.substring(0,u.length-2))==a.id&&n++}}catch(_){t={error:_}}finally{try{c&&!c.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}0==n&&(n=1),a.sprites=new m.TileSprites;for(var h=0;h<n;h++)a.sprites.addVariation(a.id+"_"+h,a.render_z)}},e.snow_sand=null,e.snow_low=null,e.snow_high=null,e.snow_hills=null,e.snow_block=null,e.ice=null,e.landmine=null,e.water_bomb=null,e.tnt_timed=null,e.tnt=null,e.fireworks=null,e.road=null,e.field=null,e.fuse=null,e.tumor_low=null,e.tumor_high=null,e.biomass_low=null,e.biomass_high=null,e.pumpkin_low=null,e.pumpkin_high=null,e.cybertile_low=null,e.cybertile_high=null,e.grass_low=null,e.grass_high=null,e.corruption_low=null,e.corruption_high=null,e.enchanted_low=null,e.enchanted_high=null,e.mushroom_low=null,e.mushroom_high=null,e.savanna_low=null,e.savanna_high=null,e.jungle_low=null,e.jungle_high=null,e.infernal_low=null,e.infernal_high=null,e.swamp_low=null,e.swamp_high=null,e.wasteland_low=null,e.wasteland_high=null,e.pool_biomes=[],e}(y.default);n.default=w,cc._RF.pop()},{}],Tornado:[function(t,e,i){"use strict";cc._RF.push(e,"0ac42D+dc9EEbdrmuMCvdgT","Tornado");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("MathUtils"),c=a("AchievData"),d=a("GameCommon"),u=a("MapAction"),h=a("BaseActorComponent"),p=a("Brush"),f=a("ToolBox"),_=a("GameAudio"),m=a("MapBox"),g=a("WorldTimer"),y=a("Actor"),v=a("ActorAsset"),b=cc._decorator,w=b.ccclass,T=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shrinkTimer=1,e.tweener=null,e.started=!1,e.scale=1,e.timeout=1,e.targetTile=null,e.startPos=cc.Vec3.ZERO,e.firstCorner=cc.Vec3.ZERO,e.secondCorner=cc.Vec3.ZERO,e.distanceToTarget=0,e.angleDirection=cc.Vec3.ZERO,e.targetPos=cc.Vec3.ZERO,e.speedMod=.02,e.brush=null,e.resizeCooldown=1.5,e.moveTimer=null,e.brushTimer=null,e.burstTimer=1,e.colorEffect=0,e.scaleFactor=.5,e.flipXMul=1,e}var i;return r(e,t),i=e,e.prototype.create=function(){t.prototype.create.call(this),this.moveTimer=new g.default(0,this.moveTick.bind(this)),this.brushTimer=new g.default(0,this.brushTick.bind(this)),this.prepare(i.TORNADO_SCALE_DEFAULT),this.actor.callbacks_landed.push(this.tornado_landed.bind(this))},e.prototype.tornado_landed=function(){this.actor.inMapBorder()?this.newMove():this.killTornado()},e.prototype.prepare=function(t){void 0===t&&(t=1),this.started||(this.started=!0,this.actor=this.getComponent(y.default),this.actor.data.alive=!0,this.node.scale=.1,this.flipXMul=f.Toolbox.randomBool()?1:-1,-1==this.flipXMul&&(this.node.scaleX*=this.flipXMul,this.actor.setFlip(!0)),this.setScaleAndTween(t,"backOut"),this.shrinkTimer=f.Toolbox.randomFloat(35,70),this.resizeTornado(t),this.newMove(),this.moveTimer.setTime(-1))},e.prototype.setScaleAndTween=function(t,e,i){void 0===i&&(i=null);var o=t*this.scaleFactor;this.actor.setActorSize(o),this.tweener&&(this.tweener.stop(),this.tweener=null),this.tweener=cc.tween(this.node).to(.5,{scale:t*this.scaleFactor},{easing:e}).call(function(){i&&i()}).start()},e.prototype.forceScaleTo=function(t){this.scale=t,this.tweener&&(this.tweener.stop(),this.tweener=null),this.node.scale=t},e.prototype.newMove=function(){this.actor.findCurrentTile(),this.startPos=this.actor.currentTile.posV3,this.targetTile=f.Toolbox.getRandomTileAround(this.actor.currentTile);var t=f.Toolbox.getRandomTileAround(this.targetTile),e=f.Toolbox.getRandomTileAround(t);this.firstCorner.x=t.posV3.x,this.firstCorner.y=t.posV3.y,this.secondCorner.x=e.posV3.x,this.secondCorner.y=e.posV3.y,this.targetPos=this.targetTile.posV3,this.distanceToTarget=0,this.speedMod=f.Toolbox.randomFloat(.1,.2),this.angleDirection.set(cc.Vec3.ZERO),this.timeout=f.Toolbox.randomInt(0,5)},e.prototype.logicUpdate=function(t){var e,i;if(!d.default.isPaused&&(null===(e=this.actor.data)||void 0===e?void 0:e.alive)&&(this.shrinkTimer-=t,this.burstTimer>0&&(this.burstTimer-=t),this.resizeCooldown>0&&(this.resizeCooldown-=t),this.updateColorEffect(t),!this.actor.is_moving)){if(this.actor.zPosition.y>0)return this.targetTile=null,void(this.distanceToTarget=0);this.targetTile||this.newMove(),this.distanceToTarget+=t*this.speedMod,this.moveTimer.logicUpdate(t),this.brushTimer.logicUpdate(t),m.default.inst.applyForce(this.actor.currentTile,10,.5,!1),this.distanceToTarget>=.95&&(this.targetTile=null,this.distanceToTarget=0),this.shrinkTimer<=0&&(null===(i=this.actor.data)||void 0===i?void 0:i.alive)&&this.split()}},e.prototype.moveTick=function(){this.actor.currentPosition=f.Toolbox.cubeBezier3(this.startPos,this.firstCorner,this.secondCorner,this.targetPos,f.Toolbox.easeInOutQuart(this.distanceToTarget)),this.actor._positionDirty=!0,this.actor._currentTileDirty=!0},e.prototype.tornadoAction=function(){this.brush=p.default.getBrushBySize(l.default.intCast(6*this.scale));for(var t=0;t<this.brush.pos.length;t++){var e=this.brush.pos[t],i=this.actor.currentTile.pos.x+e.x,o=this.actor.currentTile.pos.y+e.y;if(!(i<0||i>=m.default.width||o<0||o>=m.default.height)){var a=m.default.inst.getTileSimple(i,o);a.type.ocean&&(u.default.removeLiquid(a),f.Toolbox.randomBool()&&this.spawnBurst(a,"rain",!1)),(a.top_type||a.type.life)&&u.default.decreaseTile(a),a.type.lava&&(m.default.inst.lavaLayer.removeLava(a),f.Toolbox.randomBool()&&this.spawnBurst(a,"lava")),a.building&&a.building.stats.canBeDamagedByTornado&&a.building.getHit(1),a.data.fire&&a.stopFire()}}this.burstTimer<0&&(this.burstTimer=f.Toolbox.randomFloat(.5,2))},e.prototype.spawnBurst=function(t,e,i){void 0===i&&(i=!0),m.default.inst.dropManager.activeIndex<=3e3&&m.default.inst.dropManager.spawnBurstPixel(t,e,f.Toolbox.randomFloat(.2,.5),f.Toolbox.randomFloat(1.3,1.8))},e.prototype.brushTick=function(){this.tornadoAction(),m.default.inst.conwayLayer.checkKillRange(this.actor.currentTile.pos,7)},e.prototype.shrink=function(){var t;(null===(t=this.actor.data)||void 0===t?void 0:t.alive)&&(this.scale<i.TORNADO_SCALE_MIN?this.killTornado():this.resizeCooldown>0||(this.scale*=i.TORNADO_SCALE_DECREASE_MOD,_.default.playTornado(),this.startColorEffect("white"),this.resizeTornado(this.scale)))},e.prototype.grow=function(){var t;null===(t=this.actor.data)||void 0===t||!t.alive||this.scale>=i.TORNADO_SCALE_MAX||this.resizeCooldown>0||(this.scale*=i.TORNADO_SCALE_INCREASE_MOD,this.scale>i.TORNADO_SCALE_MAX&&(this.scale=i.TORNADO_SCALE_MAX),_.default.playTornado(),this.startColorEffect(),this.resizeTornado(this.scale))},e.prototype.split=function(t){var e;if(void 0===t&&(t=!1),!(null===(e=this.actor.data)||void 0===e?void 0:e.alive))return!1;_.default.playTornado();var o=this.scale;if(this.scale*=.5,this.resizeTornado(this.scale),this.startColorEffect("white"),this.scale<i.TORNADO_SCALE_MIN&&t&&c.default.update(48),this.scale<i.TORNADO_SCALE_MIN)return this.killTornado(),!0;var a=1;t||(a=f.Toolbox.randomInt(0,1));for(var n=0;n<a;n++){var r=m.default.inst.createNewUnit("tornado",this.actor.currentTile).getComponent(i);r.forceScaleTo(o),r.resizeTornado(this.scale)}return!0},e.prototype.resizeTornado=function(t){this.scale=t,this.shrinkTimer=f.Toolbox.randomFloat(35,70),this.setScaleAndTween(this.scale,"backIn"),this.actor.curStats.speed=6*this.scale,this.actor.curStats.damage=l.default.intCast(10*this.scale),this.resizeCooldown=.1},e.prototype.startColorEffect=function(t){void 0===t&&(t="red"),this.colorEffect=.3},e.prototype.updateColorEffect=function(t){0!=this.colorEffect&&(this.colorEffect-=t,this.colorEffect<0&&(this.colorEffect=0))},e.prototype.kill=function(){this.started=!1},e.prototype.killTornado=function(){var t;(null===(t=this.actor.data)||void 0===t?void 0:t.alive)&&(this.actor.data.alive=!1,this.setScaleAndTween(0,"backIn",this.finishAndRemove.bind(this)))},e.prototype.finishAndRemove=function(){this.actor.killHimself(!0,v.AttackType.None,!1)},e.growTornados=function(t){i.resizeOnTile(t,"grow");for(var e=0;e<t.neighboursAll.length;e++){var o=t.neighboursAll[e];i.resizeOnTile(o,"grow")}},e.shrinkTornados=function(t){i.resizeOnTile(t,"shrink");for(var e=0;e<t.neighboursAll.length;e++){var o=t.neighboursAll[e];i.resizeOnTile(o,"shrink")}},e.resizeOnTile=function(t,e){for(var o,a,n,r=0;r<t.units.length;r++){var s=t.units[r];(null===(o=s.base_data)||void 0===o?void 0:o.alive)&&"tornado"==(null===(n=null===(a=s.a)||void 0===a?void 0:a.stats)||void 0===n?void 0:n.id)&&("grow"==e?s.getComponent(i).grow():s.getComponent(i).shrink())}},e.TORNADO_SCALE_DECREASE_MOD=.9,e.TORNADO_SCALE_INCREASE_MOD=1.1,e.TORNADO_SCALE_MIN=.1,e.TORNADO_SCALE_MAX=20,e.TORNADO_SCALE_DEFAULT=.5,i=s([w],e)}(h.default));n.default=T,cc._RF.pop()},{}],UFO:[function(t,e,i){"use strict";cc._RF.push(e,"71867/ghbZBFLtVRJKE0Ps5","UFO");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.UfoState=void 0;var l,c=a("MathUtils"),d=a("MapAction"),u=a("SpriteAnimation"),h=a("AssetManager"),p=a("BaseActorComponent"),f=a("ToolBox"),_=a("GameAudio"),m=a("MapBox");(function(t){t[t.Flying=0]="Flying",t[t.Exploring=1]="Exploring",t[t.Attacking=2]="Attacking",t[t.Abduct=3]="Abduct",t[t.Dying=4]="Dying",t[t.GoingToUnitTarget=5]="GoingToUnitTarget",t[t.AttackingUnitTarget=6]="AttackingUnitTarget"})(l=n.UfoState||(n.UfoState={}));var g=cc._decorator,y=g.ccclass,v=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.beamRnd=null,e.beamAnim=null,e.attacksForCity=0,e.cityToAttack=null,e.exploringTicks=0,e.actionTime=0,e.aggroTargets=[],e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this);var e=this.node.getChildByName("Beam");this.beamRnd=e.getComponent(cc.Sprite),this.beamAnim=e.getComponent(u.SpriteAnimation),this.hideBeam(),this.setState(l.Flying),this.actor.callbacks_get_hit.push(this.getHit.bind(this))},e.prototype.click=function(){this.beamAnim.isOn||this.startBeam()},e.prototype.setState=function(t,e){var i,o;void 0===e&&(e=null),this.state=t;var a=null;switch(t){case l.GoingToUnitTarget:this.actor.curStats.speed=50,this.actor.moveTo(e),this.actor.is_moving=!0;break;case l.Flying:this.actor.curStats.speed=20,this.beamAnim.isOn=!1,this.beamRnd.enabled=!1,this.attacksForCity>0&&(null===(i=this.cityToAttack)||void 0===i?void 0:i.buildings)&&(0==this.cityToAttack.buildings.length?this.cityToAttack=null:(a=null===(o=this.cityToAttack.buildings)||void 0===o?void 0:o.getRandom().currentTile.zone.tiles.getRandom(),this.attacksForCity--,this.attacksForCity<0&&(this.cityToAttack=null))),a||(a=m.default.inst.islandsCalculator.getRandomGround()),this.actor.moveTo(a);break;case l.Exploring:this.actor.curStats.speed=10,a=this.actor.currentTile.zone.tiles.getRandom(),this.actor.moveTo(a);break;case l.Attacking:case l.AttackingUnitTarget:this.startBeam();break;case l.Dying:this.beamAnim.isOn=!1,this.beamRnd.enabled=!1;break;case l.Abduct:}},e.prototype.startBeam=function(){this.beamAnim.stopAt(0,!0),this.beamAnim.isOn=!0,this.beamRnd.enabled=!0,_.default.playUfoAttack(this.node.position)},e.prototype.logicUpdate=function(e){var i;if(t.prototype.logicUpdate.call(this,e),this.beamAnim.logicUpdate(e),this.actor.curStats.speed<30&&this.state==l.Flying&&(this.actor.curStats.speed+=10*e),null===(i=this.actor.data)||void 0===i?void 0:i.alive){if(this.beamAnim.isOn){if(4==this.beamAnim.currentFrameIndex)for(var o=0;o<8;o++)for(var a=0;a<8;a++){var n=m.default.inst.getTile(this.actor.currentTile.pos.x+a-4,this.actor.currentTile.pos.y+o-4);!n||f.Toolbox.dist(this.actor.currentTile.pos.x,this.actor.currentTile.pos.y,n.pos.x,n.pos.y)>4||this.attackTile(n)}if(this.beamAnim.currentFrameIndex!=this.beamAnim.frames.length-1)return;this.hideBeam()}this.actor.is_moving||(this.actionTime>0?this.actionTime-=e:this.nextAction())}else if(this.hideBeam(),this.actor.updateFall(e),0==this.actor.zPosition.y){_.default.playExplosionMedium();var r=m.default.inst.getTile(c.default.intCast(this.actor.currentPosition.x),c.default.intCast(this.actor.currentPosition.y));if(!r)return void this.actor.killHimself(!0);this.actor.killHimself(!0),d.default.damageWorld(r,5,h.default.terraform.get("ufo_explosion")),m.default.inst.stackEffects.get("explosionSmall").spawnAtRandomScale(r,.45,.6)}},e.prototype.hideBeam=function(){this.beamAnim.isOn=!1,this.beamRnd.enabled=!1},e.prototype.attackTile=function(t){t&&d.default.damageWorld(t,0,h.default.terraform.get("ufo_attack"))},e.prototype.nextAction=function(){var t,e,i,o;if(null===(e=null===(t=this.actor)||void 0===t?void 0:t.data)||void 0===e?void 0:e.alive){if(0!=this.aggroTargets.length){this.aggroTargets.shuffle();for(var a=0;a<this.aggroTargets.length;a++){var n=this.aggroTargets[a];if(n&&n.base_data.alive){this.setState(l.GoingToUnitTarget,n.currentTile);break}}this.aggroTargets=[]}switch(this.state){case l.GoingToUnitTarget:this.setState(l.AttackingUnitTarget);break;case l.AttackingUnitTarget:this.setState(l.Flying);break;case l.Flying:this.cityToAttack&&this.actor.currentTile.building&&!m.default.inst.worldLaws.world_law_peaceful_monsters.boolVal&&this.setState(l.Attacking),this.exploringTicks=f.Toolbox.randomInt(3,7),this.setState(l.Exploring);break;case l.Exploring:this.exploringTicks>0?(this.exploringTicks--,(null===(o=null===(i=this.actor.currentTile)||void 0===i?void 0:i.zone)||void 0===o?void 0:o.city)&&(this.cityToAttack=this.actor.currentTile.zone.city,this.attacksForCity=f.Toolbox.randomInt(3,10)),this.cityToAttack?this.setState(l.Flying):this.setState(l.Exploring)):this.setState(l.Flying);break;case l.Attacking:case l.Abduct:case l.Dying:}}},e.prototype.getHit=function(){this.state!=l.Flying&&this.state!=l.Exploring||this.nextAction(),this.actor.attackedBy&&this.aggroTargets.push(this.actor.attackedBy)},s([y],e)}(p.default));n.default=v,cc._RF.pop()},{}],UiController:[function(t,e,i){"use strict";cc._RF.push(e,"84da3hZQ5pIOIynnDoXZlbj","UiController");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0});var c=a("DateUtils"),d=a("Constants"),u=a("AdaptMgr"),h=a("AudioMgr"),p=a("ResMgr"),f=a("PlatformUtils"),_=a("UiUtil"),m=a("UMReport"),g=a("AdsManager"),y=a("GameTdd"),v=a("AchievData"),b=a("RewardData"),w=a("UserData"),T=a("GameCommon"),k=a("GuideView"),B=a("MsgCache"),S=a("AssetManager"),C=a("GameUtils"),x=a("PrefabLibrary"),A=a("ViewController"),P=a("Config"),O=a("DebugConfig"),R=a("AchievementToast"),F=a("GameAudio"),L=a("GuideController"),D=a("AdView"),M=a("AwardView"),I=a("MysteryButton"),j=a("OnlineReward"),E=a("MapBox"),N=a("PlayerConfig"),z=a("TextureLoader"),G=a("TechElement"),U=a("ModModule"),W=a("PowerButton"),q=a("PowerButtonSelector"),H=a("SelectedPowerNameTip"),V=cc._decorator,Z=V.ccclass,K=V.property,J=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propLayout=[],e.toggleContainer=null,e.selectIcon=null,e.ndSelected=null,e.mainSizeButton=null,e.btnPulldown=null,e.btnClock=null,e.btnAchiev=null,e.btnOnline=null,e.btnSignIn=null,e.btnMoreGame=null,e.btnShortcut=null,e.btnColorSign=null,e.toggleRec=null,e.pauseSprite=[],e.propSprite=[],e.pbAchiev=null,e.btnZones=[],e.researchBar=null,e.videoBanner=null,e.propDict=new Map,e.toggleIdx=0,e.curPage=null,e.gmClickTimer=0,e.gmClickCount=0,e.video_interval=0,e.insert_interval=0,e.achievList=[],e.bottomTweenTime=.3,e.isDoRecord=!1,e.playTime=0,e.reportTime=0,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){var t,e,o,a,n,r;i.inst=this,this.propDict.set(this.btnClock.name.substring(4),this.btnClock);try{for(var s=l(this.propLayout),h=s.next();!h.done;h=s.next()){var p=h.value,f=p.parent.parent;f.active=f.name.includes("0");try{for(var _=(o=void 0,l(p.children)),m=_.next();!m.done;m=_.next()){var g=m.value;if("line"!=g.name&&g.active)try{for(var y=(n=void 0,l(g.children)),b=y.next();!b.done;b=y.next()){var T=b.value;T.active&&T.getComponent(W.PowerButton)&&this.propDict.set(T.name.substring(4),T)}}catch(R){n={error:R}}finally{try{b&&!b.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}}}catch(F){o={error:F}}finally{try{m&&!m.done&&(a=_.return)&&a.call(_)}finally{if(o)throw o.error}}}}catch(L){t={error:L}}finally{try{h&&!h.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.updateProp(),this.toggleContainer.children[0].zIndex=1,this.toggleIdx=0;var k=this.node.getChildByName("left");if(this.node.getChildByName("right"),KS_GAME){var B=k.getComponent(cc.Widget);B.top=140,B.updateAlignment()}if(this.node.children.forEach(function(t){u.default.adaptScreenScale(t)}),this.bottomUpdateY(0),this.btnMoreGame.active=d.default.IS_LOCAL||JSB_OPPO||QQ_GAME||WECHAT_GAME,this.toggleRec.node.active=BYTEDANCE_GAME,cc.director.on("bannerResize",this.bottomUpdateY,this),cc.director.on("bannerError",this.bannerError,this),cc.director.on("updateProp",this.updateProp,this),cc.director.on("appBoxOnLoad",function(){A.default.open(A.view_type.AppBoxView)}),v.default.dispatcher.on(v.default.eventName,this.achievListen,this),cc.sys.platform==cc.sys.WECHAT_GAME){var S=c.default.formatDayTime();null==w.default.member.qqBoxNum[S]&&(w.default.member.qqBoxNum={},w.default.member.qqBoxNum[S]=0),null==w.default.member.qqMysteryNum[S]&&(w.default.member.qqMysteryNum={},w.default.member.qqMysteryNum[S]=0);var C=(new Date).getTime()+216e5,x=c.default.formatDayTime(C/1e3);null==w.default.member.qqGift[x]&&(w.default.member.qqGift={},w.default.member.qqGift[x]=!1),w.default.save()}QQ_GAME&&("qq"==PLATFORM.getSystemInfoSync().AppPlatform&&(this.btnColorSign.active=!(!PLATFORM.addColorSign||!PLATFORM.isColorSignExistSync||PLATFORM.isColorSignExistSync()),PLATFORM.authorize({scope:"scope.recentColorSign"}),PLATFORM.addRecentColorSign&&PLATFORM.addRecentColorSign({success:function(t){console.log("\u6dfb\u52a0\u6700\u8fd1\u5f69\u7b7e\u6210\u529f: ",t)},fail:function(t){console.log("\u6dfb\u52a0\u6700\u8fd1\u5f69\u7b7e\u5931\u8d25: ",t)}})),this.btnShortcut.active=!!PLATFORM.saveAppToDesktop,cc.find("right/layout/btnRank",this.node).active=QQ_GAME,cc.find("right/layout/btnOnlineShare",this.node).active=QQ_GAME,PLATFORM.onShareAppMessage(function(){return{title:"\u5f53\u4e00\u6b21\u4e0a\u5e1d\uff0c\u521b\u9020\u8fd8\u662f\u6bc1\u706d\u7531\u4f60\u51b3\u5b9a",imageUrl:"share.png"}}),this.showInterstitialAd(40),this.showTimeScaleView()),this.initGuideView()},e.prototype.onDestroy=function(){cc.director.off("updateProp"),cc.director.off("bannerError"),cc.director.off("bannerResize"),h.default.stopAllEffects(),v.default.dispatcher.off(v.default.eventName,this)},e.prototype.start=function(){p.default.loadDir("res/audio"),_.UiUtil.openModule("res/prefab/ui/tip/ToolTip",d.default.GLOBAL_NODE),_.UiUtil.openModule("res/prefab/ui/tip/WorldTip",d.default.GLOBAL_NODE),F.default.playBGM(),m.default.report("loadingEnd"),FIRST_PLAY&&(m.default.report("newPlayer"),cc.sys.platform==cc.sys.WECHAT_GAME&&(null===MMMSDK||void 0===MMMSDK||MMMSDK.regChar("0","\u5fae\u4fe1\u5c0f\u6e38\u620f",MMMSDK.OPEN_DATA.account,"\u65b0\u624b\u73a9\u5bb6")))},e.prototype.update=function(t){this.gmClickTimer+=t,this.gmClickTimer>.5&&(this.gmClickCount=0),this.playTime+=t;var e=Math.floor(this.playTime);if(e==this.reportTime||60!=e&&180!=e&&300!=e&&600!=e&&900!=e&&1200!=e&&1800!=e||(this.reportTime=e,m.default.report("playTime",{time:e/60})),d.default.FULLVIDEO_SHOW||(this.video_interval+=t,this.video_interval>180&&(this.video_interval=0,d.default.FULLVIDEO_SHOW=!0)),!d.default.INSERTAD_SHOW){this.insert_interval+=t;var i=(y.default.success?y.default.getData("p9",y.v_type.Number):30)||30;this.insert_interval>i&&(this.insert_interval=0,d.default.INSERTAD_SHOW=!0)}},e.prototype.initGuideView=function(){L.default.inst.initView(x.default.inst.guide)},e.prototype.bannerError=function(){if(QQ_GAME){var t=(new Date).getHours(),e=!!y.default.success&&1==y.default.getData("p14",y.v_type.Number),i=y.default.success?y.default.getData("p10",y.v_type.NumberList):[0,24];this.videoBanner.active=(t<i[0]||t>i[1])&&e}else this.videoBanner.active=!0;this.bottomUpdateY(114,!0)},e.prototype.achievListen=function(t){var e=this;t.awarded||(this.achievList.push(t),1==this.achievList.length&&function t(){_.UiUtil.openModule("res/prefab/ui/achiev/AchievToast").then(function(i){i.getComponent(R.default).show(e.achievList[0],function(){e.achievList.shift(),e.achievList.length>0&&t()}),e.btnAchiev.getChildByName("dot").active=!0})}())},e.prototype.onClickToggle=function(t,e){var i,o,a,n;F.default.playClick();var r=parseInt(e);if(0==r&&T.default.isPaused&&(this.gmClickTimer=0,this.gmClickCount++,this.gmClickCount>10&&(this.gmClickCount=0,A.default.open(A.view_type.GMView,null,t))),r!=this.toggleIdx){this.toggleIdx=r,P.default.firstClick&&(m.default.report("firstClick"),P.default.firstClick=!1);try{for(var s=l(this.propLayout),c=s.next();!c.done;c=s.next()){var d=c.value,u=(f=d.parent.parent).name.includes(r.toString());f.active=u,u&&(this.curPage=f,d.x=0,d.scaleX=.75,cc.tween(d).to(.07,{scaleX:1}).call(function(){"toggle2"==t.target.name&&L.default.inst.in(L.GUIDE_TYPE.novice,3)&&L.default.inst.do(L.GUIDE_TYPE.novice),"toggle4"==t.target.name&&L.default.inst.in(L.GUIDE_TYPE.novice,10)&&L.default.inst.do(L.GUIDE_TYPE.novice)}).start())}}catch(y){i={error:y}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}try{for(var h=l(this.toggleContainer.children),p=h.next();!p.done;p=h.next()){var f;(f=p.value).zIndex=f==t.target?1:0}}catch(v){a={error:v}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(a)throw a.error}}H.SelectedPowerNameTip.inst.setText(t.target.name)}},e.prototype.onClickProp=function(t,e){var i=t.getCurrentTarget(),o=i.getComponent(W.PowerButton);if(o&&o.type!=W.PowerButtonType.Active)o.click(t,e);else if(null==i?void 0:i.name){P.default.selectedProp=i.name.substring(4);var a=w.default.getPropConfigByID(P.default.selectedProp),n=w.default.getPropByID(P.default.selectedProp);a&&n&&(this.updateProp(P.default.selectedProp),o&&o.click(t,e),O.default.Prop_infinite||n.lock&&0==n.number&&A.default.open(A.view_type.UnLockProp),i.name=="btn_"+U.default.inst.race&&L.default.inst.in(L.GUIDE_TYPE.novice,4)&&L.default.inst.do(L.GUIDE_TYPE.novice),"btn_fertilizerTrees"==i.name&&L.default.inst.in(L.GUIDE_TYPE.novice,11)&&this.scheduleOnce(function(){L.default.inst.do(L.GUIDE_TYPE.novice)},.02))}},e.prototype.onClickZones=function(t){var e=t.getCurrentTarget();this.updateZonesBtn(e)},e.prototype.updateZonesBtn=function(t){var e,i,o=t.getComponent(W.PowerButton),a="map_"+o.godPower.id;if(N.default.switchOption(a,N.OptionType.Bool),t.getChildByName("dot").getComponent(cc.Button).interactable=!N.default.optionBoolEnabled(a),N.default.optionBoolEnabled(a)){H.SelectedPowerNameTip.inst.setText(o.godPower.name);try{for(var n=l(this.btnZones),r=n.next();!r.done;r=n.next()){var s=r.value;a="map_"+s.name.substring(4),s!=t&&N.default.optionBoolEnabled(a)&&this.updateZonesBtn(s)}}catch(u){e={error:u}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}}},e.prototype.showSelectTip=function(t){var e;if(null==t?void 0:t.node){var i=t.node.getChildByName("icon");this.selectIcon.getComponent(cc.Sprite).spriteFrame=i.getComponent(cc.Sprite).spriteFrame,this.selectIcon.width=i.width,this.selectIcon.height=i.height,this.mainSizeButton.active=1==(null===(e=t.godPower)||void 0===e?void 0:e.showToolSizes);var o=cc.find("frame/layout/btnAdd",this.ndSelected),a=w.default.getPropConfigByID(P.default.selectedProp);o.active=(null==a?void 0:a.rare)!=w.RARE_TYPE.NORMAL&&P.default.mode_count,a&&(o.getChildByName("num").getComponent(cc.Label).string="+"+a.reward),cc.tween(this.ndSelected).to(.2,{x:0}).start()}},e.prototype.closeSelectTip=function(){F.default.playClick(),cc.tween(this.ndSelected).to(.2,{x:300}).start(),q.PowerButtonSelector.inst.unselectAll()},e.prototype.onClickAddProp=function(t){var e=this;t&&_.UiUtil.btnEnabel(t),d.default.REPORT_ID="addPropNum",g.default.showVideoAds(function(t){if(1==t)w.default.getPropByID(P.default.selectedProp).number+=w.default.getPropConfigByID(P.default.selectedProp).reward,e.updateProp(P.default.selectedProp),w.default.save();else{var i=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";B.default.pushToast(i)}})},e.prototype.onClickPullDown=function(){var t=this.btnPulldown.getChildByName("touchNode"),e=this.btnPulldown.getChildByName("layout"),i=this.btnPulldown.getChildByName("icon"),o=!e.active;e.active=o,t.active=o,i.angle=o?180:0},e.prototype.onClickPause=function(t){F.default.playClick();var e=t.getCurrentTarget().getChildByName("icon").getComponent(cc.Sprite);T.default.setPause(!T.default.isPaused),H.SelectedPowerNameTip.inst.setText(T.default.isPaused?"Pause":"UnPause"),e.spriteFrame=T.default.isPaused?this.pauseSprite[1]:this.pauseSprite[0]},e.prototype.onClickTimeScale=function(t,e){F.default.playClick(),L.default.inst.in(L.GUIDE_TYPE.timeScale,1)&&L.default.inst.do(L.GUIDE_TYPE.timeScale);var i=t.node.name.substring(4),o=w.default.getPropByID(i),a=w.default.getPropConfigByID(i);this.toggleContainer.stopAllActions();var n=!1;o.number>0?t.isChecked&&(w.default.member.useTimeScale||(w.default.member.useTimeScale=!0,w.default.save()),cc.tween(this.toggleContainer).sequence(cc.delayTime(1),cc.callFunc(function(){T.default.isPaused||(o.number--,w.default.save(),v.default.update(67),0===o.number&&(t.isChecked=!1,t.checkEvents[0].emit([t,!0])))})).repeatForever().start()):(t.isChecked=!1,e||(n=!0,d.default.REPORT_ID="timeScale",g.default.showVideoAds(function(e){if(1==e)o.number+=a.reward,w.default.save(),t.isChecked=!0,t.checkEvents[0].emit([t,!0]);else{var i=0==e?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";B.default.pushToast(i)}}))),P.default.timeScale=t.isChecked?P.default.defaultTimeScale:1,n||B.default.pushToast(t.isChecked?"\u5f00\u59cb\u65f6\u95f4\u52a0\u901f":"\u505c\u6b62\u65f6\u95f4\u52a0\u901f")},e.prototype.onClickSaveWorld=function(t){F.default.playClick(),A.default.open(A.view_type.SaveWorld,null,t)},e.prototype.onClickBrushSize=function(t){var e=this;F.default.playClick(),A.default.open(A.view_type.UiBrushes,function(t){var i=e.mainSizeButton.getChildByName("icon");i.getComponent(cc.Sprite).spriteFrame=t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame,i.width=t.getChildByName("icon").width,i.height=t.getChildByName("icon").height,L.default.inst.in(L.GUIDE_TYPE.novice,13)&&L.default.inst.do(L.GUIDE_TYPE.novice)},t,!1,function(){L.default.inst.in(L.GUIDE_TYPE.novice,12)&&e.scheduleOnce(function(){L.default.inst.do(L.GUIDE_TYPE.novice)},.4)})},e.prototype.onClickWorldLog=function(t){F.default.playClick(),A.default.open(A.view_type.WorldLog,null,t)},e.prototype.onShowCultureList=function(t){F.default.playClick(),A.default.open(A.view_type.CulturesList,null,t)},e.prototype.onShowKingdomList=function(t){F.default.playClick(),A.default.open(A.view_type.KingdomList,null,t)},e.prototype.onShowCityList=function(t){F.default.playClick(),A.default.open(A.view_type.CitiesList,null,t)},e.prototype.onShowWorldLaws=function(t){F.default.playClick(),A.default.open(A.view_type.WorldLaws,null,t)},e.prototype.onShowFavoritesList=function(t){F.default.playClick(),A.default.open(A.view_type.Favorites,null,t)},e.prototype.onClickSetting=function(t){F.default.playClick(),A.default.open(A.view_type.Setting,null,t)},e.prototype.onClickNewMap=function(t){var e=this;F.default.playClick(),A.default.open(A.view_type.MapSetting,function(t){e.scheduleOnce(function(){E.default.inst.generateNewMap(t)},.3)},t)},e.prototype.onClickWorldInfo=function(t){F.default.playClick(),A.default.open(A.view_type.WorldInfo,null,t)},e.prototype.onClickAchievement=function(t){F.default.playClick(),A.default.open(A.view_type.Achiev,null,t),this.btnAchiev.getChildByName("dot").active=!1},e.prototype.onClickCensusInfo=function(t){F.default.playClick(),A.default.open(A.view_type.CensusInfo,null,t)},e.prototype.onClickSign=function(t){F.default.playClick(),A.default.open(A.view_type.SignIn,t,null,!1,null,function(){setTimeout(function(){i.inst.showQQLimitedGifts()},2e3)})},e.prototype.onClickOnline=function(t){F.default.playClick();var e=t.getCurrentTarget().getComponent(j.default);e.setEnable(!1),A.default.open(A.view_type.AwardView,null,null,!1,function(t){e.getReward(),t.getComponent(M.default).init(M.Reward_type.online,e.rewardID)})},e.prototype.onClickMysteryGift=function(t){if(F.default.playClick(),I.default.inst.hide(),cc.sys.platform==cc.sys.WECHAT_GAME){var e=(new Date).getHours(),i=c.default.formatDayTime(),o=y.default.success?y.default.getData("p10",y.v_type.NumberList):[9,19],a=y.default.success?y.default.getData("p11",y.v_type.NumberList):[120,10],n=!!y.default.success&&1==y.default.getData("p14",y.v_type.Number);if((!T.default.isInAddressBlackList||e<o[0]||e>o[1])&&w.default.member.qqMysteryNum[i]<a[1]&&n&&w.default.member.mysteryNum>1)return w.default.member.qqMysteryNum[i]++,w.default.save(),void g.default.showVideoAds(function(t){if(1==t)A.default.open(A.view_type.AwardView,null,null,!0,function(t){t.getComponent(M.default).init(M.Reward_type.mystery,3)});else{var e=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";B.default.pushToast(e)}I.default.inst.reset()})}A.default.open(A.view_type.Mystery,null,t)},e.prototype.showBoxMonster=function(){var t=this;if(cc.sys.platform==cc.sys.WECHAT_GAME){var e=(new Date).getHours(),i=c.default.formatDayTime(),o=y.default.success?y.default.getData("p10",y.v_type.NumberList):[9,19],a=y.default.success?y.default.getData("p13",y.v_type.NumberList):[120,10],n=!!y.default.success&&1==y.default.getData("p14",y.v_type.Number);(!T.default.isInAddressBlackList||e<o[0]||e>o[1])&&w.default.member.qqBoxNum[i]<a[1]&&n&&(w.default.member.qqBoxNum[i]++,w.default.save(),this.scheduleOnce(function e(){C.default.allowPopUi()?A.default.open(A.view_type.BoxMonster,null,null,!1,!1,function(){t.showBoxMonster()}):setTimeout(e,3e3)},a[0]))}},e.prototype.showQQLimitedGifts=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var t=(new Date).getTime()+216e5,e=c.default.formatDayTime(t/1e3);C.default.allowPopUi()&&!w.default.member.qqGift[e]&&A.default.open(A.view_type.QQLimitedGifts)}},e.prototype.onClickLuckyWheel=function(t){F.default.playClick(),A.default.open(A.view_type.LuckyWheel,null,t)},e.prototype.onClickStoreView=function(t){var e=this;A.default.open(A.view_type.StoreView,null,t,!1,null,function(){e.updateProp()})},e.prototype.onClickMoreGame=function(t){var e=t.getCurrentTarget().getComponent(cc.Button);e.interactable=!1,setTimeout(function(){e.interactable=!0},1e3),JSB_OPPO?f.default.requestChannel("AdsUtil","goToOppo"):QQ_GAME?g.default.showAppBoxAd(function(){}):VIVO_GAME?g.default.showAppBoxAd(function(){}):(WECHAT_GAME||d.default.IS_LOCAL)&&g.default.showAppBoxAd(function(t){1==t&&A.default.close(!0)})},e.prototype.onClickRecord=function(t){var e=this,i=this.toggleRec.node.getChildByName("title"),o=this.toggleRec.node.getChildByName("time");if(o.active=t.isChecked,i.getComponent(cc.Label).string=t.isChecked?"\u5f55\u5236\u4e2d":"\u5f00\u59cb\u5f55\u5236",t.isChecked){g.default.startRecording(function(a){a?(B.default.pushToast("\u5f55\u5c4f\u505c\u6b62"),e.isDoRecord=!1,function t(){C.default.allowPopUi()?A.default.open(A.view_type.RecordShare):e.toggleRec.scheduleOnce(t,1)}()):(e.isDoRecord=!1,B.default.pushToast("\u5f55\u5c4f\u5931\u8d25\uff1a\u5f55\u5c4f\u65f6\u957f\u4f4e\u4e8e3\u79d2")),t.isChecked=!1,o.active=!1,e.toggleRec.unscheduleAllCallbacks(),i.getComponent(cc.Label).string="\u5f00\u59cb\u5f55\u5236"},300);var a=1;B.default.pushToast("\u5f55\u5c4f\u5f00\u59cb"),o.getComponent(cc.Label).string="00:00",this.toggleRec.schedule(function(){o.getComponent(cc.Label).string=c.default.formatMinutes(a++),a>=300&&e.toggleRec.isChecked&&(e.toggleRec.isChecked=!1,e.toggleRec.checkEvents[0].emit([e.toggleRec]))},1)}else this.toggleRec.unscheduleAllCallbacks(),this.isDoRecord=!0,g.default.stopRecording(30)},e.prototype.updateCurrentTech=function(){if(P.default.selectedCulture){this.researchBar.node.active=!0;var t=P.default.selectedCulture.research_progress;P.default.selectedCulture.checkResearchingTech();var e=0,i=this.researchBar.node.getChildByName("currentTech").getComponent(G.default);if(P.default.selectedCulture.researching_tech){e=P.default.selectedCulture.getKnowledgeCostForResearch();var o=S.default.culture_tech.get(P.default.selectedCulture.researching_tech);i.node.active=!0,i.load(o)}else t=0,e=0,i.node.active=!1;this.researchBar.node.getChildByName("label").getComponent(cc.Label).string=Math.floor(10*t)/10+"/"+e,this.researchBar.progress=t/e}else this.researchBar.node.active=!1},e.prototype.updateProp=function(t){var e=this;if(void 0===t&&(t=""),""===t)this.propDict.forEach(function(t,i){e.doUpdateProp(i)});else{if("clock"!==t&&t===P.default.selectedProp){var i=w.default.getPropByID(P.default.selectedProp),o=cc.find("frame/layout/selectedBg/num",this.ndSelected);i&&o&&(o.active=i.number>=0&&P.default.mode_count,o.getComponent(cc.Label).string=Math.floor(i.number).toString())}this.doUpdateProp(t)}},e.prototype.doUpdateProp=function(t){var e=this.propDict.get(t),i=w.default.getPropByID(t),o=w.default.getPropConfigByID(t);if(i&&o&&e){var a=e.getChildByName("video");if(0==i.number){a||((a=new cc.Node("video")).scale=.6,a.addComponent(cc.Sprite),a.parent=e);var n=i.lock?z.TextureLoader.inst.getSpriteFrame(z.ATLAS_TYPE.UIATLAS,"common/icon-lock"):z.TextureLoader.inst.getSpriteFrame(z.ATLAS_TYPE.UIATLAS,"common/icon-video");a.getComponent(cc.Sprite).spriteFrame=n}a&&(a.active=0==i.number&&!O.default.Prop_infinite);var r=e.getChildByName("num");r&&(r.active=i.number>0,r.getComponent(cc.Label).string="clock"==t&&0==i.number?"+"+o.reward+"s":i.number.toString())}},e.prototype.bottomMove=function(t,e){var i=this;void 0===e&&(e=null);var o=this.node.getChildByName("bottom"),a=t?1.5*-cc.winSize.width:0;t?BYTEDANCE_GAME||this.showBanner(!1):BYTEDANCE_GAME||this.showBanner(!0),cc.tween(o).to(this.bottomTweenTime,{x:a},{easing:"backOut"}).call(function(){t||i.updateProp(P.default.selectedProp),t||i.checkGuideViewHeight(),e&&e()}).start();var n=this.node.getChildByName("right"),r=t?300:-55;cc.tween(n).to(this.bottomTweenTime,{x:cc.winSize.width/2+r},{easing:"backOut"}).start();var s=this.node.getChildByName("left"),l=t?-55:55;cc.tween(s).to(this.bottomTweenTime,{x:-cc.winSize.width/2+l},{easing:"backOut"}).start()},e.prototype.bottomUpdateY=function(t,e){void 0===e&&(e=!1);var i=(WECHAT_GAME||QQ_GAME||XIAOMI_GAME)&&!e,o=this.node.getChildByName("bottom"),a=i?t/cc.view.getFrameSize().height:t/cc.winSize.height;o.y=-cc.winSize.height/2+cc.winSize.height*a,this.checkGuideViewHeight()},e.prototype.checkGuideViewHeight=function(){var t=this.node.getChildByName("bottom").y+cc.winSize.height/2;console.log("\u66f4\u65b0\u5f15\u5bfc\u6846\u9ad8\u5ea6:",t),k.default.inst&&k.default.inst.setTipsY(t+260)},e.prototype.checkBottomHeight=function(){!d.default.IS_LOCAL&&d.default.IS_AD_SHOW&&(JSB_IOS?this.bottomUpdateY(130):XIAOMI_GAME?this.bottomUpdateY(60):JSB_MMY?this.bottomUpdateY(145):JSB_XIAOMI?this.bottomUpdateY(150):WECHAT_GAME||QQ_GAME?this.bottomUpdateY(84):JSB_233?this.bottomUpdateY(0):this.bottomUpdateY(115))},e.prototype.showBanner=function(t){t?L.default.inst.isGuiding||(this.showCustomAd(!0),this.checkBottomHeight(),g.default.showBannerAd(),this.videoBanner.active=!1):(this.showCustomAd(!1),g.default.hideBannerAd(cc.sys.platform!=cc.sys.WECHAT_GAME))},e.prototype.showCustomAd=function(t){WECHAT_GAME&&(t?g.default.showCustomAd(cc.v2(55/cc.winSize.width,.55)):g.default.hideCustomAd(),g.default.showClubButton(t,cc.v2(55/cc.winSize.width,.45)))},e.prototype.showBoxGift=function(){var t=this;if(OPPO_GAME){g.default.preloadNativeAd();var e=null,i=y.default.getData("p6",y.v_type.Number)||30;this.scheduleOnce(function i(){e||(e=g.default.getNativeAdData()),!C.default.allowPopUi()||OPPO_GAME&&!e?setTimeout(i,3e3):(A.default.open(A.view_type.BoxGift),setTimeout(function(){OPPO_GAME&&A.default.open(A.view_type.AdView,null,null,!1,function(t){t.getComponent(D.default).init(b.default.getRewards(17),e,D.AD_TYPE.boxGift)},function(){t.showBoxGift()})},1e3))},i)}},e.prototype.addShortcut=function(){if(QQ_GAME){var t=window.qq;t.saveAppToDesktop&&t.saveAppToDesktop({success:function(){},fail:function(){}})}},e.prototype.addColorSign=function(){if(QQ_GAME){var t=window.qq;t.addColorSign&&t.addColorSign({success:function(){},fail:function(){}})}},e.prototype.subscribeAppMsg=function(){QQ_GAME&&window.qq.subscribeAppMsg({subscribe:!0,success:function(t){console.log("----subscribeAppMsg----success",t)},fail:function(t){console.log("----subscribeAppMsg----fail",t)}})},e.prototype.showRankList=function(){F.default.playClick(),A.default.open(A.view_type.RankList)},e.prototype.onClickOnlineShare=function(t){F.default.playClick();var e=t.getCurrentTarget().getComponent(cc.Button);e.interactable=!1,setTimeout(function(){e.interactable=!0},1e3),QQ_GAME&&g.default.shareAppMessage({title:"\u5f53\u4e00\u6b21\u4e0a\u5e1d\uff0c\u521b\u9020\u8fd8\u662f\u6bc1\u706d\u7531\u4f60\u51b3\u5b9a",imageUrl:"share.png",success:function(){A.default.open(A.view_type.AwardView,null,null,!1,function(t){t.getComponent(M.default).init(M.Reward_type.boxGift,2)},function(){i.inst.showBoxGift()})},fail:function(){B.default.pushToast("\u5206\u4eab\u5931\u8d25\uff01")}})},e.prototype.showTimeScaleView=function(){var t=this;this.scheduleOnce(function e(){1!=P.default.timeScale?t.showTimeScaleView():C.default.allowPopUi()?A.default.open(A.view_type.TimeScale,function(){var e=t.btnClock.getComponent(cc.Toggle);e.isChecked=!0,e.checkEvents[0].emit([e,!0])},null,!1,null,function(){t.showTimeScaleView()}):t.scheduleOnce(e,3)},120)},e.prototype.showInterstitialAd=function(t){var e=this;this.scheduleOnce(function t(){C.default.allowPopUi()?g.default.showInterstitialAd(function(){var t=y.default.success?y.default.getData("p8",y.v_type.Number):100;e.showInterstitialAd(t)}):setTimeout(t,3e3)},t)},e.inst=null,s([K({type:[cc.Node],tooltip:"\u9053\u5177\u6309\u94ae\u5217\u8868"})],e.prototype,"propLayout",void 0),s([K({type:cc.Node})],e.prototype,"toggleContainer",void 0),s([K({type:cc.Node})],e.prototype,"selectIcon",void 0),s([K({type:cc.Node})],e.prototype,"ndSelected",void 0),s([K({type:cc.Node})],e.prototype,"mainSizeButton",void 0),s([K(cc.Node)],e.prototype,"btnPulldown",void 0),s([K(cc.Node)],e.prototype,"btnClock",void 0),s([K(cc.Node)],e.prototype,"btnAchiev",void 0),s([K(cc.Node)],e.prototype,"btnOnline",void 0),s([K(cc.Node)],e.prototype,"btnSignIn",void 0),s([K(cc.Node)],e.prototype,"btnMoreGame",void 0),s([K(cc.Node)],e.prototype,"btnShortcut",void 0),s([K(cc.Node)],e.prototype,"btnColorSign",void 0),s([K(cc.Toggle)],e.prototype,"toggleRec",void 0),s([K([cc.SpriteFrame])],e.prototype,"pauseSprite",void 0),s([K([cc.SpriteFrame])],e.prototype,"propSprite",void 0),s([K(cc.Prefab)],e.prototype,"pbAchiev",void 0),s([K([cc.Node])],e.prototype,"btnZones",void 0),s([K(cc.ProgressBar)],e.prototype,"researchBar",void 0),s([K(cc.Node)],e.prototype,"videoBanner",void 0),i=s([Z],e)}(cc.Component);n.default=J,cc._RF.pop()},{}],UnLockProp:[function(t,e,i){"use strict";cc._RF.push(e,"00ade70XFBA36jTyZwg3DJ0","UnLockProp");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AdsManager"),c=a("UserData"),d=a("GamePopBase"),u=a("MsgCache"),h=a("LocalizedTextManager"),p=a("AssetManager"),f=a("Config"),_=a("TextureLoader"),m=cc._decorator,g=m.ccclass,y=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propNode=null,e.title=null,e.btnText=null,e.btnCoin=null,e.coinText=null,e.video=null,e.cumulative=null,e.data=null,e.needPay=!1,e}return r(e,t),e.prototype.start=function(){var t=p.default.powers.dict.get(f.default.selectedProp);if(this.data=c.default.getPropConfigByID(f.default.selectedProp),this.data&&t){var e=c.default.getPropByID(this.data.propID);this.needPay=!1,this.btnCoin.active=!1,this.video.active=e.lock,this.title.string="\u89e3\u9501\u9053\u5177",this.btnText.string="\u7acb\u5373\u89e3\u9501",this.btnCoin.active&&(this.coinText.string=this.data.coin+"");var i=this.propNode.getChildByName("icon"),o=_.TextureLoader.inst.getSpriteFrame(_.ATLAS_TYPE.UIATLAS,"propIcon/"+t.icon);o&&(i.getComponent(cc.Sprite).spriteFrame=o),this.propNode.getChildByName("name").getComponent(cc.Label).string=this.data.propName,this.propNode.getChildByName("num").getComponent(cc.Label).string=this.needPay?"X"+1.5*this.data.reward:"X"+this.data.reward,this.propNode.getChildByName("desc").getComponent(cc.Label).string=h.LocalizedTextManager.getGodPowerDesc(t.name)}},e.prototype.clickCoin=function(){var t=c.default.getPropByID("coins"),e=c.default.getPropByID(this.data.propID);t.number>=this.data.coin?(t.number-=this.data.coin,e.number+=this.data.reward,c.default.save(),u.default.pushToast("\u8865\u5145\u9053\u5177<"+e.propName+">+"+this.data.reward+"\u6210\u529f")):u.default.pushToast("\u4e16\u754c\u5e01\u4e0d\u8db3\uff0c\u8bf7\u5145\u503c")},e.prototype.click=function(t){var e=this,i=t.getCurrentTarget().getComponent(cc.Button);i.interactable=!1,this.video.active&&l.default.showVideoAds(function(t){if(1==t)e.reward();else{i.interactable=!0;var o=0==t?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";u.default.pushToast(o)}})},e.prototype.reward=function(){var t=c.default.getPropByID(this.data.propID),e=this.needPay?1.5*this.data.reward:this.data.reward;t.number+=e,t.lock=!1,u.default.pushToast("\u89e3\u9501\u9053\u5177<"+t.propName+">\u6210\u529f"),c.default.save(),this.close()},s([y(cc.Node)],e.prototype,"propNode",void 0),s([y(cc.Label)],e.prototype,"title",void 0),s([y(cc.Label)],e.prototype,"btnText",void 0),s([y(cc.Node)],e.prototype,"btnCoin",void 0),s([y(cc.Label)],e.prototype,"coinText",void 0),s([y(cc.Node)],e.prototype,"video",void 0),s([y(cc.Node)],e.prototype,"cumulative",void 0),s([g],e)}(d.GamePopBase);n.default=v,cc._RF.pop()},{}],UnitAvatarLoader:[function(t,e,i){"use strict";cc._RF.push(e,"b7c57I9Pg5N7JRGFjNnIopF","UnitAvatarLoader");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l,c=a("ActorAnimationLoader");(function(t){t[t.Body=0]="Body",t[t.Head=1]="Head",t[t.Item=2]="Item"})(l||(l={}));var d=cc._decorator,u=d.ccclass,h=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatarSize=3,e}return r(e,t),e.prototype.load=function(t){if(t.stats.specialAnimation||(t.updateAnimation(0,!0),t.spriteAnimation.forceUpdateFrame()),this.node.destroyAllChildren(),this.node.setScale(cc.v3(t.stats.inspectAvatarScale*this.avatarSize,t.stats.inspectAvatarScale*this.avatarSize)),this.showSpritePart(t.spriteRenderer.spriteFrame,t,cc.Vec3.ZERO,l.Body),t.stats.body_separate_part_head){var e=t.getAnimationFrameData(),i=cc.v3(0,13);e&&(i.x=e.posHead.x,i.y=e.posHead.y),this.showSpritePart(t.s_head_sprite,t,i,l.Head)}if(t.isItemRendered()){var o=t.getAnimationFrameData(),a=cc.v3(-5.5,8);o&&(a.x=o.posItem.x,a.y=o.posItem.y);var n=t.getTextureToRenderInHand();this.showSpritePart(c.default.getItem(n),t,a,l.Item)}},e.prototype.showSpritePart=function(t,e,i,o){var a=new cc.Node,n=a.addComponent(cc.Sprite);n.spriteFrame=t,a.width=n.spriteFrame.getRect().width,a.height=n.spriteFrame.getRect().height,a.parent=this.node,a.y=i.y,a.x=i.x,a.anchorY=o==l.Body?0:.5},s([u],e)}(cc.Component));n.default=h,cc._RF.pop()},{}],UnitGroupManager:[function(t,e,i){"use strict";cc._RF.push(e,"7bbf4IVkexIhZSpIgOou2Y7","UnitGroupManager");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.UnitGroup=void 0;var n=o("ToolBox"),r=o("ActorBase"),s=function(){function t(t){this.units=new r.ActorContainer,this.id=0,this.groupLeader=null,this._prev_leader_position=null,this.alive=!0,this.city=null,this.city=t}return t.prototype.clear=function(){this.units.clear(),this.setGroupLeader(null),this.alive=!1},t.prototype.disband=function(){this.units.list.forEach(function(t){t.removeFromGroup()}),this.clear()},t.prototype.setGroupLeader=function(t){!t&&this.groupLeader&&this.groupLeader.setGroupLeader(!1),this.groupLeader=t,this.groupLeader&&this.groupLeader.setGroupLeader(!0)},t.prototype.logicUpdate=function(){var t;this.units.checkAddRemove(),this.groupLeader&&!(null===(t=this.groupLeader.data)||void 0===t?void 0:t.alive)&&(this._prev_leader_position=this.groupLeader.currentTile,this.setGroupLeader(null)),this.findGroupLeader(),this.checkDeadUnits()},t.prototype.findGroupLeader=function(){var t=this;if(this.groupLeader){if(this.groupLeader.kingdom.isCiv())return;this.setGroupLeader(null)}if(0!=this.units.length)if(this._prev_leader_position){var e=null,i=0,o=0;this.units.list.forEach(function(a){var r;(null===(r=a.data)||void 0===r?void 0:r.alive)&&(i=n.Toolbox.distTile(a.currentTile,t._prev_leader_position),(!e||i<o)&&(e=a,o=i))}),e&&this.setGroupLeader(e)}else{var a=this.units.getRandom();this.setGroupLeader(a)}},t.prototype.checkDeadUnits=function(){var e=this;t._units_to_remove=[],this.units.list.forEach(function(e){var i;(null===(i=e.data)||void 0===i?void 0:i.alive)||t._units_to_remove.push(e)}),t._units_to_remove.forEach(function(t){e.units.remove(t)})},t.prototype.isAlive=function(){return this.alive},t.prototype.addUnit=function(t){this.units.add(t),t.unitGroup=this},t.prototype.removeUnit=function(t){this.units.remove(t)},t.prototype.countUnits=function(){return this.units.length},t.prototype.getDebug=function(){var t=this.units.length.toString();return this.groupLeader&&(t=t+" "+this.groupLeader.data.firstName+"("+this.groupLeader.data.age+")"),t},t._tiles=[],t._units_to_remove=[],t}();a.UnitGroup=s;var l=function(){function t(){this.last_id=0,this.interval_check_dead=1,this.timer_check_dead=1,this.groups=[]}return t.prototype.logicUpdate=function(t){var e;if(this.timer_check_dead>0)this.timer_check_dead-=t;else{this.timer_check_dead=this.interval_check_dead;for(var i=0;i<this.groups.length;){var o=this.groups[i];o.logicUpdate(t),(null===(e=o.city)||void 0===e?void 0:e.alive)?i++:(o.disband(),this.groups.splice(i,1))}}},t.prototype.createNewGroup=function(t){var e=new s(t);return e.id=this.last_id++,this.groups.push(e),e},t.prototype.clear=function(){this.groups.forEach(function(t){t.clear()}),this.groups=[]},t}();a.default=l,cc._RF.pop()},{}],UnitLayer:[function(t,e,i){"use strict";cc._RF.push(e,"42c59avz7hKtb7BGS075khe","UnitLayer");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("ToolBox"),c=a("MapBox"),d=a("PlayerConfig"),u=a("MapLayer"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.prevTiles=[],e.interval=.1,e.dead=cc.color(0,0,0,127.5),e._color_clear=cc.Color.TRANSPARENT,e}return r(e,t),e.prototype.onLoad=function(){this.dead=l.Toolbox.makeColor("#393939"),t.prototype.create.call(this)},e.prototype.clear=function(){this.prevTiles=[],t.prototype.clear.call(this)},e.prototype.updateDirty=function(t){var e,i,o;if(this.timer>0)this.timer-=t;else{this.timer=this.interval;for(var a=0;a<this.prevTiles.length;a++){var n=this.prevTiles[a];this.updateSinglePixel(n.data.tile_id,this._color_clear)}this.prevTiles=[];var r=d.default.optionBoolEnabled("marks_boats"),s=c.default.inst.showCultureZones();c.default.inst.isSelectedPowerAny()&&!c.default.inst.isPowerForceMapMode()&&(s=!1);for(var l=c.default.inst.units.getSimpleList(),u=0;u<l.length;u++){var h=l[u];if(h&&(null===(e=h.data)||void 0===e?void 0:e.alive)&&(null===(i=h.stats)||void 0===i?void 0:i.hideOnMinimap)&&0!=(null===(o=h.stats)||void 0===o?void 0:o.color.a)&&!h.insideBuilding&&(this.prevTiles.push(h.currentTile),h.currentTile))if(h.data.alive)if(s){var p=c.default.inst.cultures.get(h.data.culture);p&&this.updateSinglePixel(h.currentTile.data.tile_id,p.color32_text)}else(h.stats.isBoat||h.stats.unit)&&h.kingdom&&h.kingdom.isCiv()?r&&h.stats.drawBoatMark||this.updateSinglePixel(h.currentTile.data.tile_id,h.kingdom.kingdomColor.color32_unit):this.updateSinglePixel(h.currentTile.data.tile_id,h.stats.color);else this.updateSinglePixel(h.currentTile.data.tile_id,this.dead)}this.updatePixels()}},s([p],e)}(u.default));n.default=f,cc._RF.pop()},{}],UnitSelectionEffect:[function(t,e,i){"use strict";cc._RF.push(e,"d0effFwJzNNCZU1bFyUSOD/","UnitSelectionEffect");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseAnimatedObject"),c=a("Globals"),d=a("MapBox"),u=cc._decorator,h=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.node.parent=d.default.inst.node,this.node.name="unit_selector_effect"},e.prototype.logicUpdate=function(e){t.prototype.update.call(this,e);var i=!0,o=null;d.default.inst.qualityChanger.lowRes&&(i=!1),i&&(i=!!(o=d.default.inst.getActorNearCursor())),i?(this.node.active=!0,this.node.position=o.currentPosition,this.node.scale=o.node.scale):(this.node.active=!1,this.node.position=c.default.POINT_IN_VOID)},s([h],e)}(l.default));n.default=p,cc._RF.pop()},{}],UnitSpawner:[function(t,e,i){"use strict";cc._RF.push(e,"fe8b8tUHDZBVJw1KNKG5v5+","UnitSpawner");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=a("BaseBuilding"),l=a("MapBox"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.units_current=0,e.units_limit=5,e.spawnInterval=10,e.spawnTimer=1,e.spawnActions=[],e}return r(e,t),e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.spawnTimer>0?this.spawnTimer-=e:(this.spawnTimer=this.spawnInterval,this.spawnUnit())},e.prototype.spawnUnit=function(){if(this.units_current<this.units_limit){var t=this.building.stats.spawnUnits_asset,e=l.default.inst.createNewUnit(t,this.building.currentTile);this.setUnitFromHere(e)}},e.prototype.setUnitFromHere=function(t){t.setHomeBuilding(this.building),t.callbacks_on_death.push(this.callbackUnitDied.bind(this)),this.units_current++,this.spawnActions.forEach(function(e){e(t)})},e.prototype.callbackUnitDied=function(){this.units_current--},e}(s.BaseBuildingComponent);n.default=c,cc._RF.pop()},{}],UnitSpriteAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"46d44Q6iExGoaKL/8qmjOHN","UnitSpriteAnimation");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.UnitSpriteAnimation=n.UnitSpriteAnimationData=n.AnimationDataBoat=n.AnimationDataUnit=n.ActorAnimation=n.AnimationFrameData=void 0;var l=a("Actor"),c=a("MapBox"),d=a("TextureLoader"),u=a("ActorAnimationLoader"),h=a("SpriteAnimation");n.AnimationFrameData=function(){this.id="",this.posHead=cc.Vec2.ZERO,this.posHead_new=cc.Vec2.ZERO,this.posItem=cc.Vec2.ZERO,this.posItem_new=cc.Vec2.ZERO},n.ActorAnimation=function(){this.id=0,this.frames=[],this.timeBetweenFrames=.5},n.AnimationDataUnit=function(){this.id="",this.sprites=new Map,this.frameData=new Map,this.idle=null,this.walking=null,this.swimming=null,this.heads=[]},n.AnimationDataBoat=function(){this.id="",this.dict=new Map,this.broken=null,this.normal=null},n.UnitSpriteAnimationData=function(){this.head=cc.Vec2.ZERO,this.item=cc.Vec2.ZERO,this.backpack=cc.Vec2.ZERO};var p=cc._decorator,f=p.ccclass,_=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shadow=null,e.actor=null,e.head=null,e.item=null,e.banner=null,e.favorite=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){t.prototype.create.call(this),this.actor=this.node.parent.getComponent(l.default)},e.prototype.update=function(){this.actor&&this.updateShadow()},e.prototype.updateFrame=function(){var e;if(t.prototype.updateFrame.call(this),this.actor&&this.currentSpriteGraphic&&this.actor._is_visible&&!c.default.inst.qualityChanger.lowRes){var i=this.currentSpriteGraphic.name.substr(this.currentSpriteGraphic.name.length-6),o=this.actor.actorAnimationData.frameData.get(i);o&&(this.actor.frameData=o,this.updateHead(),(null===(e=this.actor.data)||void 0===e?void 0:e.alive)&&(this.updateItem(),this.updateBanner(),this.updateFavoriteIcon()))}},e.prototype.updateHead=function(){var t=this.actor.getAnimationFrameData();t&&this.actor.stats.body_separate_part_head?(this.head=this.head||this.getHead(),this.head.parent=this.actor.node,this.head.x=t.posHead.x,this.head.y=t.posHead.y,"dwarf"==this.actor.race.id&&(this.head.y-=2),this.actor.stats.id.includes("santa")&&(this.head.y+=1),this.actor.stats.id.includes("zombie")&&(this.head.y-=1),this.head.anchorY=.5,this.head.getComponent(cc.Sprite).spriteFrame=this.actor.s_head_sprite):this.head&&(this.head.color=cc.Color.WHITE,this.head.opacity=255,i.headsPool.put(this.head),this.head=null)},e.prototype.updateShadow=function(){this.shadow.active=this.actor.stats.shadow,this.shadow.y=this.actor.isInAir()?-7:10*-(this.actor.node.y-this.actor.currentPosition.y),this.actor.stats.shadow_sprite&&(this.shadow.getComponent(cc.Sprite).spriteFrame=this.actor.stats.shadow_sprite)},e.prototype.updateItem=function(){var t=!1;this.actor.ai.task&&this.actor.ai.task.force_item_sprite&&(t=!0);var e=this.actor.getAnimationFrameData();(t||this.actor.s_weapon_texture)&&this.actor.isItemRendered()&&e?(this.item=this.item?this.item:this.getItem(),this.item.parent=this.actor.node,this.item.y=e.posItem.y,this.item.getComponent(cc.Sprite).spriteFrame=u.default.getItem(this.actor.getTextureToRenderInHand())):this.item&&(this.item.color=cc.Color.WHITE,this.item.opacity=255,i.itemsPool.put(this.item),this.item=null)},e.prototype.updateBanner=function(){var t,e,o=this.actor.getAnimationFrameData();this.actor.isGroupLeader&&(null===(t=this.actor.kingdom)||void 0===t?void 0:t.isCiv())&&(null===(e=this.actor.kingdom)||void 0===e?void 0:e.kingdomColor)&&o?(this.banner=this.banner?this.banner:this.getBanner(),this.banner.parent=this.head,this.banner.y=this.head.height/2,this.banner.color=this.actor.kingdom.kingdomColor.colorBorderOut):this.banner&&(i.bannersPool.put(this.banner),this.banner=null)},e.prototype.updateFavoriteIcon=function(){this.actor.data.favorite&&!this.actor.stats.hideFavoriteIcon?(this.favorite=this.favorite?this.favorite:this.getFavorite(),this.favorite.parent=this.head,this.favorite.y=this.head.height/2):this.favorite&&(i.favoritesPool.put(this.favorite),this.favorite=null)},e.prototype.getBanner=function(){var t=i.bannersPool.get();if(!t){(t=new cc.Node("banner")).anchorY=0;var e=d.TextureLoader.inst.getSpriteFrame(d.ATLAS_TYPE.WORLDATLAS,"actors/races/civ_army_banner");t.addComponent(cc.Sprite).spriteFrame=e}return t},e.prototype.getHead=function(){var t=i.headsPool.get();return t||(t=new cc.Node("head")).addComponent(cc.Sprite),t.anchorY=1,t},e.prototype.getItem=function(){var t=i.itemsPool.get();return t||((t=new cc.Node("item")).addComponent(cc.Sprite),t.x=-5.5),t},e.prototype.getFavorite=function(){var t=i.favoritesPool.get();if(!t){(t=new cc.Node("favorite")).anchorY=0;var e=d.TextureLoader.inst.getSpriteFrame(d.ATLAS_TYPE.UIATLAS,"icons/iconFavoriteStar");t.addComponent(cc.Sprite).spriteFrame=e}return t},e.prototype.applyCurrentSpriteGraphics=function(t){this.actor&&this.actor.setBodySprite(t)},e.itemsPool=new cc.NodePool,e.headsPool=new cc.NodePool,e.bannersPool=new cc.NodePool,e.favoritesPool=new cc.NodePool,s([_(cc.Node)],e.prototype,"shadow",void 0),i=s([f],e)}(h.SpriteAnimation);n.UnitSpriteAnimation=m,cc._RF.pop()},{}],UnitZones:[function(t,e,i){"use strict";cc._RF.push(e,"50bf1wt/KdK+Y8vYW32RiiN","UnitZones");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("Docks"),r=o("MapBox"),s=function(){function t(){this.timer=0,this.interval=1,this.chunks=[],this.tiles=[]}return t.prototype.logicUpdate=function(){this.timer>0?this.timer-=cc.director.getDeltaTime():(this.timer=this.interval,this.recalc())},t.prototype.clear=function(){for(var t=0;t<r.default.inst.citiesList.length;t++)r.default.inst.citiesList[t].clearCurrentCaptureAmounts();for(t=0;t<this.tiles.length;t++)this.tiles[t].clearUnits();for(t=0;t<r.default.inst.islandsCalculator.islands.length;t++)r.default.inst.islandsCalculator.islands[t].docks=[];for(t=0;t<this.chunks.length;t++)this.chunks[t].clearObjects();this.chunks=[],this.tiles=[]},t.prototype.addUnit=function(t,e){0==e.units.length&&this.tiles.push(e),e.units.push(t),t.professionAsset.can_capture&&e.zone.city&&!t.isInsideSomething()&&e.zone.city.updateConquest(t)},t.prototype.recalc=function(){var t,e,i;this.clear();for(var o=r.default.inst.units.getSimpleList(),a=0;a<o.length;a++){var s=o[a];if((null===(t=null==s?void 0:s.data)||void 0===t?void 0:t.alive)&&(null==s?void 0:s.kingdom)){var l=s.currentTile.chunk;0==l.k_list_objects.length&&this.chunks.push(l),this.addUnit(s,s.currentTile),l.addObject(s)}}var c=r.default.inst.buildings.getSimpleList();for(a=0;a<c.length;a++){var d=c[a];if(null===(e=null==d?void 0:d.base_data)||void 0===e?void 0:e.alive){(null===(i=d.stats)||void 0===i?void 0:i.docks)&&d.getComponent(n.default).tiles_ocean.length>0&&d.getComponent(n.default).tiles_ocean[0].region.island.docks.push(d.getComponent(n.default));var u=d.currentTile.chunk;0==u.k_list_objects.length&&this.chunks.push(u),u.addObject(d),d.stats.tower&&d.city&&d.city.addCapturePoints(d,10)}}},t}();a.default=s,cc._RF.pop()},{}],UnusedLibrary:[function(t,e,i){"use strict";cc._RF.push(e,"bf77a7qVk1BNqlB07vaeX9V","UnusedLibrary");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("DragonAsset"),c=cc._decorator,d=c.ccclass,u=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atlas=null,e.actor=[],e.meteorite=null,e.dragonAsset=null,e.zombieDragonAsset=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this},e.prototype.getActorPrefab=function(t){return this.actor.find(function(e){if(e.name==t)return e})},e.prototype.getSpriteFrames=function(t){var e=new Map;return t=(t=t.replace(/\//g,"-")).lastIndexOf("-")==t.length-1?t:t+"-",this.atlas.getSpriteFrames().forEach(function(i){if(i.name.includes(t)){var o=i.name.substring(t.length);e.set(o,i)}}),e},e.inst=null,s([u(cc.SpriteAtlas)],e.prototype,"atlas",void 0),s([u({type:[cc.Prefab],tooltip:"\u5b9e\u4f8b\u5316actor\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"actor",void 0),s([u({type:cc.Prefab,tooltip:"\u5b9e\u4f8b\u5316\u9668\u77f3\u9700\u8981\u7684\u9884\u5236"})],e.prototype,"meteorite",void 0),s([u({type:l.default,tooltip:"\u5b9e\u4f8b\u5316dragon\u9700\u8981\u7684\u914d\u7f6e"})],e.prototype,"dragonAsset",void 0),s([u({type:l.default,tooltip:"\u5b9e\u4f8b\u5316zombieDragon\u9700\u8981\u7684\u914d\u7f6e"})],e.prototype,"zombieDragonAsset",void 0),i=s([d],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],VideoBanner:[function(t,e,i){"use strict";cc._RF.push(e,"e4d4d6OuWRATKHeb/6zs0A9","VideoBanner");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Constants"),c=a("AdsManager"),d=a("RewardData"),u=a("MsgCache"),h=a("ViewController"),p=a("AwardView"),f=cc._decorator,_=f.ccclass,m=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.click=function(t){t.getCurrentTarget().getComponent(cc.Button),l.default.REPORT_ID="videoBanner",c.default.showVideoAds(function(e){if(1==e)h.default.open(h.view_type.AwardView,null,t,!0,function(t){t.getComponent(p.default).init(p.Reward_type.vedio,d.default.getRewards(3))});else{var i=0==e?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";u.default.pushToast(i)}})},s([_],e)}(cc.Component));n.default=m,cc._RF.pop()},{}],VideoInterstitial:[function(t,e,i){"use strict";cc._RF.push(e,"0b8c8kG7fJG3rkS9KUoQW3D","VideoInterstitial");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("Constants"),c=a("AdsManager"),d=a("GameTdd"),u=a("RewardData"),h=a("MsgCache"),p=a("ViewController"),f=a("AwardView"),_=cc._decorator,m=_.ccclass,g=_.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e}return r(e,t),e.prototype.onLoad=function(){var t=d.default.success?d.default.getData("p4",d.v_type.Number):0;this.bg.interactable=1==t},e.prototype.close=function(){this.node.destroy()},e.prototype.click=function(t){var e=this;t.getCurrentTarget().getComponent(cc.Button),l.default.REPORT_ID="videoInterstitial",c.default.showVideoAds(function(i){if(1==i)p.default.open(p.view_type.AwardView,null,t,!0,function(t){t.getComponent(f.default).init(f.Reward_type.vedio,u.default.getRewards(3)),e.close()});else{var o=0==i?"\u89c6\u9891\u64ad\u653e\u672a\u5b8c\u6210\u3002":"\u89c6\u9891\u64ad\u653e\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01";h.default.pushToast(o)}})},s([g(cc.Button)],e.prototype,"bg",void 0),s([m],e)}(cc.Component);n.default=y,cc._RF.pop()},{}],ViewController:[function(t,e,i){"use strict";cc._RF.push(e,"3ec5fcwEC1ALLZrnvI27MEY","ViewController");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.view_type=void 0;var n,r=o("MathUtils"),s=o("Constants"),l=o("AdaptMgr"),c=o("UiUtil"),d=o("AdsManager"),u=o("GameTdd"),h=o("GamePopBase"),p=o("GuideController"),f=o("UiController");(function(t){t.CreatureInfo="CreatureInfo",t.CulturesList="CulturesList",t.CultureWindow="CultureWindow",t.KingdomList="KingdomList",t.KingdomWindow="KingdomWindow",t.CitiesList="CitiesList",t.CityWindow="CityWindow",t.WorldLaws="WorldLaws",t.Favorites="Favorites",t.WorldInfo="WorldInfo",t.CensusInfo="CensusInfo",t.WorldLog="WorldLog",t.Setting="Setting",t.MapSetting="MapSetting",t.UiBrushes="UiBrushes",t.GMView="GMView",t.SaveWorld="SaveWorld",t.Achiev="Achiev",t.AwardView="AwardView",t.AdView="AdView",t.SignIn="SignIn",t.InfiniteProp="InfiniteProp",t.Mystery="Mystery",t.LuckyWheel="LuckyWheel",t.BoxGift="BoxGift",t.RecordShare="RecordShare",t.BoxMonster="BoxMonster",t.HtBox="HtBox",t.UnLockProp="UnLockProp",t.StoreView="StoreView",t.AppBoxView="AppBoxView",t.RankList="RankList",t.TimeScale="TimeScale",t.QQLimitedGifts="QQLimitedGifts"})(n=a.view_type||(a.view_type={}));var _=function(){function t(){this.list=[],this.pbPath={HtBox:"res/prefab/ht/HtBox",CreatureInfo:"res/prefab/ui/info/CreatureInfo",CulturesList:"res/prefab/ui/info/CulturesList",CultureWindow:"res/prefab/ui/info/CultureWindow",KingdomList:"res/prefab/ui/info/KingdomList",KingdomWindow:"res/prefab/ui/info/Kingdom",CitiesList:"res/prefab/ui/info/CitiesList",CityWindow:"res/prefab/ui/info/Village",WorldLaws:"res/prefab/ui/info/WorldLaws",Favorites:"res/prefab/ui/info/Favorites",WorldInfo:"res/prefab/ui/info/WorldInfo",CensusInfo:"res/prefab/ui/info/CensusInfo",WorldLog:"res/prefab/ui/log/WorldLogWindow",Setting:"res/prefab/ui/setting/Setting",MapSetting:"res/prefab/ui/setting/MapSetting",UiBrushes:"res/prefab/ui/setting/UiBrushes",GMView:"res/prefab/ui/setting/GMView",SaveWorld:"res/prefab/ui/save/SaveList",Achiev:"res/prefab/ui/achiev/AchievView",AwardView:"res/prefab/ui/reward/AwardView",AdView:"res/prefab/ui/reward/AdView",SignIn:"res/prefab/ui/reward/SignIn",InfiniteProp:"res/prefab/ui/reward/InfiniteProp",Mystery:"res/prefab/ui/reward/MysteryReward",LuckyWheel:"res/prefab/ui/reward/LuckyWheel",BoxGift:"res/prefab/ui/reward/BoxGift",RecordShare:"res/prefab/ui/reward/RecordShare",BoxMonster:"res/prefab/ui/reward/BoxMonster",UnLockProp:"res/prefab/ui/store/UnLockProp",StoreView:"res/prefab/ui/store/StoreView",AppBoxView:"res/prefab/ui/reward/AppBoxView",RankList:"res/prefab/ui/reward/RankList",TimeScale:"res/prefab/ui/reward/TimeScale",QQLimitedGifts:"res/prefab/ui/reward/QQLimitedGifts"}}return t.prototype.open=function(t,e,i,o,a,_){var m=this;void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===_&&(_=null);var g=i?i instanceof cc.Event?i.getCurrentTarget():i.node:null;if(g){var y=g.getComponent(cc.Button);y.interactable=!1,setTimeout(function(){y.interactable=!0},1e3)}var v=this.list.length>0?this.list[this.list.length-1]:null;c.UiUtil.openModule(this.pbPath[t]).then(function(i){if(l.default.adaptScreenScale(i),0==m.list.length){if((WECHAT_GAME||VIVO_GAME||JSB_OPPO||JSB_VIVO||XIAOMI_GAME||JSB_HUAWEI||JSB_XIAOMI||BYTEDANCE_GAME||HUAWEI_GAME)&&m.showInter(t)&&s.default.INSERTAD_SHOW){var g=u.default.success?u.default.getData("p3",u.v_type.NumberList):[.2,100];setTimeout(function(){p.default.inst.isGuiding||(s.default.INSERTAD_SHOW=!1,d.default.showInterstitialAd(function(t){1!=t&&r.default.randomRange(0,100)<g[1]&&c.UiUtil.openModule("res/prefab/ui/reward/VideoInterstitial")}))},1e3*(g[0]+.3))}if(WECHAT_GAME&&t!=n.AppBoxView){var y=u.default.success?u.default.getData("p2",u.v_type.NumberList):[30,100];r.default.randomRange(0,100)<y[1]&&d.default.showBoxBannerAd()}}a&&a(i),m.list.push(i);var b=i.getComponent(h.GamePopBase);b.setCallback(e,function(t){var e=m.list.indexOf(i);m.list.remove(i),0==m.list.length?(f.default.inst.bottomMove(!1),d.default.hideBoxBannerAd()):t||(v=m.list[e-1])&&v.getComponent(h.GamePopBase).move(!1),null==_||_()}),b.open(),v?o?v.getComponent(h.GamePopBase).move(!0):v.getComponent(h.GamePopBase).close(!0):f.default.inst.bottomMove(!0)})},t.prototype.close=function(t){void 0===t&&(t=!1);for(var e=this.list.length,i=0;i<e&&(this.list.pop().getComponent(h.GamePopBase).close(!0),t);i++);},t.prototype.showInter=function(t){switch(t){case n.SignIn:case n.LuckyWheel:case n.Achiev:case n.Achiev:return!0;case n.BoxGift:case n.AppBoxView:case n.AdView:case n.AwardView:return!1;default:return r.default.randomChance(.6)}},t}();a.default=new _,cc._RF.pop()},{}],VortexAction:[function(t,e,i){"use strict";cc._RF.push(e,"10fbcn3lf9JibrnuGfieL3d","VortexAction");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.VortexSwitchHelper=void 0;var n=o("TerraformLibrary"),r=o("ToolBox"),s=o("MapBox"),l=o("MapAction"),c=function(){this.tile=null,this.newType=null,this.newTopType=null};a.VortexSwitchHelper=c;var d=function(){function t(){}return t.moveTiles=function(e,i){t.clear();for(var o=0;o<i.pos.length;o++){var a=i.pos[o],d=s.default.inst.getTile(e.x+a.x,e.y+a.y);if(d&&(s.default.inst.flashEffects.flashPixel(d,10),!r.Toolbox.randomChance(.8))){var u=r.Toolbox.getRandom(d.neighbours);if(u.top_type&&l.default.removeGreens(u),u.type.liquid&&l.default.removeLiquid(u),u){var h=new c;h.tile=u,h.newType=d.main_type,h.newTopType=d.top_type,t.newTiles.push(h)}}}for(o=0;o<t.newTiles.length;o++){var p=t.newTiles[o];l.default.terraformTile(p.tile,p.newType,p.newTopType,n.default.destroy_no_flash),p.tile.type.lava&&s.default.inst.lavaLayer.loadLavaTile(p.tile)}},t.clear=function(){t.newTiles=[]},t.newTiles=[],t}();a.default=d,cc._RF.pop()},{}],WaveController:[function(t,e,i){"use strict";cc._RF.push(e,"cde62YbQuNC5oepQW4/5PsH","WaveController");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0}),n.WaveController=void 0;var l=a("ToolBox"),c=a("TileTypeBase"),d=a("MapBox"),u=a("Wave"),h=a("BaseEffectController"),p=cc._decorator,f=p.ccclass,_=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){t.prototype.create.call(this),this.timer_interval=.2},e.prototype.spawn=function(){var t=l.Toolbox.getRandom(d.default.inst.zoneCalculator.zones);if(t&&0!=t.tilesWithLiquid){var e=l.Toolbox.getRandom(t.tiles);e.type.layerType==c.TileLayerType.Ocean&&this.getObject().prepare(e,.25)}},e.prototype.checkTile=function(t,e){for(var i=0;i<this.list.length;i++){var o=this.list[i];if(!(l.Toolbox.dist(o.x,o.y,t.pos.x,t.pos.y)>e)){var a=o.getComponent(u.default);this.killObject(a);break}}},s([f],e)}(h.default));n.WaveController=_,cc._RF.pop()},{}],Wave:[function(t,e,i){"use strict";cc._RF.push(e,"8f03aIzru1PO6PRovhhVHT6","Wave");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("BaseEffect"),c=cc._decorator,d=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=0,e}return r(e,t),e.prototype.update=function(t){this.timer>0?this.timer-=t:(this.timer=.6,this.tile&&(this.tile=this.tile.tile_up))},e.prototype.waveEnd=function(){this.controller.killObject(this)},s([d],e)}(l.default));n.default=u,cc._RF.pop()},{}],Wheat:[function(t,e,i){"use strict";cc._RF.push(e,"7747dVK97hLtbRsn9xBFsxK","Wheat");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timerGrow=0,e.GROW_INTERVAL=30,e}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.timerGrow=this.GROW_INTERVAL},e.prototype.logicUpdate=function(t){this.timerGrow>0?this.timerGrow-=t:this.growWheat()},e.prototype.growWheat=function(){this.building.upgradeBulding(),this.timerGrow=this.GROW_INTERVAL},e}(a("BaseBuilding").BaseBuildingComponent);n.default=s,cc._RF.pop()},{}],WorldAction:[function(t,e,i){"use strict";cc._RF.push(e,"f3f79RjlxdCc6aBMPsrJdTn","WorldAction");var o=i;Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){this.list=[]}return t.create=function(){return new t},Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0==this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"any",{get:function(){return this.list.length>0},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this.list=[]},t.prototype.add=function(t){this.list.push(t)},t.prototype.do=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);for(var i=!1,o=0;o<this.list.length;o++)(0,this.list[o])(t,e)&&(i=!0);return i},t}();o.default=a,cc._RF.pop()},{}],WorldBehaviourActionBurnedTiles:[function(t,e,i){"use strict";cc._RF.push(e,"58ecesuUsdOnInMc3fm3xDq","WorldBehaviourActionBurnedTiles");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ToolBox"),r=o("TileTypeBase"),s=o("MapBox"),l=function(){function t(){}return t.updateBurnedTiles=function(){t.tiles_to_update=[],t._tempIslands=[];for(var e=0;e<s.default.inst.islandsCalculator.islands.length;e++){var i=s.default.inst.islandsCalculator.islands[e];i.type!=r.TileLayerType.Ocean&&t._tempIslands.push(i)}for(var o=0;o<t._tempIslands.length;o++)for(var a=t._tempIslands[o],l=0;l<3;l++){var c=a.regions.getRandom();if(!(s.default.inst.gameStats.gameTime-c.lastBurnedUpdate<.5)){c.lastBurnedUpdate=s.default.inst.gameStats.gameTime,c.tiles.shuffle();for(var d=0;d<c.tiles.length;d++){var u=c.tiles[d];u.data.fire||n.Toolbox.randomBool()||(u.burned_stages>1?(u.burned_stages--,s.default.inst.burnedLayer.setTileDirty(u),0==u.burned_stages&&t.tiles_to_update.push(u)):(u.burned_stages=0,t.tiles_to_update.push(u),s.default.inst.burnedLayer.setTileDirty(u)))}}}},t.tiles_to_update=[],t._tempIslands=[],t}();a.default=l,cc._RF.pop()},{}],WorldBehaviourActionCreepBiomass:[function(t,e,i){"use strict";cc._RF.push(e,"bfb4bEcs2BHS6Up+myW62oi","WorldBehaviourActionCreepBiomass");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("TopTileLibrary"),r=o("MapBox"),s=function(){function t(){}return t.updateBiomassTiles=function(){for(var e=0;e<3&&t.tryActionOn(n.default.biomass_low);e++);for(var i=0;i<3&&t.tryActionOn(n.default.biomass_high);i++);},t.tryActionOn=function(t){if(t.hashset.size<10)return!1;var e=t.getCurrentTiles().getRandom();return r.default.inst.redrawRenderedTile(e),!0},t}();a.default=s,cc._RF.pop()},{}],WorldBehaviourActionCreepDegeneration:[function(t,e,i){"use strict";cc._RF.push(e,"1c64aqg2RZKj7G6A4kBNebB","WorldBehaviourActionCreepDegeneration");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("SetUtils"),s=o("MapAction"),l=o("AssetManager"),c=o("MapBox"),d=function(){function t(){this.MAX_CREEP_TO_DESTROY_IN_ONE_STEP=3}return t.checkCreep=function(){t.checkBiome("tumor","tumor"),t.checkBiome("biomass","biomass"),t.checkBiome("superPumpkin","pumpkin"),t.checkBiome("cybercore","cybertile")},t.checkBiome=function(e,i){var o=l.default.buildings.get(e),a=c.default.inst.kingdoms.getKingdomByID(o.kingdom);if(t.clear(),t.addToNotChecked(i+"_low"),t.addToNotChecked(i+"_high"),0!=t.not_checked_tiles.size){if(a.buildings.length>0)for(var n=a.buildings.getSimpleList(),r=0;r<n.length;r++){var s=n[r];s.data.alive&&(t.checkTile(s.currentTile),t.next_wave.push(s.currentTile))}t.startWave(i),t.not_checked_tiles.size>0&&t.destroyNonCheckedCreep()}},t.startWave=function(e){if(0!=t.next_wave.length){for(t.cur_wave.addRange(t.next_wave),t.next_wave=[];t.cur_wave.length>0;)for(var i=t.cur_wave.pop(),o=0;o<i.neighboursAll.length;o++){var a=i.neighboursAll[o];a.type.biome!=e||t.checked_tiles.has(a)||(t.checkTile(a),t.next_wave.push(a))}t.next_wave.length>0&&t.startWave(e)}},t.destroyNonCheckedCreep=function(){var e,i;t._list_of_disconnected_tiles=[];try{for(var o=n(t.not_checked_tiles),a=o.next();!a.done;a=o.next()){var r=a.value;t._list_of_disconnected_tiles.push(r)}}catch(d){e={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}var l=Math.min(t._list_of_disconnected_tiles.length,3);t._list_of_disconnected_tiles.shuffle();for(var c=0;c<l;c++)s.default.decreaseTile(t._list_of_disconnected_tiles[c])},t.checkTile=function(e){t.checked_tiles.add(e),t.not_checked_tiles.delete(e)},t.addToNotChecked=function(e){var i=l.default.topTiles.get(e);0!=i.hashset.size&&(t.not_checked_tiles=r.default.addRange(t.not_checked_tiles,i.hashset))},t.clear=function(){t.checked_tiles.clear(),t.not_checked_tiles.clear(),t.next_wave=[],t.cur_wave=[]},t.next_wave=[],t.cur_wave=[],t.checked_tiles=new Set,t.not_checked_tiles=new Set,t._list_of_disconnected_tiles=[],t}();a.default=d,cc._RF.pop()},{}],WorldBehaviourActionEnchanted:[function(t,e,i){"use strict";cc._RF.push(e,"99f1aho7+pNE6/3kv+5kRPX","WorldBehaviourActionEnchanted");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("TopTileLibrary"),r=o("MapBox"),s=function(){function t(){}return t.updateSparksAction=function(){t.tryActionOn(n.default.enchanted_high),t.tryActionOn(n.default.enchanted_low)},t.tryActionOn=function(t){if(t.hashset.size>=10){var e=t.getCurrentTiles().getRandom();r.default.inst.stackEffects.get("fx_enchanted_sparkle").spawnAt(e.posV3,.25)}},t}();a.default=s,cc._RF.pop()},{}],WorldBehaviourActionErosion:[function(t,e,i){"use strict";cc._RF.push(e,"16617M+IQRJ/IG4qiHc17M3","WorldBehaviourActionErosion");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapAction"),r=o("AssetManager"),s=o("TileLibrary"),l=o("MapBox"),c=function(){function t(){}return t.updateErosion=function(){if(l.default.inst.worldLaws.world_law_erosion.boolVal){t.list=[],l.default.inst.islandsCalculator.islands.shuffle();for(var e=0;e<l.default.inst.islandsCalculator.islands.length;e++){var i=l.default.inst.islandsCalculator.islands[e];if(0==i.type){for(var o=0;o<5;o++){var a=i.getRandomTile();if(a&&(a.type.canGrowBiomeGrass||a.type.grass)&&a.isOceanAround()&&!t.list.includes(a)&&(t.list.push(a),t.list.length>=5))break}if(t.list.length>=5)break}}if(0!=t.list.length){t.list.shuffle();for(var c=0;c<t.list.length;c++)n.default.terraformMain(t.list[c],s.default.sand,r.default.terraform.get("flash"))}}},t.MAX_TILES_IN_LIST=5,t.list=[],t}();a.default=c,cc._RF.pop()},{}],WorldBehaviourActionFire:[function(t,e,i){"use strict";cc._RF.push(e,"cec75MX7JNFBoXxiUDscoYv","WorldBehaviourActionFire");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("ToolBox"),s=o("MapBox"),l=function(){function t(){}return t.clear=function(){t.tiles.clear()},t.updateFire=function(){var e,i;if(0!=t.tiles.size)try{for(var o=n(t.tiles),a=o.next();!a.done;a=o.next()){var l=a.value;if(l.data.fire_stage>9)for(var c=0;c<l.neighbours.length;c++){var d=l.neighbours[c];r.Toolbox.randomChance(d.type.fireChance)&&d.setFire()&&s.default.inst.flashEffects.flashPixel(d,10)}!l.building&&l.data.fire_stage%15==0&&Math.random()>.9&&s.default.inst.particlesFire.spawn(l.posV3.x,l.posV3.y),l.data.fire_stage++,s.default.inst.setTileDirty(l),s.default.inst.fireLayer.setTileDirty(l),l.data.fire_stage>=20&&l.stopFire(!0)}}catch(u){e={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t.tiles=new Set,t}();a.default=l,cc._RF.pop()},{}],WorldBehaviourActionGrass:[function(t,e,i){"use strict";cc._RF.push(e,"58611FhLHROsbwtBsciq/Rk","WorldBehaviourActionGrass");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("MapAction"),s=o("AssetManager"),l=o("ToolBox"),c=o("TileTypeBase"),d=o("MapBox"),u=function(){function t(){}return t.clear=function(){t._possibleTiles=[],t._tempIslands=[],t._regions_to_add=[],t.last_used_regions.clear()},t.updateGrass=function(){var e,i;if(d.default.inst.worldLaws.world_law_grow_grass.boolVal){t._tempIslands=[],t._limit=0;for(var o=0;o<d.default.inst.islandsCalculator.islands.length;o++){var a=d.default.inst.islandsCalculator.islands[o];a.type==c.TileLayerType.Ground&&t._tempIslands.push(a)}t._regions_to_add=[];var r=!1;try{for(var s=n(t.last_used_regions),l=s.next();!l.done;l=s.next()){var u=l.value;t._limit=0,t.tryToGrowGrassOnRegion(u,!0)&&(r=!0)}}catch(y){e={error:y}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(e)throw e.error}}r?t.ticks_to_clear=5:t.ticks_to_clear--,(t.ticks_to_clear<=0||t.last_used_regions.size>100)&&(t.ticks_to_clear=5,t.last_used_regions.clear(),t._regions_to_add=[]);for(var h=1,p=0;p<t._tempIslands.length;p++){var f=t._tempIslands[p];t._limit=0,(h=f.regions.length/10+1)>5&&(h=5);for(var _=0;_<h;_++)t._region=f.regions.getRandom(),t.tryToGrowGrassOnRegion(t._region)}for(var m=0;m<t._regions_to_add.length;m++){var g=t._regions_to_add[m];t.last_used_regions.add(g)}}},t.tryToGrowGrassOnRegion=function(e,i){if(void 0===i&&(i=!1),d.default.inst.gameStats.gameTime-e.lastGrassGrowth<.5)return!1;e.lastGrassGrowth=d.default.inst.gameStats.gameTime,e.tiles.shuffle();for(var o=!1,a=!1,n=0;n<e.tiles.length;n++){var u=e.tiles[n];if(!(!u.type.growToNearbyTiles||u.burned_stages>0||l.Toolbox.randomBool())){t._possibleTiles=[];for(var h=0;h<u.neighbours.length;h++){var p=u.neighbours[h];p.burned_stages>0||!p.type.canGrowBiomeGrass||p.type.biome==u.type.biome||(a=!1,p.type.soil?a=!0:d.default.inst.worldLaws.world_law_biome_overgrowth.boolVal&&(p.type.grassStrength==u.type.grassStrength?l.Toolbox.randomChance(.05)&&(a=!0):l.Toolbox.randomInt(0,u.type.grassStrength)>l.Toolbox.randomInt(0,p.type.grassStrength)&&(a=!0)),a&&t._possibleTiles.push(p))}if(0!=t._possibleTiles.length){var f=t._possibleTiles.getRandom();if(f.grassTicksBeforeGrowth>0)f.grassTicksBeforeGrowth--;else{o=!0;for(var _=0;_<f.neighbours.length;_++){var m=f.neighbours[_];t._regions_to_add.push(m.region)}if(t._regions_to_add.push(f.region),f.main_type.rankType==c.TileRank.High?r.default.growGreens(f,s.default.topTiles.get(u.top_type.biome_high)):r.default.growGreens(f,s.default.topTiles.get(u.top_type.biome_low)),t._limit++>3||i)break}}}}return o},t.ticks_to_clear=10,t._limit=0,t._possibleTiles=[],t._tempIslands=[],t._regions_to_add=[],t.last_used_regions=new Set,t._region=null,t}();a.default=u,cc._RF.pop()},{}],WorldBehaviourActionInferno:[function(t,e,i){"use strict";cc._RF.push(e,"7d2eb+vzOBLtpbJFbC9z2ZC","WorldBehaviourActionInferno");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("TopTileLibrary"),r=o("ToolBox"),s=o("MapBox"),l=function(){function t(){}return t.updateInfernalLowAnimations=function(){var t,e;if((null===(e=null===(t=n.default.infernal_low)||void 0===t?void 0:t.hashset)||void 0===e?void 0:e.size)>=10&&r.Toolbox.randomChance(.4)){var i=n.default.infernal_low.getCurrentTiles().getRandom();s.default.inst.redrawRenderedTile(i)}},t.updateInfernoFireAction=function(){t.tryFireAction(n.default.infernal_high),t.tryFireAction(n.default.infernal_low)},t.tryFireAction=function(t){var e;if((null===(e=null==t?void 0:t.hashset)||void 0===e?void 0:e.size)>=10&&r.Toolbox.randomChance(.1)){var i=t.getCurrentTiles().getRandom();i.setFire(!0),s.default.inst.particlesFire.spawn(i.posV3.x,i.posV3.y)}},t}();a.default=l,cc._RF.pop()},{}],WorldBehaviourActionSwampAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"a8a13SSmE1O6adGglFxTrrS","WorldBehaviourActionSwampAnimation");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("TopTileLibrary"),r=o("MapBox"),s=function(){function t(){}return t.updateSwampTiles=function(){var t,e;if((null===(e=null===(t=n.default.swamp_low)||void 0===t?void 0:t.hashset)||void 0===e?void 0:e.size)>=10){var i=n.default.swamp_low.getCurrentTiles().getRandom();r.default.inst.redrawRenderedTile(i)}},t}();a.default=s,cc._RF.pop()},{}],WorldBehaviourActions:[function(t,e,i){"use strict";cc._RF.push(e,"c60a9dlK6hN2ICohRoZtiqP","WorldBehaviourActions");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MapAction"),r=o("AssetManager"),s=o("BaseBuilding"),l=o("ToolBox"),c=o("MapLayer"),d=o("TileTypeBase"),u=o("MapBox"),h=function(){function t(){}return t.updateDisasters=function(){var t=r.default.disasters.getRandomAssetFromPool();t&&l.Toolbox.randomChance(t.chance)&&(null==t||t.action(t))},t.updateRoadDegeneration=function(){u.default.inst.zoneCalculator.zones.shuffle();var t=u.default.inst.zoneCalculator.zones[0];if(!t.city&&!l.Toolbox.randomBool()){t.tiles.shuffle();for(var e=0;e<64;e++)t.tiles[e].type.road&&!l.Toolbox.randomBool()&&n.default.decreaseTile(t.tiles[e])}},t.updateUnitSpawn=function(){if(u.default.inst.worldLaws.world_law_animals_spawn.boolVal&&0!=u.default.inst.mapChunkManager.list.length){var t=null;if(u.default.inst.islandsCalculator.islands_ground.length>0&&(t=u.default.inst.islandsCalculator.getRandomIslandGround()),t){var e=t.getRandomTile();if(e.type.spawn_units_auto){var i=r.default.unitStats.get(e.type.spawn_units_list.getRandom());i&&i.currentAmount<=i.maxRandomAmount&&(u.default.inst.getObjectsInChunks(e,0,c.MapObjectType.Actor),u.default.inst.temp_map_objects.length<=3&&u.default.inst.spawnNewUnit(i.id,e,"",0))}}}},t.growVegetation=function(){if(u.default.inst.worldLaws.world_law_grow_trees.boolVal)for(var t=0,e=0;e<u.default.inst.islandsCalculator.islands.length;e++){var i=u.default.inst.islandsCalculator.islands[e];if(i.type!=d.TileLayerType.Block&&i.type!=d.TileLayerType.Lava&&i.type!=d.TileLayerType.Goo&&i.type!=d.TileLayerType.Ocean){var o=i.regions.getRandom();(t=i.regions.length/20+1)>3&&(t=3),o.tiles.shuffle();for(var a=0;a<t;a++)for(var n=0;n<o.tiles.length;n++){var r=o.tiles[n];if(!r.data.fire&&r.type.grow_vegetation_auto&&!l.Toolbox.randomBool()){l.Toolbox.randomBool()?r.type.grow_type_selector_trees&&u.default.inst.tryGrowVegetationRandom(r,s.VegetationType.Trees):r.type.grow_type_selector_plants&&u.default.inst.tryGrowVegetationRandom(r,s.VegetationType.Plants);break}}}}},t}();a.default=h,cc._RF.pop()},{}],WorldBehaviourOcean:[function(t,e,i){"use strict";cc._RF.push(e,"e37b8EP5X1D5qX9GuK4y8yO","WorldBehaviourOcean");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0});var r=o("MapAction"),s=o("ToolBox"),l=o("MapBox"),c=function(){function t(){}return t.clear=function(){t.tiles_to_update=[],t.tiles.clear()},t.updateOcean=function(){var e,i;if(0!=t.tiles.size){t.tiles_to_update=[];try{for(var o=n(t.tiles),a=o.next();!a.done;a=o.next()){var c=a.value;c.world_edge?s.Toolbox.randomRange(0,100)<30||t.tiles_to_update.push(c):!c.isOceanAround()||s.Toolbox.randomRange(0,100)<30||t.tiles_to_update.push(c)}}catch(h){e={error:h}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}for(var d=0;d<t.tiles_to_update.length;d++){var u=t.tiles_to_update[d];u.type.canBeFilledWithOcean&&(u.type.explodableByOcean?l.default.inst.explosionLayer.explodeBomb(u):r.default.setOcean(u))}}},t.tiles_to_update=[],t.tiles=new Set,t}();a.default=c,cc._RF.pop()},{}],WorldBehaviourUnitTemperatures:[function(t,e,i){"use strict";cc._RF.push(e,"b196811vRRHSbqh1xy8fszy","WorldBehaviourUnitTemperatures");var o=i,a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},n=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var o,a,n=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)r.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(a)throw a.error}}return r};Object.defineProperty(o,"__esModule",{value:!0}),o.TemperatureMod=void 0;var r=function(){this.actor=null,this.new_temperature=0};o.TemperatureMod=r;var s=function(){function t(){}return t.updateUnitTemperatures=function(){var e,i,o;if(0!=t.temperatures.size){t._temperature_updaters=[];var s=!0;try{for(var l=a(t.temperatures),c=l.next();!c.done;c=l.next()){var d=n(c.value,2),u=d[0],h=d[1];if(null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.alive){s=!1;var p=h;if(p>0?--p<0&&(p=0):++p>0&&(p=0),p!=h){var f=new r;f.actor=u,f.new_temperature=p,t._temperature_updaters.push(f)}}}}catch(g){e={error:g}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}if(s)t.temperatures.clear();else{if(t._temperature_updaters.length<=0)return;for(var _=0;_<t._temperature_updaters.length;_++){var m=t._temperature_updaters[_];0==m.new_temperature?t.temperatures.delete(m.actor):t.temperatures.set(m.actor,m.new_temperature)}}}},t.changeUnitTemperature=function(e,i){t.temperatures.has(e)||t.temperatures.set(e,0);var o=t.temperatures.get(e),a=o+=i;i<0?(e.removeStatusEffect("burning"),a<-200&&(e.addStatusEffect("frozen"),o=0)):(e.removeStatusEffect("frozen"),a>300&&(e.addStatusEffect("burning"),o=0)),t.temperatures.set(e,o)},t.checkTile=function(e,i){if(0!=e.units.length)for(var o=0;o<e.units.length;o++)t.changeUnitTemperature(e.units[o],i)},t.clear=function(){t.temperatures.clear()},t.temperatures=new Map,t._temperature_updaters=[],t}();o.default=s,cc._RF.pop()},{}],WorldBehaviour:[function(t,e,i){"use strict";cc._RF.push(e,"b39d0sJmSBMtJ5hjlhWDLYb","WorldBehaviour");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("GameCommon"),r=o("ToolBox"),s=o("MapBox"),l=function(){function t(t,e,i,o,a){this.timer=0,this.interval=0,this.interval_random=0,this._updateAction=null,this._clearAction=null,this.id="",this.enabled_on_minimap=!0,this.id=i,this.interval=t,this.interval_random=e,this.timer=t,this._updateAction=o,this._clearAction=a}return t.prototype.clear=function(){this.timer=this.interval,this._clearAction&&this._clearAction()},t.prototype.logicUpdate=function(t){if((!s.default.inst.qualityChanger.lowRes||this.enabled_on_minimap)&&!n.default.isPaused){if(this.timer>0)return void(this.timer-=t);this.timer=this.interval+r.Toolbox.randomFloat(0,this.interval_random),this._updateAction()}},t}();a.default=l,cc._RF.pop()},{}],WorldInfoWindow:[function(t,e,i){"use strict";cc._RF.push(e,"08b744jgOhFPrCLefVSpCHW","WorldInfoWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.WorldInfoWindow=void 0;var c=a("GamePopBase"),d=a("StatsHelper"),u=cc._decorator,h=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueNode=null,e}return r(e,t),e.prototype.start=function(){this.showValues()},e.prototype.showValues=function(){var t,e;try{for(var i=l(this.valueNode.children),o=i.next();!o.done;o=i.next()){var a=o.value,n=d.default.getStatistic(a.name);a.getComponent(cc.RichText).string=n}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},s([p(cc.Node)],e.prototype,"valueNode",void 0),s([h],e)}(c.GamePopBase);n.WorldInfoWindow=f,cc._RF.pop()},{}],WorldLawWindow:[function(t,e,i){"use strict";cc._RF.push(e,"b75f3xhcMdD8q0TOKgkUb65","WorldLawWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GamePopBase"),c=a("ToolBox"),d=a("MapBox"),u=a("ToolTip"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lawNodes=[],e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.lawNodes.forEach(function(e){t.updateStatus(e)})},e.prototype.click=function(t){var e=t.getCurrentTarget(),i=e.name,o=d.default.inst.worldLaws.dict.get(i);o.boolVal=!o.boolVal,this.updateStatus(e,!0),"world_law_peaceful_monsters"==i&&o.boolVal&&d.default.inst.stopAttacksFor(!0)},e.prototype.updateStatus=function(t,e){void 0===e&&(e=!1);var i=t.name,o=d.default.inst.worldLaws.dict.get(i).boolVal,a=t.getChildByName("icon");t.getChildByName("select").active=o,o?(a.color=c.Toolbox.makeColor("#FFFFFF"),a.opacity=255):(a.color=c.Toolbox.makeColor("#666666"),a.opacity=155),e&&(u.default.info_tip=i+"_title",u.default.inst.show(t,"world_law",i+"_title",i+"_description"))},s([f([cc.Node])],e.prototype,"lawNodes",void 0),s([p],e)}(l.GamePopBase);n.default=_,cc._RF.pop()},{}],WorldLaws:[function(t,e,i){"use strict";cc._RF.push(e,"3734ay4G+hHvopjGV7O2uuu","WorldLaws");var o=i,a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(o,"__esModule",{value:!0}),o.PlayerOptionData=void 0;var n=function(t,e){void 0===t&&(t=""),void 0===e&&(e=!0),this.name="OPTION",this.boolVal=!0,this.stringVal="",this.name=t,this.boolVal=e};o.PlayerOptionData=n;var r=function(){function t(){this.world_law_diplomacy=null,this.world_law_peaceful_monsters=null,this.world_law_hunger=null,this.world_law_grow_trees=null,this.world_law_grow_grass=null,this.world_law_biome_overgrowth=null,this.world_law_kingdom_expansion=null,this.world_law_old_age=null,this.world_law_animals_spawn=null,this.world_law_rebellions=null,this.world_law_border_stealing=null,this.world_law_erosion=null,this.world_law_forever_lava=null,this.world_law_disasters_nature=null,this.world_law_disasters_other=null,this.world_law_angry_civilians=null,this.list=[],this.dict=new Map}return t.prototype.add=function(t){var e,i;try{for(var o=a(this.list),n=o.next();!n.done;n=o.next()){var r=n.value;if(t.name==r.name)return this.dict.set(r.name,r),r}}catch(s){e={error:s}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return this.list.push(t),this.dict.set(t.name,t),t},t.prototype.toJSON=function(){return{list:this.list}},t.prototype.check=function(){this.init()},t.prototype.init=function(){this.list||(this.list=[]),this.dict||(this.dict=new Map),this.world_law_diplomacy=this.add(new n("world_law_diplomacy",!0)),this.world_law_peaceful_monsters=this.add(new n("world_law_peaceful_monsters",!1)),this.world_law_hunger=this.add(new n("world_law_hunger",!0)),this.world_law_grow_trees=this.add(new n("world_law_grow_trees",!0)),this.world_law_grow_grass=this.add(new n("world_law_grow_grass",!0)),this.world_law_biome_overgrowth=this.add(new n("world_law_biome_overgrowth",!0)),this.world_law_kingdom_expansion=this.add(new n("world_law_kingdom_expansion",!0)),this.world_law_old_age=this.add(new n("world_law_old_age",!0)),this.world_law_animals_spawn=this.add(new n("world_law_animals_spawn",!0)),this.world_law_rebellions=this.add(new n("world_law_rebellions",!0)),this.world_law_border_stealing=this.add(new n("world_law_border_stealing",!0)),this.world_law_erosion=this.add(new n("world_law_erosion",!0)),this.world_law_forever_lava=this.add(new n("world_law_forever_lava",!1)),this.world_law_disasters_nature=this.add(new n("world_law_disasters_nature",!1)),this.world_law_disasters_other=this.add(new n("world_law_disasters_other",!1)),this.world_law_angry_civilians=this.add(new n("world_law_angry_civilians",!1))},t}();o.default=r,cc._RF.pop()},{}],WorldLogElement:[function(t,e,i){"use strict";cc._RF.push(e,"452a1XD37pMJ5yH0RFNV4cF","WorldLogElement");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("TextureLoader"),c=a("WorldLogMessageExtensions"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.description=null,e.date=null,e.icon=null,e.locate=null,e.follow=null,e.callback=null,e.message=null,e}return r(e,t),e.prototype.updateItem=function(t,e){this.message=t,this.callback=e,this.date.string=t.date;var i=c.default.getFormatedText(t,this.description,!1,!0),o=c.default.hasLocation(t),a=c.default.hasFollowLocation(t);a?(this.follow.active=a,this.locate.active=!a):(this.follow.active=a,this.locate.active=o),this.description.string=null!=i?i:"",t.icon?this.icon.spriteFrame=l.TextureLoader.inst.getSpriteFrame(l.ATLAS_TYPE.UIATLAS,"icons/"+t.icon):this.icon.node.active=!1},e.prototype.clickLocate=function(){c.default.jumpToLocation(this.message),this.callback&&this.callback()},e.prototype.clickFollow=function(){c.default.followLocation(this.message),this.callback&&this.callback()},s([h(cc.RichText)],e.prototype,"description",void 0),s([h(cc.Label)],e.prototype,"date",void 0),s([h(cc.Sprite)],e.prototype,"icon",void 0),s([h(cc.Node)],e.prototype,"locate",void 0),s([h(cc.Node)],e.prototype,"follow",void 0),s([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],WorldLogMessageExtensions:[function(t,e,i){"use strict";cc._RF.push(e,"4a06b9gCOFPgZ/dyJ483AIt","WorldLogMessageExtensions");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0}),a.WorldLogMessage=void 0;var n=o("LocalizedTextManager"),r=o("ToolBox"),s=o("MapBox"),l=o("HistoryHud"),c=o("WorldLog");a.WorldLogMessage=function(t,e,i,o){void 0===e&&(e=""),void 0===i&&(i=""),void 0===o&&(o=""),this.text="",this.special1="",this.special2="",this.special3="",this.color_special1=cc.Color.TRANSPARENT,this.color_special2=cc.Color.TRANSPARENT,this.color_special3=cc.Color.TRANSPARENT,this.date="",this.icon="",this.city=null,this.kingdom=null,this.unit=null,this.location=cc.Vec3.ZERO,this.text=t,this.special1=e,this.special2=i,this.special3=o,this.date="y:"+(s.default.inst.mapStats.year+1)+", m:"+(s.default.inst.mapStats.month+1)};var d=function(){function t(){}return t.add=function(t){c.default.inst.truncateList(),c.default.inst.list.unshift(t),l.default.inst.newHistory(t)},t.coloredText=function(t,e,i,o){void 0===o&&(o=-1);var a=cc.Color.TRANSPARENT;switch(o){case 1:a=t.color_special1;break;case 2:a=t.color_special2;break;case 3:a=t.color_special3}return a==cc.Color.TRANSPARENT&&(i=!1),i?"<color="+r.Toolbox.colorToHex(a)+">"+e+"</color>":e},t.getFormatedText=function(e,i,o,a){var s=n.LocalizedTextManager.getText(e.text),l=r.Toolbox.color_log_neutral;switch(e.text){case"log_city_revolted":l=r.Toolbox.color_log_good,s=(s=s.replace("$name$",t.coloredText(e,e.special1,a))).replace("$kingdom$",t.coloredText(e,e.special2,a,2)),e.icon="iconInspiration";break;case"king_new":l=r.Toolbox.color_log_neutral,s=(s=s.replace("$kingdom$",t.coloredText(e,e.special1,a,1))).replace("$king$",t.coloredText(e,e.special2,a,2)),e.icon="iconKings";break;case"king_dead":l=r.Toolbox.color_log_warning,s=(s=s.replace("$kingdom$",t.coloredText(e,e.special1,a,1))).replace("$king$",t.coloredText(e,e.special2,a)),e.icon="iconDead";break;case"king_killed_1":case"king_killed_2":case"king_killed_3":l=r.Toolbox.color_log_warning,s=(s=(s=s.replace("$kingdom$",t.coloredText(e,e.special1,a,1))).replace("$king$",t.coloredText(e,e.special2,a,2))).replace("$name$",t.coloredText(e,e.special3,a,3)),e.icon="iconKingslayer";break;case"favorite_dead_1":case"favorite_dead_2":case"favorite_dead_3":l=r.Toolbox.color_log_warning,s=s.replace("$name$",t.coloredText(e,e.special1,a,1)),e.icon="iconFavoriteKilled";break;case"favorite_killed_1":case"favorite_killed_2":case"favorite_killed_3":l=r.Toolbox.color_log_warning,s=(s=s.replace("$name$",t.coloredText(e,e.special1,a,1))).replace("$killer$",t.coloredText(e,e.special2,a,2)),e.icon="iconFavoriteKilled";break;case"city_new":l=r.Toolbox.color_log_neutral,s=s.replace("$name$",t.coloredText(e,e.special1,a,1)),e.icon="iconCitySelect";break;case"city_destroyed":l=r.Toolbox.color_log_warning,s=s.replace("$name$",t.coloredText(e,e.special1,a,1)),e.icon="iconPyromaniac";break;case"kingdom_new":l=r.Toolbox.color_log_neutral,s=s.replace("$name$",t.coloredText(e,e.special1,a,1)),e.icon="iconKingdom";break;case"kingdom_destroyed":l=r.Toolbox.color_log_warning,s=s.replace("$name$",t.coloredText(e,e.special1,a,1)),e.icon="iconPyromaniac";break;case"diplomacy_war_started":l=r.Toolbox.color_log_warning,s=(s=s.replace("$kingdom1$",t.coloredText(e,e.special1,a,1))).replace("$kingdom2$",t.coloredText(e,e.special2,a,2)),e.icon="iconSpite";break;case"diplomacy_peace":l=r.Toolbox.color_log_good,s=(s=s.replace("$kingdom1$",t.coloredText(e,e.special1,a,1))).replace("$kingdom2$",t.coloredText(e,e.special2,a,2)),e.icon="iconPacifist";break;case"diplomacy_invade":l=r.Toolbox.color_log_warning,s=s.replace("$kingdom1$",t.coloredText(e,e.special1,a,1)),e.icon="iconSpite";break;case"worldlog_disaster_evil_mage":case"worldlog_disaster_underground_necromancer":case"worldlog_disaster_mad_thoughts":o=!0,l=r.Toolbox.color_log_warning,s=(s=s.replace("$name$",t.coloredText(e,e.special1,a,1))).replace("$city$",t.coloredText(e,e.special2,a,1))}return o&&(i.node.color=l),s},t.followLocation=function(e){return!!t.hasFollowLocation(e)&&(c.default.locationFollow(e.unit),!0)},t.jumpToLocation=function(e){if(!t.followLocation(e)){var i=t.getLocation(e);!i.equals(cc.Vec3.ZERO)&&t.inMapBorder(i)&&c.default.locationJump(i)}},t.hasLocation=function(e){return!t.getLocation(e).equals(cc.Vec3.ZERO)},t.hasFollowLocation=function(t){var e,i;return!(null===(i=null===(e=t.unit)||void 0===e?void 0:e.data)||void 0===i||!i.alive)},t.getLocation=function(e){var i,o,a,n,r,s;if(null===(o=null===(i=e.unit)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive)return e.unit.currentPosition;if(!e.location.equals(cc.Vec3.ZERO)&&t.inMapBorder(e.location))return e.location;if((null===(n=null===(a=e.kingdom)||void 0===a?void 0:a.data)||void 0===n?void 0:n.alive)&&(null===(r=e.kingdom)||void 0===r?void 0:r.capital)){if(t.inMapBorder(e.kingdom.capital.lastCityCenter))return e.kingdom.capital.lastCityCenter;if(t.inMapBorder(e.kingdom.capital.cityCenter))return e.kingdom.capital.cityCenter}if(null===(s=e.city)||void 0===s?void 0:s.alive){if(t.inMapBorder(e.city.lastCityCenter))return e.city.lastCityCenter;if(t.inMapBorder(e.city.cityCenter))return e.city.cityCenter}return cc.Vec3.ZERO},t.inMapBorder=function(t){return!(t.x>s.default.width||t.y>s.default.height||t.x<0||t.y<0)},t}();a.default=d,cc._RF.pop()},{}],WorldLogWindow:[function(t,e,i){"use strict";cc._RF.push(e,"b672bwiegJBNb+dzBe2ZTbq","WorldLogWindow");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GamePopBase"),c=a("List"),d=a("WorldLog"),u=a("WorldLogElement"),h=cc._decorator,p=h.ccclass,f=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pbItem=null,e.scrollView=null,e}return r(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.updateList()},e.prototype.updateList=function(){this.scrollView.getComponent(c.default).numItems=d.default.inst.list.length},e.prototype.updateItem=function(t,e){if(!(d.default.inst.list.length<=e)){var i=d.default.inst.list[e];t.getComponent(u.default).updateItem(i,this.close.bind(this))}},s([f(cc.Prefab)],e.prototype,"pbItem",void 0),s([f(cc.ScrollView)],e.prototype,"scrollView",void 0),s([p],e)}(l.GamePopBase);n.default=_,cc._RF.pop()},{}],WorldLog:[function(t,e,i){"use strict";cc._RF.push(e,"d76285zd6VA0oCvHuNWfEts","WorldLog");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("MoveCamera"),r=o("ToolBox"),s=o("ModModule"),l=o("HistoryHud"),c=o("WorldLogMessageExtensions"),d=function(){function t(){this.list=[],this.limit=40,t.inst=this}return t.prototype.truncateList=function(){for(;this.list.length>=this.limit;)this.list.pop()},t.prototype.clear=function(){this.list=[]},t.logNewKing=function(t){var e,i,o=new c.WorldLogMessage("king_new",t.data.name,t.king.data.firstName);o.unit=t.king,o.location=t.king.currentPosition,o.color_special1=null===(e=t.kingdomColor)||void 0===e?void 0:e.colorBorderOut,o.color_special2=null===(i=t.kingdomColor)||void 0===i?void 0:i.colorBorderOut,c.default.add(o)},t.logKingLeft=function(t,e){var i=new c.WorldLogMessage("king_left",t.data.name,e.data.firstName);i.unit=e,i.location=e.currentPosition,i.kingdom=t,i.color_special1=t.kingdomColor.colorBorderOut,c.default.add(i)},t.logKingDead=function(t,e){var i,o=new c.WorldLogMessage("king_dead",t.data.name,e.data.firstName);o.location=e.currentPosition,o.kingdom=t,o.color_special1=null===(i=t.kingdomColor)||void 0===i?void 0:i.colorBorderOut,c.default.add(o)},t.logKingMurder=function(t,e,i){var o,a,n,s,l,d,u=new c.WorldLogMessage("king_killed_"+r.Toolbox.randomInt(1,3),t.data.name,e.data.firstName,null===(o=null==i?void 0:i.data)||void 0===o?void 0:o.firstName);u.color_special1=null===(a=t.kingdomColor)||void 0===a?void 0:a.colorBorderOut,u.color_special2=null===(n=t.kingdomColor)||void 0===n?void 0:n.colorBorderOut,(null===(s=null==i?void 0:i.kingdom)||void 0===s?void 0:s.kingdomColor)&&(u.color_special3=null===(d=null===(l=i.kingdom)||void 0===l?void 0:l.kingdomColor)||void 0===d?void 0:d.colorBorderOut),u.unit=i,u.location=e.currentPosition,u.kingdom=t,c.default.add(u)},t.logFavDead=function(t){var e,i,o,a=new c.WorldLogMessage("favorite_dead_"+r.Toolbox.randomInt(1,3),t.data.firstName);a.location=t.currentPosition,(null===(e=null==t?void 0:t.kingdom)||void 0===e?void 0:e.kingdomColor)&&(a.color_special1=null===(o=null===(i=t.kingdom)||void 0===i?void 0:i.kingdomColor)||void 0===o?void 0:o.colorBorderOut),c.default.add(a)},t.logFavMurder=function(t,e){var i,o,a,n,s,l,d,u=new c.WorldLogMessage("favorite_killed_"+r.Toolbox.randomInt(1,3),t.data.firstName,null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.firstName);(null===(o=null==t?void 0:t.kingdom)||void 0===o?void 0:o.kingdomColor)&&(u.color_special1=null===(n=null===(a=t.kingdom)||void 0===a?void 0:a.kingdomColor)||void 0===n?void 0:n.colorBorderOut),(null===(s=null==e?void 0:e.kingdom)||void 0===s?void 0:s.kingdomColor)&&(u.color_special2=null===(d=null===(l=e.kingdom)||void 0===l?void 0:l.kingdomColor)||void 0===d?void 0:d.colorBorderOut),u.unit=e,u.location=t.currentPosition,c.default.add(u)},t.logNewCity=function(t){var e,i,o=new c.WorldLogMessage("city_new",t.data.cityName);o.city=t,o.location=t.lastCityCenter,o.color_special1=null===(i=null===(e=t.kingdom)||void 0===e?void 0:e.kingdomColor)||void 0===i?void 0:i.colorBorderOut,c.default.add(o)},t.logCityRevolt=function(t){var e=new c.WorldLogMessage("log_city_revolted",t.data.cityName,t.kingdom.data.name);e.city=t,e.location=t.lastCityCenter,c.default.add(e)},t.logNewWar=function(t,e){var i,o,a,n=new c.WorldLogMessage("diplomacy_war_started",t.data.name,e.data.name);if(n.kingdom=e,n.location=e.location,n.color_special1=null===(i=null==t?void 0:t.kingdomColor)||void 0===i?void 0:i.colorBorderOut,n.color_special2=null===(o=null==e?void 0:e.kingdomColor)||void 0===o?void 0:o.colorBorderOut,c.default.add(n),e==s.default.inst.kingdom){var r=new c.WorldLogMessage("diplomacy_invade",t.data.name);r.kingdom=t,r.location=t.location,r.color_special1=null===(a=null==t?void 0:t.kingdomColor)||void 0===a?void 0:a.colorBorderOut,c.default.add(r)}},t.logNewPeace=function(t,e){var i,o,a=new c.WorldLogMessage("diplomacy_peace",t.data.name,e.data.name);a.kingdom=e,a.location=e.location,a.color_special1=null===(i=null==t?void 0:t.kingdomColor)||void 0===i?void 0:i.colorBorderOut,a.color_special2=null===(o=null==e?void 0:e.kingdomColor)||void 0===o?void 0:o.colorBorderOut,c.default.add(a),t!=s.default.inst.kingdom&&e!=s.default.inst.kingdom||l.default.inst.removeInvade(t,e)},t.logNewKingdom=function(t){var e,i=new c.WorldLogMessage("kingdom_new",t.data.name);i.kingdom=t,i.location=t.location,i.color_special1=null===(e=null==t?void 0:t.kingdomColor)||void 0===e?void 0:e.colorBorderOut,c.default.add(i)},t.logKingdomDestroyed=function(t){var e,i=new c.WorldLogMessage("kingdom_destroyed",t.data.name);i.kingdom=t,i.location=t.location,i.color_special1=null===(e=null==t?void 0:t.kingdomColor)||void 0===e?void 0:e.colorBorderOut,c.default.add(i)},t.logCityDestroyed=function(t){var e,i,o=new c.WorldLogMessage("city_destroyed",t.data.cityName);o.color_special1=null===(i=null===(e=t.kingdom)||void 0===e?void 0:e.kingdomColor)||void 0===i?void 0:i.colorBorderOut,o.location=t.lastCityCenter,o.city=t,c.default.add(o)},t.logDisaster=function(t,e,i,o,a){if(void 0===i&&(i=""),void 0===o&&(o=null),void 0===a&&(a=null),t.world_log){var n=new c.WorldLogMessage(t.world_log);n.icon=t.world_log_icon,n.location=e.posV3,n.special1=i,o&&(n.special2=o.data.cityName,n.city=o),n.unit=a,c.default.add(n)}},t.locationJump=function(t){n.MoveCamera.inst.focusOn(t.clone())},t.locationFollow=function(t){var e;n.MoveCamera.inst.focusOnAndFollow(t),(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.alive)&&n.MoveCamera.inst.focusOnAndFollow(t)},t.inst=null,t}();a.default=d,cc._RF.pop()},{}],WorldNameGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"8ca0d1HWypJApwJSLXPqjrD","WorldNameGenerator");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ToolBox"),r=function(){function t(){}return t.generateName=function(){return n.Toolbox.randomBool()?t.first.getRandom()+" "+t.second.getRandom():t.second.getRandom()+" of "+t.ofWords.getRandom()},t.first=["Forgotten","New","Red","Blue","Never","Green","Mirage","Ever","Hollow","Infinite","Empty","Ghost","Perfected","God's","Hidden","Stolen","Broken","Nightmare","Secret","Sacred","Cruel","Phantom","Free","Dragon","Demon","Thunder","Silent","Old","Ancient","Eternity","Flat","Dream"],t.second=["Isles","Lands","Land","Realm","Earth","Sanctum","World","Planet","Archipelago","Territories","Acres"],t.ofWords=["Souls","Life","Sun","Moon","God","Blood","Dragons","Man","Greatness","Misery","Happiness","Death","Clouds","Rain","War"],t}();a.default=r,cc._RF.pop()},{}],WorldTileData:[function(t,e,i){"use strict";cc._RF.push(e,"c2bcfUuD5dGkbm4QOhH2xOk","WorldTileData");var o=t,a=i;Object.defineProperty(a,"__esModule",{value:!0});var n=o("ConwayLife");a.default=function(){this.type="",this.height=0,this.conwayType=n.ConwayType.None,this.fire=!1,this.fire_stage=0,this.tile_id=0,this.x=0,this.y=0},cc._RF.pop()},{}],WorldTilemap:[function(t,e,i){"use strict";cc._RF.push(e,"9fb94VA2y1AfrAaEimtXWZt","WorldTilemap");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("AssetManager"),c=a("BaseMapObject"),d=a("MapBox"),u=a("TileMap"),h=cc._decorator,p=h.ccclass,f=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tilemap=null,e.redrawTime=0,e.redrawEnable=!0,e.inited=!1,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){t.prototype.create.call(this),this.tilemap=this.getComponent(u.default),i.lastTileEmpty.z=i.EMPTY_Z,this.border_pit=l.default.tiles.get("border_pit"),this.border_water=l.default.tiles.get("border_water")},e.prototype.clear=function(){this.tilemap.clear()},e.prototype.prepare=function(){this.inited=!1,this.redrawTime=0,this.tilemap.clear(),this.tilemap.createTextureNew(4*d.default.width,4*d.default.height)},e.prototype.updateTileMap=function(){for(var t=0;t<d.default.inst.tilesDirty.length;t++){var e=d.default.inst.tilesDirty[t];if(e.dirty){d.default.inst.checkBehaviours(e),e.dirty=!1;var o=e.main_type;if(e.top_type&&(o=e.top_type),o.render_z,e.type.render_z!=e.lastTile.z||e.lastDrawnType!=o){e.lastTile.z!=i.lastTileEmpty.z&&(this.tilemap.setTile(e.lastTile,void 0),e.lastTile=i.lastTileEmpty),e.lastDrawnType=o;var a=cc.v3(e.pos.x,e.pos.y,e.type.render_z);this.tilemap.setTile(a,this.getVariation(e,e.type)),e.lastTile=a}if(!OS_IOS)if(e.lastBorderOcean.z!=i.lastTileEmpty.z&&(this.tilemap.setTile(e.lastBorderOcean,void 0,!0),e.lastBorderOcean=i.lastTileEmpty),(e.main_type.ground||e.main_type.block)&&!e.main_type.canBeFilledWithOcean&&e.tile_down){var n=null;if(e.tile_down.main_type.canBeFilledWithOcean?(n=this.border_pit).render_z:e.tile_down.main_type.liquid&&!e.tile_down.main_type.lava&&(n=this.border_water).render_z,n){var r=cc.v3(e.pos.x,e.pos.y-1,n.render_z);this.tilemap.setTile(r,n.sprites.getVariation(0),!0),e.lastBorderOcean=r}}else e.main_type.liquid&&!e.main_type.lava&&e.tile_up&&(e.tile_up.main_type.ground||e.tile_up.main_type.block)&&!e.tile_up.main_type.canBeFilledWithOcean&&(r=cc.v3(e.pos.x,e.pos.y,this.border_water.render_z),this.tilemap.setTile(r,this.border_water.sprites.getRandom(),!0),e.tile_up.lastBorderOcean=r);this.inited||(this.inited=!0,this.tilemap.doDraw())}}},e.prototype.lateUpdate=function(t){this.redrawTime+=t,this.redrawTime>this.getRefreshTime()&&(this.tilemap.doDraw(),this.redrawTime=0)},e.prototype.getRefreshTime=function(){var t=this.tilemap.count<150?.1:1;return OS_IOS?2*t:t},e.prototype.enableTiles=function(t){this.redrawEnable=t,this.tilemap.setRendererEnabled(t)},e.prototype.getVariation=function(t,e){void 0===e&&(e=null);var i=t.main_type.sprites;return e?i=e.sprites:t.top_type&&(i=t.top_type.sprites),t.type.force_edge_variation&&null!=t.tile_up&&t.tile_up.type!=t.type?t.main_type.sprites.getVariation(t.main_type.force_edge_variation_frame):i.getRandom()},e.EMPTY_Z=-1e3,e.lastTileEmpty=cc.v3(-1,-1,-1e3),i=s([p],e)}(c.default));n.default=f,cc._RF.pop()},{}],WorldTile:[function(t,e,i){"use strict";cc._RF.push(e,"f92639hcSRDuYlA0A133n2c","WorldTile");var o=t,a=i,n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(a,"__esModule",{value:!0}),a.WorldTileZoneBorder=a.ColorArray=a.TileDirection=void 0;var r,s=o("AchievData"),l=o("MapAction"),c=o("ActionLibrary"),d=o("ActorBase"),u=o("AssetManager"),h=o("TileLibrary"),p=o("BaseBuilding"),f=o("ToolBox"),_=o("MapBox"),m=o("ConwayLife"),g=o("TileTypeBase"),y=o("WorldTileData"),v=o("WorldTilemap");(function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=3]="Down",t[t.Null=4]="Null"})(r=a.TileDirection||(a.TileDirection={})),a.ColorArray=function(t,e,i){void 0===i&&(i=1),this.colors=[],this.colors=[];for(var o=0;o<e;o++){var a=o<=0?0:1/e*o;this.colors.push(new cc.Color(t.r,t.g,t.b,a*i*255))}};var b=function(){function t(){this.corner_l_u=!1,this.corner_l_d=!1,this.corner_r_d=!1,this.corner_r_u=!1,this.borderUp=!1,this.borderLeft=!1,this.borderRight=!1,this.borderDown=!1,this.border=!1}return t.prototype.reset=function(){},t}();a.WorldTileZoneBorder=b;var w=function(){function t(t,e,i){this.top_type=null,this.main_type=null,this.cur_tile_type=null,this.clicked=!1,this.burned_stages=0,this.worldTileZoneBorder=new b,this.health=10,this.lastBorderTile=cc.v3(-1,-1,-1e3),this.lastBorderOcean=cc.v3(-1,-1,-1e3),this.lastTile=cc.v3(-1,-1,-1e3),this.delayedTimerBomb=0,this.delayedBombType="",this.lavaTick=0,this.data=new y.default,this.heat=0,this.explosionWave=0,this.explosionPower=0,this.grassTicksBeforeGrowth=0,this.targetedBy=null,this.world_edge=!1,this.tile_up=null,this.tile_down=null,this.tile_left=null,this.tile_right=null,this.neighbours=[],this.neighboursAll=[],this.roadIsland=null,this.pollinated=0,this.dirty=!1,this.needRedraw=!1,this.x=0,this.y=0,this.pos=cc.Vec2.ZERO,this.posV3=cc.Vec3.ZERO,this.buildingX=0,this.buildingY=0,this.flash_state=0,this.colorArray=null,this.edge_region_right=null,this.edge_region_up=null,this.region=null,this.zone=null,this.chunk=null,this.chunkEdge=!1,this.building=null,this.units=[],this.explosionFxStage=0,this.dirtyIslandTile=!1,this.checkedTile=!1,this.score=-1,this.debugColor=cc.Color.TRANSPARENT,this.lastTile=v.default.lastTileEmpty,this.data.tile_id=i,this.pos=cc.v2(t,e),this.posV3=cc.v3(t,e),this.posV3.x+=d.default.spriteOffset.x,this.posV3.y+=d.default.spriteOffset.y,this.x=t,this.y=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this.cur_tile_type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.data.height},set:function(t){this.data.height=t,this.data.height<0?this.data.height=0:this.data.height>255&&(this.data.height=255)},enumerable:!1,configurable:!0}),t.prototype.createNeighbourLists=function(){this.neighbours=[],this.neighboursAll=[]},t.prototype.pollinate=function(){this.pollinated++,this.pollinated>5&&(this.growFlowers(),this.pollinated=0),_.default.inst.placeBeehive&&s.default.update(20)},t.prototype.growFlowers=function(){var t=f.Toolbox.getRandomChunkFromTile(this).tiles.getRandom();t.type.grow_type_selector_plants&&_.default.inst.tryGrowVegetationRandom(t,p.VegetationType.Plants)},t.prototype.canBuildOn=function(t){return!(this.type.liquid&&!t.canBePlacedOnLiquid||t.burnable&&this.data.fire||t.affectedByLava&&this.type.lava||!t.canBePlacedOnBlocks&&this.type.block||!(t.ignoreBuildings||!this.building||this.building.isNonUsable()||this.building.city||this.building.stats.ignoredByCities)||!t.ignoreBuildings&&this.building&&this.building.stats.cityBuilding&&!this.building.isNonUsable()&&this.building.stats.priority>=t.priority)},t.prototype.setRoad=function(){_.default.inst.roadsCalculator.setDirty(this)},t.prototype.isSameIsland=function(t){return!!t&&(t.region&&this.region?t.region.island==this.region.island:t.region==this.region)},t.prototype.getColor=function(){return this.type.color},t.prototype.addNeighbour=function(t,e,i){if(void 0===i&&(i=!1),t)switch(i||this.neighbours.push(t),this.neighboursAll.push(t),e){case r.Up:this.tile_up=t;break;case r.Down:this.tile_down=t;break;case r.Left:this.tile_left=t;break;case r.Right:this.tile_right=t}else this.world_edge=!0},t.prototype.isOceanAround=function(){var t,e;try{for(var i=n(this.neighbours),o=i.next();!o.done;o=i.next())if(o.value.type.layerType==g.TileLayerType.Ocean)return!0}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.isGoodForBoat=function(){return this.type.layerType==g.TileLayerType.Ocean},t.prototype.isTypeAround=function(t){for(var e=0;e<this.neighbours.length;e++)if(this.neighbours[e].type==t)return!0;return!1},t.prototype.setFire=function(t){if(void 0===t&&(t=!1),this.type.explodable&&(_.default.inst.explosionLayer.explodeBomb(this),s.default.update(13)),!t&&(!this.type.burnable||this.data.fire))return!1;if(this.type.liquid)return!1;var e=!1;return this.building&&this.building.isBurnable()&&(c.default.addBurningEffectOnTarget(this.building),e=!0),(this.type.burnable||e||t)&&(e=!0,this.type.isType("fireworks")&&_.default.inst.stackEffects.spawnFireworks(this),this.data.fire_stage=f.Toolbox.randomRange(0,5),this.data.fire||this.zone.tilesOnFire++,this.type.burnable&&l.default.decreaseTile(this),this.data.fire=!0,_.default.inst.setTileDirty(this),_.default.inst.fireLayer.setTileDirty(this)),e},t.prototype.updateStats=function(){this.top_type?this.cur_tile_type=this.top_type:this.cur_tile_type=this.main_type},t.prototype.setTopTileType=function(t){this.top_type!=t&&(this.top_type&&this.zone.removeTileType(this.top_type,this),t&&this.zone.addTileType(t,this)),this.top_type&&this.top_type.hashsetRemove(this),this.top_type=t,this.top_type&&this.top_type.hashsetAdd(this),_.default.inst.setTileDirty(this),this.updateStats()},t.prototype.setTileType=function(e){(e="string"==typeof e?u.default.tiles.get(e):e)||(e=h.default.soil_low),this.main_type!=e&&(this.main_type&&this.zone.removeTileType(this.main_type,this),this.zone.addTileType(e,this)),this.health=t.DEFAULT_HEALTH,this.zone&&(this.main_type?(!this.main_type.liquid&&e.liquid?this.zone.tilesWithLiquid++:this.main_type.liquid&&!e.liquid&&this.zone.tilesWithLiquid--,!this.main_type.ground&&e.ground?this.zone.tilesWithGround++:this.main_type.ground&&!e.ground&&this.zone.tilesWithGround--):(e.liquid&&this.zone.tilesWithLiquid++,e.ground&&this.zone.tilesWithGround++)),this.main_type&&this.main_type.hashsetRemove(this),this.main_type=e,this.main_type.hashsetAdd(this),_.default.inst.setTileDirty(this),this.updateStats()},t.prototype.setBurned=function(t){void 0===t&&(t=-1),this.type.canBeSetOnFire&&(this.burned_stages=-1==t?15-f.Toolbox.randomRange(0,10):t,_.default.inst.burnedLayer.setTileDirty(this))},t.prototype.removeBurn=function(){0!=this.burned_stages&&(this.burned_stages=0,_.default.inst.burnedLayer.setTileDirty(this))},t.prototype.stopFire=function(t){void 0===t&&(t=!1),this.data.fire&&(this.zone.tilesOnFire--,this.data.fire=!1,this.data.fire_stage=0,_.default.inst.setTileDirty(this),this.setBurned(),_.default.inst.fireLayer.setTileDirty(this),t&&(this.grassTicksBeforeGrowth=5))},t.prototype.canGrow=function(){return!this.data.fire&&0==this.burned_stages},t.prototype.removeTrees=function(t){void 0===t&&(t=!0),t&&_.default.inst.flashEffects.flashPixel(this,20),_.default.inst.setTileDirty(this)},t.prototype.removeGrass=function(t){void 0===t&&(t=!0),t&&_.default.inst.flashEffects.flashPixel(this,20),l.default.removeGreens(this)},t.prototype.eatGreens=function(t){void 0===t&&(t=5),this.removeGrass(),this.grassTicksBeforeGrowth=t,s.default.update(8)},t.prototype.clearUnits=function(){this.units=[]},t.prototype.clear=function(){this.buildingX=0,this.buildingY=0,this.units=[],this.pollinated=0,this.setTileType(h.default.deep_ocean),this.setTopTileType(null),this.dirty=!1,this.needRedraw=!1,this.delayedTimerBomb=-1,this.height=0,this.heat=0,this.lavaTick=0,this.flash_state=0,this.burned_stages=0,this.building=null,this.data.conwayType=m.ConwayType.None,this.data.fire=!1,this.data.fire_stage=0,this.explosionFxStage=0,this.region=null,this.edge_region_right=null,this.edge_region_up=null,this.lastTile=v.default.lastTileEmpty,this.lastBorderTile=v.default.lastTileEmpty,this.worldTileZoneBorder.reset()},t.prototype.getHashCode=function(){return this.data.tile_id},t.prototype.equals=function(t){return this.data.tile_id==t.data.tile_id},t.DEFAULT_HEALTH=10,t}();a.default=w,cc._RF.pop()},{}],WorldTimer:[function(t,e,i){"use strict";cc._RF.push(e,"61482sRSXpCJZSGJcOCDuYF","WorldTimer");var o=i;Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(t,e){this.isActive=!1,this.isStopWatch=!1,this.callback=null,this.interval=0,this.timer=0,"function"==typeof e?(this.callback=e,this.timer=this.interval):this.isStopWatch=e,this.interval=t}return t.prototype.setTime=function(t){this.timer=t},t.prototype.setInterval=function(t){this.interval=t},t.prototype.startTimer=function(t){void 0===t&&(t=-1),-1!=t&&(this.interval=t),this.timer=this.interval},t.prototype.stop=function(){this.isActive=!1},t.prototype.logicUpdate=function(t){void 0===t&&(t=-1),-1==t&&(t=cc.director.getDeltaTime()),this.isStopWatch?this.timer>0?(this.timer-=t,this.isActive=!0):this.isActive=!1:this.timer>0?this.timer-=t:(this.timer=this.interval,this.callback())},t}();o.default=a,cc._RF.pop()},{}],WorldTip:[function(t,e,i){"use strict";cc._RF.push(e,"3d2674TYl5PS6umFWp4brv1","WorldTip");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(n,"__esModule",{value:!0});var l=a("GlobalNode"),c=a("LocalizedTextManager"),d=cc._decorator,u=d.ccclass,h=d.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.richText=null,e.topNode=null,e}var i;return r(e,t),i=e,e.prototype.onLoad=function(){i.inst=this,this.richText.node.active=!1},e.prototype.show=function(t,e,o){var a=this;void 0===e&&(e=!0),void 0===o&&(o="center"),e?(this.richText.string=this.addOutline(c.LocalizedTextManager.getText(t)),i.replacementDict&&(this.richText.string=this.addOutline(i.replaceWords(this.richText.string)))):this.richText.string=this.addOutline(t),this.richText.node.position="center"==o?cc.Vec3.ZERO:"top"==o?this.topNode.position:cc.v3(this.richText.node.parent.convertToNodeSpaceAR(l.default.inst.touchPos)),this.richText.node.stopAllActions(),this.richText.node.active=!0,this.richText.node.scale=.75,this.richText.node.opacity=0,cc.tween(this.richText.node).to(.2,{scale:.5,opacity:255}).delay(3).to(.5,{opacity:0}).call(function(){a.richText.node.active=!1}).start()},e.prototype.hide=function(){var t=this;this.richText.node.stopAllActions(),cc.tween(this.richText.node).to(.5,{opacity:0}).call(function(){t.richText.node.active=!1}).start()},e.addWordReplacement=function(t,e){i.replacementDict||(i.replacementDict=new Map),i.replacementDict.set(t,e)},e.replaceWords=function(t){return i.replacementDict.forEach(function(e,i){t=t.replace(i,e)}),i.replacementDict=null,t},e.prototype.addOutline=function(t){return"<outline color=black width=4>"+t+"</outline>"},e.inst=null,e.replacementDict=new Map,s([h(cc.RichText)],e.prototype,"richText",void 0),s([h(cc.Node)],e.prototype,"topNode",void 0),i=s([u],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],ZoneCalculator:[function(t,e,i){"use strict";cc._RF.push(e,"d41712UyM9DBqPl4JPUvp/4","ZoneCalculator");var o,a=t,n=i,r=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.RelationColor=n.ZoneDisplayMode=void 0;var c,d=a("MathUtils"),u=a("SetUtils"),h=a("ToolBox"),p=a("Config"),f=a("MapBox"),_=a("MapLayer"),m=a("TileZone"),g=a("WorldTile");(function(t){t[t.None=0]="None",t[t.CityBorders=1]="CityBorders",t[t.Relations=2]="Relations",t[t.Cultures=3]="Cultures",t[t.KingdomBorders=4]="KingdomBorders"})(c=n.ZoneDisplayMode||(n.ZoneDisplayMode={}));var y=function(t){this.color=cc.Color.TRANSPARENT,this.border=cc.Color.TRANSPARENT,this.color=h.Toolbox.makeColor(t),this.border=h.Toolbox.makeColor(t),this.color.a=153};n.RelationColor=y;var v=cc._decorator,b=v.ccclass,w=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.color1=cc.Color.GRAY,e.color2=cc.Color.WHITE,e.color_selected=null,e.color_ally=null,e.color_enemy=null,e.zones=[],e.zonesDict_id=new Map,e.map=[],e.checkKingdom=!1,e._dirty=!1,e._lastSelectedKingdom=null,e._currentDrawnZones=new Set,e._toCleanUp=new Set,e._debug_redrawn_last_amount=0,e._debug_redrawn_last=0,e._redraw_timer=0,e._drawZones_dirty=!1,e._mode=null,e.totalZonesX=0,e.totalZonesY=0,e.highlight_kingdom=null,e.highlight_city=null,e.highlight_culture=null,e}return r(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.zones.length},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.colorValues=cc.color(255,.46*255,48.45,255),this.color_selected=new y("#ffffff"),this.color_ally=new y("#00ff00"),this.color_enemy=new y("#ff0000"),t.prototype.create.call(this),this.sprRnd.node.opacity=198.9},e.prototype.clear=function(){var e,i;t.prototype.clear.call(this);try{for(var o=l(this.zones),a=o.next();!a.done;a=o.next())a.value.clear()}catch(s){e={error:s}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}this._currentDrawnZones.clear(),this._toCleanUp.clear()},e.prototype.generate=function(){this.zones=[],this.zonesDict_id.clear(),this.totalZonesX=8*p.default.ZONE_AMOUNT_X,this.totalZonesY=8*p.default.ZONE_AMOUNT_Y;for(var t=0,e=0;e<this.totalZonesY;e++)for(var i=0;i<this.totalZonesX;i++){var o=new m.default(i,e,t++);o.debug_zone_color=(i+e)%2==0?this.color1:this.color2,this.map[i]||(this.map[i]=[]),this.map[i][e]=o,this.zones.push(o),this.zonesDict_id.set(o.id,o),this.fillZone(o)}this.generateNeighbours(),this.zones.shuffle()},e.prototype.getZoneByID=function(t){return this.zonesDict_id.get(t)},e.prototype.getZone=function(t,e){return t<0||t>=this.totalZonesX||e<0||e>=this.totalZonesY?null:this.map[t][e]},e.prototype.generateNeighbours=function(){for(var t=0;t<this.zones.length;t++){var e=this.zones[t];e.neighbours=[],e.neighboursAll=[];var i=this.getZone(e.x-1,e.y);e.addNeighbour(i,g.TileDirection.Left),i=this.getZone(e.x+1,e.y),e.addNeighbour(i,g.TileDirection.Right),i=this.getZone(e.x,e.y-1),e.addNeighbour(i,g.TileDirection.Down),i=this.getZone(e.x,e.y+1),e.addNeighbour(i,g.TileDirection.Up),i=this.getZone(e.x-1,e.y-1),e.addNeighbour(i,g.TileDirection.Null,!0),i=this.getZone(e.x-1,e.y+1),e.addNeighbour(i,g.TileDirection.Null,!0),i=this.getZone(e.x+1,e.y-1),e.addNeighbour(i,g.TileDirection.Null,!0),i=this.getZone(e.x+1,e.y+1),e.addNeighbour(i,g.TileDirection.Null,!0)}},e.prototype.fillZone=function(t){for(var e=8*t.x,i=8*t.y,o=0;o<8;o++)for(var a=0;a<8;a++){var n=f.default.inst.getTile(o+e,a+i);n&&(n.zone=t,t.addTile(n,o,a),4==o&&4==a&&(t.centerTile=n))}},e.prototype.checkDrawnZonesDirty=function(){var t,e;if(this._drawZones_dirty&&(this._drawZones_dirty=!1,this._redraw_timer=0,this._mode==c.Relations))try{for(var i=l(this._currentDrawnZones),o=i.next();!o.done;o=i.next()){var a=o.value;a.last_drawn_id=0,a.last_drawn_hashcode=0}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},e.prototype.logicUpdate=function(e){t.prototype.logicUpdate.call(this,e),this.checkDrawnZonesDirty(),f.default.inst.isSelectedPower("relations")?(this.setMode(c.Relations),this.sprRnd.enabled=!0):f.default.inst.showCityZones()?(this.setMode(c.CityBorders),this.sprRnd.enabled=!0):f.default.inst.showKingdomZones()?(this.setMode(c.KingdomBorders),this.sprRnd.enabled=!0):f.default.inst.showCultureZones()?(this.setMode(c.Cultures),this.sprRnd.enabled=!0):(this.setMode(c.None),this.sprRnd.enabled=!1),this.redrawZones(),t.prototype.logicUpdate.call(this,e)},e.prototype.setDrawnZonesDirty=function(){this._drawZones_dirty=!0},e.prototype.setMode=function(t){this._mode!=t&&(this._redraw_timer=0),this._mode=t},e.prototype.colorModeCultures=function(t){var e=t.culture;if(e){var i=this.isBorderColor_cultures(t.zone_up,e),o=this.isBorderColor_cultures(t.zone_down,e),a=this.isBorderColor_cultures(t.zone_left,e),n=this.isBorderColor_cultures(t.zone_right,e),r=1e7*d.default.intCast(this._mode),s=t.culture.hash;i&&(r+=1e5),o&&(r+=1e4),a&&(r+=1e3),n&&(r+=100);var l=!1;if(e==this.highlight_culture&&(r++,l=!0),t.last_drawn_id!=r||t.last_drawn_hashcode!=s){t.last_drawn_id=r,t.last_drawn_hashcode=s,this._dirty=!0;for(var c=0;c<t.tiles.length;c++){var u=t.tiles[c];l?this.updateSinglePixel(u.data.tile_id,cc.Color.WHITE):u.worldTileZoneBorder.border?u.worldTileZoneBorder.borderUp&&i?this.updateSinglePixel(u.data.tile_id,e.color32_border):u.worldTileZoneBorder.borderDown&&o?this.updateSinglePixel(u.data.tile_id,e.color32_border):u.worldTileZoneBorder.borderLeft&&a?this.updateSinglePixel(u.data.tile_id,e.color32_border):u.worldTileZoneBorder.borderRight&&n?this.updateSinglePixel(u.data.tile_id,e.color32_border):this.updateSinglePixel(u.data.tile_id,e.color32):this.updateSinglePixel(u.data.tile_id,e.color32)}}}},e.prototype.colorModeRelations=function(t){if(p.default.selectedKingdom){var e=t.city.kingdom==p.default.selectedKingdom?this.color_selected:t.city.kingdom.isEnemy(p.default.selectedKingdom)?this.color_enemy:this.color_ally,i=this.isBorderColor_relations(t.zone_up,t.city,!0),o=this.isBorderColor_relations(t.zone_down,t.city),a=this.isBorderColor_relations(t.zone_left,t.city),n=this.isBorderColor_relations(t.zone_right,t.city,!0),r=1e7*d.default.intCast(this._mode),s=p.default.selectedKingdom.hashcode;if(i&&(r+=1e5),o&&(r+=1e4),a&&(r+=1e3),n&&(r+=100),s++,t.last_drawn_id!=r||t.last_drawn_hashcode!=s){t.last_drawn_id=r,t.last_drawn_hashcode=s,this._dirty=!0;for(var l=0;l<t.tiles.length;l++){var c=t.tiles[l];c.worldTileZoneBorder.border?c.worldTileZoneBorder.borderUp&&i?this.updateSinglePixel(c.data.tile_id,e.border):c.worldTileZoneBorder.borderDown&&o?this.updateSinglePixel(c.data.tile_id,e.border):c.worldTileZoneBorder.borderLeft&&a?this.updateSinglePixel(c.data.tile_id,e.border):c.worldTileZoneBorder.borderRight&&n?this.updateSinglePixel(c.data.tile_id,e.border):this.updateSinglePixel(c.data.tile_id,e.color):this.updateSinglePixel(c.data.tile_id,e.color)}this._debug_redrawn_last_amount++}}},e.prototype.colorModKingdomBorders=function(t){var e;if(null===(e=null==t?void 0:t.city)||void 0===e?void 0:e.kingdom){var i=t.city.kingdom.kingdomColor.colorBorderInsideAlpha.clone();i.a=125;var o=t.city.kingdom.kingdomColor.colorBorderOut,a=this.isBorderColor_kingdoms(t.zone_up,t.city,!0),n=this.isBorderColor_kingdoms(t.zone_down,t.city),r=this.isBorderColor_kingdoms(t.zone_left,t.city),s=this.isBorderColor_kingdoms(t.zone_right,t.city,!0),l=1e7*d.default.intCast(this._mode),c=t.city.kingdom.hashcode;a&&(l+=1e5),n&&(l+=1e4),r&&(l+=1e3),s&&(l+=100);var u=!1;if(t.city.kingdom==this.highlight_kingdom&&(l++,u=!0),t.last_drawn_id!=l||t.last_drawn_hashcode!=c){t.last_drawn_id=l,t.last_drawn_hashcode=c,this._dirty=!0;for(var h=0;h<t.tiles.length;h++){var p=t.tiles[h];u?this.updateSinglePixel(p.data.tile_id,cc.Color.WHITE):p.worldTileZoneBorder.border?p.worldTileZoneBorder.borderUp&&a?this.updateSinglePixel(p.data.tile_id,o):p.worldTileZoneBorder.borderDown&&n?this.updateSinglePixel(p.data.tile_id,o):p.worldTileZoneBorder.borderLeft&&r?this.updateSinglePixel(p.data.tile_id,o):p.worldTileZoneBorder.borderRight&&s?this.updateSinglePixel(p.data.tile_id,o):this.updateSinglePixel(p.data.tile_id,i):this.updateSinglePixel(p.data.tile_id,i)}this._debug_redrawn_last_amount++}}},e.prototype.colorModCityBorders=function(t){var e,i,o;if(null===(o=null===(i=null===(e=t.city)||void 0===e?void 0:e.kingdom)||void 0===i?void 0:i.data)||void 0===o?void 0:o.alive){var a=t.city.kingdom.kingdomColor.colorBorderInsideAlpha.clone();a.a=125;var n=t.city.kingdom.kingdomColor.colorBorderOut,r=this.isBorderColor_cities(t.zone_up,t.city,!0),s=this.isBorderColor_cities(t.zone_down,t.city),l=this.isBorderColor_cities(t.zone_left,t.city),c=this.isBorderColor_cities(t.zone_right,t.city,!0),u=1e7*d.default.intCast(this._mode),h=t.city.hashcode;r&&(u+=1e5),s&&(u+=1e4),l&&(u+=1e3),c&&(u+=100),u+=t.city.kingdom.hashcode;var p=!1;if(t.city==this.highlight_city&&(u++,p=!0),t.last_drawn_id!=u||t.last_drawn_hashcode!=h){t.last_drawn_id=u,t.last_drawn_hashcode=h,this._dirty=!0;for(var f=0;f<t.tiles.length;f++){var _=t.tiles[f];p?this.updateSinglePixel(_.data.tile_id,cc.Color.WHITE):_.worldTileZoneBorder.border?_.worldTileZoneBorder.borderUp&&r?this.updateSinglePixel(_.data.tile_id,n):_.worldTileZoneBorder.borderDown&&s?this.updateSinglePixel(_.data.tile_id,n):_.worldTileZoneBorder.borderLeft&&l?this.updateSinglePixel(_.data.tile_id,n):_.worldTileZoneBorder.borderRight&&c?this.updateSinglePixel(_.data.tile_id,n):this.updateSinglePixel(_.data.tile_id,a):this.updateSinglePixel(_.data.tile_id,a)}this._debug_redrawn_last_amount++}}},e.prototype.colorZone=function(t,e){if(void 0===e&&(e=null),e){this._dirty=!0;for(var i=0;i<t.tiles.length;i++){var o=t.tiles[i];this.updateSinglePixel(o.data.tile_id,e)}}else{switch(this.checkKingdom=!0,this._mode){case c.Relations:this.colorModeRelations(t);break;case c.CityBorders:this.colorModCityBorders(t);break;case c.KingdomBorders:this.colorModKingdomBorders(t);break;case c.Cultures:this.colorModeCultures(t)}this._currentDrawnZones.add(t),this._toCleanUp.delete(t)}},e.prototype.isBorderColor_cultures=function(t,e,i){return void 0===i&&(i=!1),!t||!t.culture||t.culture!=e},e.prototype.isBorderColor_relations=function(t,e,i){return void 0===i&&(i=!1),!(t&&t.city!=e&&t.city&&t.city.kingdom==e.kingdom||t&&t.city&&t.city.kingdom==e.kingdom)},e.prototype.isBorderColor_kingdoms=function(t,e,i){return void 0===i&&(i=!1),!(i&&null!=t&&t.city!=e&&null!=t.city&&this.checkKingdom&&t.city.kingdom==e.kingdom||(this.checkKingdom?t&&t.city&&t.city.kingdom==e.kingdom:t&&t.city==e))},e.prototype.isBorderColor_cities=function(t,e,i){return void 0===i&&(i=!1),!(i&&t&&t.city!=e&&t.city&&this.checkKingdom&&t.city.kingdom==e.kingdom||(this.checkKingdom?t&&t.city&&t.city.kingdom==e.kingdom&&t.city==e:t&&t.city==e))},e.prototype.checkHighlight=function(){if(this.highlight_kingdom=null,this.highlight_city=null,this.highlight_culture=null,!(f.default.inst.isSelectedPowerAny()&&f.default.inst.isPowerForceMapMode()||f.default.inst.isKeyDownCode>=0)&&f.default.inst.qualityChanger.lowRes){var t=f.default.inst.getMouseTilePos(),e=this.getCurrentMode();f.default.inst.isPowerForceMapMode(_.MapMode.Villages)&&(e=_.MapMode.Villages),t&&(e==_.MapMode.Cultures&&t.zone.culture?(this.highlight_culture=t.zone.culture,this._redraw_timer=0):e==_.MapMode.Kingdoms&&t.zone.city?(this.highlight_kingdom=t.zone.city.kingdom,this._redraw_timer=0):e==_.MapMode.Villages&&t.zone.city?(this.highlight_city=t.zone.city,this._redraw_timer=0):this._redraw_timer=0)}},e.prototype.getCurrentMode=function(){var t=_.MapMode.None;return(t=f.default.inst.getForcedMapMode())==_.MapMode.None&&(f.default.inst.showCultureZones()?t=_.MapMode.Cultures:f.default.inst.showKingdomZones()?t=_.MapMode.Kingdoms:f.default.inst.showCityZones()&&(t=_.MapMode.Villages)),t},e.prototype.redrawZones=function(){var t,e;if(this._lastSelectedKingdom!=p.default.selectedKingdom&&(this._lastSelectedKingdom=p.default.selectedKingdom,this._redraw_timer=0),this.checkHighlight(),this._redraw_timer>0)this._redraw_timer-=cc.director.getDeltaTime();else{if(this._redraw_timer=.3,this._dirty=!1,this._debug_redrawn_last_amount=0,this._currentDrawnZones.size>0&&(this._toCleanUp=u.default.addRange(this._toCleanUp,this._currentDrawnZones)),this.sprRnd.enabled)switch(this._mode){case c.KingdomBorders:for(var i=0;i<f.default.inst.kingdoms.list.length;i++)for(var o=f.default.inst.kingdoms.list[i],a=0;a<o.cities.length;a++)for(var n=o.cities[a],r=0;r<n.zones.length;r++){var s=n.zones[r];this.colorZone(s)}break;case c.CityBorders:for(var d=0;d<f.default.inst.citiesList.length;d++)for(var h=f.default.inst.citiesList[d],_=0;_<h.zones.length;_++){var m=h.zones[_];this.colorZone(m)}break;case c.Relations:for(var g=0;g<f.default.inst.citiesList.length;g++)for(var y=f.default.inst.citiesList[g],v=0;v<y.zones.length;v++){var b=y.zones[v];this.colorZone(b)}break;case c.Cultures:for(var w=0;w<f.default.inst.cultures.list.length;w++)try{for(var T=(t=void 0,l(f.default.inst.cultures.list[w].zones)),k=T.next();!k.done;k=T.next()){var B=k.value;this.colorZone(B)}}catch(S){t={error:S}}finally{try{k&&!k.done&&(e=T.return)&&e.call(T)}finally{if(t)throw t.error}}}this._toCleanUp.size>0&&this.clearDrawnZones(),this._dirty&&this.updatePixels()}},e.prototype.clearDrawnZones=function(){var t,e;try{for(var i=l(this._toCleanUp),o=i.next();!o.done;o=i.next()){var a=o.value;this.colorZone(a,h.Toolbox.clear),a.last_drawn_id=0,a.last_drawn_hashcode=0,this._currentDrawnZones.delete(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}this._toCleanUp.clear()},s([w(cc.Color)],e.prototype,"color1",void 0),s([w(cc.Color)],e.prototype,"color2",void 0),s([b],e)}(_.default);n.default=T,cc._RF.pop()},{}]},{},["AStarFinder","AStarParam","AchievementItem","AchievementToast","AchievementView","ActionLibrary","ActiveStatusEffect","Actor","ActorAnimationLoader","ActorAsset","ActorBag","ActorBase","ActorEquipment","ActorEquipmentSlot","ActorJob","ActorJobLibrary","ActorMove","ActorStats","ActorStatsLibrary","ActorStatus","ActorTool","ActorTraitLibrary","AdView","AiSystem","Ant","AntimatterBombEffect","AppBoxView","AssetLibrary","AssetManager","AwardView","Baby","BaseActorComponent","BaseAnimatedObject","BaseBuilding","BaseCondition","BaseContainer","BaseEffect","BaseEffectController","BaseMapObject","BaseObjectData","BaseSimObject","BaseStats","Batch","BatchActors","BatchBuildings","Bee","Beehive","BehActiveCrabDangerCheck","BehAngleAnimation","BehAnimalCheckHungry","BehAnimalFindTile","BehAttackActorTarget","BehBabymakingTime","BehBeeCheckHome","BehBeeCheckReturnHome","BehBeePollinate","BehBeeReturnHome","BehBoat","BehBoatCheckFishingRepeat","BehBoatCheckHomeDocks","BehBoatCollectFish","BehBoatDamageCheck","BehBoatDangerCheck","BehBoatFindOceanNeutralTile","BehBoatFindRequest","BehBoatFindTargetForTrade","BehBoatFindTileInDock","BehBoatFindWaterTile","BehBoatFishing","BehBoatMakeTrade","BehBoatSetHomeDockTarget","BehBoatTransportCheck","BehBoatTransportDoLoading","BehBoatTransportFindTilePickUp","BehBoatTransportFindTileUnload","BehBoatTransportUnloadUnits","BehBuildTargetProgress","BehBurnTumorTiles","BehCheckBuildCity","BehCheckCitizenJob","BehCheckCityArmyGroup","BehCheckCure","BehCheckHunger","BehCheckIfInLiquid","BehCheckIfOnGround","BehCheckIfOnSmallLand","BehChuckTargetBuildProgress","BehCity","BehCityCheckAttack","BehCityCreateRoad","BehCityFindBuilding","BehCityFindFireZone","BehCityFindNewJob","BehCityFindStorage","BehCityGetRandomZoneTile","BehCityRemoveFire","BehCitySettlerFindTileSameIsland","BehCitySettlerTaxiCheck","BehCityWarriorTaxiCheck","BehConsumeActorTarget","BehConsumeFlowers","BehConsumeGrass","BehConsumeTargetBuilding","BehConvertOre","BehCrabBurrow","BehEndJob","BehExitBuilding","BehExtractResourcesFromBuilding","BehFightCheckEnemyIsOk","BehFindBuilding","BehFindConstructionTile","BehFindEmptyNearbyCity","BehFindFarmField","BehFindGoldenBrain","BehFindMeatSource","BehFindRandomCivBuildingTile","BehFindRandomFrontBuildingTile","BehFindRandomTile","BehFindSameRaceActor","BehFindTargetForHunter","BehFindTile","BehFindTileBeach","BehFindTileForCity","BehFindTileForFarm","BehFindTileNearbyGroupLeader","BehFindTileWhenOnFire","BehFindWheat","BehGetResourcesFromMine","BehGoOrSwimToTileTarget","BehGoToActorTarget","BehGoToBuildingTarget","BehGoToTileTarget","BehHeal","BehJoinCity","BehJumpingAnimation","BehLookAtTarget","BehMagicMakeSkeleton","BehMakeBaby","BehMakeFarm","BehMakeItem","BehMoveAwayFromBlock","BehPlantCrops","BehRandomSwim","BehRandomTeleport","BehRandomWait","BehRemoveRuins","BehRepairInDock","BehReplenishHunger","BehResourceGatheringAnimation","BehRestartTask","BehSetNextTask","BehShortRandomMove","BehSitInsideBoat","BehSkeletonFindTile","BehSpawnGrassSeeds","BehSpecialRat","BehStayInBuildingTarget","BehSwimToIsland","BehTaxiCheck","BehTaxiEmbark","BehTaxiFindShipTile","BehTryBabymaking","BehUnloadResources","BehWalkIntoWaterCorner","BehaviourActionActor","BehaviourActionBase","BehaviourActionCity","BehaviourTaskActor","BehaviourTaskActorLibrary","BehaviourTaskBase","BehaviourTaskCityLibrary","BehaviourTaskKingdomLibrary","Boat","Boulder","BoxGift","BoxMonster","Brush","BrushWindow","Building","BuildingCreepHUB","BuildingCreepWorker","BuildingEffectSpawnPixel","BuildingFruitGrowth","BuildingLibrary","BuildingMapIcon","BuildingSmokeEffect","BuildingTower","BurnedTilesLayer","CachedRaycastIslands","CensusInfo","ChineseNameGenerator","ChineseNameLibrary","CitiesElement","CitiesListWindow","City","CityBehBorderGrowth","CityBehBorderSteal","CityBehBuild","CityBehBuildDocks","CityBehCheckArmy","CityBehCheckAttackZone","CityBehCheckCitizenTasks","CityBehCheckCulture","CityBehCheckPopPoints","CityBehCheckSettleTarget","CityBehFindLeader","CityBehGiveInventoryItem","CityBehProduceBoat","CityBehProduceResources","CityBehProduceUnit","CityBehRandomWait","CityBehSupplyKingdomCities","CityBehUpgradeRandomBuilding","CityBuildOrder","CityCheckAbandonZones","CityInfoElement","CityJobLibrary","CityJobs","CityPlaceFinder","CityStorage","CityTaskList","CityWindow","Cloud","CloudController","CondGroupLeader","CondHaveAttackTarget","CondHaveUnitGroup","CondNoAttackTarget","CondNoUnitGroup","CondNotGroupLeader","Config","ConwayLife","CreatureInfo","Culture","CultureElement","CultureManager","CultureTechLibrary","CultureWindow","CulturesListWindow","CumulativeReward","DebugConfig","DiplomacyManager","DiplomacyRelation","DisasterLibrary","Docks","Dragon","DragonAsset","Drop","DropManager","DropsLibrary","Earthquake","EffectDivineLight","EffectInfinityCoin","Egg","ExplosionChecker","ExplosionFlash","ExplosionsEffects","FamilysManager","FavoriteElement","FavoritesWindow","FireLayer","FogLayer","GMView","GameAudio","GameUtils","GeneratorTool","Globals","GlowParticles","GodActions","GodFinger","GodPower","GreyGooLayer","GuideController","Heat","HeatRayEffect","HistoryHud","HistoryHudItem","HoverModule","IceTower","InfiniteProp","IslandsCalculator","ItemAccessoryMaterialLibrary","ItemArmorMaterialLibrary","ItemGenerator","ItemLibrary","ItemPrefixLibrary","ItemSuffixLibrary","ItemTools","ItemWeaponMaterialLibrary","JobManager","Kingdom","KingdomBehCheckCapital","KingdomBehCheckCulture","KingdomBehCheckKing","KingdomBehRandomWait","KingdomCheckAttackTarget","KingdomCheckDeadKingdom","KingdomCheckDiplomacy","KingdomCheckRevolts","KingdomColor","KingdomColorContainer","KingdomColors","KingdomElement","KingdomJobLibrary","KingdomLibrary","KingdomListWindow","KingdomManager","KingdomOpinion","KingdomStats","KingdomWindow","LavaLayer","LuckyWheel","MapAction","MapBorder","MapBox","MapChunk","MapChunkManager","MapEdges","MapGenerator","MapLayer","MapMark","MapMarks","MapNamesManager","MapObjectShadow","MapRegion","MapSetting","MapStats","MapText","MarkContainer","Meteorite","ModModule","MoodLibrary","MoveCamera","MysteryButton","MysteryReward","NameGenerator","NameGeneratorLibrary","NapalmFlash","NukeFlash","OceanHelper","OnlineReward","PathFindingVisualiser","PathfinderTools","PersonalityLibrary","PixelFlashEffects","PlayerConfig","PowerActionsModule","PowerButton","PowerButtonSelector","PowerLibrary","PrefabLibrary","PrintLibrary","ProfessionLibrary","Projectile","ProjectileLibrary","QQLimitedGifts","QualityChanger","Race","RaceLibrary","RankListLayer","RecordShare","RegionLinkHashes","RegionPathFinder","ResourceLibrary","RoadsCalculator","Santa","SantaAnimation","SaveItem","SaveList","SaveManager","SavePopup","SavedMap","SelectedPowerNameTip","Setting","SignInSystem","SignInView","Smoke","SmoothLoader","SpawnEffect","SpellLibrary","SpriteAnimation","StackEffects","StaticGrid","StatsData","StatsHelper","StatusLibrary","StatusParticle","StoreView","TaxiManager","TaxiRequest","TechElement","TerraformLibrary","TextureBuffer","TextureLoader","TextureRotator","TextureScale","TileActionLibrary","TileDictionary","TileIsland","TileLibrary","TileMap","TileTypeBase","TileZone","TimeScale","ToolBox","ToolTip","TopTileLibrary","Tornado","UFO","UiController","UnLockProp","UnitAvatarLoader","UnitGroupManager","UnitLayer","UnitSelectionEffect","UnitSpawner","UnitSpriteAnimation","UnitZones","UnusedLibrary","VideoBanner","VideoInterstitial","ViewController","VortexAction","Wave","WaveController","Wheat","WorldAction","WorldBehaviour","WorldBehaviourActionBurnedTiles","WorldBehaviourActionCreepBiomass","WorldBehaviourActionCreepDegeneration","WorldBehaviourActionEnchanted","WorldBehaviourActionErosion","WorldBehaviourActionFire","WorldBehaviourActionGrass","WorldBehaviourActionInferno","WorldBehaviourActionSwampAnimation","WorldBehaviourActions","WorldBehaviourOcean","WorldBehaviourUnitTemperatures","WorldInfoWindow","WorldLawWindow","WorldLaws","WorldLog","WorldLogElement","WorldLogMessageExtensions","WorldLogWindow","WorldNameGenerator","WorldTile","WorldTileData","WorldTilemap","WorldTimer","WorldTip","ZoneCalculator"]);